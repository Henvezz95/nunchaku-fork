Using pip 22.0.2 from /workspace/nunchaku/venv/lib/python3.10/site-packages/pip (python 3.10)
Obtaining file:///workspace/nunchaku
  Installing build dependencies: started
  Running command pip subprocess to install build dependencies
  Collecting setuptools
    Downloading setuptools-80.9.0-py3-none-any.whl (1.2 MB)
       ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 11.0 MB/s eta 0:00:00
  Collecting torch>=2.5
    Downloading torch-2.7.1-cp310-cp310-manylinux_2_28_aarch64.whl (99.1 MB)
       ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 99.1/99.1 MB 106.7 MB/s eta 0:00:00
  Collecting wheel
    Downloading wheel-0.45.1-py3-none-any.whl (72 kB)
       ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 72.5/72.5 KB 125.5 MB/s eta 0:00:00
  Collecting ninja
    Downloading ninja-1.11.1.4-py3-none-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (156 kB)
       ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 157.0/157.0 KB 134.2 MB/s eta 0:00:00
  Collecting filelock
    Downloading filelock-3.18.0-py3-none-any.whl (16 kB)
  Collecting jinja2
    Downloading jinja2-3.1.6-py3-none-any.whl (134 kB)
       ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 134.9/134.9 KB 157.5 MB/s eta 0:00:00
  Collecting sympy>=1.13.3
    Downloading sympy-1.14.0-py3-none-any.whl (6.3 MB)
       ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.3/6.3 MB 108.6 MB/s eta 0:00:00
  Collecting typing-extensions>=4.10.0
    Downloading typing_extensions-4.14.1-py3-none-any.whl (43 kB)
       ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 43.9/43.9 KB 84.8 MB/s eta 0:00:00
  Collecting networkx
    Downloading networkx-3.4.2-py3-none-any.whl (1.7 MB)
       ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.7/1.7 MB 113.4 MB/s eta 0:00:00
  Collecting fsspec
    Downloading fsspec-2025.7.0-py3-none-any.whl (199 kB)
       ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 199.6/199.6 KB 121.0 MB/s eta 0:00:00
  Collecting mpmath<1.4,>=1.1.0
    Downloading mpmath-1.3.0-py3-none-any.whl (536 kB)
       ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 536.2/536.2 KB 107.6 MB/s eta 0:00:00
  Collecting MarkupSafe>=2.0
    Downloading MarkupSafe-3.0.2-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (21 kB)
  Installing collected packages: mpmath, wheel, typing-extensions, sympy, setuptools, ninja, networkx, MarkupSafe, fsspec, filelock, jinja2, torch
  Successfully installed MarkupSafe-3.0.2 filelock-3.18.0 fsspec-2025.7.0 jinja2-3.1.6 mpmath-1.3.0 networkx-3.4.2 ninja-1.11.1.4 setuptools-80.9.0 sympy-1.14.0 torch-2.7.1 typing-extensions-4.14.1 wheel-0.45.1
  Installing build dependencies: finished with status 'done'
  Checking if build backend supports build_editable: started
  Running command Checking if build backend supports build_editable
  Checking if build backend supports build_editable: finished with status 'done'
  Getting requirements to build editable: started
  Running command Getting requirements to build editable
  Found nvcc version: 12.8.61
  Detected SM targets: ['87']
  /usr/local/lib/python3.10/dist-packages/setuptools/dist.py:330: InformationOnly: Normalizing '0.3.2dev20250805+torch2.6' to '0.3.2.dev20250805+torch2.6'
    self.metadata.version = self._normalize_version(self.metadata.version)
  running egg_info
  writing nunchaku.egg-info/PKG-INFO
  writing dependency_links to nunchaku.egg-info/dependency_links.txt
  writing requirements to nunchaku.egg-info/requires.txt
  writing top-level names to nunchaku.egg-info/top_level.txt
  reading manifest file 'nunchaku.egg-info/SOURCES.txt'
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.hpp' under directory 'src'
  warning: no files found matching '*.ipp' under directory 'src'
  warning: no files found matching '*.hpp' under directory 'nunchaku/csrc'
  warning: no files found matching '*.ipp' under directory 'nunchaku/csrc'
  warning: no files found matching '*.cuh' under directory 'nunchaku/csrc'
  warning: no files found matching '*.hpp' under directory 'third_party/Block-Sparse-Attention/csrc/block_sparse_attn'
  warning: no files found matching '*.ipp' under directory 'third_party/Block-Sparse-Attention/csrc/block_sparse_attn'
  warning: no files found matching '*.cpp' under directory 'third_party/cutlass/include'
  warning: no files found matching '*.ipp' under directory 'third_party/cutlass/include'
  warning: no files found matching '*.cu' under directory 'third_party/cutlass/include'
  warning: no files found matching '*.cuh' under directory 'third_party/cutlass/include'
  warning: no files found matching '*.cpp' under directory 'third_party/json/include'
  warning: no files found matching '*.h' under directory 'third_party/json/include'
  warning: no files found matching '*.ipp' under directory 'third_party/json/include'
  warning: no files found matching '*.cpp' under directory 'third_party/mio/include'
  warning: no files found matching '*.h' under directory 'third_party/mio/include'
  warning: no files found matching '*.cpp' under directory 'third_party/spdlog/include'
  warning: no files found matching '*.hpp' under directory 'third_party/spdlog/include'
  warning: no files found matching '*.ipp' under directory 'third_party/spdlog/include'
  adding license file 'LICENCE.txt'
  writing manifest file 'nunchaku.egg-info/SOURCES.txt'
  Getting requirements to build editable: finished with status 'done'
  Preparing editable metadata (pyproject.toml): started
  Running command Preparing editable metadata (pyproject.toml)
  Found nvcc version: 12.8.61
  Detected SM targets: ['87']
  /usr/local/lib/python3.10/dist-packages/setuptools/dist.py:330: InformationOnly: Normalizing '0.3.2dev20250805+torch2.6' to '0.3.2.dev20250805+torch2.6'
    self.metadata.version = self._normalize_version(self.metadata.version)
  running dist_info
  creating /tmp/pip-modern-metadata-oge9exbe/nunchaku.egg-info
  writing /tmp/pip-modern-metadata-oge9exbe/nunchaku.egg-info/PKG-INFO
  writing dependency_links to /tmp/pip-modern-metadata-oge9exbe/nunchaku.egg-info/dependency_links.txt
  writing requirements to /tmp/pip-modern-metadata-oge9exbe/nunchaku.egg-info/requires.txt
  writing top-level names to /tmp/pip-modern-metadata-oge9exbe/nunchaku.egg-info/top_level.txt
  writing manifest file '/tmp/pip-modern-metadata-oge9exbe/nunchaku.egg-info/SOURCES.txt'
  reading manifest file '/tmp/pip-modern-metadata-oge9exbe/nunchaku.egg-info/SOURCES.txt'
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.hpp' under directory 'src'
  warning: no files found matching '*.ipp' under directory 'src'
  warning: no files found matching '*.hpp' under directory 'nunchaku/csrc'
  warning: no files found matching '*.ipp' under directory 'nunchaku/csrc'
  warning: no files found matching '*.cuh' under directory 'nunchaku/csrc'
  warning: no files found matching '*.hpp' under directory 'third_party/Block-Sparse-Attention/csrc/block_sparse_attn'
  warning: no files found matching '*.ipp' under directory 'third_party/Block-Sparse-Attention/csrc/block_sparse_attn'
  warning: no files found matching '*.cpp' under directory 'third_party/cutlass/include'
  warning: no files found matching '*.ipp' under directory 'third_party/cutlass/include'
  warning: no files found matching '*.cu' under directory 'third_party/cutlass/include'
  warning: no files found matching '*.cuh' under directory 'third_party/cutlass/include'
  warning: no files found matching '*.cpp' under directory 'third_party/json/include'
  warning: no files found matching '*.h' under directory 'third_party/json/include'
  warning: no files found matching '*.ipp' under directory 'third_party/json/include'
  warning: no files found matching '*.cpp' under directory 'third_party/mio/include'
  warning: no files found matching '*.h' under directory 'third_party/mio/include'
  warning: no files found matching '*.cpp' under directory 'third_party/spdlog/include'
  warning: no files found matching '*.hpp' under directory 'third_party/spdlog/include'
  warning: no files found matching '*.ipp' under directory 'third_party/spdlog/include'
  adding license file 'LICENCE.txt'
  writing manifest file '/tmp/pip-modern-metadata-oge9exbe/nunchaku.egg-info/SOURCES.txt'
  creating '/tmp/pip-modern-metadata-oge9exbe/nunchaku-0.3.2.dev20250805+torch2.6.dist-info'
  Preparing editable metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: huggingface_hub in /home/evezzali/.local/lib/python3.10/site-packages (from nunchaku==0.3.2.dev20250805+torch2.6) (0.30.2)
Requirement already satisfied: sentencepiece in /home/evezzali/.local/lib/python3.10/site-packages (from nunchaku==0.3.2.dev20250805+torch2.6) (0.2.0)
Requirement already satisfied: accelerate in /home/evezzali/.local/lib/python3.10/site-packages (from nunchaku==0.3.2.dev20250805+torch2.6) (1.6.0)
Requirement already satisfied: transformers in /home/evezzali/.local/lib/python3.10/site-packages (from nunchaku==0.3.2.dev20250805+torch2.6) (4.51.3)
Requirement already satisfied: diffusers>=0.32.2 in /home/evezzali/.local/lib/python3.10/site-packages (from nunchaku==0.3.2.dev20250805+torch2.6) (0.32.2)
Requirement already satisfied: protobuf in /usr/local/lib/python3.10/dist-packages (from nunchaku==0.3.2.dev20250805+torch2.6) (5.29.3)
Requirement already satisfied: importlib-metadata in /usr/lib/python3/dist-packages (from diffusers>=0.32.2->nunchaku==0.3.2.dev20250805+torch2.6) (4.6.4)
Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from diffusers>=0.32.2->nunchaku==0.3.2.dev20250805+torch2.6) (2.2.2)
Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from diffusers>=0.32.2->nunchaku==0.3.2.dev20250805+torch2.6) (2.32.3)
Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from diffusers>=0.32.2->nunchaku==0.3.2.dev20250805+torch2.6) (3.17.0)
Requirement already satisfied: safetensors>=0.3.1 in /home/evezzali/.local/lib/python3.10/site-packages (from diffusers>=0.32.2->nunchaku==0.3.2.dev20250805+torch2.6) (0.5.3)
Requirement already satisfied: regex!=2019.12.17 in /home/evezzali/.local/lib/python3.10/site-packages (from diffusers>=0.32.2->nunchaku==0.3.2.dev20250805+torch2.6) (2024.11.6)
Requirement already satisfied: Pillow in /home/evezzali/.local/lib/python3.10/site-packages (from diffusers>=0.32.2->nunchaku==0.3.2.dev20250805+torch2.6) (11.2.1)
Requirement already satisfied: tqdm>=4.42.1 in /home/evezzali/.local/lib/python3.10/site-packages (from huggingface_hub->nunchaku==0.3.2.dev20250805+torch2.6) (4.67.1)
Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.10/dist-packages (from huggingface_hub->nunchaku==0.3.2.dev20250805+torch2.6) (2025.2.0)
Requirement already satisfied: packaging>=20.9 in /usr/local/lib/python3.10/dist-packages (from huggingface_hub->nunchaku==0.3.2.dev20250805+torch2.6) (24.2)
Requirement already satisfied: pyyaml>=5.1 in /home/evezzali/.local/lib/python3.10/site-packages (from huggingface_hub->nunchaku==0.3.2.dev20250805+torch2.6) (6.0.2)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface_hub->nunchaku==0.3.2.dev20250805+torch2.6) (4.12.2)
Requirement already satisfied: torch>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from accelerate->nunchaku==0.3.2.dev20250805+torch2.6) (2.6.0)
Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate->nunchaku==0.3.2.dev20250805+torch2.6) (6.1.1)
Requirement already satisfied: tokenizers<0.22,>=0.21 in /home/evezzali/.local/lib/python3.10/site-packages (from transformers->nunchaku==0.3.2.dev20250805+torch2.6) (0.21.1)
Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=2.0.0->accelerate->nunchaku==0.3.2.dev20250805+torch2.6) (3.4.2)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=2.0.0->accelerate->nunchaku==0.3.2.dev20250805+torch2.6) (3.1.5)
Requirement already satisfied: sympy==1.13.1 in /usr/local/lib/python3.10/dist-packages (from torch>=2.0.0->accelerate->nunchaku==0.3.2.dev20250805+torch2.6) (1.13.1)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy==1.13.1->torch>=2.0.0->accelerate->nunchaku==0.3.2.dev20250805+torch2.6) (1.3.0)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->diffusers>=0.32.2->nunchaku==0.3.2.dev20250805+torch2.6) (3.10)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->diffusers>=0.32.2->nunchaku==0.3.2.dev20250805+torch2.6) (2025.1.31)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->diffusers>=0.32.2->nunchaku==0.3.2.dev20250805+torch2.6) (2.3.0)
Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->diffusers>=0.32.2->nunchaku==0.3.2.dev20250805+torch2.6) (3.4.1)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=2.0.0->accelerate->nunchaku==0.3.2.dev20250805+torch2.6) (3.0.2)
Building wheels for collected packages: nunchaku
  Building editable for nunchaku (pyproject.toml): started
  Running command Building editable for nunchaku (pyproject.toml)
  Found nvcc version: 12.8.61
  Detected SM targets: ['87']
  /usr/local/lib/python3.10/dist-packages/setuptools/dist.py:330: InformationOnly: Normalizing '0.3.2dev20250805+torch2.6' to '0.3.2.dev20250805+torch2.6'
    self.metadata.version = self._normalize_version(self.metadata.version)
  running editable_wheel
  creating /tmp/pip-wheel-92v_gjcq/.tmp-gb4bictp/nunchaku.egg-info
  writing /tmp/pip-wheel-92v_gjcq/.tmp-gb4bictp/nunchaku.egg-info/PKG-INFO
  writing dependency_links to /tmp/pip-wheel-92v_gjcq/.tmp-gb4bictp/nunchaku.egg-info/dependency_links.txt
  writing requirements to /tmp/pip-wheel-92v_gjcq/.tmp-gb4bictp/nunchaku.egg-info/requires.txt
  writing top-level names to /tmp/pip-wheel-92v_gjcq/.tmp-gb4bictp/nunchaku.egg-info/top_level.txt
  writing manifest file '/tmp/pip-wheel-92v_gjcq/.tmp-gb4bictp/nunchaku.egg-info/SOURCES.txt'
  reading manifest file '/tmp/pip-wheel-92v_gjcq/.tmp-gb4bictp/nunchaku.egg-info/SOURCES.txt'
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.hpp' under directory 'src'
  warning: no files found matching '*.ipp' under directory 'src'
  warning: no files found matching '*.hpp' under directory 'nunchaku/csrc'
  warning: no files found matching '*.ipp' under directory 'nunchaku/csrc'
  warning: no files found matching '*.cuh' under directory 'nunchaku/csrc'
  warning: no files found matching '*.hpp' under directory 'third_party/Block-Sparse-Attention/csrc/block_sparse_attn'
  warning: no files found matching '*.ipp' under directory 'third_party/Block-Sparse-Attention/csrc/block_sparse_attn'
  warning: no files found matching '*.cpp' under directory 'third_party/cutlass/include'
  warning: no files found matching '*.ipp' under directory 'third_party/cutlass/include'
  warning: no files found matching '*.cu' under directory 'third_party/cutlass/include'
  warning: no files found matching '*.cuh' under directory 'third_party/cutlass/include'
  warning: no files found matching '*.cpp' under directory 'third_party/json/include'
  warning: no files found matching '*.h' under directory 'third_party/json/include'
  warning: no files found matching '*.ipp' under directory 'third_party/json/include'
  warning: no files found matching '*.cpp' under directory 'third_party/mio/include'
  warning: no files found matching '*.h' under directory 'third_party/mio/include'
  warning: no files found matching '*.cpp' under directory 'third_party/spdlog/include'
  warning: no files found matching '*.hpp' under directory 'third_party/spdlog/include'
  warning: no files found matching '*.ipp' under directory 'third_party/spdlog/include'
  adding license file 'LICENCE.txt'
  writing manifest file '/tmp/pip-wheel-92v_gjcq/.tmp-gb4bictp/nunchaku.egg-info/SOURCES.txt'
  creating '/tmp/pip-wheel-92v_gjcq/.tmp-gb4bictp/nunchaku-0.3.2.dev20250805+torch2.6.dist-info'
  creating /tmp/pip-wheel-92v_gjcq/.tmp-gb4bictp/nunchaku-0.3.2.dev20250805+torch2.6.dist-info/WHEEL
  running build_py
  running build_ext
  /usr/local/lib/python3.10/dist-packages/torch/utils/cpp_extension.py:458: UserWarning: There are no aarch64-linux-gnu-g++ version bounds defined for CUDA version 12.8
    warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
  building 'nunchaku._C' extension
  creating /tmp/tmpup_b75_q.build-temp/nunchaku/csrc
  creating /tmp/tmpup_b75_q.build-temp/src
  creating /tmp/tmpup_b75_q.build-temp/src/interop
  creating /tmp/tmpup_b75_q.build-temp/src/kernels
  creating /tmp/tmpup_b75_q.build-temp/src/kernels/awq
  creating /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm
  creating /tmp/tmpup_b75_q.build-temp/third_party/Block-Sparse-Attention/csrc/block_sparse_attn
  creating /tmp/tmpup_b75_q.build-temp/third_party/Block-Sparse-Attention/csrc/block_sparse_attn/src
  Emitting ninja build file /tmp/tmpup_b75_q.build-temp/build.ninja...
  Compiling objects...
  Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
  [1/37] c++ -MMD -MF /tmp/tmpup_b75_q.build-temp/src/activation.o.d -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -fPIC -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/activation.cpp -o /tmp/tmpup_b75_q.build-temp/src/activation.o -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -fvisibility=hidden -g -std=c++20 -UNDEBUG -Og -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [2/37] c++ -MMD -MF /tmp/tmpup_b75_q.build-temp/src/Module.o.d -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -fPIC -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/Module.cpp -o /tmp/tmpup_b75_q.build-temp/src/Module.o -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -fvisibility=hidden -g -std=c++20 -UNDEBUG -Og -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [3/37] c++ -MMD -MF /tmp/tmpup_b75_q.build-temp/src/Linear.o.d -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -fPIC -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/Linear.cpp -o /tmp/tmpup_b75_q.build-temp/src/Linear.o -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -fvisibility=hidden -g -std=c++20 -UNDEBUG -Og -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [4/37] c++ -MMD -MF /tmp/tmpup_b75_q.build-temp/src/SanaModel.o.d -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -fPIC -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/SanaModel.cpp -o /tmp/tmpup_b75_q.build-temp/src/SanaModel.o -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -fvisibility=hidden -g -std=c++20 -UNDEBUG -Og -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [5/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/src/kernels/activation_kernels.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/kernels/activation_kernels.cu -o /tmp/tmpup_b75_q.build-temp/src/kernels/activation_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [6/37] c++ -MMD -MF /tmp/tmpup_b75_q.build-temp/src/Serialization.o.d -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -fPIC -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/Serialization.cpp -o /tmp/tmpup_b75_q.build-temp/src/Serialization.o -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -fvisibility=hidden -g -std=c++20 -UNDEBUG -Og -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [7/37] c++ -MMD -MF /tmp/tmpup_b75_q.build-temp/src/FluxModel.o.d -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -fPIC -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/FluxModel.cpp -o /tmp/tmpup_b75_q.build-temp/src/FluxModel.o -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -fvisibility=hidden -g -std=c++20 -UNDEBUG -Og -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  /workspace/nunchaku/src/FluxModel.cpp: In member function ‘Tensor Attention::forward(Tensor)’:
  /workspace/nunchaku/src/FluxModel.cpp:110:18: warning: variable ‘device’ set but not used [-Wunused-but-set-variable]
    110 |     const Device device  = qkv.device();
        |                  ^~~~~~
  [8/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/src/kernels/awq/gemv_awq.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/kernels/awq/gemv_awq.cu -o /tmp/tmpup_b75_q.build-temp/src/kernels/awq/gemv_awq.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [9/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/src/kernels/awq/gemm_awq.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/kernels/awq/gemm_awq.cu -o /tmp/tmpup_b75_q.build-temp/src/kernels/awq/gemm_awq.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  /workspace/nunchaku/src/kernels/awq/gemm_awq.cu(394): warning #177-D: variable "blockIdx_x" was declared but never referenced
        int blockIdx_x = 0;
            ^

  Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

  /workspace/nunchaku/src/kernels/awq/gemm_awq.cu(414): warning #177-D: variable "kSmemSizeZeros" was declared but never referenced
        constexpr int kSmemSizeZeros = CTA_N * STAGES / scales_load_interval * scales_per_load;
                      ^

  /workspace/nunchaku/src/kernels/awq/gemm_awq.cu(266): warning #177-D: variable "total_global_iters" was declared but never referenced
        constexpr int total_global_iters = LD_AMOUNT / 8 / threads_used;
                      ^
            detected during instantiation of "void gemm_w4a16_T1<f16_t,CTA_M,CTA_N,CTA_K,WARP_M,WARP_N,WARP_K,STAGES,G,SPLITK>(f16_t *, f16_t *, f16_t *, f16_t *, f16_t *, int *, int, int, int) [with f16_t=half, CTA_M=16, CTA_N=128, CTA_K=128, WARP_M=16, WARP_N=32, WARP_K=64, STAGES=4, G=128, SPLITK=2]"

  /workspace/nunchaku/src/kernels/awq/gemm_awq.cu(956): warning #177-D: variable "blockIdx_x" was declared but never referenced
        int blockIdx_x = 0;
            ^

  /workspace/nunchaku/src/kernels/awq/gemm_awq.cu(958): warning #177-D: variable "blockIdx_z" was declared but never referenced
        int blockIdx_z = blockIdx.x / (num_blocks_m * num_blocks_n);
            ^

  /workspace/nunchaku/src/kernels/awq/gemm_awq.cu(974): warning #177-D: variable "kSmemSizeZeros" was declared but never referenced
        constexpr int kSmemSizeZeros = CTA_N * STAGES / 2;
                      ^

  /workspace/nunchaku/src/kernels/awq/gemm_awq.cu(852): warning #177-D: variable "total_global_iters" was declared but never referenced
        constexpr int total_global_iters = CTA_N / 8 / threads_used;
                      ^
            detected during instantiation of "void gemm_w4a16_T2<f16_t,CTA_M,CTA_N,CTA_K,WARP_M,WARP_N,WARP_K,STAGES,G>(f16_t *, f16_t *, f16_t *, f16_t *, f16_t *, int, int, int) [with f16_t=half, CTA_M=64, CTA_N=128, CTA_K=64, WARP_M=64, WARP_N=32, WARP_K=64, STAGES=4, G=128]"

  /workspace/nunchaku/src/kernels/awq/gemm_awq.cu(854): warning #177-D: variable "kSmemCol" was declared but never referenced
        constexpr int kSmemCol = CTA_N;
                      ^
            detected during instantiation of "void gemm_w4a16_T2<f16_t,CTA_M,CTA_N,CTA_K,WARP_M,WARP_N,WARP_K,STAGES,G>(f16_t *, f16_t *, f16_t *, f16_t *, f16_t *, int, int, int) [with f16_t=half, CTA_M=64, CTA_N=128, CTA_K=64, WARP_M=64, WARP_N=32, WARP_K=64, STAGES=4, G=128]"

  [10/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/src/kernels/gemm_batched.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/kernels/gemm_batched.cu -o /tmp/tmpup_b75_q.build-temp/src/kernels/gemm_batched.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [11/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/src/kernels/dwconv.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/kernels/dwconv.cu -o /tmp/tmpup_b75_q.build-temp/src/kernels/dwconv.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [12/37] c++ -MMD -MF /tmp/tmpup_b75_q.build-temp/nunchaku/csrc/pybind.o.d -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -fPIC -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/nunchaku/csrc/pybind.cpp -o /tmp/tmpup_b75_q.build-temp/nunchaku/csrc/pybind.o -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -fvisibility=hidden -g -std=c++20 -UNDEBUG -Og -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  FAILED: /tmp/tmpup_b75_q.build-temp/nunchaku/csrc/pybind.o
  c++ -MMD -MF /tmp/tmpup_b75_q.build-temp/nunchaku/csrc/pybind.o.d -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -fPIC -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/nunchaku/csrc/pybind.cpp -o /tmp/tmpup_b75_q.build-temp/nunchaku/csrc/pybind.o -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -fvisibility=hidden -g -std=c++20 -UNDEBUG -Og -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:33,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Generator.h:122:3: error: reference to ‘Device’ is ambiguous
    122 |   Device device() const { return impl_->device(); }
        |   ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Generator.h: In function ‘T* at::check_generator(std::optional<at::Generator>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Generator.h:156:40: error: ‘struct at::Generator’ has no member named ‘device’
    156 |   TORCH_CHECK(T::device_type() == gen->device().type(), "Expected a '", T::device_type(), "' device type for generator but found '", gen->device().type(), "'");
        |                                        ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Generator.h:156:3: note: in expansion of macro ‘TORCH_CHECK’
    156 |   TORCH_CHECK(T::device_type() == gen->device().type(), "Expected a '", T::device_type(), "' device type for generator but found '", gen->device().type(), "'");
        |   ^~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Generator.h:156:139: error: ‘struct at::Generator’ has no member named ‘device’
    156 |   TORCH_CHECK(T::device_type() == gen->device().type(), "Expected a '", T::device_type(), "' device type for generator but found '", gen->device().type(), "'");
        |                                                                                                                                           ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Generator.h:156:3: note: in expansion of macro ‘TORCH_CHECK’
    156 |   TORCH_CHECK(T::device_type() == gen->device().type(), "Expected a '", T::device_type(), "' device type for generator but found '", gen->device().type(), "'");
        |   ^~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:33,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:110:45: error: template argument 1 is invalid
    110 |   TensorOptions options(std::optional<Device> device_opt) const {
        |                                             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:110:45: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:110:45: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:110:45: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:110:25: error: invalid template-id
    110 |   TensorOptions options(std::optional<Device> device_opt) const {
        |                         ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:110:39: error: reference to ‘Device’ is ambiguous
    110 |   TensorOptions options(std::optional<Device> device_opt) const {
        |                                       ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:33,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:110:25: error: class template placeholder ‘std::optional’ not permitted in this context
    110 |   TensorOptions options(std::optional<Device> device_opt) const {
        |                         ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:110:25: note: use ‘auto’ for an abbreviated function template
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:132:80: error: template argument 1 is invalid
    132 |   Tensor copy(const Tensor & src, bool non_blocking=false, std::optional<Device> to_device={}) const;
        |                                                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:132:80: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:132:80: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:132:80: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:132:60: error: invalid template-id
    132 |   Tensor copy(const Tensor & src, bool non_blocking=false, std::optional<Device> to_device={}) const;
        |                                                            ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:132:74: error: reference to ‘Device’ is ambiguous
    132 |   Tensor copy(const Tensor & src, bool non_blocking=false, std::optional<Device> to_device={}) const;
        |                                                                          ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:33,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:132:60: error: class template placeholder ‘std::optional’ not permitted in this context
    132 |   Tensor copy(const Tensor & src, bool non_blocking=false, std::optional<Device> to_device={}) const;
        |                                                            ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:132:60: note: use ‘auto’ for an abbreviated function template
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h: In member function ‘c10::TensorOptions at::DeprecatedTypeProperties::options(...) const’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:111:10: error: ‘device_opt’ was not declared in this scope; did you mean ‘device_type’?
    111 |     if (!device_opt.has_value()) {
        |          ^~~~~~~~~~
        |          device_type
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:114:7: error: reference to ‘Device’ is ambiguous
    114 |       Device device = device_opt.value();
        |       ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:115:24: error: request for member ‘type’ in ‘c10::device’, which is of non-class type ‘c10::TensorOptions(c10::Device)’
    115 |       AT_ASSERT(device.type() == device_type());
        |                        ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:341:39: note: in definition of macro ‘C10_EXPAND_MSVC_WORKAROUND’
    341 | #define C10_EXPAND_MSVC_WORKAROUND(x) x
        |                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:361:34: note: in expansion of macro ‘C10_UNLIKELY’
    361 | #define C10_UNLIKELY_OR_CONST(e) C10_UNLIKELY(e)
        |                                  ^~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:413:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    413 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {                                          \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:730:32: note: in expansion of macro ‘TORCH_INTERNAL_ASSERT’
    730 |     C10_EXPAND_MSVC_WORKAROUND(TORCH_INTERNAL_ASSERT(__VA_ARGS__)); \
        |                                ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:115:7: note: in expansion of macro ‘AT_ASSERT’
    115 |       AT_ASSERT(device.type() == device_type());
        |       ^~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:33,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:116:29: error: request for member ‘index’ in ‘c10::device’, which is of non-class type ‘c10::TensorOptions(c10::Device)’
    116 |       return options(device.index());
        |                             ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h: In member function ‘at::DeprecatedTypeProperties::operator c10::TensorOptions() const’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:121:19: error: call of overloaded ‘options()’ is ambiguous
    121 |     return options();
        |            ~~~~~~~^~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:102:17: note: candidate: ‘c10::TensorOptions at::DeprecatedTypeProperties::options(int16_t) const’
    102 |   TensorOptions options(int16_t device_index = -1) const {
        |                 ^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:110:17: note: candidate: ‘c10::TensorOptions at::DeprecatedTypeProperties::options(...) const’
    110 |   TensorOptions options(std::optional<Device> device_opt) const {
        |                 ^~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:38,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBase.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBase.h:415:10: error: reference to ‘Device’ is ambiguous
    415 |   inline Device device() const {
        |          ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:38,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBase.h: In member function ‘c10::TensorOptions at::TensorBase::options() const’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBase.h:578:41: error: too few arguments to function ‘c10::TensorOptions c10::device(c10::Device)’
    578 |                           .device(device())
        |                                   ~~~~~~^~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/CheckMemoryFormat.h:1,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:31,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/TensorOptions.h:595:22: note: declared here
    595 | inline TensorOptions device(Device device) {
        |                      ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1372:20: error: reference to ‘Device’ is ambiguous
   1372 |   inline Tensor to(Device device, caffe2::TypeMeta type_meta, bool non_blocking=false, bool copy=false) const {
        |                    ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1372:20: error: ‘Device’ has not been declared
   1372 |   inline Tensor to(Device device, caffe2::TypeMeta type_meta, bool non_blocking=false, bool copy=false) const {
        |                    ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h: In member function ‘at::Tensor at::Tensor::to(int, caffe2::TypeMeta, bool, bool) const’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1373:20: error: no matching function for call to ‘at::Tensor::to(int&, c10::ScalarType, bool&, bool&) const’
   1373 |     return this->to(device, /*scalar_type=*/typeMetaToScalarType(type_meta), non_blocking, copy);
        |            ~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1074:14: note: candidate: ‘at::Tensor at::Tensor::to(c10::TensorOptions, bool, bool, std::optional<c10::MemoryFormat>) const’
   1074 |   at::Tensor to(at::TensorOptions options={}, bool non_blocking=false, bool copy=false, ::std::optional<at::MemoryFormat> memory_format=::std::nullopt) const;
        |              ^~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1074:35: note:   no known conversion for argument 1 from ‘int’ to ‘c10::TensorOptions’
   1074 |   at::Tensor to(at::TensorOptions options={}, bool non_blocking=false, bool copy=false, ::std::optional<at::MemoryFormat> memory_format=::std::nullopt) const;
        |                 ~~~~~~~~~~~~~~~~~~^~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1075:14: note: candidate: ‘at::Tensor at::Tensor::to(std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>) const’
   1075 |   at::Tensor to(::std::optional<at::ScalarType> dtype, ::std::optional<at::Layout> layout, ::std::optional<at::Device> device, ::std::optional<bool> pin_memory, bool non_blocking, bool copy, ::std::optional<at::MemoryFormat> memory_format) const;
        |              ^~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1075:14: note:   candidate expects 7 arguments, 4 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1076:14: note: candidate: ‘at::Tensor at::Tensor::to(c10::Device, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>) const’
   1076 |   at::Tensor to(at::Device device, at::ScalarType dtype, bool non_blocking=false, bool copy=false, ::std::optional<at::MemoryFormat> memory_format=::std::nullopt) const;
        |              ^~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1076:28: note:   no known conversion for argument 1 from ‘int’ to ‘c10::Device’
   1076 |   at::Tensor to(at::Device device, at::ScalarType dtype, bool non_blocking=false, bool copy=false, ::std::optional<at::MemoryFormat> memory_format=::std::nullopt) const;
        |                 ~~~~~~~~~~~^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1077:14: note: candidate: ‘at::Tensor at::Tensor::to(c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>) const’
   1077 |   at::Tensor to(at::ScalarType dtype, bool non_blocking=false, bool copy=false, ::std::optional<at::MemoryFormat> memory_format=::std::nullopt) const;
        |              ^~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1077:32: note:   no known conversion for argument 1 from ‘int’ to ‘c10::ScalarType’
   1077 |   at::Tensor to(at::ScalarType dtype, bool non_blocking=false, bool copy=false, ::std::optional<at::MemoryFormat> memory_format=::std::nullopt) const;
        |                 ~~~~~~~~~~~~~~~^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1078:14: note: candidate: ‘at::Tensor at::Tensor::to(const at::Tensor&, bool, bool, std::optional<c10::MemoryFormat>) const’
   1078 |   at::Tensor to(const at::Tensor & other, bool non_blocking=false, bool copy=false, ::std::optional<at::MemoryFormat> memory_format=::std::nullopt) const;
        |              ^~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1078:36: note:   no known conversion for argument 1 from ‘int’ to ‘const at::Tensor&’
   1078 |   at::Tensor to(const at::Tensor & other, bool non_blocking=false, bool copy=false, ::std::optional<at::MemoryFormat> memory_format=::std::nullopt) const;
        |                 ~~~~~~~~~~~~~~~~~~~^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1369:17: note: candidate: ‘at::Tensor at::Tensor::to(caffe2::TypeMeta, bool, bool) const’
   1369 |   inline Tensor to(caffe2::TypeMeta type_meta, bool non_blocking=false, bool copy=false) const {
        |                 ^~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1369:17: note:   candidate expects 3 arguments, 4 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1372:17: note: candidate: ‘at::Tensor at::Tensor::to(int, caffe2::TypeMeta, bool, bool) const’
   1372 |   inline Tensor to(Device device, caffe2::TypeMeta type_meta, bool non_blocking=false, bool copy=false) const {
        |                 ^~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:1372:52: note:   no known conversion for argument 2 from ‘c10::ScalarType’ to ‘caffe2::TypeMeta’
   1372 |   inline Tensor to(Device device, caffe2::TypeMeta type_meta, bool non_blocking=false, bool copy=false) const {
        |                                   ~~~~~~~~~~~~~~~~~^~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/detail/MTIAHooksInterface.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/DeviceAccelerator.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:59,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/detail/AcceleratorHooksInterface.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/detail/AcceleratorHooksInterface.h:62:11: error: reference to ‘Device’ is ambiguous
     62 |   virtual Device getDeviceFromPtr(void* data) const {
        |           ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:59,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/detail/CUDAHooksInterface.h:77:3: error: reference to ‘Device’ is ambiguous
     77 |   Device getDeviceFromPtr(void* /*data*/) const override {
        |   ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:59,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/detail/HPUHooksInterface.h:28:3: error: reference to ‘Device’ is ambiguous
     28 |   Device getDeviceFromPtr(void* /*data*/) const override {
        |   ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:59,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/detail/PrivateUse1HooksInterface.h:23:14: error: ‘c10::Device at::PrivateUse1HooksInterface::getDeviceFromPtr(void*) const’ marked ‘override’, but does not override
     23 |   at::Device getDeviceFromPtr(void* data) const override {
        |              ^~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:21,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:59,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/detail/XPUHooksInterface.h:30:48: error: reference to ‘Device’ is ambiguous
     30 |   virtual int32_t getGlobalIdxFromDevice(const Device& device) const {
        |                                                ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:21,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:59,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/detail/XPUHooksInterface.h:53:3: error: reference to ‘Device’ is ambiguous
     53 |   Device getDeviceFromPtr(void* /*data*/) const override {
        |   ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:59,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:42:37: error: reference to ‘Device’ is ambiguous
     42 |   const Generator& defaultGenerator(Device device) {
        |                                     ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:59,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:42:37: error: ‘Device’ has not been declared
     42 |   const Generator& defaultGenerator(Device device) {
        |                                     ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:83:3: error: reference to ‘Device’ is ambiguous
     83 |   Device getDeviceFromPtr(void* data, c10::DeviceType device_type) {
        |   ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:59,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h: In member function ‘const at::Generator& at::Context::defaultGenerator(int)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:43:42: error: request for member ‘type’ in ‘device’, which is of non-class type ‘int’
     43 |     c10::DeviceType device_type = device.type();
        |                                          ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:50:39: error: request for member ‘index’ in ‘device’, which is of non-class type ‘int’
     50 |           .getDefaultGenerator(device.index());
        |                                       ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h: In function ‘void at::manual_seed(uint64_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:554:64: error: cannot convert ‘c10::DeviceType’ to ‘int’
    554 |   auto gen = globalContext().defaultGenerator(c10::DeviceType::CPU);
        |                                               ~~~~~~~~~~~~~~~~~^~~
        |                                                                |
        |                                                                c10::DeviceType
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:42:44: note:   initializing argument 1 of ‘const at::Generator& at::Context::defaultGenerator(int)’
     42 |   const Generator& defaultGenerator(Device device) {
        |                                     ~~~~~~~^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:566:11: error: reference to ‘Device’ is ambiguous
    566 |           Device(at::kCUDA, static_cast<c10::DeviceIndex>(i)));
        |           ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:59,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:579:11: error: reference to ‘Device’ is ambiguous
    579 |           Device(at::kXPU, static_cast<c10::DeviceIndex>(i)));
        |           ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:59,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:589:70: error: cannot convert ‘c10::DeviceType’ to ‘int’
    589 |     auto mps_gen = globalContext().defaultGenerator(c10::DeviceType::MPS);
        |                                                     ~~~~~~~~~~~~~~~~~^~~
        |                                                                      |
        |                                                                      c10::DeviceType
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Context.h:42:44: note:   initializing argument 1 of ‘const at::Generator& at::Context::defaultGenerator(int)’
     42 |   const Generator& defaultGenerator(Device device) {
        |                                     ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:60,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/DeviceGuard.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/DeviceGuard.h:18:28: error: template argument 1 is invalid
     18 | inline std::optional<Device> device_of(const Tensor& t) {
        |                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/DeviceGuard.h: In function ‘int at::device_of(const at::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/DeviceGuard.h:20:14: error: ‘const class at::Tensor’ has no member named ‘device’; did you mean ‘divide’?
     20 |     return t.device();
        |              ^~~~~~
        |              divide
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/DeviceGuard.h:22:17: error: cannot convert ‘const std::nullopt_t’ to ‘int’ in return
     22 |     return std::nullopt;
        |                 ^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/DeviceGuard.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/DeviceGuard.h:26:28: error: template argument 1 is invalid
     26 | inline std::optional<Device> device_of(const std::optional<Tensor>& t) {
        |                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/DeviceGuard.h: In function ‘int at::device_of(const std::optional<at::Tensor>&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/DeviceGuard.h:27:24: error: operands to ‘?:’ have different types ‘int’ and ‘const std::nullopt_t’
     27 |   return t.has_value() ? device_of(t.value()) : std::nullopt;
        |          ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/DeviceGuard.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/DeviceGuard.h:33:28: error: template argument 1 is invalid
     33 | inline std::optional<Device> device_of(ITensorListRef t) {
        |                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/DeviceGuard.h: In function ‘int at::device_of(at::ITensorListRef)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/DeviceGuard.h:37:17: error: cannot convert ‘const std::nullopt_t’ to ‘int’ in return
     37 |     return std::nullopt;
        |                 ^~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:61,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:85:25: error: template argument 1 is invalid
     85 |     std::optional<Device> device_opt,
        |                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:85:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:85:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:85:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:85:5: error: invalid template-id
     85 |     std::optional<Device> device_opt,
        |     ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:85:19: error: reference to ‘Device’ is ambiguous
     85 |     std::optional<Device> device_opt,
        |                   ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:61,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:85:5: error: class template placeholder ‘std::optional’ not permitted in this context
     85 |     std::optional<Device> device_opt,
        |     ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:85:5: note: use ‘auto’ for an abbreviated function template
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:102:25: error: template argument 1 is invalid
    102 |     std::optional<Device> device_opt,
        |                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:102:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:102:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:102:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:102:5: error: invalid template-id
    102 |     std::optional<Device> device_opt,
        |     ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:102:19: error: reference to ‘Device’ is ambiguous
    102 |     std::optional<Device> device_opt,
        |                   ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:61,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:102:5: error: class template placeholder ‘std::optional’ not permitted in this context
    102 |     std::optional<Device> device_opt,
        |     ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:102:5: note: use ‘auto’ for an abbreviated function template
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:119:25: error: template argument 1 is invalid
    119 |     std::optional<Device> device_opt,
        |                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:119:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:119:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:119:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:119:5: error: invalid template-id
    119 |     std::optional<Device> device_opt,
        |     ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:119:19: error: reference to ‘Device’ is ambiguous
    119 |     std::optional<Device> device_opt,
        |                   ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:61,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:119:5: error: class template placeholder ‘std::optional’ not permitted in this context
    119 |     std::optional<Device> device_opt,
        |     ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:119:5: note: use ‘auto’ for an abbreviated function template
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:127:25: error: template argument 1 is invalid
    127 |     std::optional<Device> device_opt,
        |                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:127:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:127:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:127:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:127:5: error: invalid template-id
    127 |     std::optional<Device> device_opt,
        |     ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:127:19: error: reference to ‘Device’ is ambiguous
    127 |     std::optional<Device> device_opt,
        |                   ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:61,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:127:5: error: class template placeholder ‘std::optional’ not permitted in this context
    127 |     std::optional<Device> device_opt,
        |     ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:127:5: note: use ‘auto’ for an abbreviated function template
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:141:25: error: template argument 1 is invalid
    141 |     std::optional<Device> device_opt,
        |                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:141:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:141:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:141:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:141:5: error: invalid template-id
    141 |     std::optional<Device> device_opt,
        |     ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:141:19: error: reference to ‘Device’ is ambiguous
    141 |     std::optional<Device> device_opt,
        |                   ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:61,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:141:5: error: class template placeholder ‘std::optional’ not permitted in this context
    141 |     std::optional<Device> device_opt,
        |     ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:141:5: note: use ‘auto’ for an abbreviated function template
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:159:25: error: template argument 1 is invalid
    159 |     std::optional<Device> device_opt);
        |                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:159:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:159:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:159:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:159:5: error: invalid template-id
    159 |     std::optional<Device> device_opt);
        |     ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:159:19: error: reference to ‘Device’ is ambiguous
    159 |     std::optional<Device> device_opt);
        |                   ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:61,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:159:5: error: class template placeholder ‘std::optional’ not permitted in this context
    159 |     std::optional<Device> device_opt);
        |     ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/EmptyTensor.h:159:5: note: use ‘auto’ for an abbreviated function template
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorUtils.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:61,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Utils.h: In function ‘std::vector<c10::TensorImpl*> at::checked_dense_tensor_list_unwrap(c10::ArrayRef<at::Tensor>, const char*, int, c10::DeviceType, c10::ScalarType)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Utils.h:51:14: error: ‘const class at::Tensor’ has no member named ‘device’; did you mean ‘divide’?
     51 |     if (expr.device().type() != device_type) {
        |              ^~~~~~
        |              divide
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Utils.h:57:16: error: ‘const class at::Tensor’ has no member named ‘device’; did you mean ‘divide’?
     57 |           expr.device().type(),
        |                ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Utils.h:52:7: note: in expansion of macro ‘TORCH_CHECK’
     52 |       TORCH_CHECK(
        |       ^~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:74,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:53:50: error: template argument 1 is invalid
     53 |   TensorMaker& target_device(std::optional<Device> value) noexcept {
        |                                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:53:50: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:53:50: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:53:50: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:53:30: error: invalid template-id
     53 |   TensorMaker& target_device(std::optional<Device> value) noexcept {
        |                              ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:53:44: error: reference to ‘Device’ is ambiguous
     53 |   TensorMaker& target_device(std::optional<Device> value) noexcept {
        |                                            ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:74,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:53:30: error: class template placeholder ‘std::optional’ not permitted in this context
     53 |   TensorMaker& target_device(std::optional<Device> value) noexcept {
        |                              ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:53:30: note: use ‘auto’ for an abbreviated function template
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:97:23: error: template argument 1 is invalid
     97 |   std::optional<Device> device_{};
        |                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:97:8: error: ‘<expression error>’ in namespace ‘std’ does not name a type
     97 |   std::optional<Device> device_{};
        |        ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h: In member function ‘at::TensorMaker& at::TensorMaker::target_device(...)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:54:5: error: ‘device_’ was not declared in this scope; did you mean ‘Device’?
     54 |     device_ = value;
        |     ^~~~~~~
        |     Device
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:54:15: error: ‘value’ was not declared in this scope
     54 |     device_ = value;
        |               ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:113:31: error: template argument 1 is invalid
    113 |     const std::optional<Device> target_device = std::nullopt) {
        |                               ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:113:31: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:113:31: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:113:31: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:113:11: error: invalid template-id
    113 |     const std::optional<Device> target_device = std::nullopt) {
        |           ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:113:25: error: reference to ‘Device’ is ambiguous
    113 |     const std::optional<Device> target_device = std::nullopt) {
        |                         ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:74,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:113:5: error: class template placeholder ‘std::optional’ not permitted in this context
    113 |     const std::optional<Device> target_device = std::nullopt) {
        |     ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:113:5: note: use ‘auto’ for an abbreviated function template
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h: In function ‘at::Tensor at::from_blob(...)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:118:22: error: ‘target_device’ was not declared in this scope; did you mean ‘get_device’?
    118 |       .target_device(target_device)
        |                      ^~~~~~~~~~~~~
        |                      get_device
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:129:31: error: template argument 1 is invalid
    129 |     const std::optional<Device> target_device = std::nullopt) {
        |                               ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:129:31: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:129:31: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:129:31: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:129:11: error: invalid template-id
    129 |     const std::optional<Device> target_device = std::nullopt) {
        |           ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:129:25: error: reference to ‘Device’ is ambiguous
    129 |     const std::optional<Device> target_device = std::nullopt) {
        |                         ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:74,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:129:5: error: class template placeholder ‘std::optional’ not permitted in this context
    129 |     const std::optional<Device> target_device = std::nullopt) {
        |     ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:129:5: note: use ‘auto’ for an abbreviated function template
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:122:15: error: redefinition of ‘at::Tensor at::from_blob(...)’
    122 | inline Tensor from_blob(
        |               ^~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:107:15: note: ‘at::Tensor at::from_blob(...)’ previously defined here
    107 | inline Tensor from_blob(
        |               ^~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h: In function ‘at::Tensor at::from_blob(...)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:135:22: error: ‘target_device’ was not declared in this scope; did you mean ‘get_device’?
    135 |       .target_device(target_device)
        |                      ^~~~~~~~~~~~~
        |                      get_device
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:144:31: error: template argument 1 is invalid
    144 |     const std::optional<Device> target_device = std::nullopt) {
        |                               ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:144:31: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:144:31: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:144:31: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:144:11: error: invalid template-id
    144 |     const std::optional<Device> target_device = std::nullopt) {
        |           ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:144:25: error: reference to ‘Device’ is ambiguous
    144 |     const std::optional<Device> target_device = std::nullopt) {
        |                         ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:74,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:144:5: error: class template placeholder ‘std::optional’ not permitted in this context
    144 |     const std::optional<Device> target_device = std::nullopt) {
        |     ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:144:5: note: use ‘auto’ for an abbreviated function template
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:139:15: error: redefinition of ‘at::Tensor at::from_blob(...)’
    139 | inline Tensor from_blob(
        |               ^~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:107:15: note: ‘at::Tensor at::from_blob(...)’ previously defined here
    107 | inline Tensor from_blob(
        |               ^~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h: In function ‘at::Tensor at::from_blob(...)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/from_blob.h:148:22: error: ‘target_device’ was not declared in this scope; did you mean ‘get_device’?
    148 |       .target_device(target_device)
        |                      ^~~~~~~~~~~~~
        |                      get_device
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/dynamo/compiled_autograd.h: In member function ‘void torch::dynamo::autograd::CompiledNodeArgs::collect(const torch::dynamo::autograd::TensorArg&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/dynamo/compiled_autograd.h:278:22: error: ‘const class at::Tensor’ has no member named ‘device’; did you mean ‘divide’?
    278 |       collect(tensor.device());
        |                      ^~~~~~
        |                      divide
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ATen.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ScalarOps.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ScalarOps.h:22:25: error: template argument 1 is invalid
     22 |     std::optional<Device> device_opt);
        |                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ScalarOps.h:22:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ScalarOps.h:22:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ScalarOps.h:22:25: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ScalarOps.h:22:5: error: invalid template-id
     22 |     std::optional<Device> device_opt);
        |     ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ScalarOps.h:22:19: error: reference to ‘Device’ is ambiguous
     22 |     std::optional<Device> device_opt);
        |                   ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ATen.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ScalarOps.h:22:5: error: class template placeholder ‘std::optional’ not permitted in this context
     22 |     std::optional<Device> device_opt);
        |     ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ScalarOps.h:22:5: note: use ‘auto’ for an abbreviated function template
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ScalarOps.h:47:11: error: reference to ‘Device’ is ambiguous
     47 |     const Device device = at::kCPU) {
        |           ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ATen.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ScalarOps.h:47:35: error: could not convert ‘c10::kCPU’ from ‘const c10::DeviceType’ to ‘const int’
     47 |     const Device device = at::kCPU) {
        |                                   ^
        |                                   |
        |                                   const c10::DeviceType
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ScalarOps.h: In function ‘at::Tensor at::native::wrapped_scalar_tensor(const c10::Scalar&, int)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ScalarOps.h:48:42: error: could not convert ‘device’ from ‘const int’ to ‘c10::Device’
     48 |   auto tensor = scalar_to_tensor(scalar, device);
        |                                          ^~~~~~
        |                                          |
        |                                          const int
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_addmm_activation_meta.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_addmm_activation_native.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/NativeFunctions.h:37,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIndexing.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ATen.h:18,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h:150:23: error: template argument 1 is invalid
    150 |   std::optional<Device> device = std::nullopt;
        |                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h:150:8: error: ‘<expression error>’ in namespace ‘std’ does not name a type
    150 |   std::optional<Device> device = std::nullopt;
        |        ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h: In constructor ‘at::OperandInfo::OperandInfo(c10::MaybeOwned<at::TensorBase>&&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h:122:19: error: ‘const class at::TensorBase’ has no member named ‘device’
    122 |       device = t->device();
        |                   ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h: In member function ‘bool at::OperandInfo::is_device_defined() const’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h:159:19: error: request for member ‘has_value’ in ‘c10::device’, which is of non-class type ‘c10::TensorOptions(c10::Device)’
    159 |     return device.has_value();
        |                   ^~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h:322:3: error: reference to ‘Device’ is ambiguous
    322 |   Device device(int64_t arg = 0) const {
        |   ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_addmm_activation_meta.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_addmm_activation_native.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/NativeFunctions.h:37,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIndexing.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ATen.h:18,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h:723:3: error: reference to ‘Device’ is ambiguous
    723 |   Device common_device_ = kCPU;
        |   ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_addmm_activation_meta.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_addmm_activation_native.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/NativeFunctions.h:37,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIndexing.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ATen.h:18,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h: In member function ‘c10::DeviceType at::TensorIteratorBase::device_type(int64_t) const’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h:327:19: error: could not convert ‘arg’ from ‘int64_t’ {aka ‘long int’} to ‘c10::Device’
    327 |     return device(arg).type();
        |                   ^~~
        |                   |
        |                   int64_t {aka long int}
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h:954:7: error: reference to ‘Device’ is ambiguous
    954 |       Device device);
        |       ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_addmm_activation_meta.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_addmm_activation_native.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/NativeFunctions.h:37,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIndexing.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ATen.h:18,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h:954:7: error: ‘Device’ has not been declared
    954 |       Device device);
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h:956:47: error: reference to ‘Device’ is ambiguous
    956 |   TensorIteratorConfig& declare_static_device(Device device);
        |                                               ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_addmm_activation_meta.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_addmm_activation_native.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/NativeFunctions.h:37,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIndexing.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ATen.h:18,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h:956:47: error: ‘Device’ has not been declared
    956 |   TensorIteratorConfig& declare_static_device(Device device);
        |                                               ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h:979:23: error: template argument 1 is invalid
    979 |   std::optional<Device> static_device_ = std::nullopt;
        |                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h:979:8: error: ‘<expression error>’ in namespace ‘std’ does not name a type
    979 |   std::optional<Device> static_device_ = std::nullopt;
        |        ^~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ATen.h:18,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIndexing.h: In function ‘void at::indexing::copy_to(const at::Tensor&, const at::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIndexing.h:420:36: error: ‘const class at::Tensor’ has no member named ‘device’; did you mean ‘divide’?
    420 |   } else if (src.dim() == 0 && src.device().type() == at::kCPU) {
        |                                    ^~~~~~
        |                                    divide
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIndexing.h: In function ‘at::Tensor at::indexing::get_item(const at::Tensor&, const c10::ArrayRef<at::indexing::TensorIndex>&, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIndexing.h:612:33: error: ‘const class at::Tensor’ has no member named ‘device’; did you mean ‘divide’?
    612 |   at::Device self_device = self.device();
        |                                 ^~~~~~
        |                                 divide
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIndexing.h: In function ‘void at::indexing::set_item(const at::Tensor&, const c10::ArrayRef<at::indexing::TensorIndex>&, const at::Tensor&, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIndexing.h:679:33: error: ‘const class at::Tensor’ has no member named ‘device’; did you mean ‘divide’?
    679 |   at::Device self_device = self.device();
        |                                 ^~~~~~
        |                                 divide
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/jit/runtime/graph_executor.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/jit/api/function_impl.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/jit/api/method.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/jit/api/object.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/jit/api/module.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/serialize/input-archive.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/serialize/archive.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/samplers/serialize.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/samplers.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets/chunk.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/jit/runtime/argument_spec.h: In member function ‘void torch::jit::ArgumentSpec::addTensor(const c10::IValue&, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/jit/runtime/argument_spec.h:106:30: error: ‘const class at::Tensor’ has no member named ‘device’; did you mean ‘divide’?
    106 |       at::Device device = t->device();
        |                              ^~~~~~
        |                              divide
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/jit/runtime/argument_spec.h: In constructor ‘torch::jit::CompleteArgumentSpec::CompleteArgumentSpec(bool, c10::ArrayRef<c10::IValue>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/jit/runtime/argument_spec.h:267:33: error: ‘class at::Tensor’ has no member named ‘device’; did you mean ‘divide’?
    267 |           at::Device device = t.device();
        |                                 ^~~~~~
        |                                 divide
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/serialize/archive.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/samplers/serialize.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/samplers.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets/chunk.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/serialize/input-archive.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/serialize/input-archive.h:19:11: error: ‘class at::Tensor’ conflicts with a previous declaration
     19 | using at::Tensor;
        |           ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: previous declaration ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/serialize/archive.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/samplers/serialize.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/samplers.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets/chunk.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/serialize/output-archive.h:16:11: error: ‘class at::Tensor’ conflicts with a previous declaration
     16 | using at::Tensor;
        |           ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: previous declaration ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets/mnist.h:42:10: error: field ‘images_’ has incomplete type ‘torch::Tensor’
     42 |   Tensor images_, targets_;
        |          ^~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets/mnist.h:42:19: error: field ‘targets_’ has incomplete type ‘torch::Tensor’
     42 |   Tensor images_, targets_;
        |                   ^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets/tensor.h:31:10: error: field ‘tensor’ has incomplete type ‘torch::Tensor’
     31 |   Tensor tensor;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets/tensor.h: In constructor ‘torch::data::datasets::TensorDataset::TensorDataset(const std::vector<torch::Tensor>&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets/tensor.h:17:36: error: could not convert ‘tensors’ from ‘const std::vector<torch::Tensor>’ to ‘at::TensorList’ {aka ‘c10::ArrayRef<at::Tensor>’}
     17 |       : TensorDataset(torch::stack(tensors)) {}
        |                                    ^~~~~~~
        |                                    |
        |                                    const std::vector<torch::Tensor>
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets/tensor.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets/tensor.h:19:40: error: ‘tensor’ has incomplete type
     19 |   explicit TensorDataset(torch::Tensor tensor) : tensor(std::move(tensor)) {}
        |                          ~~~~~~~~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h: In member function ‘virtual torch::data::Example<> torch::data::transforms::Stack<torch::data::Example<> >::apply_batch(std::vector<torch::data::Example<> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:24:21: error: no matching function for call to ‘std::vector<torch::Tensor>::push_back(std::remove_reference<at::Tensor&>::type)’
     24 |       data.push_back(std::move(example.data));
        |       ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:1187:7: note: candidate: ‘void std::vector<_Tp, _Alloc>::push_back(const value_type&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::value_type = torch::Tensor]’
   1187 |       push_back(const value_type& __x)
        |       ^~~~~~~~~
  /usr/include/c++/11/bits/stl_vector.h:1187:35: note:   no known conversion for argument 1 from ‘std::remove_reference<at::Tensor&>::type’ {aka ‘at::Tensor’} to ‘const value_type&’ {aka ‘const torch::Tensor&’}
   1187 |       push_back(const value_type& __x)
        |                 ~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:1203:7: note: candidate: ‘void std::vector<_Tp, _Alloc>::push_back(std::vector<_Tp, _Alloc>::value_type&&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::value_type = torch::Tensor]’
   1203 |       push_back(value_type&& __x)
        |       ^~~~~~~~~
  /usr/include/c++/11/bits/stl_vector.h:1203:30: note:   no known conversion for argument 1 from ‘std::remove_reference<at::Tensor&>::type’ {aka ‘at::Tensor’} to ‘std::vector<torch::Tensor>::value_type&&’ {aka ‘torch::Tensor&&’}
   1203 |       push_back(value_type&& __x)
        |                 ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:25:24: error: no matching function for call to ‘std::vector<torch::Tensor>::push_back(std::remove_reference<at::Tensor&>::type)’
     25 |       targets.push_back(std::move(example.target));
        |       ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:1187:7: note: candidate: ‘void std::vector<_Tp, _Alloc>::push_back(const value_type&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::value_type = torch::Tensor]’
   1187 |       push_back(const value_type& __x)
        |       ^~~~~~~~~
  /usr/include/c++/11/bits/stl_vector.h:1187:35: note:   no known conversion for argument 1 from ‘std::remove_reference<at::Tensor&>::type’ {aka ‘at::Tensor’} to ‘const value_type&’ {aka ‘const torch::Tensor&’}
   1187 |       push_back(const value_type& __x)
        |                 ~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:1203:7: note: candidate: ‘void std::vector<_Tp, _Alloc>::push_back(std::vector<_Tp, _Alloc>::value_type&&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::value_type = torch::Tensor]’
   1203 |       push_back(value_type&& __x)
        |       ^~~~~~~~~
  /usr/include/c++/11/bits/stl_vector.h:1203:30: note:   no known conversion for argument 1 from ‘std::remove_reference<at::Tensor&>::type’ {aka ‘at::Tensor’} to ‘std::vector<torch::Tensor>::value_type&&’ {aka ‘torch::Tensor&&’}
   1203 |       push_back(value_type&& __x)
        |                 ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:27:26: error: could not convert ‘data’ from ‘std::vector<torch::Tensor>’ to ‘at::TensorList’ {aka ‘c10::ArrayRef<at::Tensor>’}
     27 |     return {torch::stack(data), torch::stack(targets)};
        |                          ^~~~
        |                          |
        |                          std::vector<torch::Tensor>
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:27:46: error: could not convert ‘targets’ from ‘std::vector<torch::Tensor>’ to ‘at::TensorList’ {aka ‘c10::ArrayRef<at::Tensor>’}
     27 |     return {torch::stack(data), torch::stack(targets)};
        |                                              ^~~~~~~
        |                                              |
        |                                              std::vector<torch::Tensor>
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:27:54: error: could not convert ‘{<expression error>, <expression error>}’ from ‘<brace-enclosed initializer list>’ to ‘torch::data::Example<>’
     27 |     return {torch::stack(data), torch::stack(targets)};
        |                                                      ^
        |                                                      |
        |                                                      <brace-enclosed initializer list>
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:36:17: error: ‘torch::data::TensorExample torch::data::transforms::Stack<torch::data::Example<at::Tensor, void> >::apply_batch(std::vector<torch::data::Example<at::Tensor, void>, std::allocator<torch::data::Example<at::Tensor, void> > >)’ marked ‘override’, but does not override
     36 |   TensorExample apply_batch(std::vector<TensorExample> examples) override {
        |                 ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h: In member function ‘torch::data::TensorExample torch::data::transforms::Stack<torch::data::Example<at::Tensor, void> >::apply_batch(std::vector<torch::data::Example<at::Tensor, void>, std::allocator<torch::data::Example<at::Tensor, void> > >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:40:21: error: no matching function for call to ‘std::vector<torch::Tensor>::push_back(std::remove_reference<at::Tensor&>::type)’
     40 |       data.push_back(std::move(example.data));
        |       ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:1187:7: note: candidate: ‘void std::vector<_Tp, _Alloc>::push_back(const value_type&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::value_type = torch::Tensor]’
   1187 |       push_back(const value_type& __x)
        |       ^~~~~~~~~
  /usr/include/c++/11/bits/stl_vector.h:1187:35: note:   no known conversion for argument 1 from ‘std::remove_reference<at::Tensor&>::type’ {aka ‘at::Tensor’} to ‘const value_type&’ {aka ‘const torch::Tensor&’}
   1187 |       push_back(const value_type& __x)
        |                 ~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:1203:7: note: candidate: ‘void std::vector<_Tp, _Alloc>::push_back(std::vector<_Tp, _Alloc>::value_type&&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::value_type = torch::Tensor]’
   1203 |       push_back(value_type&& __x)
        |       ^~~~~~~~~
  /usr/include/c++/11/bits/stl_vector.h:1203:30: note:   no known conversion for argument 1 from ‘std::remove_reference<at::Tensor&>::type’ {aka ‘at::Tensor’} to ‘std::vector<torch::Tensor>::value_type&&’ {aka ‘torch::Tensor&&’}
   1203 |       push_back(value_type&& __x)
        |                 ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:42:25: error: could not convert ‘data’ from ‘std::vector<torch::Tensor>’ to ‘at::TensorList’ {aka ‘c10::ArrayRef<at::Tensor>’}
     42 |     return torch::stack(data);
        |                         ^~~~
        |                         |
        |                         std::vector<torch::Tensor>
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/tensor.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/tensor.h:44:28: error: ‘input’ has incomplete type
     44 |   Tensor operator()(Tensor input) override {
        |                     ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/tensor.h:44:44: error: return type ‘class torch::Tensor’ is incomplete
     44 |   Tensor operator()(Tensor input) override {
        |                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/tensor.h:71:17: error: field ‘mean’ has incomplete type ‘torch::Tensor’
     71 |   torch::Tensor mean, stddev;
        |                 ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/tensor.h:71:23: error: field ‘stddev’ has incomplete type ‘torch::Tensor’
     71 |   torch::Tensor mean, stddev;
        |                       ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/tensor.h:67:35: error: ‘input’ has incomplete type
     67 |   torch::Tensor operator()(Tensor input) override {
        |                            ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/tensor.h:67:51: error: return type ‘class torch::Tensor’ is incomplete
     67 |   torch::Tensor operator()(Tensor input) override {
        |                                                   ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:22:56: error: return type ‘class torch::Tensor’ is incomplete
     22 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::fft(const torch::Tensor&, std::optional<c10::SymInt>, int64_t, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:23:32: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     23 |   return torch::fft_fft_symint(self, std::move(n), dim, norm);
        |                                ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:703,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_fft.h:37:53: note: in passing argument 1 of ‘at::Tensor at::fft_fft_symint(const at::Tensor&, std::optional<c10::SymInt>, int64_t, std::optional<std::basic_string_view<char> >)’
     37 | inline at::Tensor fft_fft_symint(const at::Tensor & self, ::std::optional<c10::SymInt> n=::std::nullopt, int64_t dim=-1, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                                  ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:38:56: error: return type ‘class torch::Tensor’ is incomplete
     38 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::ifft(const torch::Tensor&, std::optional<c10::SymInt>, int64_t, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:39:33: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     39 |   return torch::fft_ifft_symint(self, std::move(n), dim, norm);
        |                                 ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:711,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_ifft.h:37:54: note: in passing argument 1 of ‘at::Tensor at::fft_ifft_symint(const at::Tensor&, std::optional<c10::SymInt>, int64_t, std::optional<std::basic_string_view<char> >)’
     37 | inline at::Tensor fft_ifft_symint(const at::Tensor & self, ::std::optional<c10::SymInt> n=::std::nullopt, int64_t dim=-1, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                                   ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:54:56: error: return type ‘class torch::Tensor’ is incomplete
     54 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::fft2(const torch::Tensor&, c10::OptionalIntArrayRef, c10::IntArrayRef, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:55:26: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     55 |   return torch::fft_fft2(self, s, dim, norm);
        |                          ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:704,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_fft2.h:26:47: note: in passing argument 1 of ‘at::Tensor at::fft_fft2(const at::Tensor&, at::OptionalIntArrayRef, at::IntArrayRef, std::optional<std::basic_string_view<char> >)’
     26 | inline at::Tensor fft_fft2(const at::Tensor & self, at::OptionalIntArrayRef s=::std::nullopt, at::IntArrayRef dim={-2,-1}, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                            ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:70:56: error: return type ‘class torch::Tensor’ is incomplete
     70 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::ifft2(const torch::Tensor&, at::OptionalIntArrayRef, c10::IntArrayRef, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:71:27: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     71 |   return torch::fft_ifft2(self, s, dim, norm);
        |                           ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:712,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_ifft2.h:26:48: note: in passing argument 1 of ‘at::Tensor at::fft_ifft2(const at::Tensor&, at::OptionalIntArrayRef, at::IntArrayRef, std::optional<std::basic_string_view<char> >)’
     26 | inline at::Tensor fft_ifft2(const at::Tensor & self, at::OptionalIntArrayRef s=::std::nullopt, at::IntArrayRef dim={-2,-1}, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                             ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:86:56: error: return type ‘class torch::Tensor’ is incomplete
     86 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::fftn(const torch::Tensor&, at::OptionalIntArrayRef, at::OptionalIntArrayRef, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:87:26: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     87 |   return torch::fft_fftn(self, s, dim, norm);
        |                          ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:706,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_fftn.h:26:47: note: in passing argument 1 of ‘at::Tensor at::fft_fftn(const at::Tensor&, at::OptionalIntArrayRef, at::OptionalIntArrayRef, std::optional<std::basic_string_view<char> >)’
     26 | inline at::Tensor fft_fftn(const at::Tensor & self, at::OptionalIntArrayRef s=::std::nullopt, at::OptionalIntArrayRef dim=::std::nullopt, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                            ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:102:56: error: return type ‘class torch::Tensor’ is incomplete
    102 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::ifftn(const torch::Tensor&, at::OptionalIntArrayRef, at::OptionalIntArrayRef, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:103:27: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    103 |   return torch::fft_ifftn(self, s, dim, norm);
        |                           ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:713,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_ifftn.h:26:48: note: in passing argument 1 of ‘at::Tensor at::fft_ifftn(const at::Tensor&, at::OptionalIntArrayRef, at::OptionalIntArrayRef, std::optional<std::basic_string_view<char> >)’
     26 | inline at::Tensor fft_ifftn(const at::Tensor & self, at::OptionalIntArrayRef s=::std::nullopt, at::OptionalIntArrayRef dim=::std::nullopt, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                             ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:119:56: error: return type ‘class torch::Tensor’ is incomplete
    119 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::rfft(const torch::Tensor&, std::optional<c10::SymInt>, int64_t, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:120:33: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    120 |   return torch::fft_rfft_symint(self, std::move(n), dim, norm);
        |                                 ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:721,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_rfft.h:37:54: note: in passing argument 1 of ‘at::Tensor at::fft_rfft_symint(const at::Tensor&, std::optional<c10::SymInt>, int64_t, std::optional<std::basic_string_view<char> >)’
     37 | inline at::Tensor fft_rfft_symint(const at::Tensor & self, ::std::optional<c10::SymInt> n=::std::nullopt, int64_t dim=-1, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                                   ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:138:56: error: return type ‘class torch::Tensor’ is incomplete
    138 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::irfft(const torch::Tensor&, std::optional<c10::SymInt>, int64_t, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:139:34: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    139 |   return torch::fft_irfft_symint(self, std::move(n), dim, norm);
        |                                  ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:718,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_irfft.h:37:55: note: in passing argument 1 of ‘at::Tensor at::fft_irfft_symint(const at::Tensor&, std::optional<c10::SymInt>, int64_t, std::optional<std::basic_string_view<char> >)’
     37 | inline at::Tensor fft_irfft_symint(const at::Tensor & self, ::std::optional<c10::SymInt> n=::std::nullopt, int64_t dim=-1, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                                    ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:154:56: error: return type ‘class torch::Tensor’ is incomplete
    154 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::rfft2(const torch::Tensor&, at::OptionalIntArrayRef, c10::IntArrayRef, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:155:27: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    155 |   return torch::fft_rfft2(self, s, dim, norm);
        |                           ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:722,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_rfft2.h:26:48: note: in passing argument 1 of ‘at::Tensor at::fft_rfft2(const at::Tensor&, at::OptionalIntArrayRef, at::IntArrayRef, std::optional<std::basic_string_view<char> >)’
     26 | inline at::Tensor fft_rfft2(const at::Tensor & self, at::OptionalIntArrayRef s=::std::nullopt, at::IntArrayRef dim={-2,-1}, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                             ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:170:56: error: return type ‘class torch::Tensor’ is incomplete
    170 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::irfft2(const torch::Tensor&, at::OptionalIntArrayRef, c10::IntArrayRef, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:171:28: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    171 |   return torch::fft_irfft2(self, s, dim, norm);
        |                            ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:719,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_irfft2.h:26:49: note: in passing argument 1 of ‘at::Tensor at::fft_irfft2(const at::Tensor&, at::OptionalIntArrayRef, at::IntArrayRef, std::optional<std::basic_string_view<char> >)’
     26 | inline at::Tensor fft_irfft2(const at::Tensor & self, at::OptionalIntArrayRef s=::std::nullopt, at::IntArrayRef dim={-2,-1}, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:186:56: error: return type ‘class torch::Tensor’ is incomplete
    186 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::rfftn(const torch::Tensor&, at::OptionalIntArrayRef, at::OptionalIntArrayRef, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:187:27: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    187 |   return torch::fft_rfftn(self, s, dim, norm);
        |                           ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:724,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_rfftn.h:26:48: note: in passing argument 1 of ‘at::Tensor at::fft_rfftn(const at::Tensor&, at::OptionalIntArrayRef, at::OptionalIntArrayRef, std::optional<std::basic_string_view<char> >)’
     26 | inline at::Tensor fft_rfftn(const at::Tensor & self, at::OptionalIntArrayRef s=::std::nullopt, at::OptionalIntArrayRef dim=::std::nullopt, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                             ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:202:56: error: return type ‘class torch::Tensor’ is incomplete
    202 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::irfftn(const torch::Tensor&, at::OptionalIntArrayRef, at::OptionalIntArrayRef, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:203:28: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    203 |   return torch::fft_irfftn(self, s, dim, norm);
        |                            ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:720,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_irfftn.h:26:49: note: in passing argument 1 of ‘at::Tensor at::fft_irfftn(const at::Tensor&, at::OptionalIntArrayRef, at::OptionalIntArrayRef, std::optional<std::basic_string_view<char> >)’
     26 | inline at::Tensor fft_irfftn(const at::Tensor & self, at::OptionalIntArrayRef s=::std::nullopt, at::OptionalIntArrayRef dim=::std::nullopt, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:222:56: error: return type ‘class torch::Tensor’ is incomplete
    222 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::hfft(const torch::Tensor&, std::optional<c10::SymInt>, int64_t, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:223:33: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    223 |   return torch::fft_hfft_symint(self, std::move(n), dim, norm);
        |                                 ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:708,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_hfft.h:37:54: note: in passing argument 1 of ‘at::Tensor at::fft_hfft_symint(const at::Tensor&, std::optional<c10::SymInt>, int64_t, std::optional<std::basic_string_view<char> >)’
     37 | inline at::Tensor fft_hfft_symint(const at::Tensor & self, ::std::optional<c10::SymInt> n=::std::nullopt, int64_t dim=-1, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                                   ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:241:56: error: return type ‘class torch::Tensor’ is incomplete
    241 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::ihfft(const torch::Tensor&, std::optional<c10::SymInt>, int64_t, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:242:34: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    242 |   return torch::fft_ihfft_symint(self, std::move(n), dim, norm);
        |                                  ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:715,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_ihfft.h:37:55: note: in passing argument 1 of ‘at::Tensor at::fft_ihfft_symint(const at::Tensor&, std::optional<c10::SymInt>, int64_t, std::optional<std::basic_string_view<char> >)’
     37 | inline at::Tensor fft_ihfft_symint(const at::Tensor & self, ::std::optional<c10::SymInt> n=::std::nullopt, int64_t dim=-1, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                                    ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:260:56: error: return type ‘class torch::Tensor’ is incomplete
    260 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::hfft2(const torch::Tensor&, at::OptionalIntArrayRef, c10::IntArrayRef, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:261:27: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    261 |   return torch::fft_hfft2(self, s, dim, norm);
        |                           ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:709,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_hfft2.h:26:48: note: in passing argument 1 of ‘at::Tensor at::fft_hfft2(const at::Tensor&, at::OptionalIntArrayRef, at::IntArrayRef, std::optional<std::basic_string_view<char> >)’
     26 | inline at::Tensor fft_hfft2(const at::Tensor & self, at::OptionalIntArrayRef s=::std::nullopt, at::IntArrayRef dim={-2,-1}, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                             ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:280:56: error: return type ‘class torch::Tensor’ is incomplete
    280 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::ihfft2(const torch::Tensor&, at::OptionalIntArrayRef, c10::IntArrayRef, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:281:28: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    281 |   return torch::fft_ihfft2(self, s, dim, norm);
        |                            ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:716,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_ihfft2.h:26:49: note: in passing argument 1 of ‘at::Tensor at::fft_ihfft2(const at::Tensor&, at::OptionalIntArrayRef, at::IntArrayRef, std::optional<std::basic_string_view<char> >)’
     26 | inline at::Tensor fft_ihfft2(const at::Tensor & self, at::OptionalIntArrayRef s=::std::nullopt, at::IntArrayRef dim={-2,-1}, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:299:56: error: return type ‘class torch::Tensor’ is incomplete
    299 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::hfftn(const torch::Tensor&, at::OptionalIntArrayRef, c10::IntArrayRef, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:300:27: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    300 |   return torch::fft_hfftn(self, s, dim, norm);
        |                           ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:710,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_hfftn.h:26:48: note: in passing argument 1 of ‘at::Tensor at::fft_hfftn(const at::Tensor&, at::OptionalIntArrayRef, at::OptionalIntArrayRef, std::optional<std::basic_string_view<char> >)’
     26 | inline at::Tensor fft_hfftn(const at::Tensor & self, at::OptionalIntArrayRef s=::std::nullopt, at::OptionalIntArrayRef dim=::std::nullopt, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                             ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:319:56: error: return type ‘class torch::Tensor’ is incomplete
    319 |     std::optional<c10::string_view> norm = std::nullopt) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::ihfftn(const torch::Tensor&, at::OptionalIntArrayRef, c10::IntArrayRef, std::optional<std::basic_string_view<char> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:320:28: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    320 |   return torch::fft_ihfftn(self, s, dim, norm);
        |                            ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:717,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_ihfftn.h:26:49: note: in passing argument 1 of ‘at::Tensor at::fft_ihfftn(const at::Tensor&, at::OptionalIntArrayRef, at::OptionalIntArrayRef, std::optional<std::basic_string_view<char> >)’
     26 | inline at::Tensor fft_ihfftn(const at::Tensor & self, at::OptionalIntArrayRef s=::std::nullopt, at::OptionalIntArrayRef dim=::std::nullopt, ::std::optional<c10::string_view> norm=::std::nullopt) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:332:77: error: return type ‘class torch::Tensor’ is incomplete
    332 | inline Tensor fftfreq(int64_t n, double d, const TensorOptions& options = {}) {
        |                                                                             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:336:67: error: return type ‘class torch::Tensor’ is incomplete
    336 | inline Tensor fftfreq(int64_t n, const TensorOptions& options = {}) {
        |                                                                   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:349:73: error: return type ‘class torch::Tensor’ is incomplete
    349 | inline Tensor rfftfreq(int64_t n, double d, const TensorOptions& options) {
        |                                                                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:353:63: error: return type ‘class torch::Tensor’ is incomplete
    353 | inline Tensor rfftfreq(int64_t n, const TensorOptions& options) {
        |                                                               ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:369:47: error: return type ‘class torch::Tensor’ is incomplete
    369 |     at::OptionalIntArrayRef dim = std::nullopt) {
        |                                               ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::fftshift(const torch::Tensor&, at::OptionalIntArrayRef)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:370:30: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    370 |   return torch::fft_fftshift(x, dim);
        |                              ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:707,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_fftshift.h:26:51: note: in passing argument 1 of ‘at::Tensor at::fft_fftshift(const at::Tensor&, at::OptionalIntArrayRef)’
     26 | inline at::Tensor fft_fftshift(const at::Tensor & self, at::OptionalIntArrayRef dim=::std::nullopt) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:386:47: error: return type ‘class torch::Tensor’ is incomplete
    386 |     at::OptionalIntArrayRef dim = std::nullopt) {
        |                                               ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h: In function ‘void torch::fft::ifftshift(const torch::Tensor&, at::OptionalIntArrayRef)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/fft.h:387:31: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    387 |   return torch::fft_ifftshift(x, dim);
        |                               ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:714,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/fft_ifftshift.h:26:52: note: in passing argument 1 of ‘at::Tensor at::fft_ifftshift(const at::Tensor&, at::OptionalIntArrayRef)’
     26 | inline at::Tensor fft_ifftshift(const at::Tensor & self, at::OptionalIntArrayRef dim=::std::nullopt) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h:29:27: error: template argument 1 is invalid
     29 |       std::optional<Device> device) const = 0;
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h:29:27: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h:29:27: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h:29:27: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h:29:7: error: invalid template-id
     29 |       std::optional<Device> device) const = 0;
        |       ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h:29:21: error: reference to ‘Device’ is ambiguous
     29 |       std::optional<Device> device) const = 0;
        |                     ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h:29:7: error: class template placeholder ‘std::optional’ not permitted in this context
     29 |       std::optional<Device> device) const = 0;
        |       ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h:29:7: note: use ‘auto’ for an abbreviated function template
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h:126:27: error: template argument 1 is invalid
    126 |       std::optional<Device> device) const override {
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h:126:27: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h:126:27: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h:126:27: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h:126:7: error: invalid template-id
    126 |       std::optional<Device> device) const override {
        |       ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h:126:21: error: reference to ‘Device’ is ambiguous
    126 |       std::optional<Device> device) const override {
        |                     ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h:126:7: error: class template placeholder ‘std::optional’ not permitted in this context
    126 |       std::optional<Device> device) const override {
        |       ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h:126:7: note: use ‘auto’ for an abbreviated function template
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:118:33: error: template argument 1 is invalid
    118 |       const std::optional<Device>& device = std::nullopt) const;
        |                                 ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:118:33: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:118:33: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:118:33: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:118:13: error: invalid template-id
    118 |       const std::optional<Device>& device = std::nullopt) const;
        |             ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:118:27: error: reference to ‘Device’ is ambiguous
    118 |       const std::optional<Device>& device = std::nullopt) const;
        |                           ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:118:7: error: template placeholder type ‘const optional<...auto...>’ must be followed by a simple declarator-id
    118 |       const std::optional<Device>& device = std::nullopt) const;
        |       ^~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:65:11: note: ‘template<class _Tp> class std::optional’ declared here
     65 |     class optional;
        |           ^~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:574:31: error: template argument 1 is invalid
    574 |       const std::vector<Device>& devices);
        |                               ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:574:31: error: template argument 2 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:574:31: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:574:31: error: template argument 2 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:574:31: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:574:31: error: template argument 2 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:574:31: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:574:31: error: template argument 2 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:574:13: error: invalid template-id
    574 |       const std::vector<Device>& devices);
        |             ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:574:25: error: reference to ‘Device’ is ambiguous
    574 |       const std::vector<Device>& devices);
        |                         ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:574:7: error: template placeholder type ‘const vector<...auto...>’ must be followed by a simple declarator-id
    574 |       const std::vector<Device>& devices);
        |       ^~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:389:11: note: ‘template<class _Tp, class _Alloc> class std::vector’ declared here
    389 |     class vector : protected _Vector_base<_Tp, _Alloc>
        |           ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:579:64: error: template argument 1 is invalid
    579 |   virtual void clone_(Module& other, const std::optional<Device>& device);
        |                                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:579:64: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:579:64: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:579:64: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:579:44: error: invalid template-id
    579 |   virtual void clone_(Module& other, const std::optional<Device>& device);
        |                                            ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:579:58: error: reference to ‘Device’ is ambiguous
    579 |   virtual void clone_(Module& other, const std::optional<Device>& device);
        |                                                          ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:579:38: error: template placeholder type ‘const optional<...auto...>’ must be followed by a simple declarator-id
    579 |   virtual void clone_(Module& other, const std::optional<Device>& device);
        |                                      ^~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:65:11: note: ‘template<class _Tp> class std::optional’ declared here
     65 |     class optional;
        |           ^~~~~~~~
  In file included from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_pair.h: In instantiation of ‘struct std::pair<std::__cxx11::basic_string<char>, torch::Tensor>’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/ordered_dict.h:242:27:   required from ‘class torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:691:60:   required from here
  /usr/include/c++/11/bits/stl_pair.h:218:11: error: ‘std::pair<_T1, _T2>::second’ has incomplete type
    218 |       _T2 second;                ///< The second member
        |           ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/move.h:57,
                   from /usr/include/c++/11/bits/stl_pair.h:59,
                   from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::is_copy_assignable<torch::Tensor>’:
  /usr/include/c++/11/type_traits:152:12:   required from ‘struct std::__and_<std::is_copy_assignable<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::is_copy_assignable<torch::Tensor> >’
  /usr/include/c++/11/bits/stl_pair.h:390:7:   required from ‘struct std::pair<std::__cxx11::basic_string<char>, torch::Tensor>’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/ordered_dict.h:242:27:   required from ‘class torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:691:60:   required from here
  /usr/include/c++/11/type_traits:1110:52: error: static assertion failed: template argument must be a complete class or an unbounded array
   1110 |       static_assert(std::__is_complete_or_unbounded(__type_identity<_Tp>{}),
        |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/type_traits:1110:52: note: ‘std::__is_complete_or_unbounded<std::__type_identity<torch::Tensor> >((std::__type_identity<torch::Tensor>{}, std::__type_identity<torch::Tensor>()))’ evaluates to false
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::is_move_assignable<torch::Tensor>’:
  /usr/include/c++/11/type_traits:152:12:   required from ‘struct std::__and_<std::is_move_assignable<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::is_move_assignable<torch::Tensor> >’
  /usr/include/c++/11/bits/stl_pair.h:401:7:   required from ‘struct std::pair<std::__cxx11::basic_string<char>, torch::Tensor>’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/ordered_dict.h:242:27:   required from ‘class torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:691:60:   required from here
  /usr/include/c++/11/type_traits:1131:52: error: static assertion failed: template argument must be a complete class or an unbounded array
   1131 |       static_assert(std::__is_complete_or_unbounded(__type_identity<_Tp>{}),
        |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/type_traits:1131:52: note: ‘std::__is_complete_or_unbounded<std::__type_identity<torch::Tensor> >((std::__type_identity<torch::Tensor>{}, std::__type_identity<torch::Tensor>()))’ evaluates to false
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h: In member function ‘void torch::nn::Module::to_impl(Ts&& ...)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:692:14: warning: invalid use of incomplete type ‘class torch::Tensor’
    692 |     parameter->set_data(autograd::Variable(*parameter).to(ts...));
        |              ^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:696:11: warning: invalid use of incomplete type ‘class torch::Tensor’
    696 |     buffer->set_data(autograd::Variable(*buffer).to(ts...));
        |           ^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/utils.h: In function ‘bool torch::equal_if_defined(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/utils.h:94:9: error: invalid use of incomplete type ‘const class torch::Tensor’
     94 |       (!t1.defined() && !t2.defined()) ||
        |         ^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/utils.h:94:26: error: invalid use of incomplete type ‘const class torch::Tensor’
     94 |       (!t1.defined() && !t2.defined()) ||
        |                          ^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/utils.h:95:8: error: invalid use of incomplete type ‘const class torch::Tensor’
     95 |       (t1.defined() && t2.defined() && torch::equal(t1, t2)));
        |        ^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/utils.h:95:24: error: invalid use of incomplete type ‘const class torch::Tensor’
     95 |       (t1.defined() && t2.defined() && torch::equal(t1, t2)));
        |                        ^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/utils.h:95:53: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     95 |       (t1.defined() && t2.defined() && torch::equal(t1, t2)));
        |                                                     ^~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:676,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/equal.h:26:38: note: in passing argument 1 of ‘bool at::equal(const at::Tensor&, const at::Tensor&)’
     26 | inline bool equal(const at::Tensor & self, const at::Tensor & other) {
        |                   ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:35:33: error: template argument 1 is invalid
     35 |       const std::optional<Device>& device = std::nullopt) const override {
        |                                 ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:35:33: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:35:33: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:35:33: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:35:13: error: invalid template-id
     35 |       const std::optional<Device>& device = std::nullopt) const override {
        |             ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:35:27: error: reference to ‘Device’ is ambiguous
     35 |       const std::optional<Device>& device = std::nullopt) const override {
        |                           ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:35:7: error: template placeholder type ‘const optional<...auto...>’ must be followed by a simple declarator-id
     35 |       const std::optional<Device>& device = std::nullopt) const override {
        |       ^~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:65:11: note: ‘template<class _Tp> class std::optional’ declared here
     65 |     class optional;
        |           ^~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:81:56: error: template argument 1 is invalid
     81 |   void clone_(Module& other, const std::optional<Device>& device) final {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:81:56: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:81:56: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:81:56: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:81:36: error: invalid template-id
     81 |   void clone_(Module& other, const std::optional<Device>& device) final {
        |                                    ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:81:50: error: reference to ‘Device’ is ambiguous
     81 |   void clone_(Module& other, const std::optional<Device>& device) final {
        |                                                  ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:81:30: error: template placeholder type ‘const optional<...auto...>’ must be followed by a simple declarator-id
     81 |   void clone_(Module& other, const std::optional<Device>& device) final {
        |                              ^~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:65:11: note: ‘template<class _Tp> class std::optional’ declared here
     65 |     class optional;
        |           ^~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In member function ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:29: warning: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:58: warning: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:58: warning: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:29: warning: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:58: warning: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:58: warning: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In member function ‘void torch::nn::Cloneable<Derived>::clone_(...)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:85:53: error: ‘other’ was not declared in this scope; did you mean ‘c10::attr::other’?
     85 |     auto clone = std::dynamic_pointer_cast<Derived>(other.clone(device));
        |                                                     ^~~~~
        |                                                     c10::attr::other
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/jit/ir/ir.h:18,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/jit/api/function_impl.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/jit/api/method.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/jit/api/object.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/jit/api/module.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/serialize/input-archive.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/serialize/archive.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/samplers/serialize.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/samplers.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets/chunk.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/aten_interned_strings.h:2005:9: note: ‘c10::attr::other’ declared here
   2005 | _(attr, other) \
        |         ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/interned_strings.h:351:35: note: in definition of macro ‘DEFINE_SYMBOL’
    351 |   namespace ns { constexpr Symbol s(static_cast<unique_t>(_keys::ns##_##s)); }
        |                                   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/interned_strings.h:298:3: note: in expansion of macro ‘FORALL_ATTR_BASE_SYMBOLS’
    298 |   FORALL_ATTR_BASE_SYMBOLS(_)        \
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/interned_strings.h:352:1: note: in expansion of macro ‘FORALL_NS_SYMBOLS’
    352 | FORALL_NS_SYMBOLS(DEFINE_SYMBOL)
        | ^~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/batchnorm.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/batchnorm.h:76:21: error: field ‘weight_’ has incomplete type ‘torch::Tensor’
     76 |   TORCH_ARG(Tensor, weight) = Tensor();
        |                     ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/batchnorm.h:78:21: error: field ‘bias_’ has incomplete type ‘torch::Tensor’
     78 |   TORCH_ARG(Tensor, bias) = Tensor();
        |                     ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:15:12: error: ‘weight’ has incomplete type
     15 |     Tensor weight,
        |     ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:16:12: error: ‘bias’ has incomplete type
     16 |     Tensor bias,
        |     ~~~~~~~^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:19:15: error: return type ‘class torch::Tensor’ is incomplete
     19 |     double eps) {
        |               ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h: In function ‘void torch::nn::functional::detail::batch_norm(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::Tensor, torch::Tensor, bool, std::optional<double>, double)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:21:7: error: invalid use of incomplete type ‘const class torch::Tensor’
     21 |       input.dim() >= 2,
        |       ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:20:3: note: in expansion of macro ‘TORCH_CHECK’
     20 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:23:7: error: invalid use of incomplete type ‘const class torch::Tensor’
     23 |       input.dim());
        |       ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:20:3: note: in expansion of macro ‘TORCH_CHECK’
     20 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:25:17: error: invalid use of incomplete type ‘const class torch::Tensor’
     25 |     auto size = input.sizes();
        |                 ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:67:45: error: return type ‘class torch::Tensor’ is incomplete
     67 |     const BatchNormFuncOptions& options = {}) {
        |                                             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h: In function ‘void torch::nn::functional::batch_norm(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, const torch::nn::functional::BatchNormFuncOptions&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:72:21: error: invalid use of incomplete type ‘const class torch::Tensor’
     72 |       options.weight(),
        |       ~~~~~~~~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:15:12: note:   initializing argument 4 of ‘void torch::nn::functional::detail::batch_norm(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::Tensor, torch::Tensor, bool, std::optional<double>, double)’
     15 |     Tensor weight,
        |     ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/conv.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/conv.h:199:28: error: field ‘bias_’ has incomplete type ‘torch::Tensor’
    199 |   TORCH_ARG(torch::Tensor, bias) = Tensor();
        |                            ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/conv.h:355:28: error: field ‘bias_’ has incomplete type ‘torch::Tensor’
    355 |   TORCH_ARG(torch::Tensor, bias) = Tensor();
        |                            ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:31:19: error: return type ‘class torch::Tensor’ is incomplete
     31 |     int64_t groups) {
        |                   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h: In instantiation of ‘torch::nn::functional::detail::conv1d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<1>, const padding_t&, torch::ExpandingArray<1>, int64_t)::<lambda(const auto:46&)> [with auto:46 = torch::ExpandingArray<1>]’:
  /usr/include/c++/11/type_traits:2530:26:   required by substitution of ‘template<class _Fn, class ... _Args> static std::__result_of_success<decltype (declval<_Fn>()((declval<_Args>)()...)), std::__invoke_other> std::__result_of_other_impl::_S_test(int) [with _Fn = torch::nn::functional::detail::conv1d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<1>, const padding_t&, torch::ExpandingArray<1>, int64_t)::<lambda(const auto:46&)>; _Args = {const torch::ExpandingArray<1, long int>&}]’
  /usr/include/c++/11/type_traits:2541:55:   required from ‘struct std::__result_of_impl<false, false, torch::nn::functional::detail::conv1d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<1>, const padding_t&, torch::ExpandingArray<1>, int64_t)::<lambda(const auto:46&)>, const torch::ExpandingArray<1, long int>&>’
  /usr/include/c++/11/type_traits:2546:12:   required from ‘struct std::__invoke_result<torch::nn::functional::detail::conv1d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<1>, const padding_t&, torch::ExpandingArray<1>, int64_t)::<lambda(const auto:46&)>, const torch::ExpandingArray<1, long int>&>’
  /usr/include/c++/11/type_traits:3004:12:   required from ‘struct std::invoke_result<torch::nn::functional::detail::conv1d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<1>, const padding_t&, torch::ExpandingArray<1>, int64_t)::<lambda(const auto:46&)>, const torch::ExpandingArray<1, long int>&>’
  /usr/include/c++/11/type_traits:3016:11:   required by substitution of ‘template<class _Fn, class ... _Args> using invoke_result_t = typename std::invoke_result::type [with _Fn = torch::nn::functional::detail::conv1d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<1>, const padding_t&, torch::ExpandingArray<1>, int64_t)::<lambda(const auto:46&)>; _Args = {const torch::ExpandingArray<1, long int>&}]’
  /usr/include/c++/11/variant:1078:11:   required by substitution of ‘template<class _Visitor, class ... _Variants> using __visit_result_t = std::invoke_result_t<_Visitor, std::__detail::__variant::__get_t<0, _Variants, decltype (std::__detail::__variant::__as(declval<_Variants>())), typename std::variant_alternative<0, typename std::remove_reference<decltype (std::__detail::__variant::__as(declval<_Variants>()))>::type>::type>...> [with _Visitor = torch::nn::functional::detail::conv1d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<1>, const padding_t&, torch::ExpandingArray<1>, int64_t)::<lambda(const auto:46&)>; _Variants = {const std::variant<torch::ExpandingArray<1, long int>, torch::enumtype::kValid, torch::enumtype::kSame>&}]’
  /usr/include/c++/11/variant:1734:5:   required by substitution of ‘template<class _Visitor, class ... _Variants> constexpr std::__detail::__variant::__visit_result_t<_Visitor, _Variants ...> std::visit(_Visitor&&, _Variants&& ...) [with _Visitor = torch::nn::functional::detail::conv1d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<1>, const padding_t&, torch::ExpandingArray<1>, int64_t)::<lambda(const auto:46&)>; _Variants = {const std::variant<torch::ExpandingArray<1, long int>, torch::enumtype::kValid, torch::enumtype::kSame>&}]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:32:20:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:34:29: error: no matching function for call to ‘conv1d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<1>&, c10::IntArrayRef, torch::ExpandingArray<1>&, int64_t&)’
     34 |         return torch::conv1d(
        |                ~~~~~~~~~~~~~^
     35 |             input, weight, bias, stride, padding_unwrap(pad), dilation, groups);
        |             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:592,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/conv1d.h:26:19: note: candidate: ‘at::Tensor at::conv1d(const at::Tensor&, const at::Tensor&, const std::optional<at::Tensor>&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, int64_t)’
     26 | inline at::Tensor conv1d(const at::Tensor & input, const at::Tensor & weight, const ::std::optional<at::Tensor> & bias={}, at::IntArrayRef stride=1, at::IntArrayRef padding=0, at::IntArrayRef dilation=1, int64_t groups=1) {
        |                   ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/conv1d.h:26:45: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor conv1d(const at::Tensor & input, const at::Tensor & weight, const ::std::optional<at::Tensor> & bias={}, at::IntArrayRef stride=1, at::IntArrayRef padding=0, at::IntArrayRef dilation=1, int64_t groups=1) {
        |                          ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:592,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/conv1d.h:48:19: note: candidate: ‘at::Tensor at::conv1d(const at::Tensor&, const at::Tensor&, const std::optional<at::Tensor>&, at::IntArrayRef, c10::string_view, at::IntArrayRef, int64_t)’
     48 | inline at::Tensor conv1d(const at::Tensor & input, const at::Tensor & weight, const ::std::optional<at::Tensor> & bias, at::IntArrayRef stride, c10::string_view padding, at::IntArrayRef dilation=1, int64_t groups=1) {
        |                   ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/conv1d.h:48:45: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     48 | inline at::Tensor conv1d(const at::Tensor & input, const at::Tensor & weight, const ::std::optional<at::Tensor> & bias, at::IntArrayRef stride, c10::string_view padding, at::IntArrayRef dilation=1, int64_t groups=1) {
        |                          ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h: In function ‘void torch::nn::functional::detail::conv1d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<1>, const padding_t&, torch::ExpandingArray<1>, int64_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:32:20: error: no matching function for call to ‘visit(torch::nn::functional::detail::conv1d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<1>, const padding_t&, torch::ExpandingArray<1>, int64_t)::<lambda(const auto:46&)>, const padding_t&)’
     32 |   return std::visit(
        |          ~~~~~~~~~~^
     33 |       [&](const auto& pad) {
        |       ~~~~~~~~~~~~~~~~~~~~~~
     34 |         return torch::conv1d(
        |         ~~~~~~~~~~~~~~~~~~~~~
     35 |             input, weight, bias, stride, padding_unwrap(pad), dilation, groups);
        |             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     36 |       },
        |       ~~
     37 |       padding);
        |       ~~~~~~~~
  In file included from /workspace/nunchaku/src/common.h:18,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/variant:1734:5: note: candidate: ‘template<class _Visitor, class ... _Variants> constexpr std::__detail::__variant::__visit_result_t<_Visitor, _Variants ...> std::visit(_Visitor&&, _Variants&& ...)’
   1734 |     visit(_Visitor&& __visitor, _Variants&&... __variants)
        |     ^~~~~
  /usr/include/c++/11/variant:1734:5: note:   substitution of deduced template arguments resulted in errors seen above
  /usr/include/c++/11/variant:1774:5: note: candidate: ‘template<class _Res, class _Visitor, class ... _Variants> constexpr _Res std::visit(_Visitor&&, _Variants&& ...)’
   1774 |     visit(_Visitor&& __visitor, _Variants&&... __variants)
        |     ^~~~~
  /usr/include/c++/11/variant:1774:5: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:32:20: note:   couldn’t deduce template parameter ‘_Res’
     32 |   return std::visit(
        |          ~~~~~~~~~~^
     33 |       [&](const auto& pad) {
        |       ~~~~~~~~~~~~~~~~~~~~~~
     34 |         return torch::conv1d(
        |         ~~~~~~~~~~~~~~~~~~~~~
     35 |             input, weight, bias, stride, padding_unwrap(pad), dilation, groups);
        |             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     36 |       },
        |       ~~
     37 |       padding);
        |       ~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:57:42: error: return type ‘class torch::Tensor’ is incomplete
     57 |     const Conv1dFuncOptions& options = {}) {
        |                                          ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:77:19: error: return type ‘class torch::Tensor’ is incomplete
     77 |     int64_t groups) {
        |                   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h: In instantiation of ‘torch::nn::functional::detail::conv2d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<2>, const padding_t&, torch::ExpandingArray<2>, int64_t)::<lambda(const auto:47&)> [with auto:47 = torch::ExpandingArray<2>]’:
  /usr/include/c++/11/type_traits:2530:26:   required by substitution of ‘template<class _Fn, class ... _Args> static std::__result_of_success<decltype (declval<_Fn>()((declval<_Args>)()...)), std::__invoke_other> std::__result_of_other_impl::_S_test(int) [with _Fn = torch::nn::functional::detail::conv2d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<2>, const padding_t&, torch::ExpandingArray<2>, int64_t)::<lambda(const auto:47&)>; _Args = {const torch::ExpandingArray<2, long int>&}]’
  /usr/include/c++/11/type_traits:2541:55:   required from ‘struct std::__result_of_impl<false, false, torch::nn::functional::detail::conv2d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<2>, const padding_t&, torch::ExpandingArray<2>, int64_t)::<lambda(const auto:47&)>, const torch::ExpandingArray<2, long int>&>’
  /usr/include/c++/11/type_traits:2546:12:   required from ‘struct std::__invoke_result<torch::nn::functional::detail::conv2d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<2>, const padding_t&, torch::ExpandingArray<2>, int64_t)::<lambda(const auto:47&)>, const torch::ExpandingArray<2, long int>&>’
  /usr/include/c++/11/type_traits:3004:12:   required from ‘struct std::invoke_result<torch::nn::functional::detail::conv2d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<2>, const padding_t&, torch::ExpandingArray<2>, int64_t)::<lambda(const auto:47&)>, const torch::ExpandingArray<2, long int>&>’
  /usr/include/c++/11/type_traits:3016:11:   required by substitution of ‘template<class _Fn, class ... _Args> using invoke_result_t = typename std::invoke_result::type [with _Fn = torch::nn::functional::detail::conv2d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<2>, const padding_t&, torch::ExpandingArray<2>, int64_t)::<lambda(const auto:47&)>; _Args = {const torch::ExpandingArray<2, long int>&}]’
  /usr/include/c++/11/variant:1078:11:   required by substitution of ‘template<class _Visitor, class ... _Variants> using __visit_result_t = std::invoke_result_t<_Visitor, std::__detail::__variant::__get_t<0, _Variants, decltype (std::__detail::__variant::__as(declval<_Variants>())), typename std::variant_alternative<0, typename std::remove_reference<decltype (std::__detail::__variant::__as(declval<_Variants>()))>::type>::type>...> [with _Visitor = torch::nn::functional::detail::conv2d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<2>, const padding_t&, torch::ExpandingArray<2>, int64_t)::<lambda(const auto:47&)>; _Variants = {const std::variant<torch::ExpandingArray<2, long int>, torch::enumtype::kValid, torch::enumtype::kSame>&}]’
  /usr/include/c++/11/variant:1734:5:   required by substitution of ‘template<class _Visitor, class ... _Variants> constexpr std::__detail::__variant::__visit_result_t<_Visitor, _Variants ...> std::visit(_Visitor&&, _Variants&& ...) [with _Visitor = torch::nn::functional::detail::conv2d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<2>, const padding_t&, torch::ExpandingArray<2>, int64_t)::<lambda(const auto:47&)>; _Variants = {const std::variant<torch::ExpandingArray<2, long int>, torch::enumtype::kValid, torch::enumtype::kSame>&}]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:78:20:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:80:29: error: no matching function for call to ‘conv2d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<2>&, c10::IntArrayRef, torch::ExpandingArray<2>&, int64_t&)’
     80 |         return torch::conv2d(
        |                ~~~~~~~~~~~~~^
     81 |             input, weight, bias, stride, padding_unwrap(pad), dilation, groups);
        |             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:593,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/conv2d.h:26:19: note: candidate: ‘at::Tensor at::conv2d(const at::Tensor&, const at::Tensor&, const std::optional<at::Tensor>&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, int64_t)’
     26 | inline at::Tensor conv2d(const at::Tensor & input, const at::Tensor & weight, const ::std::optional<at::Tensor> & bias={}, at::IntArrayRef stride=1, at::IntArrayRef padding=0, at::IntArrayRef dilation=1, int64_t groups=1) {
        |                   ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/conv2d.h:26:45: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor conv2d(const at::Tensor & input, const at::Tensor & weight, const ::std::optional<at::Tensor> & bias={}, at::IntArrayRef stride=1, at::IntArrayRef padding=0, at::IntArrayRef dilation=1, int64_t groups=1) {
        |                          ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:593,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/conv2d.h:48:19: note: candidate: ‘at::Tensor at::conv2d(const at::Tensor&, const at::Tensor&, const std::optional<at::Tensor>&, at::IntArrayRef, c10::string_view, at::IntArrayRef, int64_t)’
     48 | inline at::Tensor conv2d(const at::Tensor & input, const at::Tensor & weight, const ::std::optional<at::Tensor> & bias, at::IntArrayRef stride, c10::string_view padding, at::IntArrayRef dilation=1, int64_t groups=1) {
        |                   ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/conv2d.h:48:45: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     48 | inline at::Tensor conv2d(const at::Tensor & input, const at::Tensor & weight, const ::std::optional<at::Tensor> & bias, at::IntArrayRef stride, c10::string_view padding, at::IntArrayRef dilation=1, int64_t groups=1) {
        |                          ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h: In function ‘void torch::nn::functional::detail::conv2d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<2>, const padding_t&, torch::ExpandingArray<2>, int64_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:78:20: error: no matching function for call to ‘visit(torch::nn::functional::detail::conv2d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<2>, const padding_t&, torch::ExpandingArray<2>, int64_t)::<lambda(const auto:47&)>, const padding_t&)’
     78 |   return std::visit(
        |          ~~~~~~~~~~^
     79 |       [&](const auto& pad) {
        |       ~~~~~~~~~~~~~~~~~~~~~~
     80 |         return torch::conv2d(
        |         ~~~~~~~~~~~~~~~~~~~~~
     81 |             input, weight, bias, stride, padding_unwrap(pad), dilation, groups);
        |             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     82 |       },
        |       ~~
     83 |       padding);
        |       ~~~~~~~~
  In file included from /workspace/nunchaku/src/common.h:18,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/variant:1734:5: note: candidate: ‘template<class _Visitor, class ... _Variants> constexpr std::__detail::__variant::__visit_result_t<_Visitor, _Variants ...> std::visit(_Visitor&&, _Variants&& ...)’
   1734 |     visit(_Visitor&& __visitor, _Variants&&... __variants)
        |     ^~~~~
  /usr/include/c++/11/variant:1734:5: note:   substitution of deduced template arguments resulted in errors seen above
  /usr/include/c++/11/variant:1774:5: note: candidate: ‘template<class _Res, class _Visitor, class ... _Variants> constexpr _Res std::visit(_Visitor&&, _Variants&& ...)’
   1774 |     visit(_Visitor&& __visitor, _Variants&&... __variants)
        |     ^~~~~
  /usr/include/c++/11/variant:1774:5: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:78:20: note:   couldn’t deduce template parameter ‘_Res’
     78 |   return std::visit(
        |          ~~~~~~~~~~^
     79 |       [&](const auto& pad) {
        |       ~~~~~~~~~~~~~~~~~~~~~~
     80 |         return torch::conv2d(
        |         ~~~~~~~~~~~~~~~~~~~~~
     81 |             input, weight, bias, stride, padding_unwrap(pad), dilation, groups);
        |             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     82 |       },
        |       ~~
     83 |       padding);
        |       ~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:103:42: error: return type ‘class torch::Tensor’ is incomplete
    103 |     const Conv2dFuncOptions& options = {}) {
        |                                          ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:123:19: error: return type ‘class torch::Tensor’ is incomplete
    123 |     int64_t groups) {
        |                   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h: In instantiation of ‘torch::nn::functional::detail::conv3d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<3>, const padding_t&, torch::ExpandingArray<3>, int64_t)::<lambda(const auto:48&)> [with auto:48 = torch::ExpandingArray<3>]’:
  /usr/include/c++/11/type_traits:2530:26:   required by substitution of ‘template<class _Fn, class ... _Args> static std::__result_of_success<decltype (declval<_Fn>()((declval<_Args>)()...)), std::__invoke_other> std::__result_of_other_impl::_S_test(int) [with _Fn = torch::nn::functional::detail::conv3d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<3>, const padding_t&, torch::ExpandingArray<3>, int64_t)::<lambda(const auto:48&)>; _Args = {const torch::ExpandingArray<3, long int>&}]’
  /usr/include/c++/11/type_traits:2541:55:   required from ‘struct std::__result_of_impl<false, false, torch::nn::functional::detail::conv3d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<3>, const padding_t&, torch::ExpandingArray<3>, int64_t)::<lambda(const auto:48&)>, const torch::ExpandingArray<3, long int>&>’
  /usr/include/c++/11/type_traits:2546:12:   required from ‘struct std::__invoke_result<torch::nn::functional::detail::conv3d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<3>, const padding_t&, torch::ExpandingArray<3>, int64_t)::<lambda(const auto:48&)>, const torch::ExpandingArray<3, long int>&>’
  /usr/include/c++/11/type_traits:3004:12:   required from ‘struct std::invoke_result<torch::nn::functional::detail::conv3d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<3>, const padding_t&, torch::ExpandingArray<3>, int64_t)::<lambda(const auto:48&)>, const torch::ExpandingArray<3, long int>&>’
  /usr/include/c++/11/type_traits:3016:11:   required by substitution of ‘template<class _Fn, class ... _Args> using invoke_result_t = typename std::invoke_result::type [with _Fn = torch::nn::functional::detail::conv3d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<3>, const padding_t&, torch::ExpandingArray<3>, int64_t)::<lambda(const auto:48&)>; _Args = {const torch::ExpandingArray<3, long int>&}]’
  /usr/include/c++/11/variant:1078:11:   required by substitution of ‘template<class _Visitor, class ... _Variants> using __visit_result_t = std::invoke_result_t<_Visitor, std::__detail::__variant::__get_t<0, _Variants, decltype (std::__detail::__variant::__as(declval<_Variants>())), typename std::variant_alternative<0, typename std::remove_reference<decltype (std::__detail::__variant::__as(declval<_Variants>()))>::type>::type>...> [with _Visitor = torch::nn::functional::detail::conv3d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<3>, const padding_t&, torch::ExpandingArray<3>, int64_t)::<lambda(const auto:48&)>; _Variants = {const std::variant<torch::ExpandingArray<3, long int>, torch::enumtype::kValid, torch::enumtype::kSame>&}]’
  /usr/include/c++/11/variant:1734:5:   required by substitution of ‘template<class _Visitor, class ... _Variants> constexpr std::__detail::__variant::__visit_result_t<_Visitor, _Variants ...> std::visit(_Visitor&&, _Variants&& ...) [with _Visitor = torch::nn::functional::detail::conv3d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<3>, const padding_t&, torch::ExpandingArray<3>, int64_t)::<lambda(const auto:48&)>; _Variants = {const std::variant<torch::ExpandingArray<3, long int>, torch::enumtype::kValid, torch::enumtype::kSame>&}]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:124:20:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:126:29: error: no matching function for call to ‘conv3d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<3>&, c10::IntArrayRef, torch::ExpandingArray<3>&, int64_t&)’
    126 |         return torch::conv3d(
        |                ~~~~~~~~~~~~~^
    127 |             input, weight, bias, stride, padding_unwrap(pad), dilation, groups);
        |             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:594,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/conv3d.h:26:19: note: candidate: ‘at::Tensor at::conv3d(const at::Tensor&, const at::Tensor&, const std::optional<at::Tensor>&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, int64_t)’
     26 | inline at::Tensor conv3d(const at::Tensor & input, const at::Tensor & weight, const ::std::optional<at::Tensor> & bias={}, at::IntArrayRef stride=1, at::IntArrayRef padding=0, at::IntArrayRef dilation=1, int64_t groups=1) {
        |                   ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/conv3d.h:26:45: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor conv3d(const at::Tensor & input, const at::Tensor & weight, const ::std::optional<at::Tensor> & bias={}, at::IntArrayRef stride=1, at::IntArrayRef padding=0, at::IntArrayRef dilation=1, int64_t groups=1) {
        |                          ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:594,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/conv3d.h:48:19: note: candidate: ‘at::Tensor at::conv3d(const at::Tensor&, const at::Tensor&, const std::optional<at::Tensor>&, at::IntArrayRef, c10::string_view, at::IntArrayRef, int64_t)’
     48 | inline at::Tensor conv3d(const at::Tensor & input, const at::Tensor & weight, const ::std::optional<at::Tensor> & bias, at::IntArrayRef stride, c10::string_view padding, at::IntArrayRef dilation=1, int64_t groups=1) {
        |                   ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/conv3d.h:48:45: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     48 | inline at::Tensor conv3d(const at::Tensor & input, const at::Tensor & weight, const ::std::optional<at::Tensor> & bias, at::IntArrayRef stride, c10::string_view padding, at::IntArrayRef dilation=1, int64_t groups=1) {
        |                          ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h: In function ‘void torch::nn::functional::detail::conv3d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<3>, const padding_t&, torch::ExpandingArray<3>, int64_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:124:20: error: no matching function for call to ‘visit(torch::nn::functional::detail::conv3d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<3>, const padding_t&, torch::ExpandingArray<3>, int64_t)::<lambda(const auto:48&)>, const padding_t&)’
    124 |   return std::visit(
        |          ~~~~~~~~~~^
    125 |       [&](const auto& pad) {
        |       ~~~~~~~~~~~~~~~~~~~~~~
    126 |         return torch::conv3d(
        |         ~~~~~~~~~~~~~~~~~~~~~
    127 |             input, weight, bias, stride, padding_unwrap(pad), dilation, groups);
        |             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    128 |       },
        |       ~~
    129 |       padding);
        |       ~~~~~~~~
  In file included from /workspace/nunchaku/src/common.h:18,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/variant:1734:5: note: candidate: ‘template<class _Visitor, class ... _Variants> constexpr std::__detail::__variant::__visit_result_t<_Visitor, _Variants ...> std::visit(_Visitor&&, _Variants&& ...)’
   1734 |     visit(_Visitor&& __visitor, _Variants&&... __variants)
        |     ^~~~~
  /usr/include/c++/11/variant:1734:5: note:   substitution of deduced template arguments resulted in errors seen above
  /usr/include/c++/11/variant:1774:5: note: candidate: ‘template<class _Res, class _Visitor, class ... _Variants> constexpr _Res std::visit(_Visitor&&, _Variants&& ...)’
   1774 |     visit(_Visitor&& __visitor, _Variants&&... __variants)
        |     ^~~~~
  /usr/include/c++/11/variant:1774:5: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:124:20: note:   couldn’t deduce template parameter ‘_Res’
    124 |   return std::visit(
        |          ~~~~~~~~~~^
    125 |       [&](const auto& pad) {
        |       ~~~~~~~~~~~~~~~~~~~~~~
    126 |         return torch::conv3d(
        |         ~~~~~~~~~~~~~~~~~~~~~
    127 |             input, weight, bias, stride, padding_unwrap(pad), dilation, groups);
        |             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    128 |       },
        |       ~~
    129 |       padding);
        |       ~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:149:42: error: return type ‘class torch::Tensor’ is incomplete
    149 |     const Conv3dFuncOptions& options = {}) {
        |                                          ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:172:25: error: return type ‘class torch::Tensor’ is incomplete
    172 |     IntArrayRef dilation) {
        |                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h: In function ‘void torch::nn::functional::detail::conv_transpose1d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, c10::IntArrayRef, c10::IntArrayRef, c10::IntArrayRef, int64_t, c10::IntArrayRef)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:174:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    174 |       input, weight, bias, stride, padding, output_padding, groups, dilation);
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:598,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/conv_transpose1d.h:26:55: note: in passing argument 1 of ‘at::Tensor at::conv_transpose1d(const at::Tensor&, const at::Tensor&, const std::optional<at::Tensor>&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, int64_t, at::IntArrayRef)’
     26 | inline at::Tensor conv_transpose1d(const at::Tensor & input, const at::Tensor & weight, const ::std::optional<at::Tensor> & bias={}, at::IntArrayRef stride=1, at::IntArrayRef padding=0, at::IntArrayRef output_padding=0, int64_t groups=1, at::IntArrayRef dilation=1) {
        |                                    ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:195:51: error: return type ‘class torch::Tensor’ is incomplete
    195 |     const ConvTranspose1dFuncOptions& options = {}) {
        |                                                   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:217:25: error: return type ‘class torch::Tensor’ is incomplete
    217 |     IntArrayRef dilation) {
        |                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h: In function ‘void torch::nn::functional::detail::conv_transpose2d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, c10::IntArrayRef, c10::IntArrayRef, c10::IntArrayRef, int64_t, c10::IntArrayRef)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:219:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    219 |       input, weight, bias, stride, padding, output_padding, groups, dilation);
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:599,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/conv_transpose2d.h:26:55: note: in passing argument 1 of ‘at::Tensor at::conv_transpose2d(const at::Tensor&, const at::Tensor&, const std::optional<at::Tensor>&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, int64_t, at::IntArrayRef)’
     26 | inline at::Tensor conv_transpose2d(const at::Tensor & input, const at::Tensor & weight, const ::std::optional<at::Tensor> & bias={}, at::IntArrayRef stride=1, at::IntArrayRef padding=0, at::IntArrayRef output_padding=0, int64_t groups=1, at::IntArrayRef dilation=1) {
        |                                    ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:240:51: error: return type ‘class torch::Tensor’ is incomplete
    240 |     const ConvTranspose2dFuncOptions& options = {}) {
        |                                                   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:262:25: error: return type ‘class torch::Tensor’ is incomplete
    262 |     IntArrayRef dilation) {
        |                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h: In function ‘void torch::nn::functional::detail::conv_transpose3d(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, c10::IntArrayRef, c10::IntArrayRef, c10::IntArrayRef, int64_t, c10::IntArrayRef)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:264:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    264 |       input, weight, bias, stride, padding, output_padding, groups, dilation);
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:600,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/conv_transpose3d.h:26:55: note: in passing argument 1 of ‘at::Tensor at::conv_transpose3d(const at::Tensor&, const at::Tensor&, const std::optional<at::Tensor>&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, int64_t, at::IntArrayRef)’
     26 | inline at::Tensor conv_transpose3d(const at::Tensor & input, const at::Tensor & weight, const ::std::optional<at::Tensor> & bias={}, at::IntArrayRef stride=1, at::IntArrayRef padding=0, at::IntArrayRef output_padding=0, int64_t groups=1, at::IntArrayRef dilation=1) {
        |                                    ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/conv.h:285:51: error: return type ‘class torch::Tensor’ is incomplete
    285 |     const ConvTranspose3dFuncOptions& options = {}) {
        |                                                   ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/distance.h:13:15: error: return type ‘class torch::Tensor’ is incomplete
     13 |     double eps) {
        |               ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/distance.h: In function ‘void torch::nn::functional::detail::cosine_similarity(const torch::Tensor&, const torch::Tensor&, int64_t, double)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/distance.h:14:35: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     14 |   return torch::cosine_similarity(x1, x2, dim, eps);
        |                                   ^~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:612,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cosine_similarity.h:26:56: note: in passing argument 1 of ‘at::Tensor at::cosine_similarity(const at::Tensor&, const at::Tensor&, int64_t, double)’
     26 | inline at::Tensor cosine_similarity(const at::Tensor & x1, const at::Tensor & x2, int64_t dim=1, double eps=1e-08) {
        |                                     ~~~~~~~~~~~~~~~~~~~^~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/distance.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/distance.h:36:52: error: return type ‘class torch::Tensor’ is incomplete
     36 |     const CosineSimilarityFuncOptions& options = {}) {
        |                                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/distance.h:49:17: error: return type ‘class torch::Tensor’ is incomplete
     49 |     bool keepdim) {
        |                 ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/distance.h: In function ‘void torch::nn::functional::detail::pairwise_distance(const torch::Tensor&, const torch::Tensor&, double, double, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/distance.h:50:35: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     50 |   return torch::pairwise_distance(x1, x2, p, eps, keepdim);
        |                                   ^~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1060,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/pairwise_distance.h:26:56: note: in passing argument 1 of ‘at::Tensor at::pairwise_distance(const at::Tensor&, const at::Tensor&, double, double, bool)’
     26 | inline at::Tensor pairwise_distance(const at::Tensor & x1, const at::Tensor & x2, double p=2, double eps=1e-06, bool keepdim=false) {
        |                                     ~~~~~~~~~~~~~~~~~~~^~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/distance.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/distance.h:71:52: error: return type ‘class torch::Tensor’ is incomplete
     71 |     const PairwiseDistanceFuncOptions& options = {}) {
        |                                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/distance.h:80:56: error: return type ‘class torch::Tensor’ is incomplete
     80 | inline Tensor pdist(const Tensor& input, double p = 2.0) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/distance.h: In function ‘void torch::nn::functional::pdist(const torch::Tensor&, double)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/distance.h:81:23: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     81 |   return torch::pdist(input, p);
        |                       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1061,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/pdist.h:26:44: note: in passing argument 1 of ‘at::Tensor at::pdist(const at::Tensor&, double)’
     26 | inline at::Tensor pdist(const at::Tensor & self, double p=2) {
        |                         ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:12:30: error: ‘input’ has incomplete type
     12 | inline Tensor dropout(Tensor input, double p, bool training, bool inplace) {
        |                       ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:12:74: error: return type ‘class torch::Tensor’ is incomplete
     12 | inline Tensor dropout(Tensor input, double p, bool training, bool inplace) {
        |                                                                          ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:39:30: error: ‘input’ has incomplete type
     39 | inline Tensor dropout(Tensor input, const DropoutFuncOptions& options = {}) {
        |                       ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:39:75: error: return type ‘class torch::Tensor’ is incomplete
     39 | inline Tensor dropout(Tensor input, const DropoutFuncOptions& options = {}) {
        |                                                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:51:12: error: ‘input’ has incomplete type
     51 |     Tensor input,
        |     ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:55:24: error: return type ‘class torch::Tensor’ is incomplete
     55 |     const char* fn_name) {
        |                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h: In function ‘void torch::nn::functional::detail::_dropoutNd_helper(torch::Tensor, double, bool, bool, const char*)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:71:10: error: ‘result’ has incomplete type
     71 |   Tensor result;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:71:10: error: ‘result’ has incomplete type
     71 |   Tensor result;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:88:32: error: ‘input’ has incomplete type
     88 | inline Tensor dropout2d(Tensor input, double p, bool training, bool inplace) {
        |                         ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:88:76: error: return type ‘class torch::Tensor’ is incomplete
     88 | inline Tensor dropout2d(Tensor input, double p, bool training, bool inplace) {
        |                                                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:109:12: error: ‘input’ has incomplete type
    109 |     Tensor input,
        |     ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:110:45: error: return type ‘class torch::Tensor’ is incomplete
    110 |     const Dropout2dFuncOptions& options = {}) {
        |                                             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:120:32: error: ‘input’ has incomplete type
    120 | inline Tensor dropout3d(Tensor input, double p, bool training, bool inplace) {
        |                         ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:120:76: error: return type ‘class torch::Tensor’ is incomplete
    120 | inline Tensor dropout3d(Tensor input, double p, bool training, bool inplace) {
        |                                                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:141:12: error: ‘input’ has incomplete type
    141 |     Tensor input,
        |     ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:142:45: error: return type ‘class torch::Tensor’ is incomplete
    142 |     const Dropout3dFuncOptions& options = {}) {
        |                                             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:153:12: error: ‘input’ has incomplete type
    153 |     Tensor input,
        |     ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:156:17: error: return type ‘class torch::Tensor’ is incomplete
    156 |     bool inplace) {
        |                 ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:182:12: error: ‘input’ has incomplete type
    182 |     Tensor input,
        |     ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:183:48: error: return type ‘class torch::Tensor’ is incomplete
    183 |     const AlphaDropoutFuncOptions& options = {}) {
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:194:12: error: ‘input’ has incomplete type
    194 |     Tensor input,
        |     ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:197:17: error: return type ‘class torch::Tensor’ is incomplete
    197 |     bool inplace) {
        |                 ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:224:12: error: ‘input’ has incomplete type
    224 |     Tensor input,
        |     ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/dropout.h:225:55: error: return type ‘class torch::Tensor’ is incomplete
    225 |     const FeatureAlphaDropoutFuncOptions& options = {}) {
        |                                                       ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/embedding.h:43:28: error: field ‘_weight_’ has incomplete type ‘torch::Tensor’
     43 |   TORCH_ARG(torch::Tensor, _weight) = Tensor();
        |                            ^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/embedding.h:139:28: error: field ‘_weight_’ has incomplete type ‘torch::Tensor’
    139 |   TORCH_ARG(torch::Tensor, _weight) = Tensor();
        |                            ^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/embedding.h:204:28: error: field ‘offsets_’ has incomplete type ‘torch::Tensor’
    204 |   TORCH_ARG(torch::Tensor, offsets) = Tensor();
        |                            ^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/embedding.h:226:28: error: field ‘per_sample_weights_’ has incomplete type ‘torch::Tensor’
    226 |   TORCH_ARG(torch::Tensor, per_sample_weights) = Tensor();
        |                            ^~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:7:69: error: return type ‘class torch::Tensor’ is incomplete
      7 | inline Tensor one_hot(const Tensor& tensor, int64_t num_classes = -1) {
        |                                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h: In function ‘void torch::nn::functional::one_hot(const torch::Tensor&, int64_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:8:25: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
      8 |   return torch::one_hot(tensor, num_classes);
        |                         ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1050,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/one_hot.h:26:46: note: in passing argument 1 of ‘at::Tensor at::one_hot(const at::Tensor&, int64_t)’
     26 | inline at::Tensor one_hot(const at::Tensor & self, int64_t num_classes=-1) {
        |                           ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:14:12: error: ‘weight’ has incomplete type
     14 |     Tensor weight,
        |     ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:29:16: error: return type ‘class torch::Tensor’ is incomplete
     29 |     bool sparse) {
        |                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h: In function ‘void torch::nn::functional::detail::embedding(const torch::Tensor&, const torch::Tensor&, std::optional<long int>, std::optional<double>, double, bool, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:30:8: error: ‘torch::Tensor input_’ has incomplete type
     30 |   auto input_ = input;
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:35:26: error: invalid use of incomplete type ‘const class torch::Tensor’
     35 |           *padding_idx < weight.size(0),
        |                          ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:34:7: note: in expansion of macro ‘TORCH_CHECK’
     34 |       TORCH_CHECK(
        |       ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:39:28: error: invalid use of incomplete type ‘const class torch::Tensor’
     39 |           *padding_idx >= -weight.size(0),
        |                            ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:38:7: note: in expansion of macro ‘TORCH_CHECK’
     38 |       TORCH_CHECK(
        |       ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:41:21: error: invalid use of incomplete type ‘const class torch::Tensor’
     41 |       padding_idx = weight.size(0) + *padding_idx;
        |                     ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:74:45: error: return type ‘class torch::Tensor’ is incomplete
     74 |     const EmbeddingFuncOptions& options = {}) {
        |                                             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:98:39: error: return type ‘class torch::Tensor’ is incomplete
     98 |     std::optional<int64_t> padding_idx) {
        |                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h: In function ‘void torch::nn::functional::detail::embedding_bag(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, std::optional<double>, double, bool, torch::nn::EmbeddingBagMode, bool, const torch::Tensor&, bool, std::optional<long int>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:99:8: error: ‘torch::Tensor input_’ has incomplete type
     99 |   auto input_ = input;
        |        ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:100:8: error: ‘torch::Tensor offsets_’ has incomplete type
    100 |   auto offsets_ = offsets;
        |        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:101:8: error: ‘torch::Tensor per_sample_weights_’ has incomplete type
    101 |   auto per_sample_weights_ = per_sample_weights;
        |        ^~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:191:48: error: return type ‘class torch::Tensor’ is incomplete
    191 |     const EmbeddingBagFuncOptions& options = {}) {
        |                                                ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h:15:29: error: return type ‘class torch::Tensor’ is incomplete
     15 |     ExpandingArray<2> stride) {
        |                             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h: In function ‘void torch::nn::functional::detail::fold(const torch::Tensor&, torch::ExpandingArray<2>, torch::ExpandingArray<2>, torch::ExpandingArray<2>, torch::ExpandingArray<2>, torch::ExpandingArray<2>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h:16:7: error: invalid use of incomplete type ‘const class torch::Tensor’
     16 |   if (input.dim() == 3 || input.dim() == 2) {
        |       ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h:16:27: error: invalid use of incomplete type ‘const class torch::Tensor’
     16 |   if (input.dim() == 3 || input.dim() == 2) {
        |                           ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h:18:9: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     18 |         input, output_size, kernel_size, dilation, padding, stride);
        |         ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:580,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/col2im.h:70:45: note: in passing argument 1 of ‘at::Tensor at::col2im(const at::Tensor&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef)’
     70 | inline at::Tensor col2im(const at::Tensor & self, at::IntArrayRef output_size, at::IntArrayRef kernel_size, at::IntArrayRef dilation, at::IntArrayRef padding, at::IntArrayRef stride) {
        |                          ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h:24:9: error: invalid use of incomplete type ‘const class torch::Tensor’
     24 |         input.dim(),
        |         ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h:20:5: note: in expansion of macro ‘TORCH_CHECK’
     20 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h:43:71: error: return type ‘class torch::Tensor’ is incomplete
     43 | inline Tensor fold(const Tensor& input, const FoldFuncOptions& options) {
        |                                                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h:62:29: error: return type ‘class torch::Tensor’ is incomplete
     62 |     ExpandingArray<2> stride) {
        |                             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h: In function ‘void torch::nn::functional::detail::unfold(const torch::Tensor&, torch::ExpandingArray<2>, torch::ExpandingArray<2>, torch::ExpandingArray<2>, torch::ExpandingArray<2>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h:63:7: error: invalid use of incomplete type ‘const class torch::Tensor’
     63 |   if (input.dim() == 4) {
        |       ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h:64:26: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     64 |     return torch::im2col(input, kernel_size, dilation, padding, stride);
        |                          ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:799,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/im2col.h:35:45: note: in passing argument 1 of ‘at::Tensor at::im2col(const at::Tensor&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef)’
     35 | inline at::Tensor im2col(const at::Tensor & self, at::IntArrayRef kernel_size, at::IntArrayRef dilation, at::IntArrayRef padding, at::IntArrayRef stride) {
        |                          ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h:70:9: error: invalid use of incomplete type ‘const class torch::Tensor’
     70 |         input.dim(),
        |         ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h:66:5: note: in expansion of macro ‘TORCH_CHECK’
     66 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/fold.h:89:75: error: return type ‘class torch::Tensor’ is incomplete
     89 | inline Tensor unfold(const Tensor& input, const UnfoldFuncOptions& options) {
        |                                                                           ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/instancenorm.h:70:21: error: field ‘running_mean_’ has incomplete type ‘torch::Tensor’
     70 |   TORCH_ARG(Tensor, running_mean) = Tensor();
        |                     ^~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/instancenorm.h:72:21: error: field ‘running_var_’ has incomplete type ‘torch::Tensor’
     72 |   TORCH_ARG(Tensor, running_var) = Tensor();
        |                     ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/instancenorm.h:74:21: error: field ‘weight_’ has incomplete type ‘torch::Tensor’
     74 |   TORCH_ARG(Tensor, weight) = Tensor();
        |                     ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/instancenorm.h:76:21: error: field ‘bias_’ has incomplete type ‘torch::Tensor’
     76 |   TORCH_ARG(Tensor, bias) = Tensor();
        |                     ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/instancenorm.h:17:15: error: return type ‘class torch::Tensor’ is incomplete
     17 |     double eps) {
        |               ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/instancenorm.h: In function ‘void torch::nn::functional::detail::instance_norm(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, bool, double, double)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/instancenorm.h:19:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     19 |       input,
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:813,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/instance_norm.h:26:52: note: in passing argument 1 of ‘at::Tensor at::instance_norm(const at::Tensor&, const std::optional<at::Tensor>&, const std::optional<at::Tensor>&, const std::optional<at::Tensor>&, const std::optional<at::Tensor>&, bool, double, double, bool)’
     26 | inline at::Tensor instance_norm(const at::Tensor & input, const ::std::optional<at::Tensor> & weight, const ::std::optional<at::Tensor> & bias, const ::std::optional<at::Tensor> & running_mean, const ::std::optional<at::Tensor> & running_var, bool use_input_stats, double momentum, double eps, bool cudnn_enabled) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/instancenorm.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/instancenorm.h:47:48: error: return type ‘class torch::Tensor’ is incomplete
     47 |     const InstanceNormFuncOptions& options = {}) {
        |                                                ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/linear.h:11:33: error: invalid use of incomplete type ‘class torch::Tensor’
     11 |     const Tensor& bias = Tensor()) {
        |                                 ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/linear.h:11:34: error: return type ‘class torch::Tensor’ is incomplete
     11 |     const Tensor& bias = Tensor()) {
        |                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/linear.h: In function ‘void torch::nn::functional::bilinear(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/linear.h:12:26: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     12 |   return torch::bilinear(input1, input2, weight, bias);
        |                          ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:539,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/bilinear.h:26:47: note: in passing argument 1 of ‘at::Tensor at::bilinear(const at::Tensor&, const at::Tensor&, const at::Tensor&, const std::optional<at::Tensor>&)’
     26 | inline at::Tensor bilinear(const at::Tensor & input1, const at::Tensor & input2, const at::Tensor & weight, const ::std::optional<at::Tensor> & bias={}) {
        |                            ~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/linear.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/linear.h:20:28: error: invalid use of incomplete type ‘const class torch::Tensor’
     20 |     const Tensor& bias = {}) {
        |                            ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/linear.h:20:28: error: return type ‘class torch::Tensor’ is incomplete
     20 |     const Tensor& bias = {}) {
        |                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/linear.h: In function ‘void torch::nn::functional::linear(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/linear.h:21:7: error: invalid use of incomplete type ‘const class torch::Tensor’
     21 |   if (input.dim() == 2 && bias.defined()) {
        |       ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/linear.h:21:27: error: invalid use of incomplete type ‘const class torch::Tensor’
     21 |   if (input.dim() == 2 && bias.defined()) {
        |                           ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/linear.h:23:38: error: invalid use of incomplete type ‘const class torch::Tensor’
     23 |     return torch::addmm(bias, input, weight.t());
        |                                      ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/linear.h:25:19: error: invalid use of incomplete type ‘const class torch::Tensor’
     25 |     auto output = input.matmul(weight.t());
        |                   ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/linear.h:25:32: error: invalid use of incomplete type ‘const class torch::Tensor’
     25 |     auto output = input.matmul(weight.t());
        |                                ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/linear.h:26:9: error: invalid use of incomplete type ‘const class torch::Tensor’
     26 |     if (bias.defined()) {
        |         ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/activation.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/activation.h:671:21: error: field ‘in_proj_weight_’ has incomplete type ‘torch::Tensor’
    671 |   TORCH_ARG(Tensor, in_proj_weight);
        |                     ^~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/activation.h:673:21: error: field ‘in_proj_bias_’ has incomplete type ‘torch::Tensor’
    673 |   TORCH_ARG(Tensor, in_proj_bias);
        |                     ^~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/activation.h:675:21: error: field ‘bias_k_’ has incomplete type ‘torch::Tensor’
    675 |   TORCH_ARG(Tensor, bias_k);
        |                     ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/activation.h:677:21: error: field ‘bias_v_’ has incomplete type ‘torch::Tensor’
    677 |   TORCH_ARG(Tensor, bias_v);
        |                     ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/activation.h:683:21: error: field ‘out_proj_weight_’ has incomplete type ‘torch::Tensor’
    683 |   TORCH_ARG(Tensor, out_proj_weight);
        |                     ^~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/activation.h:685:21: error: field ‘out_proj_bias_’ has incomplete type ‘torch::Tensor’
    685 |   TORCH_ARG(Tensor, out_proj_bias);
        |                     ^~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/activation.h:689:21: error: field ‘key_padding_mask_’ has incomplete type ‘torch::Tensor’
    689 |   TORCH_ARG(Tensor, key_padding_mask) = {};
        |                     ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/activation.h:693:21: error: field ‘attn_mask_’ has incomplete type ‘torch::Tensor’
    693 |   TORCH_ARG(Tensor, attn_mask) = {};
        |                     ^~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/activation.h:697:21: error: field ‘q_proj_weight_’ has incomplete type ‘torch::Tensor’
    697 |   TORCH_ARG(Tensor, q_proj_weight) = {};
        |                     ^~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/activation.h:699:21: error: field ‘k_proj_weight_’ has incomplete type ‘torch::Tensor’
    699 |   TORCH_ARG(Tensor, k_proj_weight) = {};
        |                     ^~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/activation.h:701:21: error: field ‘v_proj_weight_’ has incomplete type ‘torch::Tensor’
    701 |   TORCH_ARG(Tensor, v_proj_weight) = {};
        |                     ^~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/activation.h:703:21: error: field ‘static_k_’ has incomplete type ‘torch::Tensor’
    703 |   TORCH_ARG(Tensor, static_k) = {};
        |                     ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/activation.h:705:21: error: field ‘static_v_’ has incomplete type ‘torch::Tensor’
    705 |   TORCH_ARG(Tensor, static_v) = {};
        |                     ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:17:26: error: ‘input’ has incomplete type
     17 | inline Tensor elu(Tensor input, double alpha, bool inplace) {
        |                   ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:17:59: error: return type ‘class torch::Tensor’ is incomplete
     17 | inline Tensor elu(Tensor input, double alpha, bool inplace) {
        |                                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:39:26: error: ‘input’ has incomplete type
     39 | inline Tensor elu(Tensor input, const ELUFuncOptions& options = {}) {
        |                   ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:39:67: error: return type ‘class torch::Tensor’ is incomplete
     39 | inline Tensor elu(Tensor input, const ELUFuncOptions& options = {}) {
        |                                                                   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:47:27: error: ‘input’ has incomplete type
     47 | inline Tensor selu(Tensor input, bool inplace) {
        |                    ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:47:46: error: return type ‘class torch::Tensor’ is incomplete
     47 | inline Tensor selu(Tensor input, bool inplace) {
        |                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:69:27: error: ‘input’ has incomplete type
     69 | inline Tensor selu(Tensor input, const SELUFuncOptions& options = {}) {
        |                    ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:69:69: error: return type ‘class torch::Tensor’ is incomplete
     69 | inline Tensor selu(Tensor input, const SELUFuncOptions& options = {}) {
        |                                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:77:60: error: return type ‘class torch::Tensor’ is incomplete
     77 | inline Tensor hardshrink(const Tensor& input, double lambda) {
        |                                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In function ‘void torch::nn::functional::detail::hardshrink(const torch::Tensor&, double)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:78:28: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     78 |   return torch::hardshrink(input, lambda);
        |                            ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:777,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/hardshrink.h:35:49: note: in passing argument 1 of ‘at::Tensor at::hardshrink(const at::Tensor&, const c10::Scalar&)’
     35 | inline at::Tensor hardshrink(const at::Tensor & self, const at::Scalar & lambd=0.5) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:97:46: error: return type ‘class torch::Tensor’ is incomplete
     97 |     const HardshrinkFuncOptions& options = {}) {
        |                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:106:12: error: ‘input’ has incomplete type
    106 |     Tensor input,
        |     ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:109:17: error: return type ‘class torch::Tensor’ is incomplete
    109 |     bool inplace) {
        |                 ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:132:31: error: ‘input’ has incomplete type
    132 | inline Tensor hardtanh(Tensor input, const HardtanhFuncOptions& options = {}) {
        |                        ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:132:77: error: return type ‘class torch::Tensor’ is incomplete
    132 | inline Tensor hardtanh(Tensor input, const HardtanhFuncOptions& options = {}) {
        |                                                                             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:144:33: error: ‘input’ has incomplete type
    144 | inline Tensor leaky_relu(Tensor input, double negative_slope, bool inplace) {
        |                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:144:75: error: return type ‘class torch::Tensor’ is incomplete
    144 | inline Tensor leaky_relu(Tensor input, double negative_slope, bool inplace) {
        |                                                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:168:12: error: ‘input’ has incomplete type
    168 |     Tensor input,
        |     ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:169:45: error: return type ‘class torch::Tensor’ is incomplete
    169 |     const LeakyReLUFuncOptions& options = {}) {
        |                                             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:176:45: error: return type ‘class torch::Tensor’ is incomplete
    176 | inline Tensor logsigmoid(const Tensor& input) {
        |                                             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In function ‘void torch::nn::functional::logsigmoid(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:177:29: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    177 |   return torch::log_sigmoid(input);
        |                             ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:907,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/log_sigmoid.h:35:50: note: in passing argument 1 of ‘at::Tensor at::log_sigmoid(const at::Tensor&)’
     35 | inline at::Tensor log_sigmoid(const at::Tensor & self) {
        |                               ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:188:12: error: return type ‘class torch::Tensor’ is incomplete
    188 |     int dim) {
        |            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In function ‘void torch::nn::functional::detail::gumbel_softmax(const torch::Tensor&, double, bool, int)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:190:26: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    190 |       -torch::empty_like(logits).exponential_().log(); // ~Gumbel(0,1)
        |                          ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/generated/variable_factories.h:304:49: note: in passing argument 1 of ‘at::Tensor torch::empty_like(const at::Tensor&, c10::TensorOptions, std::optional<c10::MemoryFormat>)’
    304 | inline at::Tensor empty_like(const at::Tensor & self, at::TensorOptions options = {}, ::std::optional<at::MemoryFormat> memory_format = ::std::nullopt) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:194:17: error: aggregate ‘torch::Tensor ret’ has incomplete type and cannot be defined
    194 |   torch::Tensor ret;
        |                 ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:198:37: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    198 |     auto y_hard = torch::zeros_like(logits).scatter_(dim, index, 1.0);
        |                                     ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/generated/variable_factories.h:604:49: note: in passing argument 1 of ‘at::Tensor torch::zeros_like(const at::Tensor&, c10::TensorOptions, std::optional<c10::MemoryFormat>)’
    604 | inline at::Tensor zeros_like(const at::Tensor & self, at::TensorOptions options = {}, ::std::optional<at::MemoryFormat> memory_format = ::std::nullopt) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:222:49: error: return type ‘class torch::Tensor’ is incomplete
    222 |     const GumbelSoftmaxFuncOptions& options = {}) {
        |                                                 ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:234:38: error: return type ‘class torch::Tensor’ is incomplete
    234 |     std::optional<torch::Dtype> dtype) {
        |                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In function ‘void torch::nn::functional::detail::softmax(const torch::Tensor&, int64_t, std::optional<c10::ScalarType>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:235:10: error: aggregate ‘torch::Tensor ret’ has incomplete type and cannot be defined
    235 |   Tensor ret;
        |          ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:238:11: error: invalid use of incomplete type ‘const class torch::Tensor’
    238 |     ret = input.softmax(dim);
        |           ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:240:11: error: invalid use of incomplete type ‘const class torch::Tensor’
    240 |     ret = input.softmax(dim, dtype);
        |           ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:260:77: error: return type ‘class torch::Tensor’ is incomplete
    260 | inline Tensor softmax(const Tensor& input, const SoftmaxFuncOptions& options) {
        |                                                                             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:271:38: error: return type ‘class torch::Tensor’ is incomplete
    271 |     std::optional<torch::Dtype> dtype) {
        |                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In function ‘void torch::nn::functional::detail::softmin(const torch::Tensor&, int64_t, std::optional<c10::ScalarType>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:272:10: error: aggregate ‘torch::Tensor ret’ has incomplete type and cannot be defined
    272 |   Tensor ret;
        |          ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:275:12: error: no match for ‘operator-’ (operand type is ‘const torch::Tensor’)
    275 |     ret = (-input).softmax(dim);
        |            ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:358:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const c10::complex<U>&)’
    358 | constexpr complex<T> operator-(const complex<T>& val) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:358:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:275:13: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    275 |     ret = (-input).softmax(dim);
        |             ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:380:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const c10::complex<U>&, const c10::complex<U>&)’
    380 | constexpr complex<T> operator-(const complex<T>& lhs, const complex<T>& rhs) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:380:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:275:13: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    275 |     ret = (-input).softmax(dim);
        |             ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:386:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const c10::complex<U>&, const T&)’
    386 | constexpr complex<T> operator-(const complex<T>& lhs, const T& rhs) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:386:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:275:13: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    275 |     ret = (-input).softmax(dim);
        |             ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:392:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const T&, const c10::complex<U>&)’
    392 | constexpr complex<T> operator-(const T& lhs, const complex<T>& rhs) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:392:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:275:13: note:   candidate expects 2 arguments, 1 provided
    275 |     ret = (-input).softmax(dim);
        |             ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:453:28: note: candidate: ‘template<class fT, class iT, typename std::enable_if<(is_floating_point_v<fT> && is_integral_v<iT>), int>::type <anonymous> > constexpr c10::complex<U> c10::operator-(const c10::complex<U>&, const iT&)’
    453 | constexpr c10::complex<fT> operator-(const c10::complex<fT>& a, const iT& b) {
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:453:28: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:275:13: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    275 |     ret = (-input).softmax(dim);
        |             ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:458:28: note: candidate: ‘template<class fT, class iT, typename std::enable_if<(is_floating_point_v<fT> && is_integral_v<iT>), int>::type <anonymous> > constexpr c10::complex<U> c10::operator-(const iT&, const c10::complex<U>&)’
    458 | constexpr c10::complex<fT> operator-(const iT& a, const c10::complex<fT>& b) {
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:458:28: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:275:13: note:   candidate expects 2 arguments, 1 provided
    275 |     ret = (-input).softmax(dim);
        |             ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16.h:130,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:91:1: note: candidate: ‘c10::BFloat16 c10::operator-(const c10::BFloat16&, const c10::BFloat16&)’
     91 | operator-(const BFloat16& a, const BFloat16& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:91:1: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:105:33: note: candidate: ‘c10::BFloat16 c10::operator-(const c10::BFloat16&)’
    105 | inline C10_HOST_DEVICE BFloat16 operator-(const BFloat16& a) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:105:59: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::BFloat16&’
    105 | inline C10_HOST_DEVICE BFloat16 operator-(const BFloat16& a) {
        |                                           ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:149:30: note: candidate: ‘float c10::operator-(c10::BFloat16, float)’
    149 | inline C10_HOST_DEVICE float operator-(BFloat16 a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:149:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:162:30: note: candidate: ‘float c10::operator-(float, c10::BFloat16)’
    162 | inline C10_HOST_DEVICE float operator-(float a, BFloat16 b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:162:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:190:31: note: candidate: ‘double c10::operator-(c10::BFloat16, double)’
    190 | inline C10_HOST_DEVICE double operator-(BFloat16 a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:190:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:203:31: note: candidate: ‘double c10::operator-(double, c10::BFloat16)’
    203 | inline C10_HOST_DEVICE double operator-(double a, BFloat16 b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:203:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:218:33: note: candidate: ‘c10::BFloat16 c10::operator-(c10::BFloat16, int)’
    218 | inline C10_HOST_DEVICE BFloat16 operator-(BFloat16 a, int b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:218:33: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:231:33: note: candidate: ‘c10::BFloat16 c10::operator-(int, c10::BFloat16)’
    231 | inline C10_HOST_DEVICE BFloat16 operator-(int a, BFloat16 b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:231:33: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:246:33: note: candidate: ‘c10::BFloat16 c10::operator-(c10::BFloat16, int64_t)’
    246 | inline C10_HOST_DEVICE BFloat16 operator-(BFloat16 a, int64_t b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:246:33: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:259:33: note: candidate: ‘c10::BFloat16 c10::operator-(int64_t, c10::BFloat16)’
    259 | inline C10_HOST_DEVICE BFloat16 operator-(int64_t a, BFloat16 b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:259:33: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn.h:240,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:39:1: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(const c10::Float8_e4m3fn&, const c10::Float8_e4m3fn&)’
     39 | operator-(const Float8_e4m3fn& a, const Float8_e4m3fn& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:39:1: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:54:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(const c10::Float8_e4m3fn&)’
     54 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(const Float8_e4m3fn& a) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:54:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Float8_e4m3fn&’
     54 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(const Float8_e4m3fn& a) {
        |                                                ~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:91:30: note: candidate: ‘float c10::operator-(c10::Float8_e4m3fn, float)’
     91 | inline C10_HOST_DEVICE float operator-(Float8_e4m3fn a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:91:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:105:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e4m3fn)’
    105 | inline C10_HOST_DEVICE float operator-(float a, Float8_e4m3fn b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:105:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:134:31: note: candidate: ‘double c10::operator-(c10::Float8_e4m3fn, double)’
    134 | inline C10_HOST_DEVICE double operator-(Float8_e4m3fn a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:134:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:148:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e4m3fn)’
    148 | inline C10_HOST_DEVICE double operator-(double a, Float8_e4m3fn b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:148:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:164:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(c10::Float8_e4m3fn, int)’
    164 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(Float8_e4m3fn a, int b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:164:38: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:177:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(int, c10::Float8_e4m3fn)’
    177 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(int a, Float8_e4m3fn b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:177:38: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:192:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(c10::Float8_e4m3fn, int64_t)’
    192 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(Float8_e4m3fn a, int64_t b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:192:38: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:205:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(int64_t, c10::Float8_e4m3fn)’
    205 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(int64_t a, Float8_e4m3fn b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:205:38: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz.h:139,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:40:1: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(const c10::Float8_e4m3fnuz&, const c10::Float8_e4m3fnuz&)’
     40 | operator-(const Float8_e4m3fnuz& a, const Float8_e4m3fnuz& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:40:1: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:55:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(const c10::Float8_e4m3fnuz&)’
     55 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(const Float8_e4m3fnuz& a) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:55:73: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Float8_e4m3fnuz&’
     55 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(const Float8_e4m3fnuz& a) {
        |                                                  ~~~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:92:30: note: candidate: ‘float c10::operator-(c10::Float8_e4m3fnuz, float)’
     92 | inline C10_HOST_DEVICE float operator-(Float8_e4m3fnuz a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:92:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:106:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e4m3fnuz)’
    106 | inline C10_HOST_DEVICE float operator-(float a, Float8_e4m3fnuz b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:106:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:135:31: note: candidate: ‘double c10::operator-(c10::Float8_e4m3fnuz, double)’
    135 | inline C10_HOST_DEVICE double operator-(Float8_e4m3fnuz a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:135:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:149:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e4m3fnuz)’
    149 | inline C10_HOST_DEVICE double operator-(double a, Float8_e4m3fnuz b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:149:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:165:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(c10::Float8_e4m3fnuz, int)’
    165 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(Float8_e4m3fnuz a, int b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:165:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:178:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(int, c10::Float8_e4m3fnuz)’
    178 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(int a, Float8_e4m3fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:178:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:193:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(c10::Float8_e4m3fnuz, int64_t)’
    193 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(Float8_e4m3fnuz a, int64_t b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:193:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:206:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(int64_t, c10::Float8_e4m3fnuz)’
    206 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(int64_t a, Float8_e4m3fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:206:40: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half.h:423,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:111:29: note: candidate: ‘c10::Half c10::operator-(const c10::Half&, const c10::Half&)’
    111 | inline C10_HOST_DEVICE Half operator-(const Half& a, const Half& b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:111:29: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:124:29: note: candidate: ‘c10::Half c10::operator-(const c10::Half&)’
    124 | inline C10_HOST_DEVICE Half operator-(const Half& a) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:124:51: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Half&’
    124 | inline C10_HOST_DEVICE Half operator-(const Half& a) {
        |                                       ~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:160:30: note: candidate: ‘float c10::operator-(c10::Half, float)’
    160 | inline C10_HOST_DEVICE float operator-(Half a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:160:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:174:30: note: candidate: ‘float c10::operator-(float, c10::Half)’
    174 | inline C10_HOST_DEVICE float operator-(float a, Half b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:174:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:203:31: note: candidate: ‘double c10::operator-(c10::Half, double)’
    203 | inline C10_HOST_DEVICE double operator-(Half a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:203:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:217:31: note: candidate: ‘double c10::operator-(double, c10::Half)’
    217 | inline C10_HOST_DEVICE double operator-(double a, Half b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:217:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:233:29: note: candidate: ‘c10::Half c10::operator-(c10::Half, int)’
    233 | inline C10_HOST_DEVICE Half operator-(Half a, int b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:233:29: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:246:29: note: candidate: ‘c10::Half c10::operator-(int, c10::Half)’
    246 | inline C10_HOST_DEVICE Half operator-(int a, Half b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:246:29: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:261:29: note: candidate: ‘c10::Half c10::operator-(c10::Half, int64_t)’
    261 | inline C10_HOST_DEVICE Half operator-(Half a, int64_t b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:261:29: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:274:29: note: candidate: ‘c10::Half c10::operator-(int64_t, c10::Half)’
    274 | inline C10_HOST_DEVICE Half operator-(int64_t a, Half b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:274:29: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2.h:148,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:47:1: note: candidate: ‘c10::Float8_e5m2 c10::operator-(const c10::Float8_e5m2&, const c10::Float8_e5m2&)’
     47 | operator-(const Float8_e5m2& a, const Float8_e5m2& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:47:1: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:62:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(const c10::Float8_e5m2&)’
     62 | inline C10_HOST_DEVICE Float8_e5m2 operator-(const Float8_e5m2& a) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:62:65: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Float8_e5m2&’
     62 | inline C10_HOST_DEVICE Float8_e5m2 operator-(const Float8_e5m2& a) {
        |                                              ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:99:30: note: candidate: ‘float c10::operator-(c10::Float8_e5m2, float)’
     99 | inline C10_HOST_DEVICE float operator-(Float8_e5m2 a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:99:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:113:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e5m2)’
    113 | inline C10_HOST_DEVICE float operator-(float a, Float8_e5m2 b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:113:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:142:31: note: candidate: ‘double c10::operator-(c10::Float8_e5m2, double)’
    142 | inline C10_HOST_DEVICE double operator-(Float8_e5m2 a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:142:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:156:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e5m2)’
    156 | inline C10_HOST_DEVICE double operator-(double a, Float8_e5m2 b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:156:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:172:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(c10::Float8_e5m2, int)’
    172 | inline C10_HOST_DEVICE Float8_e5m2 operator-(Float8_e5m2 a, int b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:172:36: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:185:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(int, c10::Float8_e5m2)’
    185 | inline C10_HOST_DEVICE Float8_e5m2 operator-(int a, Float8_e5m2 b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:185:36: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:200:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(c10::Float8_e5m2, int64_t)’
    200 | inline C10_HOST_DEVICE Float8_e5m2 operator-(Float8_e5m2 a, int64_t b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:200:36: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:213:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(int64_t, c10::Float8_e5m2)’
    213 | inline C10_HOST_DEVICE Float8_e5m2 operator-(int64_t a, Float8_e5m2 b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:213:36: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz.h:138,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:44:1: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(const c10::Float8_e5m2fnuz&, const c10::Float8_e5m2fnuz&)’
     44 | operator-(const Float8_e5m2fnuz& a, const Float8_e5m2fnuz& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:44:1: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:59:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(const c10::Float8_e5m2fnuz&)’
     59 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(const Float8_e5m2fnuz& a) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:59:73: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Float8_e5m2fnuz&’
     59 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(const Float8_e5m2fnuz& a) {
        |                                                  ~~~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:96:30: note: candidate: ‘float c10::operator-(c10::Float8_e5m2fnuz, float)’
     96 | inline C10_HOST_DEVICE float operator-(Float8_e5m2fnuz a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:96:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:110:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e5m2fnuz)’
    110 | inline C10_HOST_DEVICE float operator-(float a, Float8_e5m2fnuz b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:110:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:139:31: note: candidate: ‘double c10::operator-(c10::Float8_e5m2fnuz, double)’
    139 | inline C10_HOST_DEVICE double operator-(Float8_e5m2fnuz a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:139:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:153:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e5m2fnuz)’
    153 | inline C10_HOST_DEVICE double operator-(double a, Float8_e5m2fnuz b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:153:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:169:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(c10::Float8_e5m2fnuz, int)’
    169 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(Float8_e5m2fnuz a, int b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:169:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:182:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(int, c10::Float8_e5m2fnuz)’
    182 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(int a, Float8_e5m2fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:182:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:197:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(c10::Float8_e5m2fnuz, int64_t)’
    197 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(Float8_e5m2fnuz a, int64_t b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:197:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:210:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(int64_t, c10::Float8_e5m2fnuz)’
    210 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(int64_t a, Float8_e5m2fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:210:40: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, int64_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(int64_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, int32_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(int32_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, uint64_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(uint64_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, uint32_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(uint32_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymFloat c10::operator-(const c10::SymInt&, double)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymFloat c10::operator-(double, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymFloat c10::operator-(const c10::SymInt&, float)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymFloat c10::operator-(float, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:367:16: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&)’
    367 | C10_API SymInt operator-(const SymInt& s);
        |                ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:367:40: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::SymInt&’
    367 | C10_API SymInt operator-(const SymInt& s);
        |                          ~~~~~~~~~~~~~~^
  In file included from /usr/local/cuda/include/cuda_fp16.h:5293,
                   from /usr/local/cuda/include/cublas_api.h:77,
                   from /usr/local/cuda/include/cublas_v2.h:69,
                   from /workspace/nunchaku/src/common.h:23,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/local/cuda/include/cuda_fp16.hpp:222:54: note: candidate: ‘__half operator-(const __half&, const __half&)’
    222 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half operator-(const __half &lh, const __half &rh) { return __hsub(lh, rh); }
        |                                                      ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:222:54: note:   candidate expects 2 arguments, 1 provided
  /usr/local/cuda/include/cuda_fp16.hpp:254:54: note: candidate: ‘__half operator-(const __half&)’
    254 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half operator-(const __half &h) { return __hneg(h); }
        |                                                      ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:254:78: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const __half&’
    254 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half operator-(const __half &h) { return __hneg(h); }
        |                                                                ~~~~~~~~~~~~~~^
  /usr/local/cuda/include/cuda_fp16.hpp:308:55: note: candidate: ‘__half2 operator-(const __half2&, const __half2&)’
    308 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half2 operator-(const __half2 &lh, const __half2 &rh) { return __hsub2(lh, rh); }
        |                                                       ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:308:55: note:   candidate expects 2 arguments, 1 provided
  /usr/local/cuda/include/cuda_fp16.hpp:342:55: note: candidate: ‘__half2 operator-(const __half2&)’
    342 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half2 operator-(const __half2 &h) { return __hneg2(h); }
        |                                                       ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:342:80: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const __half2&’
    342 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half2 operator-(const __half2 &h) { return __hneg2(h); }
        |                                                                 ~~~~~~~~~~~~~~~^
  In file included from /usr/local/cuda/include/cuda_bf16.h:5079,
                   from /usr/local/cuda/include/cublas_api.h:78,
                   from /usr/local/cuda/include/cublas_v2.h:69,
                   from /workspace/nunchaku/src/common.h:23,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/local/cuda/include/cuda_bf16.hpp:203:61: note: candidate: ‘__nv_bfloat16 operator-(const __nv_bfloat16&, const __nv_bfloat16&)’
    203 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat16 operator-(const __nv_bfloat16 &lh, const __nv_bfloat16 &rh) { return __hsub(lh, rh); }
        |                                                             ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:203:61: note:   candidate expects 2 arguments, 1 provided
  /usr/local/cuda/include/cuda_bf16.hpp:235:61: note: candidate: ‘__nv_bfloat16 operator-(const __nv_bfloat16&)’
    235 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat16 operator-(const __nv_bfloat16 &h) { return __hneg(h); }
        |                                                             ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:235:92: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const __nv_bfloat16&’
    235 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat16 operator-(const __nv_bfloat16 &h) { return __hneg(h); }
        |                                                                       ~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/cuda/include/cuda_bf16.hpp:320:62: note: candidate: ‘__nv_bfloat162 operator-(const __nv_bfloat162&, const __nv_bfloat162&)’
    320 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat162 operator-(const __nv_bfloat162 &lh, const __nv_bfloat162 &rh) { return __hsub2(lh, rh); }
        |                                                              ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:320:62: note:   candidate expects 2 arguments, 1 provided
  /usr/local/cuda/include/cuda_bf16.hpp:354:62: note: candidate: ‘__nv_bfloat162 operator-(const __nv_bfloat162&)’
    354 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat162 operator-(const __nv_bfloat162 &h) { return __hneg2(h); }
        |                                                              ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:354:94: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const __nv_bfloat162&’
    354 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat162 operator-(const __nv_bfloat162 &h) { return __hneg2(h); }
        |                                                                        ~~~~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ATen.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:17: note: candidate: ‘at::Tensor at::operator-(const at::Tensor&, const at::Tensor&)’
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:17: note: in definition of macro ‘DEFINE_OPERATOR’
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:17: note:   candidate expects 2 arguments, 1 provided
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:17: note: in definition of macro ‘DEFINE_OPERATOR’
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:17: note: candidate: ‘at::Tensor at::operator-(const at::Tensor&, const c10::Scalar&)’
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:17: note: in definition of macro ‘DEFINE_OPERATOR’
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:17: note:   candidate expects 2 arguments, 1 provided
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:17: note: in definition of macro ‘DEFINE_OPERATOR’
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:17: note: candidate: ‘at::Tensor at::operator-(const c10::Scalar&, const at::Tensor&)’
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:17: note: in definition of macro ‘DEFINE_OPERATOR’
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:17: note:   candidate expects 2 arguments, 1 provided
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:17: note: in definition of macro ‘DEFINE_OPERATOR’
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:277:12: error: no match for ‘operator-’ (operand type is ‘const torch::Tensor’)
    277 |     ret = (-input).softmax(dim, dtype);
        |            ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:358:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const c10::complex<U>&)’
    358 | constexpr complex<T> operator-(const complex<T>& val) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:358:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:277:13: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    277 |     ret = (-input).softmax(dim, dtype);
        |             ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:380:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const c10::complex<U>&, const c10::complex<U>&)’
    380 | constexpr complex<T> operator-(const complex<T>& lhs, const complex<T>& rhs) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:380:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:277:13: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    277 |     ret = (-input).softmax(dim, dtype);
        |             ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:386:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const c10::complex<U>&, const T&)’
    386 | constexpr complex<T> operator-(const complex<T>& lhs, const T& rhs) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:386:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:277:13: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    277 |     ret = (-input).softmax(dim, dtype);
        |             ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:392:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const T&, const c10::complex<U>&)’
    392 | constexpr complex<T> operator-(const T& lhs, const complex<T>& rhs) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:392:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:277:13: note:   candidate expects 2 arguments, 1 provided
    277 |     ret = (-input).softmax(dim, dtype);
        |             ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:453:28: note: candidate: ‘template<class fT, class iT, typename std::enable_if<(is_floating_point_v<fT> && is_integral_v<iT>), int>::type <anonymous> > constexpr c10::complex<U> c10::operator-(const c10::complex<U>&, const iT&)’
    453 | constexpr c10::complex<fT> operator-(const c10::complex<fT>& a, const iT& b) {
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:453:28: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:277:13: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    277 |     ret = (-input).softmax(dim, dtype);
        |             ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:458:28: note: candidate: ‘template<class fT, class iT, typename std::enable_if<(is_floating_point_v<fT> && is_integral_v<iT>), int>::type <anonymous> > constexpr c10::complex<U> c10::operator-(const iT&, const c10::complex<U>&)’
    458 | constexpr c10::complex<fT> operator-(const iT& a, const c10::complex<fT>& b) {
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:458:28: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:277:13: note:   candidate expects 2 arguments, 1 provided
    277 |     ret = (-input).softmax(dim, dtype);
        |             ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16.h:130,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:91:1: note: candidate: ‘c10::BFloat16 c10::operator-(const c10::BFloat16&, const c10::BFloat16&)’
     91 | operator-(const BFloat16& a, const BFloat16& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:91:1: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:105:33: note: candidate: ‘c10::BFloat16 c10::operator-(const c10::BFloat16&)’
    105 | inline C10_HOST_DEVICE BFloat16 operator-(const BFloat16& a) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:105:59: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::BFloat16&’
    105 | inline C10_HOST_DEVICE BFloat16 operator-(const BFloat16& a) {
        |                                           ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:149:30: note: candidate: ‘float c10::operator-(c10::BFloat16, float)’
    149 | inline C10_HOST_DEVICE float operator-(BFloat16 a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:149:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:162:30: note: candidate: ‘float c10::operator-(float, c10::BFloat16)’
    162 | inline C10_HOST_DEVICE float operator-(float a, BFloat16 b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:162:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:190:31: note: candidate: ‘double c10::operator-(c10::BFloat16, double)’
    190 | inline C10_HOST_DEVICE double operator-(BFloat16 a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:190:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:203:31: note: candidate: ‘double c10::operator-(double, c10::BFloat16)’
    203 | inline C10_HOST_DEVICE double operator-(double a, BFloat16 b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:203:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:218:33: note: candidate: ‘c10::BFloat16 c10::operator-(c10::BFloat16, int)’
    218 | inline C10_HOST_DEVICE BFloat16 operator-(BFloat16 a, int b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:218:33: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:231:33: note: candidate: ‘c10::BFloat16 c10::operator-(int, c10::BFloat16)’
    231 | inline C10_HOST_DEVICE BFloat16 operator-(int a, BFloat16 b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:231:33: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:246:33: note: candidate: ‘c10::BFloat16 c10::operator-(c10::BFloat16, int64_t)’
    246 | inline C10_HOST_DEVICE BFloat16 operator-(BFloat16 a, int64_t b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:246:33: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:259:33: note: candidate: ‘c10::BFloat16 c10::operator-(int64_t, c10::BFloat16)’
    259 | inline C10_HOST_DEVICE BFloat16 operator-(int64_t a, BFloat16 b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:259:33: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn.h:240,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:39:1: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(const c10::Float8_e4m3fn&, const c10::Float8_e4m3fn&)’
     39 | operator-(const Float8_e4m3fn& a, const Float8_e4m3fn& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:39:1: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:54:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(const c10::Float8_e4m3fn&)’
     54 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(const Float8_e4m3fn& a) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:54:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Float8_e4m3fn&’
     54 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(const Float8_e4m3fn& a) {
        |                                                ~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:91:30: note: candidate: ‘float c10::operator-(c10::Float8_e4m3fn, float)’
     91 | inline C10_HOST_DEVICE float operator-(Float8_e4m3fn a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:91:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:105:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e4m3fn)’
    105 | inline C10_HOST_DEVICE float operator-(float a, Float8_e4m3fn b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:105:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:134:31: note: candidate: ‘double c10::operator-(c10::Float8_e4m3fn, double)’
    134 | inline C10_HOST_DEVICE double operator-(Float8_e4m3fn a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:134:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:148:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e4m3fn)’
    148 | inline C10_HOST_DEVICE double operator-(double a, Float8_e4m3fn b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:148:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:164:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(c10::Float8_e4m3fn, int)’
    164 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(Float8_e4m3fn a, int b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:164:38: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:177:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(int, c10::Float8_e4m3fn)’
    177 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(int a, Float8_e4m3fn b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:177:38: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:192:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(c10::Float8_e4m3fn, int64_t)’
    192 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(Float8_e4m3fn a, int64_t b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:192:38: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:205:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(int64_t, c10::Float8_e4m3fn)’
    205 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(int64_t a, Float8_e4m3fn b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:205:38: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz.h:139,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:40:1: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(const c10::Float8_e4m3fnuz&, const c10::Float8_e4m3fnuz&)’
     40 | operator-(const Float8_e4m3fnuz& a, const Float8_e4m3fnuz& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:40:1: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:55:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(const c10::Float8_e4m3fnuz&)’
     55 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(const Float8_e4m3fnuz& a) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:55:73: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Float8_e4m3fnuz&’
     55 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(const Float8_e4m3fnuz& a) {
        |                                                  ~~~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:92:30: note: candidate: ‘float c10::operator-(c10::Float8_e4m3fnuz, float)’
     92 | inline C10_HOST_DEVICE float operator-(Float8_e4m3fnuz a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:92:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:106:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e4m3fnuz)’
    106 | inline C10_HOST_DEVICE float operator-(float a, Float8_e4m3fnuz b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:106:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:135:31: note: candidate: ‘double c10::operator-(c10::Float8_e4m3fnuz, double)’
    135 | inline C10_HOST_DEVICE double operator-(Float8_e4m3fnuz a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:135:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:149:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e4m3fnuz)’
    149 | inline C10_HOST_DEVICE double operator-(double a, Float8_e4m3fnuz b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:149:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:165:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(c10::Float8_e4m3fnuz, int)’
    165 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(Float8_e4m3fnuz a, int b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:165:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:178:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(int, c10::Float8_e4m3fnuz)’
    178 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(int a, Float8_e4m3fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:178:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:193:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(c10::Float8_e4m3fnuz, int64_t)’
    193 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(Float8_e4m3fnuz a, int64_t b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:193:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:206:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(int64_t, c10::Float8_e4m3fnuz)’
    206 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(int64_t a, Float8_e4m3fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:206:40: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half.h:423,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:111:29: note: candidate: ‘c10::Half c10::operator-(const c10::Half&, const c10::Half&)’
    111 | inline C10_HOST_DEVICE Half operator-(const Half& a, const Half& b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:111:29: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:124:29: note: candidate: ‘c10::Half c10::operator-(const c10::Half&)’
    124 | inline C10_HOST_DEVICE Half operator-(const Half& a) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:124:51: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Half&’
    124 | inline C10_HOST_DEVICE Half operator-(const Half& a) {
        |                                       ~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:160:30: note: candidate: ‘float c10::operator-(c10::Half, float)’
    160 | inline C10_HOST_DEVICE float operator-(Half a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:160:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:174:30: note: candidate: ‘float c10::operator-(float, c10::Half)’
    174 | inline C10_HOST_DEVICE float operator-(float a, Half b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:174:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:203:31: note: candidate: ‘double c10::operator-(c10::Half, double)’
    203 | inline C10_HOST_DEVICE double operator-(Half a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:203:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:217:31: note: candidate: ‘double c10::operator-(double, c10::Half)’
    217 | inline C10_HOST_DEVICE double operator-(double a, Half b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:217:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:233:29: note: candidate: ‘c10::Half c10::operator-(c10::Half, int)’
    233 | inline C10_HOST_DEVICE Half operator-(Half a, int b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:233:29: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:246:29: note: candidate: ‘c10::Half c10::operator-(int, c10::Half)’
    246 | inline C10_HOST_DEVICE Half operator-(int a, Half b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:246:29: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:261:29: note: candidate: ‘c10::Half c10::operator-(c10::Half, int64_t)’
    261 | inline C10_HOST_DEVICE Half operator-(Half a, int64_t b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:261:29: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:274:29: note: candidate: ‘c10::Half c10::operator-(int64_t, c10::Half)’
    274 | inline C10_HOST_DEVICE Half operator-(int64_t a, Half b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:274:29: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2.h:148,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:47:1: note: candidate: ‘c10::Float8_e5m2 c10::operator-(const c10::Float8_e5m2&, const c10::Float8_e5m2&)’
     47 | operator-(const Float8_e5m2& a, const Float8_e5m2& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:47:1: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:62:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(const c10::Float8_e5m2&)’
     62 | inline C10_HOST_DEVICE Float8_e5m2 operator-(const Float8_e5m2& a) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:62:65: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Float8_e5m2&’
     62 | inline C10_HOST_DEVICE Float8_e5m2 operator-(const Float8_e5m2& a) {
        |                                              ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:99:30: note: candidate: ‘float c10::operator-(c10::Float8_e5m2, float)’
     99 | inline C10_HOST_DEVICE float operator-(Float8_e5m2 a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:99:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:113:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e5m2)’
    113 | inline C10_HOST_DEVICE float operator-(float a, Float8_e5m2 b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:113:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:142:31: note: candidate: ‘double c10::operator-(c10::Float8_e5m2, double)’
    142 | inline C10_HOST_DEVICE double operator-(Float8_e5m2 a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:142:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:156:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e5m2)’
    156 | inline C10_HOST_DEVICE double operator-(double a, Float8_e5m2 b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:156:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:172:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(c10::Float8_e5m2, int)’
    172 | inline C10_HOST_DEVICE Float8_e5m2 operator-(Float8_e5m2 a, int b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:172:36: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:185:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(int, c10::Float8_e5m2)’
    185 | inline C10_HOST_DEVICE Float8_e5m2 operator-(int a, Float8_e5m2 b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:185:36: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:200:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(c10::Float8_e5m2, int64_t)’
    200 | inline C10_HOST_DEVICE Float8_e5m2 operator-(Float8_e5m2 a, int64_t b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:200:36: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:213:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(int64_t, c10::Float8_e5m2)’
    213 | inline C10_HOST_DEVICE Float8_e5m2 operator-(int64_t a, Float8_e5m2 b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:213:36: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz.h:138,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:44:1: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(const c10::Float8_e5m2fnuz&, const c10::Float8_e5m2fnuz&)’
     44 | operator-(const Float8_e5m2fnuz& a, const Float8_e5m2fnuz& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:44:1: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:59:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(const c10::Float8_e5m2fnuz&)’
     59 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(const Float8_e5m2fnuz& a) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:59:73: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Float8_e5m2fnuz&’
     59 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(const Float8_e5m2fnuz& a) {
        |                                                  ~~~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:96:30: note: candidate: ‘float c10::operator-(c10::Float8_e5m2fnuz, float)’
     96 | inline C10_HOST_DEVICE float operator-(Float8_e5m2fnuz a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:96:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:110:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e5m2fnuz)’
    110 | inline C10_HOST_DEVICE float operator-(float a, Float8_e5m2fnuz b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:110:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:139:31: note: candidate: ‘double c10::operator-(c10::Float8_e5m2fnuz, double)’
    139 | inline C10_HOST_DEVICE double operator-(Float8_e5m2fnuz a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:139:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:153:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e5m2fnuz)’
    153 | inline C10_HOST_DEVICE double operator-(double a, Float8_e5m2fnuz b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:153:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:169:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(c10::Float8_e5m2fnuz, int)’
    169 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(Float8_e5m2fnuz a, int b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:169:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:182:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(int, c10::Float8_e5m2fnuz)’
    182 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(int a, Float8_e5m2fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:182:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:197:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(c10::Float8_e5m2fnuz, int64_t)’
    197 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(Float8_e5m2fnuz a, int64_t b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:197:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:210:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(int64_t, c10::Float8_e5m2fnuz)’
    210 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(int64_t a, Float8_e5m2fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:210:40: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, int64_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(int64_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, int32_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(int32_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, uint64_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(uint64_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, uint32_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(uint32_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymFloat c10::operator-(const c10::SymInt&, double)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymFloat c10::operator-(double, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymFloat c10::operator-(const c10::SymInt&, float)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymFloat c10::operator-(float, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:367:16: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&)’
    367 | C10_API SymInt operator-(const SymInt& s);
        |                ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:367:40: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::SymInt&’
    367 | C10_API SymInt operator-(const SymInt& s);
        |                          ~~~~~~~~~~~~~~^
  In file included from /usr/local/cuda/include/cuda_fp16.h:5293,
                   from /usr/local/cuda/include/cublas_api.h:77,
                   from /usr/local/cuda/include/cublas_v2.h:69,
                   from /workspace/nunchaku/src/common.h:23,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/local/cuda/include/cuda_fp16.hpp:222:54: note: candidate: ‘__half operator-(const __half&, const __half&)’
    222 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half operator-(const __half &lh, const __half &rh) { return __hsub(lh, rh); }
        |                                                      ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:222:54: note:   candidate expects 2 arguments, 1 provided
  /usr/local/cuda/include/cuda_fp16.hpp:254:54: note: candidate: ‘__half operator-(const __half&)’
    254 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half operator-(const __half &h) { return __hneg(h); }
        |                                                      ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:254:78: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const __half&’
    254 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half operator-(const __half &h) { return __hneg(h); }
        |                                                                ~~~~~~~~~~~~~~^
  /usr/local/cuda/include/cuda_fp16.hpp:308:55: note: candidate: ‘__half2 operator-(const __half2&, const __half2&)’
    308 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half2 operator-(const __half2 &lh, const __half2 &rh) { return __hsub2(lh, rh); }
        |                                                       ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:308:55: note:   candidate expects 2 arguments, 1 provided
  /usr/local/cuda/include/cuda_fp16.hpp:342:55: note: candidate: ‘__half2 operator-(const __half2&)’
    342 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half2 operator-(const __half2 &h) { return __hneg2(h); }
        |                                                       ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:342:80: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const __half2&’
    342 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half2 operator-(const __half2 &h) { return __hneg2(h); }
        |                                                                 ~~~~~~~~~~~~~~~^
  In file included from /usr/local/cuda/include/cuda_bf16.h:5079,
                   from /usr/local/cuda/include/cublas_api.h:78,
                   from /usr/local/cuda/include/cublas_v2.h:69,
                   from /workspace/nunchaku/src/common.h:23,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/local/cuda/include/cuda_bf16.hpp:203:61: note: candidate: ‘__nv_bfloat16 operator-(const __nv_bfloat16&, const __nv_bfloat16&)’
    203 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat16 operator-(const __nv_bfloat16 &lh, const __nv_bfloat16 &rh) { return __hsub(lh, rh); }
        |                                                             ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:203:61: note:   candidate expects 2 arguments, 1 provided
  /usr/local/cuda/include/cuda_bf16.hpp:235:61: note: candidate: ‘__nv_bfloat16 operator-(const __nv_bfloat16&)’
    235 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat16 operator-(const __nv_bfloat16 &h) { return __hneg(h); }
        |                                                             ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:235:92: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const __nv_bfloat16&’
    235 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat16 operator-(const __nv_bfloat16 &h) { return __hneg(h); }
        |                                                                       ~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/cuda/include/cuda_bf16.hpp:320:62: note: candidate: ‘__nv_bfloat162 operator-(const __nv_bfloat162&, const __nv_bfloat162&)’
    320 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat162 operator-(const __nv_bfloat162 &lh, const __nv_bfloat162 &rh) { return __hsub2(lh, rh); }
        |                                                              ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:320:62: note:   candidate expects 2 arguments, 1 provided
  /usr/local/cuda/include/cuda_bf16.hpp:354:62: note: candidate: ‘__nv_bfloat162 operator-(const __nv_bfloat162&)’
    354 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat162 operator-(const __nv_bfloat162 &h) { return __hneg2(h); }
        |                                                              ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:354:94: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const __nv_bfloat162&’
    354 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat162 operator-(const __nv_bfloat162 &h) { return __hneg2(h); }
        |                                                                        ~~~~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ATen.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:17: note: candidate: ‘at::Tensor at::operator-(const at::Tensor&, const at::Tensor&)’
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:17: note: in definition of macro ‘DEFINE_OPERATOR’
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:17: note:   candidate expects 2 arguments, 1 provided
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:17: note: in definition of macro ‘DEFINE_OPERATOR’
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:17: note: candidate: ‘at::Tensor at::operator-(const at::Tensor&, const c10::Scalar&)’
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:17: note: in definition of macro ‘DEFINE_OPERATOR’
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:17: note:   candidate expects 2 arguments, 1 provided
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:17: note: in definition of macro ‘DEFINE_OPERATOR’
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:17: note: candidate: ‘at::Tensor at::operator-(const c10::Scalar&, const at::Tensor&)’
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:17: note: in definition of macro ‘DEFINE_OPERATOR’
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:17: note:   candidate expects 2 arguments, 1 provided
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:17: note: in definition of macro ‘DEFINE_OPERATOR’
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:297:77: error: return type ‘class torch::Tensor’ is incomplete
    297 | inline Tensor softmin(const Tensor& input, const SoftminFuncOptions& options) {
        |                                                                             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:308:38: error: return type ‘class torch::Tensor’ is incomplete
    308 |     std::optional<torch::Dtype> dtype) {
        |                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In function ‘void torch::nn::functional::detail::log_softmax(const torch::Tensor&, int64_t, std::optional<c10::ScalarType>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:309:10: error: aggregate ‘torch::Tensor ret’ has incomplete type and cannot be defined
    309 |   Tensor ret;
        |          ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:312:11: error: invalid use of incomplete type ‘const class torch::Tensor’
    312 |     ret = input.log_softmax(dim);
        |           ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:314:11: error: invalid use of incomplete type ‘const class torch::Tensor’
    314 |     ret = input.log_softmax(dim, dtype);
        |           ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:336:41: error: return type ‘class torch::Tensor’ is incomplete
    336 |     const LogSoftmaxFuncOptions& options) {
        |                                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:344:51: error: return type ‘class torch::Tensor’ is incomplete
    344 | inline Tensor glu(const Tensor& input, int64_t dim) {
        |                                                   ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In function ‘void torch::nn::functional::detail::glu(const torch::Tensor&, int64_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:346:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    346 |       input.dim() != 0,
        |       ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:345:3: note: in expansion of macro ‘TORCH_CHECK’
    345 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:348:21: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    348 |   return torch::glu(input, dim);
        |                     ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:759,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/glu.h:35:42: note: in passing argument 1 of ‘at::Tensor at::glu(const at::Tensor&, int64_t)’
     35 | inline at::Tensor glu(const at::Tensor & self, int64_t dim=-1) {
        |                       ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:365:74: error: return type ‘class torch::Tensor’ is incomplete
    365 | inline Tensor glu(const Tensor& input, const GLUFuncOptions& options = {}) {
        |                                                                          ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:373:66: error: return type ‘class torch::Tensor’ is incomplete
    373 | inline Tensor gelu(const Tensor& input, const string& approximate) {
        |                                                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In function ‘void torch::nn::functional::detail::gelu(const torch::Tensor&, const string&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:374:22: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    374 |   return torch::gelu(input, approximate);
        |                      ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:754,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/gelu.h:40:43: note: in passing argument 1 of ‘at::Tensor at::gelu(const at::Tensor&, c10::string_view)’
     40 | inline at::Tensor gelu(const at::Tensor & self, c10::string_view approximate="none") {
        |                        ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:379:76: error: return type ‘class torch::Tensor’ is incomplete
    379 | inline Tensor gelu(const Tensor& input, const GELUFuncOptions& options = {}) {
        |                                                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:385:39: error: return type ‘class torch::Tensor’ is incomplete
    385 | inline Tensor silu(const Tensor& input) {
        |                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In function ‘void torch::nn::functional::silu(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:386:22: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    386 |   return torch::silu(input);
        |                      ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1178,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/silu.h:26:43: note: in passing argument 1 of ‘at::Tensor at::silu(const at::Tensor&)’
     26 | inline at::Tensor silu(const at::Tensor & self) {
        |                        ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:391:39: error: return type ‘class torch::Tensor’ is incomplete
    391 | inline Tensor mish(const Tensor& input) {
        |                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In function ‘void torch::nn::functional::mish(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:392:22: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    392 |   return torch::mish(input);
        |                      ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:971,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/mish.h:26:43: note: in passing argument 1 of ‘at::Tensor at::mish(const at::Tensor&)’
     26 | inline at::Tensor mish(const at::Tensor & self) {
        |                        ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:397:62: error: return type ‘class torch::Tensor’ is incomplete
    397 | inline Tensor prelu(const Tensor& input, const Tensor& weight) {
        |                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In function ‘void torch::nn::functional::prelu(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:398:23: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    398 |   return torch::prelu(input, weight);
        |                       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1074,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/prelu.h:26:44: note: in passing argument 1 of ‘at::Tensor at::prelu(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor prelu(const at::Tensor & self, const at::Tensor & weight) {
        |                         ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:405:27: error: ‘input’ has incomplete type
    405 | inline Tensor relu(Tensor input, bool inplace) {
        |                    ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:405:46: error: return type ‘class torch::Tensor’ is incomplete
    405 | inline Tensor relu(Tensor input, bool inplace) {
        |                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:427:27: error: ‘input’ has incomplete type
    427 | inline Tensor relu(Tensor input, const ReLUFuncOptions& options = {}) {
        |                    ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:427:69: error: return type ‘class torch::Tensor’ is incomplete
    427 | inline Tensor relu(Tensor input, const ReLUFuncOptions& options = {}) {
        |                                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:435:28: error: ‘input’ has incomplete type
    435 | inline Tensor relu6(Tensor input, bool inplace) {
        |                     ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:435:47: error: return type ‘class torch::Tensor’ is incomplete
    435 | inline Tensor relu6(Tensor input, bool inplace) {
        |                                               ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:457:28: error: ‘input’ has incomplete type
    457 | inline Tensor relu6(Tensor input, const ReLU6FuncOptions& options = {}) {
        |                     ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:457:71: error: return type ‘class torch::Tensor’ is incomplete
    457 | inline Tensor relu6(Tensor input, const ReLU6FuncOptions& options = {}) {
        |                                                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:466:12: error: ‘input’ has incomplete type
    466 |     Tensor input,
        |     ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:470:17: error: return type ‘class torch::Tensor’ is incomplete
    470 |     bool inplace) {
        |                 ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:492:28: error: ‘input’ has incomplete type
    492 | inline Tensor rrelu(Tensor input, const RReLUFuncOptions& options = {}) {
        |                     ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:492:71: error: return type ‘class torch::Tensor’ is incomplete
    492 | inline Tensor rrelu(Tensor input, const RReLUFuncOptions& options = {}) {
        |                                                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:505:27: error: ‘input’ has incomplete type
    505 | inline Tensor celu(Tensor input, double alpha, bool inplace) {
        |                    ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:505:60: error: return type ‘class torch::Tensor’ is incomplete
    505 | inline Tensor celu(Tensor input, double alpha, bool inplace) {
        |                                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:527:27: error: ‘input’ has incomplete type
    527 | inline Tensor celu(Tensor input, const CELUFuncOptions& options = {}) {
        |                    ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:527:69: error: return type ‘class torch::Tensor’ is incomplete
    527 | inline Tensor celu(Tensor input, const CELUFuncOptions& options = {}) {
        |                                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:535:74: error: return type ‘class torch::Tensor’ is incomplete
    535 | inline Tensor softplus(const Tensor& input, double beta, double threshold) {
        |                                                                          ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In function ‘void torch::nn::functional::detail::softplus(const torch::Tensor&, double, double)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:536:26: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    536 |   return torch::softplus(input, beta, threshold);
        |                          ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1202,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/softplus.h:35:47: note: in passing argument 1 of ‘at::Tensor at::softplus(const at::Tensor&, const c10::Scalar&, const c10::Scalar&)’
     35 | inline at::Tensor softplus(const at::Tensor & self, const at::Scalar & beta=1, const at::Scalar & threshold=20) {
        |                            ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:555:44: error: return type ‘class torch::Tensor’ is incomplete
    555 |     const SoftplusFuncOptions& options = {}) {
        |                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:563:60: error: return type ‘class torch::Tensor’ is incomplete
    563 | inline Tensor softshrink(const Tensor& input, double lambda) {
        |                                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In function ‘void torch::nn::functional::detail::softshrink(const torch::Tensor&, double)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:564:28: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    564 |   return torch::softshrink(input, lambda);
        |                            ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1204,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/softshrink.h:35:49: note: in passing argument 1 of ‘at::Tensor at::softshrink(const at::Tensor&, const c10::Scalar&)’
     35 | inline at::Tensor softshrink(const at::Tensor & self, const at::Scalar & lambd=0.5) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:583:46: error: return type ‘class torch::Tensor’ is incomplete
    583 |     const SoftshrinkFuncOptions& options = {}) {
        |                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:589:43: error: return type ‘class torch::Tensor’ is incomplete
    589 | inline Tensor softsign(const Tensor& input) {
        |                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In function ‘void torch::nn::functional::softsign(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:590:19: error: invalid use of incomplete type ‘const class torch::Tensor’
    590 |   return input / (input.abs() + 1);
        |                   ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:595:45: error: return type ‘class torch::Tensor’ is incomplete
    595 | inline Tensor tanhshrink(const Tensor& input) {
        |                                             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In function ‘void torch::nn::functional::tanhshrink(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:596:18: error: invalid use of incomplete type ‘const class torch::Tensor’
    596 |   return input - input.tanh();
        |                  ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:604:12: error: ‘input’ has incomplete type
    604 |     Tensor input,
        |     ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:607:17: error: return type ‘class torch::Tensor’ is incomplete
    607 |     bool inplace) {
        |                 ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:629:32: error: ‘input’ has incomplete type
    629 | inline Tensor threshold(Tensor input, const ThresholdFuncOptions& options) {
        |                         ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:629:74: error: return type ‘class torch::Tensor’ is incomplete
    629 | inline Tensor threshold(Tensor input, const ThresholdFuncOptions& options) {
        |                                                                          ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:665:37: error: invalid use of incomplete type ‘const class torch::Tensor’
    665 |     bool average_attn_weights = true) {
        |                                     ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:665:37: error: invalid use of incomplete type ‘const class torch::Tensor’
    665 |     bool average_attn_weights = true) {
        |                                     ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:665:37: error: invalid use of incomplete type ‘const class torch::Tensor’
    665 |     bool average_attn_weights = true) {
        |                                     ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:665:37: error: invalid use of incomplete type ‘const class torch::Tensor’
    665 |     bool average_attn_weights = true) {
        |                                     ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:665:37: error: invalid use of incomplete type ‘const class torch::Tensor’
    665 |     bool average_attn_weights = true) {
        |                                     ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:665:37: error: invalid use of incomplete type ‘const class torch::Tensor’
    665 |     bool average_attn_weights = true) {
        |                                     ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:665:37: error: invalid use of incomplete type ‘const class torch::Tensor’
    665 |     bool average_attn_weights = true) {
        |                                     ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/unique_ptr.h:37,
                   from /usr/include/c++/11/memory:76,
                   from /workspace/nunchaku/src/common.h:9,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/tuple: In instantiation of ‘struct std::_Tuple_impl<0, torch::Tensor, torch::Tensor>’:
  /usr/include/c++/11/tuple:981:11:   required from ‘class std::tuple<torch::Tensor, torch::Tensor>’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:665:37:   required from here
  /usr/include/c++/11/tuple:69:28: error: invalid use of incomplete type ‘class torch::Tensor’
     69 |     = typename conditional<__is_final(_Tp), false_type,
        |                            ^~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/unique_ptr.h:37,
                   from /usr/include/c++/11/memory:76,
                   from /workspace/nunchaku/src/common.h:9,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/tuple: In instantiation of ‘struct std::_Tuple_impl<1, torch::Tensor>’:
  /usr/include/c++/11/tuple:258:12:   required from ‘struct std::_Tuple_impl<0, torch::Tensor, torch::Tensor>’
  /usr/include/c++/11/tuple:981:11:   required from ‘class std::tuple<torch::Tensor, torch::Tensor>’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:665:37:   required from here
  /usr/include/c++/11/tuple:69:28: error: invalid use of incomplete type ‘class torch::Tensor’
     69 |     = typename conditional<__is_final(_Tp), false_type,
        |                            ^~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/unique_ptr.h:37,
                   from /usr/include/c++/11/memory:76,
                   from /workspace/nunchaku/src/common.h:9,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/tuple:69:28: error: invalid use of incomplete type ‘class torch::Tensor’
     69 |     = typename conditional<__is_final(_Tp), false_type,
        |                            ^~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/unique_ptr.h:37,
                   from /usr/include/c++/11/memory:76,
                   from /workspace/nunchaku/src/common.h:9,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/tuple: In instantiation of ‘struct std::_Tuple_impl<0, torch::Tensor, torch::Tensor>’:
  /usr/include/c++/11/tuple:981:11:   required from ‘class std::tuple<torch::Tensor, torch::Tensor>’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:665:37:   required from here
  /usr/include/c++/11/tuple:69:28: error: invalid use of incomplete type ‘class torch::Tensor’
     69 |     = typename conditional<__is_final(_Tp), false_type,
        |                            ^~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In function ‘std::tuple<torch::Tensor, torch::Tensor> torch::nn::functional::detail::multi_head_attention_forward(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, int64_t, int64_t, const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, bool, double, const torch::Tensor&, const torch::Tensor&, bool, const torch::Tensor&, bool, const torch::Tensor&, bool, const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:668:28: error: invalid use of incomplete type ‘const class torch::Tensor’
    668 |   const auto query_sizes = query.sizes();
        |                            ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:673:25: error: invalid use of incomplete type ‘const class torch::Tensor’
    673 |   TORCH_INTERNAL_ASSERT(key.sizes() == value.sizes());
        |                         ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:413:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    413 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {                                          \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:673:3: note: in expansion of macro ‘TORCH_INTERNAL_ASSERT’
    673 |   TORCH_INTERNAL_ASSERT(key.sizes() == value.sizes());
        |   ^~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:673:40: error: invalid use of incomplete type ‘const class torch::Tensor’
    673 |   TORCH_INTERNAL_ASSERT(key.sizes() == value.sizes());
        |                                        ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:413:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    413 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {                                          \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:673:3: note: in expansion of macro ‘TORCH_INTERNAL_ASSERT’
    673 |   TORCH_INTERNAL_ASSERT(key.sizes() == value.sizes());
        |   ^~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:681:10: error: aggregate ‘torch::Tensor q’ has incomplete type and cannot be defined
    681 |   Tensor q, k, v;
        |          ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:681:13: error: aggregate ‘torch::Tensor k’ has incomplete type and cannot be defined
    681 |   Tensor q, k, v;
        |             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:681:16: error: aggregate ‘torch::Tensor v’ has incomplete type and cannot be defined
    681 |   Tensor q, k, v;
        |                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:683:22: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    683 |     if (torch::equal(query, key) && torch::equal(key, value)) {
        |                      ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:676,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/equal.h:26:38: note: in passing argument 1 of ‘bool at::equal(const at::Tensor&, const at::Tensor&)’
     26 | inline bool equal(const at::Tensor & self, const at::Tensor & other) {
        |                   ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:683:50: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    683 |     if (torch::equal(query, key) && torch::equal(key, value)) {
        |                                                  ^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:676,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/equal.h:26:38: note: in passing argument 1 of ‘bool at::equal(const at::Tensor&, const at::Tensor&)’
     26 | inline bool equal(const at::Tensor & self, const at::Tensor & other) {
        |                   ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:686:20: error: invalid use of ‘void’
    686 |           F::linear(query, in_proj_weight, in_proj_bias).chunk(3, /*dim=*/-1);
        |           ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:690:29: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    690 |     } else if (torch::equal(key, value)) {
        |                             ^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:676,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/equal.h:26:38: note: in passing argument 1 of ‘bool at::equal(const at::Tensor&, const at::Tensor&)’
     26 | inline bool equal(const at::Tensor & self, const at::Tensor & other) {
        |                   ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:693:12: error: ‘torch::Tensor _b’ has incomplete type
    693 |       auto _b = in_proj_bias;
        |            ^~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:696:17: error: invalid use of incomplete type ‘const class torch::Tensor’
    696 |       auto _w = in_proj_weight.slice(/*dim=*/0, _start, _end);
        |                 ^~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:702:12: error: invalid use of incomplete type ‘const class torch::Tensor’
    702 |       if (!key.defined()) {
        |            ^~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:703:32: error: invalid use of incomplete type ‘const class torch::Tensor’
    703 |         TORCH_INTERNAL_ASSERT(!value.defined());
        |                                ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:413:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    413 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {                                          \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:703:9: note: in expansion of macro ‘TORCH_INTERNAL_ASSERT’
    703 |         TORCH_INTERNAL_ASSERT(!value.defined());
        |         ^~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:710:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    710 |         _w = in_proj_weight.slice(/*dim=*/0, _start);
        |              ^~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:720:12: error: ‘torch::Tensor _b’ has incomplete type
    720 |       auto _b = in_proj_bias;
        |            ^~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:723:17: error: invalid use of incomplete type ‘const class torch::Tensor’
    723 |       auto _w = in_proj_weight.slice(/*dim=*/0, _start, _end);
        |                 ^~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:733:12: error: invalid use of incomplete type ‘const class torch::Tensor’
    733 |       _w = in_proj_weight.slice(/*dim=*/0, _start, _end);
        |            ^~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:742:12: error: invalid use of incomplete type ‘const class torch::Tensor’
    742 |       _w = in_proj_weight.slice(/*dim=*/0, _start);
        |            ^~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:751:26: error: invalid use of incomplete type ‘const class torch::Tensor’
    751 |       const auto sizes = q_proj_weight_non_opt.sizes();
        |                          ^~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:754:48: error: invalid use of incomplete type ‘const class torch::Tensor’
    754 |       TORCH_CHECK(len1 == embed_dim && len2 == query.size(-1));
        |                                                ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:754:7: note: in expansion of macro ‘TORCH_CHECK’
    754 |       TORCH_CHECK(len1 == embed_dim && len2 == query.size(-1));
        |       ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:759:26: error: invalid use of incomplete type ‘const class torch::Tensor’
    759 |       const auto sizes = k_proj_weight_non_opt.sizes();
        |                          ^~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:762:48: error: invalid use of incomplete type ‘const class torch::Tensor’
    762 |       TORCH_CHECK(len1 == embed_dim && len2 == key.size(-1));
        |                                                ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:762:7: note: in expansion of macro ‘TORCH_CHECK’
    762 |       TORCH_CHECK(len1 == embed_dim && len2 == key.size(-1));
        |       ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:767:26: error: invalid use of incomplete type ‘const class torch::Tensor’
    767 |       const auto sizes = v_proj_weight_non_opt.sizes();
        |                          ^~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:770:48: error: invalid use of incomplete type ‘const class torch::Tensor’
    770 |       TORCH_CHECK(len1 == embed_dim && len2 == value.size(-1));
        |                                                ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:770:7: note: in expansion of macro ‘TORCH_CHECK’
    770 |       TORCH_CHECK(len1 == embed_dim && len2 == value.size(-1));
        |       ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:773:9: error: invalid use of incomplete type ‘const class torch::Tensor’
    773 |     if (in_proj_bias.defined()) {
        |         ^~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:777:11: error: invalid use of incomplete type ‘const class torch::Tensor’
    777 |           in_proj_bias.slice(/*dim=*/0, 0, embed_dim));
        |           ^~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:781:11: error: invalid use of incomplete type ‘const class torch::Tensor’
    781 |           in_proj_bias.slice(/*dim=*/0, embed_dim, (embed_dim * 2)));
        |           ^~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:785:11: error: invalid use of incomplete type ‘const class torch::Tensor’
    785 |           in_proj_bias.slice(/*dim=*/0, (embed_dim * 2)));
        |           ^~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:793:10: error: variable ‘torch::Tensor attn_mask_’ has initializer but incomplete type
    793 |   Tensor attn_mask_ = attn_mask;
        |          ^~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:794:10: error: variable ‘torch::Tensor key_padding_mask_’ has initializer but incomplete type
    794 |   Tensor key_padding_mask_ = key_padding_mask;
        |          ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:795:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    795 |   if (bias_k.defined() && bias_v.defined()) {
        |       ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:795:27: error: invalid use of incomplete type ‘const class torch::Tensor’
    795 |   if (bias_k.defined() && bias_v.defined()) {
        |                           ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:796:10: error: invalid use of incomplete type ‘const class torch::Tensor’
    796 |     if (!static_k.defined() && !static_v.defined()) {
        |          ^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:796:33: error: invalid use of incomplete type ‘const class torch::Tensor’
    796 |     if (!static_k.defined() && !static_v.defined()) {
        |                                 ^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:797:26: error: invalid use of incomplete type ‘const class torch::Tensor’
    797 |       k = torch::cat({k, bias_k.repeat({1, bsz, 1})});
        |                          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:797:21: error: no matching function for call to ‘cat(<brace-enclosed initializer list>)’
    797 |       k = torch::cat({k, bias_k.repeat({1, bsz, 1})});
        |           ~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:559,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:19: note: candidate: ‘at::Tensor at::cat(const ITensorListRef&, int64_t)’
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:50: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const ITensorListRef&’ {aka ‘const c10::IListRef<at::Tensor>&’}
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:19: note: candidate: ‘at::Tensor at::cat(at::TensorList, at::Dimname)’
     40 | inline at::Tensor cat(at::TensorList tensors, at::Dimname dim) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:19: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:798:26: error: invalid use of incomplete type ‘const class torch::Tensor’
    798 |       v = torch::cat({v, bias_v.repeat({1, bsz, 1})});
        |                          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:798:21: error: no matching function for call to ‘cat(<brace-enclosed initializer list>)’
    798 |       v = torch::cat({v, bias_v.repeat({1, bsz, 1})});
        |           ~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:559,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:19: note: candidate: ‘at::Tensor at::cat(const ITensorListRef&, int64_t)’
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:50: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const ITensorListRef&’ {aka ‘const c10::IListRef<at::Tensor>&’}
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:19: note: candidate: ‘at::Tensor at::cat(at::TensorList, at::Dimname)’
     40 | inline at::Tensor cat(at::TensorList tensors, at::Dimname dim) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:19: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:800:32: error: no matching function for call to ‘cat(<brace-enclosed initializer list>, int)’
    800 |         attn_mask_ = torch::cat(
        |                      ~~~~~~~~~~^
    801 |             {attn_mask_,
        |             ~~~~~~~~~~~~
    802 |              torch::zeros(
        |              ~~~~~~~~~~~~~
    803 |                  {attn_mask_.size(0), 1},
        |                  ~~~~~~~~~~~~~~~~~~~~~~~~
    804 |                  at::TensorOptions(attn_mask_.dtype())
        |                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    805 |                      .device(attn_mask_.device()))},
        |                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    806 |             /*dim=*/1);
        |             ~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:559,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:19: note: candidate: ‘at::Tensor at::cat(const ITensorListRef&, int64_t)’
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:50: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const ITensorListRef&’ {aka ‘const c10::IListRef<at::Tensor>&’}
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:19: note: candidate: ‘at::Tensor at::cat(at::TensorList, at::Dimname)’
     40 | inline at::Tensor cat(at::TensorList tensors, at::Dimname dim) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:38: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘at::TensorList’ {aka ‘c10::ArrayRef<at::Tensor>’}
     40 | inline at::Tensor cat(at::TensorList tensors, at::Dimname dim) {
        |                       ~~~~~~~~~~~~~~~^~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:809:39: error: no matching function for call to ‘cat(<brace-enclosed initializer list>, int)’
    809 |         key_padding_mask_ = torch::cat(
        |                             ~~~~~~~~~~^
    810 |             {key_padding_mask_,
        |             ~~~~~~~~~~~~~~~~~~~
    811 |              torch::zeros(
        |              ~~~~~~~~~~~~~
    812 |                  {key_padding_mask_.size(0), 1},
        |                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    813 |                  at::TensorOptions(key_padding_mask_.dtype())
        |                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    814 |                      .device(key_padding_mask_.device()))},
        |                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    815 |             /*dim=*/1);
        |             ~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:559,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:19: note: candidate: ‘at::Tensor at::cat(const ITensorListRef&, int64_t)’
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:50: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const ITensorListRef&’ {aka ‘const c10::IListRef<at::Tensor>&’}
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:19: note: candidate: ‘at::Tensor at::cat(at::TensorList, at::Dimname)’
     40 | inline at::Tensor cat(at::TensorList tensors, at::Dimname dim) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:38: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘at::TensorList’ {aka ‘c10::ArrayRef<at::Tensor>’}
     40 | inline at::Tensor cat(at::TensorList tensors, at::Dimname dim) {
        |                       ~~~~~~~~~~~~~~~^~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:818:20: error: invalid use of incomplete type ‘const class torch::Tensor’
    818 |       TORCH_CHECK(!static_k.defined(), "bias cannot be added to static key.");
        |                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:818:7: note: in expansion of macro ‘TORCH_CHECK’
    818 |       TORCH_CHECK(!static_k.defined(), "bias cannot be added to static key.");
        |       ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:819:20: error: invalid use of incomplete type ‘const class torch::Tensor’
    819 |       TORCH_CHECK(!static_v.defined(), "bias cannot be added to static value.");
        |                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:819:7: note: in expansion of macro ‘TORCH_CHECK’
    819 |       TORCH_CHECK(!static_v.defined(), "bias cannot be added to static value.");
        |       ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:822:18: error: invalid use of incomplete type ‘const class torch::Tensor’
    822 |     TORCH_CHECK(!bias_k.defined());
        |                  ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:822:5: note: in expansion of macro ‘TORCH_CHECK’
    822 |     TORCH_CHECK(!bias_k.defined());
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:823:18: error: invalid use of incomplete type ‘const class torch::Tensor’
    823 |     TORCH_CHECK(!bias_v.defined());
        |                  ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:823:5: note: in expansion of macro ‘TORCH_CHECK’
    823 |     TORCH_CHECK(!bias_v.defined());
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:832:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    832 |   if (static_k.defined()) {
        |       ^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:833:17: error: invalid use of incomplete type ‘const class torch::Tensor’
    833 |     TORCH_CHECK(static_k.size(0) == bsz * num_heads);
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:833:5: note: in expansion of macro ‘TORCH_CHECK’
    833 |     TORCH_CHECK(static_k.size(0) == bsz * num_heads);
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:834:17: error: invalid use of incomplete type ‘const class torch::Tensor’
    834 |     TORCH_CHECK(static_k.size(2) == head_dim);
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:834:5: note: in expansion of macro ‘TORCH_CHECK’
    834 |     TORCH_CHECK(static_k.size(2) == head_dim);
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:837:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    837 |   if (static_v.defined()) {
        |       ^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:838:17: error: invalid use of incomplete type ‘const class torch::Tensor’
    838 |     TORCH_CHECK(static_v.size(0) == bsz * num_heads);
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:838:5: note: in expansion of macro ‘TORCH_CHECK’
    838 |     TORCH_CHECK(static_v.size(0) == bsz * num_heads);
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:839:17: error: invalid use of incomplete type ‘const class torch::Tensor’
    839 |     TORCH_CHECK(static_v.size(2) == head_dim);
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:839:5: note: in expansion of macro ‘TORCH_CHECK’
    839 |     TORCH_CHECK(static_v.size(2) == head_dim);
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:851:19: error: no matching function for call to ‘cat(<brace-enclosed initializer list>, int)’
    851 |     k = torch::cat(
        |         ~~~~~~~~~~^
    852 |         {k,
        |         ~~~
    853 |          torch::zeros(
        |          ~~~~~~~~~~~~~
    854 |              k_sizes, at::TensorOptions(k.dtype()).device(k.device()))},
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    855 |         /*dim=*/1);
        |         ~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:559,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:19: note: candidate: ‘at::Tensor at::cat(const ITensorListRef&, int64_t)’
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:50: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const ITensorListRef&’ {aka ‘const c10::IListRef<at::Tensor>&’}
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:19: note: candidate: ‘at::Tensor at::cat(at::TensorList, at::Dimname)’
     40 | inline at::Tensor cat(at::TensorList tensors, at::Dimname dim) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:38: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘at::TensorList’ {aka ‘c10::ArrayRef<at::Tensor>’}
     40 | inline at::Tensor cat(at::TensorList tensors, at::Dimname dim) {
        |                       ~~~~~~~~~~~~~~~^~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:858:19: error: no matching function for call to ‘cat(<brace-enclosed initializer list>, int)’
    858 |     v = torch::cat(
        |         ~~~~~~~~~~^
    859 |         {v,
        |         ~~~
    860 |          torch::zeros(
        |          ~~~~~~~~~~~~~
    861 |              v_sizes, at::TensorOptions(v.dtype()).device(v.device()))},
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    862 |         /*dim=*/1);
        |         ~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:559,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:19: note: candidate: ‘at::Tensor at::cat(const ITensorListRef&, int64_t)’
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:50: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const ITensorListRef&’ {aka ‘const c10::IListRef<at::Tensor>&’}
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:19: note: candidate: ‘at::Tensor at::cat(at::TensorList, at::Dimname)’
     40 | inline at::Tensor cat(at::TensorList tensors, at::Dimname dim) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:38: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘at::TensorList’ {aka ‘c10::ArrayRef<at::Tensor>’}
     40 | inline at::Tensor cat(at::TensorList tensors, at::Dimname dim) {
        |                       ~~~~~~~~~~~~~~~^~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:864:30: error: no matching function for call to ‘cat(<brace-enclosed initializer list>, int)’
    864 |       attn_mask_ = torch::cat(
        |                    ~~~~~~~~~~^
    865 |           {attn_mask_,
        |           ~~~~~~~~~~~~
    866 |            torch::zeros(
        |            ~~~~~~~~~~~~~
    867 |                {attn_mask_.size(0), 1},
        |                ~~~~~~~~~~~~~~~~~~~~~~~~
    868 |                at::TensorOptions(attn_mask_.dtype())
        |                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    869 |                    .device(attn_mask_.device()))},
        |                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    870 |           /*dim=*/1);
        |           ~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:559,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:19: note: candidate: ‘at::Tensor at::cat(const ITensorListRef&, int64_t)’
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:50: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const ITensorListRef&’ {aka ‘const c10::IListRef<at::Tensor>&’}
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:19: note: candidate: ‘at::Tensor at::cat(at::TensorList, at::Dimname)’
     40 | inline at::Tensor cat(at::TensorList tensors, at::Dimname dim) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:38: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘at::TensorList’ {aka ‘c10::ArrayRef<at::Tensor>’}
     40 | inline at::Tensor cat(at::TensorList tensors, at::Dimname dim) {
        |                       ~~~~~~~~~~~~~~~^~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:873:37: error: no matching function for call to ‘cat(<brace-enclosed initializer list>, int)’
    873 |       key_padding_mask_ = torch::cat(
        |                           ~~~~~~~~~~^
    874 |           {key_padding_mask_,
        |           ~~~~~~~~~~~~~~~~~~~
    875 |            torch::zeros(
        |            ~~~~~~~~~~~~~
    876 |                {key_padding_mask_.size(0), 1},
        |                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    877 |                at::TensorOptions(key_padding_mask_.dtype())
        |                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    878 |                    .device(key_padding_mask_.device()))},
        |                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    879 |           /*dim=*/1);
        |           ~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:559,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:19: note: candidate: ‘at::Tensor at::cat(const ITensorListRef&, int64_t)’
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:50: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const ITensorListRef&’ {aka ‘const c10::IListRef<at::Tensor>&’}
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:19: note: candidate: ‘at::Tensor at::cat(at::TensorList, at::Dimname)’
     40 | inline at::Tensor cat(at::TensorList tensors, at::Dimname dim) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:38: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘at::TensorList’ {aka ‘c10::ArrayRef<at::Tensor>’}
     40 | inline at::Tensor cat(at::TensorList tensors, at::Dimname dim) {
        |                       ~~~~~~~~~~~~~~~^~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:885:54: error: no matching function for call to ‘c10::ArrayRef<long int>::ArrayRef(<brace-enclosed initializer list>)’
    885 |       IntArrayRef({bsz * num_heads, tgt_len, src_len}));
        |                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:883:3: note: in expansion of macro ‘TORCH_CHECK’
    883 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/MemoryFormat.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:129:28: note: candidate: ‘constexpr c10::ArrayRef<T>::ArrayRef(const T (&)[N]) [with long unsigned int N = 3; T = long int]’
    129 |   /* implicit */ constexpr ArrayRef(const T (&Arr)[N]) : Data(Arr), Length(N) {}
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:129:47: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const long int (&)[3]’
    129 |   /* implicit */ constexpr ArrayRef(const T (&Arr)[N]) : Data(Arr), Length(N) {}
        |                                     ~~~~~~~~~~^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:123:28: note: candidate: ‘template<long unsigned int N> constexpr c10::ArrayRef<T>::ArrayRef(const std::array<T, N>&) [with long unsigned int N = N; T = long int]’
    123 |   /* implicit */ constexpr ArrayRef(const std::array<T, N>& Arr)
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:123:28: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:885:54: note:   couldn’t deduce template parameter ‘N’
    885 |       IntArrayRef({bsz * num_heads, tgt_len, src_len}));
        |                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:883:3: note: in expansion of macro ‘TORCH_CHECK’
    883 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/MemoryFormat.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:114:18: note: candidate: ‘template<class A> c10::ArrayRef<T>::ArrayRef(const std::vector<T, A>&) [with A = A; T = long int]’
    114 |   /* implicit */ ArrayRef(const std::vector<T, A>& Vec)
        |                  ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:114:18: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:885:54: note:   couldn’t deduce template parameter ‘A’
    885 |       IntArrayRef({bsz * num_heads, tgt_len, src_len}));
        |                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:883:3: note: in expansion of macro ‘TORCH_CHECK’
    883 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/MemoryFormat.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:104:18: note: candidate: ‘template<class Container, class U, class> c10::ArrayRef<T>::ArrayRef(const Container&) [with Container = Container; U = U; <template-parameter-2-3> = <template-parameter-1-3>; T = long int]’
    104 |   /* implicit */ ArrayRef(const Container& container)
        |                  ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:104:18: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:885:54: note:   couldn’t deduce template parameter ‘Container’
    885 |       IntArrayRef({bsz * num_heads, tgt_len, src_len}));
        |                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:883:3: note: in expansion of macro ‘TORCH_CHECK’
    883 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/MemoryFormat.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:94:18: note: candidate: ‘template<class U> c10::ArrayRef<T>::ArrayRef(const c10::SmallVectorTemplateCommon<T, U>&) [with U = U; T = long int]’
     94 |   /* implicit */ ArrayRef(const SmallVectorTemplateCommon<T, U>& Vec)
        |                  ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:94:18: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:885:54: note:   couldn’t deduce template parameter ‘U’
    885 |       IntArrayRef({bsz * num_heads, tgt_len, src_len}));
        |                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:883:3: note: in expansion of macro ‘TORCH_CHECK’
    883 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/MemoryFormat.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:132:28: note: candidate: ‘constexpr c10::ArrayRef<T>::ArrayRef(const std::initializer_list<_Tp>&) [with T = long int]’
    132 |   /* implicit */ constexpr ArrayRef(const std::initializer_list<T>& Vec)
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:132:69: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::initializer_list<long int>&’
    132 |   /* implicit */ constexpr ArrayRef(const std::initializer_list<T>& Vec)
        |                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:85:13: note: candidate: ‘constexpr c10::ArrayRef<T>::ArrayRef(const T*, const T*) [with T = long int]’
     85 |   constexpr ArrayRef(const T* begin, const T* end)
        |             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:85:13: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:79:13: note: candidate: ‘constexpr c10::ArrayRef<T>::ArrayRef(const T*, size_t) [with T = long int; size_t = long unsigned int]’
     79 |   constexpr ArrayRef(const T* data, size_t length)
        |             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:79:13: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:76:13: note: candidate: ‘constexpr c10::ArrayRef<T>::ArrayRef(const T&) [with T = long int]’
     76 |   constexpr ArrayRef(const T& OneElt) : Data(&OneElt), Length(1) {}
        |             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:76:31: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const long int&’
     76 |   constexpr ArrayRef(const T& OneElt) : Data(&OneElt), Length(1) {}
        |                      ~~~~~~~~~^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:72:28: note: candidate: ‘constexpr c10::ArrayRef<T>::ArrayRef() [with T = long int]’
     72 |   /* implicit */ constexpr ArrayRef() : Data(nullptr), Length(0) {}
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:72:28: note:   candidate expects 0 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:45:7: note: candidate: ‘constexpr c10::ArrayRef<long int>::ArrayRef(const c10::ArrayRef<long int>&)’
     45 | class ArrayRef final {
        |       ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:45:7: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const c10::ArrayRef<long int>&’
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:45:7: note: candidate: ‘constexpr c10::ArrayRef<long int>::ArrayRef(c10::ArrayRef<long int>&&)’
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:45:7: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘c10::ArrayRef<long int>&&’
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:910:78: error: no matching function for call to ‘c10::ArrayRef<long int>::ArrayRef(<brace-enclosed initializer list>)’
    910 |       attn_output.sizes() == IntArrayRef({bsz * num_heads, tgt_len, head_dim}));
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:909:3: note: in expansion of macro ‘TORCH_CHECK’
    909 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/MemoryFormat.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:129:28: note: candidate: ‘constexpr c10::ArrayRef<T>::ArrayRef(const T (&)[N]) [with long unsigned int N = 3; T = long int]’
    129 |   /* implicit */ constexpr ArrayRef(const T (&Arr)[N]) : Data(Arr), Length(N) {}
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:129:47: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const long int (&)[3]’
    129 |   /* implicit */ constexpr ArrayRef(const T (&Arr)[N]) : Data(Arr), Length(N) {}
        |                                     ~~~~~~~~~~^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:123:28: note: candidate: ‘template<long unsigned int N> constexpr c10::ArrayRef<T>::ArrayRef(const std::array<T, N>&) [with long unsigned int N = N; T = long int]’
    123 |   /* implicit */ constexpr ArrayRef(const std::array<T, N>& Arr)
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:123:28: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:910:78: note:   couldn’t deduce template parameter ‘N’
    910 |       attn_output.sizes() == IntArrayRef({bsz * num_heads, tgt_len, head_dim}));
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:909:3: note: in expansion of macro ‘TORCH_CHECK’
    909 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/MemoryFormat.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:114:18: note: candidate: ‘template<class A> c10::ArrayRef<T>::ArrayRef(const std::vector<T, A>&) [with A = A; T = long int]’
    114 |   /* implicit */ ArrayRef(const std::vector<T, A>& Vec)
        |                  ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:114:18: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:910:78: note:   couldn’t deduce template parameter ‘A’
    910 |       attn_output.sizes() == IntArrayRef({bsz * num_heads, tgt_len, head_dim}));
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:909:3: note: in expansion of macro ‘TORCH_CHECK’
    909 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/MemoryFormat.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:104:18: note: candidate: ‘template<class Container, class U, class> c10::ArrayRef<T>::ArrayRef(const Container&) [with Container = Container; U = U; <template-parameter-2-3> = <template-parameter-1-3>; T = long int]’
    104 |   /* implicit */ ArrayRef(const Container& container)
        |                  ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:104:18: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:910:78: note:   couldn’t deduce template parameter ‘Container’
    910 |       attn_output.sizes() == IntArrayRef({bsz * num_heads, tgt_len, head_dim}));
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:909:3: note: in expansion of macro ‘TORCH_CHECK’
    909 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/MemoryFormat.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:94:18: note: candidate: ‘template<class U> c10::ArrayRef<T>::ArrayRef(const c10::SmallVectorTemplateCommon<T, U>&) [with U = U; T = long int]’
     94 |   /* implicit */ ArrayRef(const SmallVectorTemplateCommon<T, U>& Vec)
        |                  ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:94:18: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:910:78: note:   couldn’t deduce template parameter ‘U’
    910 |       attn_output.sizes() == IntArrayRef({bsz * num_heads, tgt_len, head_dim}));
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:909:3: note: in expansion of macro ‘TORCH_CHECK’
    909 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/MemoryFormat.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:132:28: note: candidate: ‘constexpr c10::ArrayRef<T>::ArrayRef(const std::initializer_list<_Tp>&) [with T = long int]’
    132 |   /* implicit */ constexpr ArrayRef(const std::initializer_list<T>& Vec)
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:132:69: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::initializer_list<long int>&’
    132 |   /* implicit */ constexpr ArrayRef(const std::initializer_list<T>& Vec)
        |                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:85:13: note: candidate: ‘constexpr c10::ArrayRef<T>::ArrayRef(const T*, const T*) [with T = long int]’
     85 |   constexpr ArrayRef(const T* begin, const T* end)
        |             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:85:13: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:79:13: note: candidate: ‘constexpr c10::ArrayRef<T>::ArrayRef(const T*, size_t) [with T = long int; size_t = long unsigned int]’
     79 |   constexpr ArrayRef(const T* data, size_t length)
        |             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:79:13: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:76:13: note: candidate: ‘constexpr c10::ArrayRef<T>::ArrayRef(const T&) [with T = long int]’
     76 |   constexpr ArrayRef(const T& OneElt) : Data(&OneElt), Length(1) {}
        |             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:76:31: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const long int&’
     76 |   constexpr ArrayRef(const T& OneElt) : Data(&OneElt), Length(1) {}
        |                      ~~~~~~~~~^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:72:28: note: candidate: ‘constexpr c10::ArrayRef<T>::ArrayRef() [with T = long int]’
     72 |   /* implicit */ constexpr ArrayRef() : Data(nullptr), Length(0) {}
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:72:28: note:   candidate expects 0 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:45:7: note: candidate: ‘constexpr c10::ArrayRef<long int>::ArrayRef(const c10::ArrayRef<long int>&)’
     45 | class ArrayRef final {
        |       ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:45:7: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const c10::ArrayRef<long int>&’
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:45:7: note: candidate: ‘constexpr c10::ArrayRef<long int>::ArrayRef(c10::ArrayRef<long int>&&)’
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:45:7: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘c10::ArrayRef<long int>&&’
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:923:48: error: invalid use of incomplete type ‘class torch::Tensor’
    923 |     return std::make_tuple(attn_output, Tensor());
        |                                                ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/loss.h:134:21: error: field ‘weight_’ has incomplete type ‘torch::Tensor’
    134 |   TORCH_ARG(Tensor, weight) = {};
        |                     ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/loss.h:210:21: error: field ‘weight_’ has incomplete type ‘torch::Tensor’
    210 |   TORCH_ARG(Tensor, weight) = Tensor();
        |                     ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/loss.h:368:21: error: field ‘weight_’ has incomplete type ‘torch::Tensor’
    368 |   TORCH_ARG(Tensor, weight) = Tensor();
        |                     ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/loss.h:700:21: error: field ‘weight_’ has incomplete type ‘torch::Tensor’
    700 |   TORCH_ARG(Tensor, weight) = {};
        |                     ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/loss.h:738:21: error: field ‘weight_’ has incomplete type ‘torch::Tensor’
    738 |   TORCH_ARG(Tensor, weight) = {};
        |                     ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/loss.h:777:21: error: field ‘weight_’ has incomplete type ‘torch::Tensor’
    777 |   TORCH_ARG(Tensor, weight) = {};
        |                     ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/loss.h:782:21: error: field ‘pos_weight_’ has incomplete type ‘torch::Tensor’
    782 |   TORCH_ARG(Tensor, pos_weight) = {};
        |                     ^~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:14:45: error: return type ‘class torch::Tensor’ is incomplete
     14 |     L1LossFuncOptions::reduction_t reduction) {
        |                                             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::l1_loss(const torch::Tensor&, const torch::Tensor&, torch::nn::L1LossOptions::reduction_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:15:25: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     15 |   return torch::l1_loss(input, target, enumtype::reduction_get_enum(reduction));
        |                         ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:844,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/l1_loss.h:26:46: note: in passing argument 1 of ‘at::Tensor at::l1_loss(const at::Tensor&, const at::Tensor&, int64_t)’
     26 | inline at::Tensor l1_loss(const at::Tensor & self, const at::Tensor & target, int64_t reduction=at::Reduction::Mean) {
        |                           ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:35:42: error: return type ‘class torch::Tensor’ is incomplete
     35 |     const L1LossFuncOptions& options = {}) {
        |                                          ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:47:28: error: return type ‘class torch::Tensor’ is incomplete
     47 |     bool log_target = false) {
        |                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::kl_div(const torch::Tensor&, const torch::Tensor&, torch::nn::KLDivLossOptions::reduction_t, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:64:32: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     64 |   auto reduced = torch::kl_div(input, target, reduction_enum, log_target);
        |                                ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:841,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/kl_div.h:26:45: note: in passing argument 1 of ‘at::Tensor at::kl_div(const at::Tensor&, const at::Tensor&, int64_t, bool)’
     26 | inline at::Tensor kl_div(const at::Tensor & self, const at::Tensor & target, int64_t reduction=at::Reduction::Mean, bool log_target=false) {
        |                          ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:67:7: error: invalid use of incomplete type ‘const class torch::Tensor’
     67 |       input.dim() != 0) {
        |       ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:68:25: error: invalid use of incomplete type ‘const class torch::Tensor’
     68 |     reduced = reduced / input.sizes()[0];
        |                         ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:92:41: error: return type ‘class torch::Tensor’ is incomplete
     92 |     const KLDivFuncOptions& options = {}) {
        |                                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:104:46: error: return type ‘class torch::Tensor’ is incomplete
    104 |     MSELossFuncOptions::reduction_t reduction) {
        |                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::mse_loss(const torch::Tensor&, const torch::Tensor&, torch::nn::MSELossOptions::reduction_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:105:9: error: invalid use of incomplete type ‘const class torch::Tensor’
    105 |   if (!(target.sizes() == input.sizes())) {
        |         ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:105:27: error: invalid use of incomplete type ‘const class torch::Tensor’
    105 |   if (!(target.sizes() == input.sizes())) {
        |                           ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:108:9: error: invalid use of incomplete type ‘const class torch::Tensor’
    108 |         target.sizes(),
        |         ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:640:48: note: in definition of macro ‘WARNING_MESSAGE_STRING’
    640 | #define WARNING_MESSAGE_STRING(...) ::c10::str(__VA_ARGS__)
        |                                                ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:657:25: note: in expansion of macro ‘_TORCH_WARN_WITH’
    657 | #define TORCH_WARN(...) _TORCH_WARN_WITH(::c10::UserWarning, __VA_ARGS__);
        |                         ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:106:5: note: in expansion of macro ‘TORCH_WARN’
    106 |     TORCH_WARN(
        |     ^~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:110:9: error: invalid use of incomplete type ‘const class torch::Tensor’
    110 |         input.sizes(),
        |         ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:640:48: note: in definition of macro ‘WARNING_MESSAGE_STRING’
    640 | #define WARNING_MESSAGE_STRING(...) ::c10::str(__VA_ARGS__)
        |                                                ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:657:25: note: in expansion of macro ‘_TORCH_WARN_WITH’
    657 | #define TORCH_WARN(...) _TORCH_WARN_WITH(::c10::UserWarning, __VA_ARGS__);
        |                         ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:106:5: note: in expansion of macro ‘TORCH_WARN’
    106 |     TORCH_WARN(
        |     ^~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:116:31: error: could not convert ‘{input, target}’ from ‘<brace-enclosed initializer list>’ to ‘at::TensorList’ {aka ‘c10::ArrayRef<at::Tensor>’}
    116 |       torch::broadcast_tensors({input, target});
        |       ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
        |                               |
        |                               <brace-enclosed initializer list>
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:117:8: error: ‘torch::Tensor expanded_input’ has incomplete type
    117 |   auto expanded_input = broadcast_tensors[0];
        |        ^~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:118:8: error: ‘torch::Tensor expanded_target’ has incomplete type
    118 |   auto expanded_target = broadcast_tensors[1];
        |        ^~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:140:43: error: return type ‘class torch::Tensor’ is incomplete
    140 |     const MSELossFuncOptions& options = {}) {
        |                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:152:57: error: return type ‘class torch::Tensor’ is incomplete
    152 |     BinaryCrossEntropyFuncOptions::reduction_t reduction) {
        |                                                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::binary_cross_entropy(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::nn::BCELossOptions::reduction_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:155:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    155 |   if (target.sizes() != input.sizes()) {
        |       ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:155:25: error: invalid use of incomplete type ‘const class torch::Tensor’
    155 |   if (target.sizes() != input.sizes()) {
        |                         ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:159:9: error: invalid use of incomplete type ‘const class torch::Tensor’
    159 |         target.sizes(),
        |         ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:156:5: note: in expansion of macro ‘TORCH_CHECK’
    156 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:162:9: error: invalid use of incomplete type ‘const class torch::Tensor’
    162 |         input.sizes(),
        |         ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:156:5: note: in expansion of macro ‘TORCH_CHECK’
    156 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:167:8: error: ‘torch::Tensor weight_’ has incomplete type
    167 |   auto weight_ = weight;
        |        ^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:169:36: error: invalid use of incomplete type ‘const class torch::Tensor’
    169 |     auto new_size = at::infer_size(target.sizes(), weight_.sizes());
        |                                    ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:195:54: error: return type ‘class torch::Tensor’ is incomplete
    195 |     const BinaryCrossEntropyFuncOptions& options = {}) {
        |                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:208:57: error: return type ‘class torch::Tensor’ is incomplete
    208 |     HingeEmbeddingLossFuncOptions::reduction_t reduction) {
        |                                                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::hinge_embedding_loss(const torch::Tensor&, const torch::Tensor&, double, torch::nn::HingeEmbeddingLossOptions::reduction_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:210:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    210 |       input, target, margin, enumtype::reduction_get_enum(reduction));
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:786,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/hinge_embedding_loss.h:26:59: note: in passing argument 1 of ‘at::Tensor at::hinge_embedding_loss(const at::Tensor&, const at::Tensor&, double, int64_t)’
     26 | inline at::Tensor hinge_embedding_loss(const at::Tensor & self, const at::Tensor & target, double margin=1.0, int64_t reduction=at::Reduction::Mean) {
        |                                        ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:232:54: error: return type ‘class torch::Tensor’ is incomplete
    232 |     const HingeEmbeddingLossFuncOptions& options = {}) {
        |                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:247:54: error: return type ‘class torch::Tensor’ is incomplete
    247 |     MultiMarginLossFuncOptions::reduction_t reduction) {
        |                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::multi_margin_loss(const torch::Tensor&, const torch::Tensor&, int64_t, double, const torch::Tensor&, torch::nn::MultiMarginLossOptions::reduction_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:249:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    249 |   if (weight.defined()) {
        |       ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:250:17: error: invalid use of incomplete type ‘const class torch::Tensor’
    250 |     TORCH_CHECK(weight.dim() == 1, "weight must be one-dimensional");
        |                 ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:250:5: note: in expansion of macro ‘TORCH_CHECK’
    250 |     TORCH_CHECK(weight.dim() == 1, "weight must be one-dimensional");
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:254:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    254 |       input,
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:998,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/multi_margin_loss.h:35:56: note: in passing argument 1 of ‘at::Tensor at::multi_margin_loss(const at::Tensor&, const at::Tensor&, const c10::Scalar&, const c10::Scalar&, const std::optional<at::Tensor>&, int64_t)’
     35 | inline at::Tensor multi_margin_loss(const at::Tensor & self, const at::Tensor & target, const at::Scalar & p=1, const at::Scalar & margin=1, const ::std::optional<at::Tensor> & weight={}, int64_t reduction=at::Reduction::Mean) {
        |                                     ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:281:51: error: return type ‘class torch::Tensor’ is incomplete
    281 |     const MultiMarginLossFuncOptions& options = {}) {
        |                                                   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:300:58: error: return type ‘class torch::Tensor’ is incomplete
    300 |     CosineEmbeddingLossFuncOptions::reduction_t reduction) {
        |                                                          ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::cosine_embedding_loss(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, double, torch::nn::CosineEmbeddingLossOptions::reduction_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:302:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    302 |       input1, input2, target, margin, enumtype::reduction_get_enum(reduction));
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:611,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cosine_embedding_loss.h:26:60: note: in passing argument 1 of ‘at::Tensor at::cosine_embedding_loss(const at::Tensor&, const at::Tensor&, const at::Tensor&, double, int64_t)’
     26 | inline at::Tensor cosine_embedding_loss(const at::Tensor & input1, const at::Tensor & input2, const at::Tensor & target, double margin=0.0, int64_t reduction=at::Reduction::Mean) {
        |                                         ~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:325:55: error: return type ‘class torch::Tensor’ is incomplete
    325 |     const CosineEmbeddingLossFuncOptions& options = {}) {
        |                                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:335:21: error: return type ‘class torch::Tensor’ is incomplete
    335 |     double beta = 1.) {
        |                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::_smooth_l1_loss(const torch::Tensor&, const torch::Tensor&, double)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:336:29: error: no match for ‘operator-’ (operand types are ‘const torch::Tensor’ and ‘const torch::Tensor’)
    336 |   auto t = torch::abs(input - target);
        |                       ~~~~~ ^ ~~~~~~
        |                       |       |
        |                       |       const torch::Tensor
        |                       const torch::Tensor
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:358:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const c10::complex<U>&)’
    358 | constexpr complex<T> operator-(const complex<T>& val) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:358:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:336:31: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    336 |   auto t = torch::abs(input - target);
        |                               ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:380:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const c10::complex<U>&, const c10::complex<U>&)’
    380 | constexpr complex<T> operator-(const complex<T>& lhs, const complex<T>& rhs) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:380:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:336:31: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    336 |   auto t = torch::abs(input - target);
        |                               ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:386:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const c10::complex<U>&, const T&)’
    386 | constexpr complex<T> operator-(const complex<T>& lhs, const T& rhs) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:386:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:336:31: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    336 |   auto t = torch::abs(input - target);
        |                               ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:392:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const T&, const c10::complex<U>&)’
    392 | constexpr complex<T> operator-(const T& lhs, const complex<T>& rhs) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:392:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:336:31: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    336 |   auto t = torch::abs(input - target);
        |                               ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:453:28: note: candidate: ‘template<class fT, class iT, typename std::enable_if<(is_floating_point_v<fT> && is_integral_v<iT>), int>::type <anonymous> > constexpr c10::complex<U> c10::operator-(const c10::complex<U>&, const iT&)’
    453 | constexpr c10::complex<fT> operator-(const c10::complex<fT>& a, const iT& b) {
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:453:28: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:336:31: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    336 |   auto t = torch::abs(input - target);
        |                               ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:458:28: note: candidate: ‘template<class fT, class iT, typename std::enable_if<(is_floating_point_v<fT> && is_integral_v<iT>), int>::type <anonymous> > constexpr c10::complex<U> c10::operator-(const iT&, const c10::complex<U>&)’
    458 | constexpr c10::complex<fT> operator-(const iT& a, const c10::complex<fT>& b) {
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:458:28: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:336:31: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    336 |   auto t = torch::abs(input - target);
        |                               ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16.h:130,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:91:1: note: candidate: ‘c10::BFloat16 c10::operator-(const c10::BFloat16&, const c10::BFloat16&)’
     91 | operator-(const BFloat16& a, const BFloat16& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:91:27: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::BFloat16&’
     91 | operator-(const BFloat16& a, const BFloat16& b) {
        |           ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:105:33: note: candidate: ‘c10::BFloat16 c10::operator-(const c10::BFloat16&)’
    105 | inline C10_HOST_DEVICE BFloat16 operator-(const BFloat16& a) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:105:33: note:   candidate expects 1 argument, 2 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:149:30: note: candidate: ‘float c10::operator-(c10::BFloat16, float)’
    149 | inline C10_HOST_DEVICE float operator-(BFloat16 a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:149:49: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::BFloat16’
    149 | inline C10_HOST_DEVICE float operator-(BFloat16 a, float b) {
        |                                        ~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:162:30: note: candidate: ‘float c10::operator-(float, c10::BFloat16)’
    162 | inline C10_HOST_DEVICE float operator-(float a, BFloat16 b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:162:46: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘float’
    162 | inline C10_HOST_DEVICE float operator-(float a, BFloat16 b) {
        |                                        ~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:190:31: note: candidate: ‘double c10::operator-(c10::BFloat16, double)’
    190 | inline C10_HOST_DEVICE double operator-(BFloat16 a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:190:50: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::BFloat16’
    190 | inline C10_HOST_DEVICE double operator-(BFloat16 a, double b) {
        |                                         ~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:203:31: note: candidate: ‘double c10::operator-(double, c10::BFloat16)’
    203 | inline C10_HOST_DEVICE double operator-(double a, BFloat16 b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:203:48: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘double’
    203 | inline C10_HOST_DEVICE double operator-(double a, BFloat16 b) {
        |                                         ~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:218:33: note: candidate: ‘c10::BFloat16 c10::operator-(c10::BFloat16, int)’
    218 | inline C10_HOST_DEVICE BFloat16 operator-(BFloat16 a, int b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:218:52: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::BFloat16’
    218 | inline C10_HOST_DEVICE BFloat16 operator-(BFloat16 a, int b) {
        |                                           ~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:231:33: note: candidate: ‘c10::BFloat16 c10::operator-(int, c10::BFloat16)’
    231 | inline C10_HOST_DEVICE BFloat16 operator-(int a, BFloat16 b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:231:47: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘int’
    231 | inline C10_HOST_DEVICE BFloat16 operator-(int a, BFloat16 b) {
        |                                           ~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:246:33: note: candidate: ‘c10::BFloat16 c10::operator-(c10::BFloat16, int64_t)’
    246 | inline C10_HOST_DEVICE BFloat16 operator-(BFloat16 a, int64_t b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:246:52: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::BFloat16’
    246 | inline C10_HOST_DEVICE BFloat16 operator-(BFloat16 a, int64_t b) {
        |                                           ~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:259:33: note: candidate: ‘c10::BFloat16 c10::operator-(int64_t, c10::BFloat16)’
    259 | inline C10_HOST_DEVICE BFloat16 operator-(int64_t a, BFloat16 b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:259:51: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘int64_t’ {aka ‘long int’}
    259 | inline C10_HOST_DEVICE BFloat16 operator-(int64_t a, BFloat16 b) {
        |                                           ~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn.h:240,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:39:1: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(const c10::Float8_e4m3fn&, const c10::Float8_e4m3fn&)’
     39 | operator-(const Float8_e4m3fn& a, const Float8_e4m3fn& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:39:32: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Float8_e4m3fn&’
     39 | operator-(const Float8_e4m3fn& a, const Float8_e4m3fn& b) {
        |           ~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:54:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(const c10::Float8_e4m3fn&)’
     54 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(const Float8_e4m3fn& a) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:54:38: note:   candidate expects 1 argument, 2 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:91:30: note: candidate: ‘float c10::operator-(c10::Float8_e4m3fn, float)’
     91 | inline C10_HOST_DEVICE float operator-(Float8_e4m3fn a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:91:54: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Float8_e4m3fn’
     91 | inline C10_HOST_DEVICE float operator-(Float8_e4m3fn a, float b) {
        |                                        ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:105:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e4m3fn)’
    105 | inline C10_HOST_DEVICE float operator-(float a, Float8_e4m3fn b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:105:46: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘float’
    105 | inline C10_HOST_DEVICE float operator-(float a, Float8_e4m3fn b) {
        |                                        ~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:134:31: note: candidate: ‘double c10::operator-(c10::Float8_e4m3fn, double)’
    134 | inline C10_HOST_DEVICE double operator-(Float8_e4m3fn a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:134:55: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Float8_e4m3fn’
    134 | inline C10_HOST_DEVICE double operator-(Float8_e4m3fn a, double b) {
        |                                         ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:148:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e4m3fn)’
    148 | inline C10_HOST_DEVICE double operator-(double a, Float8_e4m3fn b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:148:48: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘double’
    148 | inline C10_HOST_DEVICE double operator-(double a, Float8_e4m3fn b) {
        |                                         ~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:164:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(c10::Float8_e4m3fn, int)’
    164 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(Float8_e4m3fn a, int b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:164:62: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Float8_e4m3fn’
    164 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(Float8_e4m3fn a, int b) {
        |                                                ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:177:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(int, c10::Float8_e4m3fn)’
    177 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(int a, Float8_e4m3fn b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:177:52: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘int’
    177 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(int a, Float8_e4m3fn b) {
        |                                                ~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:192:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(c10::Float8_e4m3fn, int64_t)’
    192 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(Float8_e4m3fn a, int64_t b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:192:62: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Float8_e4m3fn’
    192 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(Float8_e4m3fn a, int64_t b) {
        |                                                ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:205:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(int64_t, c10::Float8_e4m3fn)’
    205 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(int64_t a, Float8_e4m3fn b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:205:56: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘int64_t’ {aka ‘long int’}
    205 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(int64_t a, Float8_e4m3fn b) {
        |                                                ~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz.h:139,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:40:1: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(const c10::Float8_e4m3fnuz&, const c10::Float8_e4m3fnuz&)’
     40 | operator-(const Float8_e4m3fnuz& a, const Float8_e4m3fnuz& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:40:34: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Float8_e4m3fnuz&’
     40 | operator-(const Float8_e4m3fnuz& a, const Float8_e4m3fnuz& b) {
        |           ~~~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:55:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(const c10::Float8_e4m3fnuz&)’
     55 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(const Float8_e4m3fnuz& a) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:55:40: note:   candidate expects 1 argument, 2 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:92:30: note: candidate: ‘float c10::operator-(c10::Float8_e4m3fnuz, float)’
     92 | inline C10_HOST_DEVICE float operator-(Float8_e4m3fnuz a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:92:56: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Float8_e4m3fnuz’
     92 | inline C10_HOST_DEVICE float operator-(Float8_e4m3fnuz a, float b) {
        |                                        ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:106:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e4m3fnuz)’
    106 | inline C10_HOST_DEVICE float operator-(float a, Float8_e4m3fnuz b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:106:46: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘float’
    106 | inline C10_HOST_DEVICE float operator-(float a, Float8_e4m3fnuz b) {
        |                                        ~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:135:31: note: candidate: ‘double c10::operator-(c10::Float8_e4m3fnuz, double)’
    135 | inline C10_HOST_DEVICE double operator-(Float8_e4m3fnuz a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:135:57: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Float8_e4m3fnuz’
    135 | inline C10_HOST_DEVICE double operator-(Float8_e4m3fnuz a, double b) {
        |                                         ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:149:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e4m3fnuz)’
    149 | inline C10_HOST_DEVICE double operator-(double a, Float8_e4m3fnuz b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:149:48: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘double’
    149 | inline C10_HOST_DEVICE double operator-(double a, Float8_e4m3fnuz b) {
        |                                         ~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:165:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(c10::Float8_e4m3fnuz, int)’
    165 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(Float8_e4m3fnuz a, int b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:165:66: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Float8_e4m3fnuz’
    165 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(Float8_e4m3fnuz a, int b) {
        |                                                  ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:178:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(int, c10::Float8_e4m3fnuz)’
    178 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(int a, Float8_e4m3fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:178:54: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘int’
    178 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(int a, Float8_e4m3fnuz b) {
        |                                                  ~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:193:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(c10::Float8_e4m3fnuz, int64_t)’
    193 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(Float8_e4m3fnuz a, int64_t b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:193:66: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Float8_e4m3fnuz’
    193 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(Float8_e4m3fnuz a, int64_t b) {
        |                                                  ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:206:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(int64_t, c10::Float8_e4m3fnuz)’
    206 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(int64_t a, Float8_e4m3fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:206:58: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘int64_t’ {aka ‘long int’}
    206 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(int64_t a, Float8_e4m3fnuz b) {
        |                                                  ~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half.h:423,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:111:29: note: candidate: ‘c10::Half c10::operator-(const c10::Half&, const c10::Half&)’
    111 | inline C10_HOST_DEVICE Half operator-(const Half& a, const Half& b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:111:51: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Half&’
    111 | inline C10_HOST_DEVICE Half operator-(const Half& a, const Half& b) {
        |                                       ~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:124:29: note: candidate: ‘c10::Half c10::operator-(const c10::Half&)’
    124 | inline C10_HOST_DEVICE Half operator-(const Half& a) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:124:29: note:   candidate expects 1 argument, 2 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:160:30: note: candidate: ‘float c10::operator-(c10::Half, float)’
    160 | inline C10_HOST_DEVICE float operator-(Half a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:160:45: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Half’
    160 | inline C10_HOST_DEVICE float operator-(Half a, float b) {
        |                                        ~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:174:30: note: candidate: ‘float c10::operator-(float, c10::Half)’
    174 | inline C10_HOST_DEVICE float operator-(float a, Half b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:174:46: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘float’
    174 | inline C10_HOST_DEVICE float operator-(float a, Half b) {
        |                                        ~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:203:31: note: candidate: ‘double c10::operator-(c10::Half, double)’
    203 | inline C10_HOST_DEVICE double operator-(Half a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:203:46: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Half’
    203 | inline C10_HOST_DEVICE double operator-(Half a, double b) {
        |                                         ~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:217:31: note: candidate: ‘double c10::operator-(double, c10::Half)’
    217 | inline C10_HOST_DEVICE double operator-(double a, Half b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:217:48: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘double’
    217 | inline C10_HOST_DEVICE double operator-(double a, Half b) {
        |                                         ~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:233:29: note: candidate: ‘c10::Half c10::operator-(c10::Half, int)’
    233 | inline C10_HOST_DEVICE Half operator-(Half a, int b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:233:44: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Half’
    233 | inline C10_HOST_DEVICE Half operator-(Half a, int b) {
        |                                       ~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:246:29: note: candidate: ‘c10::Half c10::operator-(int, c10::Half)’
    246 | inline C10_HOST_DEVICE Half operator-(int a, Half b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:246:43: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘int’
    246 | inline C10_HOST_DEVICE Half operator-(int a, Half b) {
        |                                       ~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:261:29: note: candidate: ‘c10::Half c10::operator-(c10::Half, int64_t)’
    261 | inline C10_HOST_DEVICE Half operator-(Half a, int64_t b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:261:44: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Half’
    261 | inline C10_HOST_DEVICE Half operator-(Half a, int64_t b) {
        |                                       ~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:274:29: note: candidate: ‘c10::Half c10::operator-(int64_t, c10::Half)’
    274 | inline C10_HOST_DEVICE Half operator-(int64_t a, Half b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:274:47: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘int64_t’ {aka ‘long int’}
    274 | inline C10_HOST_DEVICE Half operator-(int64_t a, Half b) {
        |                                       ~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2.h:148,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:47:1: note: candidate: ‘c10::Float8_e5m2 c10::operator-(const c10::Float8_e5m2&, const c10::Float8_e5m2&)’
     47 | operator-(const Float8_e5m2& a, const Float8_e5m2& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:47:30: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Float8_e5m2&’
     47 | operator-(const Float8_e5m2& a, const Float8_e5m2& b) {
        |           ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:62:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(const c10::Float8_e5m2&)’
     62 | inline C10_HOST_DEVICE Float8_e5m2 operator-(const Float8_e5m2& a) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:62:36: note:   candidate expects 1 argument, 2 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:99:30: note: candidate: ‘float c10::operator-(c10::Float8_e5m2, float)’
     99 | inline C10_HOST_DEVICE float operator-(Float8_e5m2 a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:99:52: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Float8_e5m2’
     99 | inline C10_HOST_DEVICE float operator-(Float8_e5m2 a, float b) {
        |                                        ~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:113:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e5m2)’
    113 | inline C10_HOST_DEVICE float operator-(float a, Float8_e5m2 b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:113:46: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘float’
    113 | inline C10_HOST_DEVICE float operator-(float a, Float8_e5m2 b) {
        |                                        ~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:142:31: note: candidate: ‘double c10::operator-(c10::Float8_e5m2, double)’
    142 | inline C10_HOST_DEVICE double operator-(Float8_e5m2 a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:142:53: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Float8_e5m2’
    142 | inline C10_HOST_DEVICE double operator-(Float8_e5m2 a, double b) {
        |                                         ~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:156:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e5m2)’
    156 | inline C10_HOST_DEVICE double operator-(double a, Float8_e5m2 b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:156:48: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘double’
    156 | inline C10_HOST_DEVICE double operator-(double a, Float8_e5m2 b) {
        |                                         ~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:172:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(c10::Float8_e5m2, int)’
    172 | inline C10_HOST_DEVICE Float8_e5m2 operator-(Float8_e5m2 a, int b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:172:58: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Float8_e5m2’
    172 | inline C10_HOST_DEVICE Float8_e5m2 operator-(Float8_e5m2 a, int b) {
        |                                              ~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:185:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(int, c10::Float8_e5m2)’
    185 | inline C10_HOST_DEVICE Float8_e5m2 operator-(int a, Float8_e5m2 b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:185:50: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘int’
    185 | inline C10_HOST_DEVICE Float8_e5m2 operator-(int a, Float8_e5m2 b) {
        |                                              ~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:200:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(c10::Float8_e5m2, int64_t)’
    200 | inline C10_HOST_DEVICE Float8_e5m2 operator-(Float8_e5m2 a, int64_t b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:200:58: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Float8_e5m2’
    200 | inline C10_HOST_DEVICE Float8_e5m2 operator-(Float8_e5m2 a, int64_t b) {
        |                                              ~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:213:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(int64_t, c10::Float8_e5m2)’
    213 | inline C10_HOST_DEVICE Float8_e5m2 operator-(int64_t a, Float8_e5m2 b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:213:54: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘int64_t’ {aka ‘long int’}
    213 | inline C10_HOST_DEVICE Float8_e5m2 operator-(int64_t a, Float8_e5m2 b) {
        |                                              ~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz.h:138,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:44:1: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(const c10::Float8_e5m2fnuz&, const c10::Float8_e5m2fnuz&)’
     44 | operator-(const Float8_e5m2fnuz& a, const Float8_e5m2fnuz& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:44:34: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Float8_e5m2fnuz&’
     44 | operator-(const Float8_e5m2fnuz& a, const Float8_e5m2fnuz& b) {
        |           ~~~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:59:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(const c10::Float8_e5m2fnuz&)’
     59 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(const Float8_e5m2fnuz& a) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:59:40: note:   candidate expects 1 argument, 2 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:96:30: note: candidate: ‘float c10::operator-(c10::Float8_e5m2fnuz, float)’
     96 | inline C10_HOST_DEVICE float operator-(Float8_e5m2fnuz a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:96:56: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Float8_e5m2fnuz’
     96 | inline C10_HOST_DEVICE float operator-(Float8_e5m2fnuz a, float b) {
        |                                        ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:110:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e5m2fnuz)’
    110 | inline C10_HOST_DEVICE float operator-(float a, Float8_e5m2fnuz b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:110:46: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘float’
    110 | inline C10_HOST_DEVICE float operator-(float a, Float8_e5m2fnuz b) {
        |                                        ~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:139:31: note: candidate: ‘double c10::operator-(c10::Float8_e5m2fnuz, double)’
    139 | inline C10_HOST_DEVICE double operator-(Float8_e5m2fnuz a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:139:57: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Float8_e5m2fnuz’
    139 | inline C10_HOST_DEVICE double operator-(Float8_e5m2fnuz a, double b) {
        |                                         ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:153:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e5m2fnuz)’
    153 | inline C10_HOST_DEVICE double operator-(double a, Float8_e5m2fnuz b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:153:48: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘double’
    153 | inline C10_HOST_DEVICE double operator-(double a, Float8_e5m2fnuz b) {
        |                                         ~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:169:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(c10::Float8_e5m2fnuz, int)’
    169 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(Float8_e5m2fnuz a, int b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:169:66: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Float8_e5m2fnuz’
    169 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(Float8_e5m2fnuz a, int b) {
        |                                                  ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:182:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(int, c10::Float8_e5m2fnuz)’
    182 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(int a, Float8_e5m2fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:182:54: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘int’
    182 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(int a, Float8_e5m2fnuz b) {
        |                                                  ~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:197:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(c10::Float8_e5m2fnuz, int64_t)’
    197 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(Float8_e5m2fnuz a, int64_t b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:197:66: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘c10::Float8_e5m2fnuz’
    197 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(Float8_e5m2fnuz a, int64_t b) {
        |                                                  ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:210:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(int64_t, c10::Float8_e5m2fnuz)’
    210 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(int64_t a, Float8_e5m2fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:210:58: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘int64_t’ {aka ‘long int’}
    210 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(int64_t a, Float8_e5m2fnuz b) {
        |                                                  ~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, int64_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:41: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::SymInt&’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                           ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:350:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    350 | DECLARE_SYMINT_OP(int64_t, SymInt)
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(int64_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:36: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘int64_t’ {aka ‘long int’}
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:350:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    350 | DECLARE_SYMINT_OP(int64_t, SymInt)
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, int32_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:41: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::SymInt&’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                           ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:351:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    351 | DECLARE_SYMINT_OP(int32_t, SymInt) // make sure constants work
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(int32_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:36: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘int32_t’ {aka ‘int’}
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:351:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    351 | DECLARE_SYMINT_OP(int32_t, SymInt) // make sure constants work
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, uint64_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:41: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::SymInt&’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                           ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:352:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    352 | DECLARE_SYMINT_OP(uint64_t, SymInt)
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(uint64_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:36: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘uint64_t’ {aka ‘long unsigned int’}
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:352:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    352 | DECLARE_SYMINT_OP(uint64_t, SymInt)
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, uint32_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:41: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::SymInt&’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                           ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:353:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    353 | DECLARE_SYMINT_OP(uint32_t, SymInt)
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(uint32_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:36: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘uint32_t’ {aka ‘unsigned int’}
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:353:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    353 | DECLARE_SYMINT_OP(uint32_t, SymInt)
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymFloat c10::operator-(const c10::SymInt&, double)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:41: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::SymInt&’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                           ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:354:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    354 | DECLARE_SYMINT_OP(double, SymFloat)
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymFloat c10::operator-(double, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:36: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘double’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:354:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    354 | DECLARE_SYMINT_OP(double, SymFloat)
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymFloat c10::operator-(const c10::SymInt&, float)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:41: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::SymInt&’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                           ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:355:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    355 | DECLARE_SYMINT_OP(float, SymFloat) // just for completeness
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymFloat c10::operator-(float, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:36: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘float’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:355:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    355 | DECLARE_SYMINT_OP(float, SymFloat) // just for completeness
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:367:16: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&)’
    367 | C10_API SymInt operator-(const SymInt& s);
        |                ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:367:16: note:   candidate expects 1 argument, 2 provided
  In file included from /usr/local/cuda/include/cuda_fp16.h:5293,
                   from /usr/local/cuda/include/cublas_api.h:77,
                   from /usr/local/cuda/include/cublas_v2.h:69,
                   from /workspace/nunchaku/src/common.h:23,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/local/cuda/include/cuda_fp16.hpp:222:54: note: candidate: ‘__half operator-(const __half&, const __half&)’
    222 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half operator-(const __half &lh, const __half &rh) { return __hsub(lh, rh); }
        |                                                      ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:222:78: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const __half&’
    222 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half operator-(const __half &lh, const __half &rh) { return __hsub(lh, rh); }
        |                                                                ~~~~~~~~~~~~~~^~
  /usr/local/cuda/include/cuda_fp16.hpp:254:54: note: candidate: ‘__half operator-(const __half&)’
    254 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half operator-(const __half &h) { return __hneg(h); }
        |                                                      ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:254:54: note:   candidate expects 1 argument, 2 provided
  /usr/local/cuda/include/cuda_fp16.hpp:308:55: note: candidate: ‘__half2 operator-(const __half2&, const __half2&)’
    308 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half2 operator-(const __half2 &lh, const __half2 &rh) { return __hsub2(lh, rh); }
        |                                                       ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:308:80: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const __half2&’
    308 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half2 operator-(const __half2 &lh, const __half2 &rh) { return __hsub2(lh, rh); }
        |                                                                 ~~~~~~~~~~~~~~~^~
  /usr/local/cuda/include/cuda_fp16.hpp:342:55: note: candidate: ‘__half2 operator-(const __half2&)’
    342 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half2 operator-(const __half2 &h) { return __hneg2(h); }
        |                                                       ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:342:55: note:   candidate expects 1 argument, 2 provided
  In file included from /usr/local/cuda/include/cuda_bf16.h:5079,
                   from /usr/local/cuda/include/cublas_api.h:78,
                   from /usr/local/cuda/include/cublas_v2.h:69,
                   from /workspace/nunchaku/src/common.h:23,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/local/cuda/include/cuda_bf16.hpp:203:61: note: candidate: ‘__nv_bfloat16 operator-(const __nv_bfloat16&, const __nv_bfloat16&)’
    203 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat16 operator-(const __nv_bfloat16 &lh, const __nv_bfloat16 &rh) { return __hsub(lh, rh); }
        |                                                             ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:203:92: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const __nv_bfloat16&’
    203 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat16 operator-(const __nv_bfloat16 &lh, const __nv_bfloat16 &rh) { return __hsub(lh, rh); }
        |                                                                       ~~~~~~~~~~~~~~~~~~~~~^~
  /usr/local/cuda/include/cuda_bf16.hpp:235:61: note: candidate: ‘__nv_bfloat16 operator-(const __nv_bfloat16&)’
    235 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat16 operator-(const __nv_bfloat16 &h) { return __hneg(h); }
        |                                                             ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:235:61: note:   candidate expects 1 argument, 2 provided
  /usr/local/cuda/include/cuda_bf16.hpp:320:62: note: candidate: ‘__nv_bfloat162 operator-(const __nv_bfloat162&, const __nv_bfloat162&)’
    320 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat162 operator-(const __nv_bfloat162 &lh, const __nv_bfloat162 &rh) { return __hsub2(lh, rh); }
        |                                                              ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:320:94: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const __nv_bfloat162&’
    320 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat162 operator-(const __nv_bfloat162 &lh, const __nv_bfloat162 &rh) { return __hsub2(lh, rh); }
        |                                                                        ~~~~~~~~~~~~~~~~~~~~~~^~
  /usr/local/cuda/include/cuda_bf16.hpp:354:62: note: candidate: ‘__nv_bfloat162 operator-(const __nv_bfloat162&)’
    354 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat162 operator-(const __nv_bfloat162 &h) { return __hneg2(h); }
        |                                                              ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:354:62: note:   candidate expects 1 argument, 2 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ATen.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:17: note: candidate: ‘at::Tensor at::operator-(const at::Tensor&, const at::Tensor&)’
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:17: note: in definition of macro ‘DEFINE_OPERATOR’
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:43: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                             ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:17:3: note: in expansion of macro ‘DEFINE_OPERATOR’
     17 |   _(-,                                                                      \
        |   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:17: note: candidate: ‘at::Tensor at::operator-(const at::Tensor&, const c10::Scalar&)’
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:17: note: in definition of macro ‘DEFINE_OPERATOR’
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:43: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                             ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:17:3: note: in expansion of macro ‘DEFINE_OPERATOR’
     17 |   _(-,                                                                      \
        |   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:17: note: candidate: ‘at::Tensor at::operator-(const c10::Scalar&, const at::Tensor&)’
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:17: note: in definition of macro ‘DEFINE_OPERATOR’
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:43: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                             ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:17:3: note: in expansion of macro ‘DEFINE_OPERATOR’
     17 |   _(-,                                                                      \
        |   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:346:50: error: return type ‘class torch::Tensor’ is incomplete
    346 |     std::optional<double> beta_opt = std::nullopt) {
        |                                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::smooth_l1_loss(const torch::Tensor&, const torch::Tensor&, torch::nn::SmoothL1LossOptions::reduction_t, std::optional<double>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:347:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    347 |   if (target.sizes() != input.sizes()) {
        |       ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:347:25: error: invalid use of incomplete type ‘const class torch::Tensor’
    347 |   if (target.sizes() != input.sizes()) {
        |                         ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:350:9: error: invalid use of incomplete type ‘const class torch::Tensor’
    350 |         target.sizes(),
        |         ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:640:48: note: in definition of macro ‘WARNING_MESSAGE_STRING’
    640 | #define WARNING_MESSAGE_STRING(...) ::c10::str(__VA_ARGS__)
        |                                                ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:657:25: note: in expansion of macro ‘_TORCH_WARN_WITH’
    657 | #define TORCH_WARN(...) _TORCH_WARN_WITH(::c10::UserWarning, __VA_ARGS__);
        |                         ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:348:5: note: in expansion of macro ‘TORCH_WARN’
    348 |     TORCH_WARN(
        |     ^~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:352:9: error: invalid use of incomplete type ‘const class torch::Tensor’
    352 |         input.sizes(),
        |         ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:640:48: note: in definition of macro ‘WARNING_MESSAGE_STRING’
    640 | #define WARNING_MESSAGE_STRING(...) ::c10::str(__VA_ARGS__)
        |                                                ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:657:25: note: in expansion of macro ‘_TORCH_WARN_WITH’
    657 | #define TORCH_WARN(...) _TORCH_WARN_WITH(::c10::UserWarning, __VA_ARGS__);
        |                         ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:348:5: note: in expansion of macro ‘TORCH_WARN’
    348 |     TORCH_WARN(
        |     ^~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:360:31: error: could not convert ‘{input, target}’ from ‘<brace-enclosed initializer list>’ to ‘at::TensorList’ {aka ‘c10::ArrayRef<at::Tensor>’}
    360 |       torch::broadcast_tensors({input, target});
        |       ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
        |                               |
        |                               <brace-enclosed initializer list>
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:361:31: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘__gnu_cxx::__alloc_traits<std::allocator<torch::Tensor>, torch::Tensor>::value_type’ {aka ‘torch::Tensor’}
    361 |   return torch::smooth_l1_loss(
        |          ~~~~~~~~~~~~~~~~~~~~~^
    362 |       expanded_tensors[0],
        |       ~~~~~~~~~~~~~~~~~~~~
    363 |       expanded_tensors[1],
        |       ~~~~~~~~~~~~~~~~~~~~
    364 |       enumtype::reduction_get_enum(reduction),
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    365 |       beta);
        |       ~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1197,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/smooth_l1_loss.h:35:53: note: in passing argument 1 of ‘at::Tensor at::smooth_l1_loss(const at::Tensor&, const at::Tensor&, int64_t, double)’
     35 | inline at::Tensor smooth_l1_loss(const at::Tensor & self, const at::Tensor & target, int64_t reduction=at::Reduction::Mean, double beta=1.0) {
        |                                  ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:385:48: error: return type ‘class torch::Tensor’ is incomplete
    385 |     const SmoothL1LossFuncOptions& options = {}) {
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:403:16: error: return type ‘class torch::Tensor’ is incomplete
    403 |     double beta) {
        |                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:419:22: error: return type ‘class torch::Tensor’ is incomplete
    419 |     double delta = 1.) {
        |                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::huber_loss(const torch::Tensor&, const torch::Tensor&, torch::nn::HuberLossOptions::reduction_t, double)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:420:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    420 |   if (target.sizes() != input.sizes()) {
        |       ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:420:25: error: invalid use of incomplete type ‘const class torch::Tensor’
    420 |   if (target.sizes() != input.sizes()) {
        |                         ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:423:9: error: invalid use of incomplete type ‘const class torch::Tensor’
    423 |         target.sizes(),
        |         ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:640:48: note: in definition of macro ‘WARNING_MESSAGE_STRING’
    640 | #define WARNING_MESSAGE_STRING(...) ::c10::str(__VA_ARGS__)
        |                                                ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:657:25: note: in expansion of macro ‘_TORCH_WARN_WITH’
    657 | #define TORCH_WARN(...) _TORCH_WARN_WITH(::c10::UserWarning, __VA_ARGS__);
        |                         ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:421:5: note: in expansion of macro ‘TORCH_WARN’
    421 |     TORCH_WARN(
        |     ^~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:425:9: error: invalid use of incomplete type ‘const class torch::Tensor’
    425 |         input.sizes(),
        |         ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:640:48: note: in definition of macro ‘WARNING_MESSAGE_STRING’
    640 | #define WARNING_MESSAGE_STRING(...) ::c10::str(__VA_ARGS__)
        |                                                ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:657:25: note: in expansion of macro ‘_TORCH_WARN_WITH’
    657 | #define TORCH_WARN(...) _TORCH_WARN_WITH(::c10::UserWarning, __VA_ARGS__);
        |                         ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:421:5: note: in expansion of macro ‘TORCH_WARN’
    421 |     TORCH_WARN(
        |     ^~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:432:31: error: could not convert ‘{input, target}’ from ‘<brace-enclosed initializer list>’ to ‘at::TensorList’ {aka ‘c10::ArrayRef<at::Tensor>’}
    432 |       torch::broadcast_tensors({input, target});
        |       ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
        |                               |
        |                               <brace-enclosed initializer list>
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:433:27: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘__gnu_cxx::__alloc_traits<std::allocator<torch::Tensor>, torch::Tensor>::value_type’ {aka ‘torch::Tensor’}
    433 |   return torch::huber_loss(
        |          ~~~~~~~~~~~~~~~~~^
    434 |       expanded_tensors[0],
        |       ~~~~~~~~~~~~~~~~~~~~
    435 |       expanded_tensors[1],
        |       ~~~~~~~~~~~~~~~~~~~~
    436 |       enumtype::reduction_get_enum(reduction),
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    437 |       delta);
        |       ~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:793,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/huber_loss.h:35:49: note: in passing argument 1 of ‘at::Tensor at::huber_loss(const at::Tensor&, const at::Tensor&, int64_t, double)’
     35 | inline at::Tensor huber_loss(const at::Tensor & self, const at::Tensor & target, int64_t reduction=at::Reduction::Mean, double delta=1.0) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:458:45: error: return type ‘class torch::Tensor’ is incomplete
    458 |     const HuberLossFuncOptions& options = {}) {
        |                                             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:470:59: error: return type ‘class torch::Tensor’ is incomplete
    470 |     MultilabelMarginLossFuncOptions::reduction_t reduction) {
        |                                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::multilabel_margin_loss(const torch::Tensor&, const torch::Tensor&, torch::nn::MultiLabelMarginLossOptions::reduction_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:472:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    472 |       input, target, enumtype::reduction_get_enum(reduction));
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1000,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/multilabel_margin_loss.h:35:61: note: in passing argument 1 of ‘at::Tensor at::multilabel_margin_loss(const at::Tensor&, const at::Tensor&, int64_t)’
     35 | inline at::Tensor multilabel_margin_loss(const at::Tensor & self, const at::Tensor & target, int64_t reduction=at::Reduction::Mean) {
        |                                          ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:494:56: error: return type ‘class torch::Tensor’ is incomplete
    494 |     const MultilabelMarginLossFuncOptions& options = {}) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:505:53: error: return type ‘class torch::Tensor’ is incomplete
    505 |     SoftMarginLossFuncOptions::reduction_t reduction) {
        |                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::soft_margin_loss(const torch::Tensor&, const torch::Tensor&, torch::nn::SoftMarginLossOptions::reduction_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:507:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    507 |       input, target, enumtype::reduction_get_enum(reduction));
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1199,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/soft_margin_loss.h:35:55: note: in passing argument 1 of ‘at::Tensor at::soft_margin_loss(const at::Tensor&, const at::Tensor&, int64_t)’
     35 | inline at::Tensor soft_margin_loss(const at::Tensor & self, const at::Tensor & target, int64_t reduction=at::Reduction::Mean) {
        |                                    ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:528:50: error: return type ‘class torch::Tensor’ is incomplete
    528 |     const SoftMarginLossFuncOptions& options = {}) {
        |                                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:540:63: error: return type ‘class torch::Tensor’ is incomplete
    540 |     MultilabelSoftMarginLossFuncOptions::reduction_t reduction) {
        |                                                               ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::multilabel_soft_margin_loss(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::nn::MultiLabelSoftMarginLossOptions::reduction_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:542:37: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    542 |       -(target * torch::log_sigmoid(input) +
        |                                     ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:907,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/log_sigmoid.h:35:50: note: in passing argument 1 of ‘at::Tensor at::log_sigmoid(const at::Tensor&)’
     35 | inline at::Tensor log_sigmoid(const at::Tensor & self) {
        |                               ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:543:12: error: no match for ‘operator-’ (operand types are ‘int’ and ‘const torch::Tensor’)
    543 |         (1 - target) * torch::log_sigmoid(-input));
        |          ~ ^ ~~~~~~
        |          |   |
        |          int const torch::Tensor
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:358:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const c10::complex<U>&)’
    358 | constexpr complex<T> operator-(const complex<T>& val) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:358:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:543:14: note:   mismatched types ‘const c10::complex<U>’ and ‘int’
    543 |         (1 - target) * torch::log_sigmoid(-input));
        |              ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:380:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const c10::complex<U>&, const c10::complex<U>&)’
    380 | constexpr complex<T> operator-(const complex<T>& lhs, const complex<T>& rhs) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:380:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:543:14: note:   mismatched types ‘const c10::complex<U>’ and ‘int’
    543 |         (1 - target) * torch::log_sigmoid(-input));
        |              ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:386:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const c10::complex<U>&, const T&)’
    386 | constexpr complex<T> operator-(const complex<T>& lhs, const T& rhs) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:386:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:543:14: note:   mismatched types ‘const c10::complex<U>’ and ‘int’
    543 |         (1 - target) * torch::log_sigmoid(-input));
        |              ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:392:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const T&, const c10::complex<U>&)’
    392 | constexpr complex<T> operator-(const T& lhs, const complex<T>& rhs) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:392:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:543:14: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    543 |         (1 - target) * torch::log_sigmoid(-input));
        |              ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:453:28: note: candidate: ‘template<class fT, class iT, typename std::enable_if<(is_floating_point_v<fT> && is_integral_v<iT>), int>::type <anonymous> > constexpr c10::complex<U> c10::operator-(const c10::complex<U>&, const iT&)’
    453 | constexpr c10::complex<fT> operator-(const c10::complex<fT>& a, const iT& b) {
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:453:28: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:543:14: note:   mismatched types ‘const c10::complex<U>’ and ‘int’
    543 |         (1 - target) * torch::log_sigmoid(-input));
        |              ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:458:28: note: candidate: ‘template<class fT, class iT, typename std::enable_if<(is_floating_point_v<fT> && is_integral_v<iT>), int>::type <anonymous> > constexpr c10::complex<U> c10::operator-(const iT&, const c10::complex<U>&)’
    458 | constexpr c10::complex<fT> operator-(const iT& a, const c10::complex<fT>& b) {
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:458:28: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:543:14: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    543 |         (1 - target) * torch::log_sigmoid(-input));
        |              ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16.h:130,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:91:1: note: candidate: ‘c10::BFloat16 c10::operator-(const c10::BFloat16&, const c10::BFloat16&)’
     91 | operator-(const BFloat16& a, const BFloat16& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:91:46: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const c10::BFloat16&’
     91 | operator-(const BFloat16& a, const BFloat16& b) {
        |                              ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:105:33: note: candidate: ‘c10::BFloat16 c10::operator-(const c10::BFloat16&)’
    105 | inline C10_HOST_DEVICE BFloat16 operator-(const BFloat16& a) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:105:33: note:   candidate expects 1 argument, 2 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:149:30: note: candidate: ‘float c10::operator-(c10::BFloat16, float)’
    149 | inline C10_HOST_DEVICE float operator-(BFloat16 a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:149:58: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘float’
    149 | inline C10_HOST_DEVICE float operator-(BFloat16 a, float b) {
        |                                                    ~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:162:30: note: candidate: ‘float c10::operator-(float, c10::BFloat16)’
    162 | inline C10_HOST_DEVICE float operator-(float a, BFloat16 b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:162:58: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::BFloat16’
    162 | inline C10_HOST_DEVICE float operator-(float a, BFloat16 b) {
        |                                                 ~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:190:31: note: candidate: ‘double c10::operator-(c10::BFloat16, double)’
    190 | inline C10_HOST_DEVICE double operator-(BFloat16 a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:190:60: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘double’
    190 | inline C10_HOST_DEVICE double operator-(BFloat16 a, double b) {
        |                                                     ~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:203:31: note: candidate: ‘double c10::operator-(double, c10::BFloat16)’
    203 | inline C10_HOST_DEVICE double operator-(double a, BFloat16 b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:203:60: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::BFloat16’
    203 | inline C10_HOST_DEVICE double operator-(double a, BFloat16 b) {
        |                                                   ~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:218:33: note: candidate: ‘c10::BFloat16 c10::operator-(c10::BFloat16, int)’
    218 | inline C10_HOST_DEVICE BFloat16 operator-(BFloat16 a, int b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:218:59: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘int’
    218 | inline C10_HOST_DEVICE BFloat16 operator-(BFloat16 a, int b) {
        |                                                       ~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:231:33: note: candidate: ‘c10::BFloat16 c10::operator-(int, c10::BFloat16)’
    231 | inline C10_HOST_DEVICE BFloat16 operator-(int a, BFloat16 b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:231:59: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::BFloat16’
    231 | inline C10_HOST_DEVICE BFloat16 operator-(int a, BFloat16 b) {
        |                                                  ~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:246:33: note: candidate: ‘c10::BFloat16 c10::operator-(c10::BFloat16, int64_t)’
    246 | inline C10_HOST_DEVICE BFloat16 operator-(BFloat16 a, int64_t b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:246:63: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘int64_t’ {aka ‘long int’}
    246 | inline C10_HOST_DEVICE BFloat16 operator-(BFloat16 a, int64_t b) {
        |                                                       ~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:259:33: note: candidate: ‘c10::BFloat16 c10::operator-(int64_t, c10::BFloat16)’
    259 | inline C10_HOST_DEVICE BFloat16 operator-(int64_t a, BFloat16 b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:259:63: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::BFloat16’
    259 | inline C10_HOST_DEVICE BFloat16 operator-(int64_t a, BFloat16 b) {
        |                                                      ~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn.h:240,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:39:1: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(const c10::Float8_e4m3fn&, const c10::Float8_e4m3fn&)’
     39 | operator-(const Float8_e4m3fn& a, const Float8_e4m3fn& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:39:56: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const c10::Float8_e4m3fn&’
     39 | operator-(const Float8_e4m3fn& a, const Float8_e4m3fn& b) {
        |                                   ~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:54:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(const c10::Float8_e4m3fn&)’
     54 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(const Float8_e4m3fn& a) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:54:38: note:   candidate expects 1 argument, 2 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:91:30: note: candidate: ‘float c10::operator-(c10::Float8_e4m3fn, float)’
     91 | inline C10_HOST_DEVICE float operator-(Float8_e4m3fn a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:91:63: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘float’
     91 | inline C10_HOST_DEVICE float operator-(Float8_e4m3fn a, float b) {
        |                                                         ~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:105:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e4m3fn)’
    105 | inline C10_HOST_DEVICE float operator-(float a, Float8_e4m3fn b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:105:63: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Float8_e4m3fn’
    105 | inline C10_HOST_DEVICE float operator-(float a, Float8_e4m3fn b) {
        |                                                 ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:134:31: note: candidate: ‘double c10::operator-(c10::Float8_e4m3fn, double)’
    134 | inline C10_HOST_DEVICE double operator-(Float8_e4m3fn a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:134:65: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘double’
    134 | inline C10_HOST_DEVICE double operator-(Float8_e4m3fn a, double b) {
        |                                                          ~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:148:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e4m3fn)’
    148 | inline C10_HOST_DEVICE double operator-(double a, Float8_e4m3fn b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:148:65: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Float8_e4m3fn’
    148 | inline C10_HOST_DEVICE double operator-(double a, Float8_e4m3fn b) {
        |                                                   ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:164:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(c10::Float8_e4m3fn, int)’
    164 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(Float8_e4m3fn a, int b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:164:69: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘int’
    164 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(Float8_e4m3fn a, int b) {
        |                                                                 ~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:177:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(int, c10::Float8_e4m3fn)’
    177 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(int a, Float8_e4m3fn b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:177:69: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Float8_e4m3fn’
    177 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(int a, Float8_e4m3fn b) {
        |                                                       ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:192:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(c10::Float8_e4m3fn, int64_t)’
    192 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(Float8_e4m3fn a, int64_t b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:192:73: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘int64_t’ {aka ‘long int’}
    192 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(Float8_e4m3fn a, int64_t b) {
        |                                                                 ~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:205:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(int64_t, c10::Float8_e4m3fn)’
    205 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(int64_t a, Float8_e4m3fn b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:205:73: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Float8_e4m3fn’
    205 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(int64_t a, Float8_e4m3fn b) {
        |                                                           ~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz.h:139,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:40:1: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(const c10::Float8_e4m3fnuz&, const c10::Float8_e4m3fnuz&)’
     40 | operator-(const Float8_e4m3fnuz& a, const Float8_e4m3fnuz& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:40:60: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const c10::Float8_e4m3fnuz&’
     40 | operator-(const Float8_e4m3fnuz& a, const Float8_e4m3fnuz& b) {
        |                                     ~~~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:55:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(const c10::Float8_e4m3fnuz&)’
     55 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(const Float8_e4m3fnuz& a) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:55:40: note:   candidate expects 1 argument, 2 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:92:30: note: candidate: ‘float c10::operator-(c10::Float8_e4m3fnuz, float)’
     92 | inline C10_HOST_DEVICE float operator-(Float8_e4m3fnuz a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:92:65: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘float’
     92 | inline C10_HOST_DEVICE float operator-(Float8_e4m3fnuz a, float b) {
        |                                                           ~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:106:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e4m3fnuz)’
    106 | inline C10_HOST_DEVICE float operator-(float a, Float8_e4m3fnuz b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:106:65: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Float8_e4m3fnuz’
    106 | inline C10_HOST_DEVICE float operator-(float a, Float8_e4m3fnuz b) {
        |                                                 ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:135:31: note: candidate: ‘double c10::operator-(c10::Float8_e4m3fnuz, double)’
    135 | inline C10_HOST_DEVICE double operator-(Float8_e4m3fnuz a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:135:67: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘double’
    135 | inline C10_HOST_DEVICE double operator-(Float8_e4m3fnuz a, double b) {
        |                                                            ~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:149:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e4m3fnuz)’
    149 | inline C10_HOST_DEVICE double operator-(double a, Float8_e4m3fnuz b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:149:67: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Float8_e4m3fnuz’
    149 | inline C10_HOST_DEVICE double operator-(double a, Float8_e4m3fnuz b) {
        |                                                   ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:165:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(c10::Float8_e4m3fnuz, int)’
    165 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(Float8_e4m3fnuz a, int b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:165:73: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘int’
    165 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(Float8_e4m3fnuz a, int b) {
        |                                                                     ~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:178:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(int, c10::Float8_e4m3fnuz)’
    178 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(int a, Float8_e4m3fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:178:73: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Float8_e4m3fnuz’
    178 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(int a, Float8_e4m3fnuz b) {
        |                                                         ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:193:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(c10::Float8_e4m3fnuz, int64_t)’
    193 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(Float8_e4m3fnuz a, int64_t b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:193:77: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘int64_t’ {aka ‘long int’}
    193 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(Float8_e4m3fnuz a, int64_t b) {
        |                                                                     ~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:206:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(int64_t, c10::Float8_e4m3fnuz)’
    206 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(int64_t a, Float8_e4m3fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:206:77: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Float8_e4m3fnuz’
    206 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(int64_t a, Float8_e4m3fnuz b) {
        |                                                             ~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half.h:423,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:111:29: note: candidate: ‘c10::Half c10::operator-(const c10::Half&, const c10::Half&)’
    111 | inline C10_HOST_DEVICE Half operator-(const Half& a, const Half& b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:111:66: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const c10::Half&’
    111 | inline C10_HOST_DEVICE Half operator-(const Half& a, const Half& b) {
        |                                                      ~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:124:29: note: candidate: ‘c10::Half c10::operator-(const c10::Half&)’
    124 | inline C10_HOST_DEVICE Half operator-(const Half& a) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:124:29: note:   candidate expects 1 argument, 2 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:160:30: note: candidate: ‘float c10::operator-(c10::Half, float)’
    160 | inline C10_HOST_DEVICE float operator-(Half a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:160:54: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘float’
    160 | inline C10_HOST_DEVICE float operator-(Half a, float b) {
        |                                                ~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:174:30: note: candidate: ‘float c10::operator-(float, c10::Half)’
    174 | inline C10_HOST_DEVICE float operator-(float a, Half b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:174:54: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Half’
    174 | inline C10_HOST_DEVICE float operator-(float a, Half b) {
        |                                                 ~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:203:31: note: candidate: ‘double c10::operator-(c10::Half, double)’
    203 | inline C10_HOST_DEVICE double operator-(Half a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:203:56: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘double’
    203 | inline C10_HOST_DEVICE double operator-(Half a, double b) {
        |                                                 ~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:217:31: note: candidate: ‘double c10::operator-(double, c10::Half)’
    217 | inline C10_HOST_DEVICE double operator-(double a, Half b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:217:56: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Half’
    217 | inline C10_HOST_DEVICE double operator-(double a, Half b) {
        |                                                   ~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:233:29: note: candidate: ‘c10::Half c10::operator-(c10::Half, int)’
    233 | inline C10_HOST_DEVICE Half operator-(Half a, int b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:233:51: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘int’
    233 | inline C10_HOST_DEVICE Half operator-(Half a, int b) {
        |                                               ~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:246:29: note: candidate: ‘c10::Half c10::operator-(int, c10::Half)’
    246 | inline C10_HOST_DEVICE Half operator-(int a, Half b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:246:51: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Half’
    246 | inline C10_HOST_DEVICE Half operator-(int a, Half b) {
        |                                              ~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:261:29: note: candidate: ‘c10::Half c10::operator-(c10::Half, int64_t)’
    261 | inline C10_HOST_DEVICE Half operator-(Half a, int64_t b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:261:55: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘int64_t’ {aka ‘long int’}
    261 | inline C10_HOST_DEVICE Half operator-(Half a, int64_t b) {
        |                                               ~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:274:29: note: candidate: ‘c10::Half c10::operator-(int64_t, c10::Half)’
    274 | inline C10_HOST_DEVICE Half operator-(int64_t a, Half b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:274:55: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Half’
    274 | inline C10_HOST_DEVICE Half operator-(int64_t a, Half b) {
        |                                                  ~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2.h:148,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:47:1: note: candidate: ‘c10::Float8_e5m2 c10::operator-(const c10::Float8_e5m2&, const c10::Float8_e5m2&)’
     47 | operator-(const Float8_e5m2& a, const Float8_e5m2& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:47:52: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const c10::Float8_e5m2&’
     47 | operator-(const Float8_e5m2& a, const Float8_e5m2& b) {
        |                                 ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:62:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(const c10::Float8_e5m2&)’
     62 | inline C10_HOST_DEVICE Float8_e5m2 operator-(const Float8_e5m2& a) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:62:36: note:   candidate expects 1 argument, 2 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:99:30: note: candidate: ‘float c10::operator-(c10::Float8_e5m2, float)’
     99 | inline C10_HOST_DEVICE float operator-(Float8_e5m2 a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:99:61: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘float’
     99 | inline C10_HOST_DEVICE float operator-(Float8_e5m2 a, float b) {
        |                                                       ~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:113:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e5m2)’
    113 | inline C10_HOST_DEVICE float operator-(float a, Float8_e5m2 b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:113:61: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Float8_e5m2’
    113 | inline C10_HOST_DEVICE float operator-(float a, Float8_e5m2 b) {
        |                                                 ~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:142:31: note: candidate: ‘double c10::operator-(c10::Float8_e5m2, double)’
    142 | inline C10_HOST_DEVICE double operator-(Float8_e5m2 a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:142:63: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘double’
    142 | inline C10_HOST_DEVICE double operator-(Float8_e5m2 a, double b) {
        |                                                        ~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:156:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e5m2)’
    156 | inline C10_HOST_DEVICE double operator-(double a, Float8_e5m2 b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:156:63: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Float8_e5m2’
    156 | inline C10_HOST_DEVICE double operator-(double a, Float8_e5m2 b) {
        |                                                   ~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:172:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(c10::Float8_e5m2, int)’
    172 | inline C10_HOST_DEVICE Float8_e5m2 operator-(Float8_e5m2 a, int b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:172:65: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘int’
    172 | inline C10_HOST_DEVICE Float8_e5m2 operator-(Float8_e5m2 a, int b) {
        |                                                             ~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:185:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(int, c10::Float8_e5m2)’
    185 | inline C10_HOST_DEVICE Float8_e5m2 operator-(int a, Float8_e5m2 b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:185:65: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Float8_e5m2’
    185 | inline C10_HOST_DEVICE Float8_e5m2 operator-(int a, Float8_e5m2 b) {
        |                                                     ~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:200:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(c10::Float8_e5m2, int64_t)’
    200 | inline C10_HOST_DEVICE Float8_e5m2 operator-(Float8_e5m2 a, int64_t b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:200:69: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘int64_t’ {aka ‘long int’}
    200 | inline C10_HOST_DEVICE Float8_e5m2 operator-(Float8_e5m2 a, int64_t b) {
        |                                                             ~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:213:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(int64_t, c10::Float8_e5m2)’
    213 | inline C10_HOST_DEVICE Float8_e5m2 operator-(int64_t a, Float8_e5m2 b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:213:69: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Float8_e5m2’
    213 | inline C10_HOST_DEVICE Float8_e5m2 operator-(int64_t a, Float8_e5m2 b) {
        |                                                         ~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz.h:138,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:44:1: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(const c10::Float8_e5m2fnuz&, const c10::Float8_e5m2fnuz&)’
     44 | operator-(const Float8_e5m2fnuz& a, const Float8_e5m2fnuz& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:44:60: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const c10::Float8_e5m2fnuz&’
     44 | operator-(const Float8_e5m2fnuz& a, const Float8_e5m2fnuz& b) {
        |                                     ~~~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:59:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(const c10::Float8_e5m2fnuz&)’
     59 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(const Float8_e5m2fnuz& a) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:59:40: note:   candidate expects 1 argument, 2 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:96:30: note: candidate: ‘float c10::operator-(c10::Float8_e5m2fnuz, float)’
     96 | inline C10_HOST_DEVICE float operator-(Float8_e5m2fnuz a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:96:65: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘float’
     96 | inline C10_HOST_DEVICE float operator-(Float8_e5m2fnuz a, float b) {
        |                                                           ~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:110:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e5m2fnuz)’
    110 | inline C10_HOST_DEVICE float operator-(float a, Float8_e5m2fnuz b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:110:65: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Float8_e5m2fnuz’
    110 | inline C10_HOST_DEVICE float operator-(float a, Float8_e5m2fnuz b) {
        |                                                 ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:139:31: note: candidate: ‘double c10::operator-(c10::Float8_e5m2fnuz, double)’
    139 | inline C10_HOST_DEVICE double operator-(Float8_e5m2fnuz a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:139:67: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘double’
    139 | inline C10_HOST_DEVICE double operator-(Float8_e5m2fnuz a, double b) {
        |                                                            ~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:153:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e5m2fnuz)’
    153 | inline C10_HOST_DEVICE double operator-(double a, Float8_e5m2fnuz b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:153:67: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Float8_e5m2fnuz’
    153 | inline C10_HOST_DEVICE double operator-(double a, Float8_e5m2fnuz b) {
        |                                                   ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:169:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(c10::Float8_e5m2fnuz, int)’
    169 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(Float8_e5m2fnuz a, int b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:169:73: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘int’
    169 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(Float8_e5m2fnuz a, int b) {
        |                                                                     ~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:182:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(int, c10::Float8_e5m2fnuz)’
    182 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(int a, Float8_e5m2fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:182:73: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Float8_e5m2fnuz’
    182 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(int a, Float8_e5m2fnuz b) {
        |                                                         ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:197:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(c10::Float8_e5m2fnuz, int64_t)’
    197 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(Float8_e5m2fnuz a, int64_t b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:197:77: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘int64_t’ {aka ‘long int’}
    197 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(Float8_e5m2fnuz a, int64_t b) {
        |                                                                     ~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:210:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(int64_t, c10::Float8_e5m2fnuz)’
    210 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(int64_t a, Float8_e5m2fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:210:77: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘c10::Float8_e5m2fnuz’
    210 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(int64_t a, Float8_e5m2fnuz b) {
        |                                                             ~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, int64_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:53: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘int64_t’ {aka ‘long int’}
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:350:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    350 | DECLARE_SYMINT_OP(int64_t, SymInt)
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(int64_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:53: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const c10::SymInt&’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                                       ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:350:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    350 | DECLARE_SYMINT_OP(int64_t, SymInt)
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, int32_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:53: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘int32_t’ {aka ‘int’}
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:351:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    351 | DECLARE_SYMINT_OP(int32_t, SymInt) // make sure constants work
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(int32_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:53: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const c10::SymInt&’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                                       ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:351:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    351 | DECLARE_SYMINT_OP(int32_t, SymInt) // make sure constants work
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, uint64_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:53: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘uint64_t’ {aka ‘long unsigned int’}
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:352:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    352 | DECLARE_SYMINT_OP(uint64_t, SymInt)
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(uint64_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:53: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const c10::SymInt&’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                                       ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:352:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    352 | DECLARE_SYMINT_OP(uint64_t, SymInt)
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, uint32_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:53: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘uint32_t’ {aka ‘unsigned int’}
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:353:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    353 | DECLARE_SYMINT_OP(uint32_t, SymInt)
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(uint32_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:53: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const c10::SymInt&’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                                       ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:353:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    353 | DECLARE_SYMINT_OP(uint32_t, SymInt)
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymFloat c10::operator-(const c10::SymInt&, double)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:53: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘double’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:354:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    354 | DECLARE_SYMINT_OP(double, SymFloat)
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymFloat c10::operator-(double, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:53: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const c10::SymInt&’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                                       ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:354:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    354 | DECLARE_SYMINT_OP(double, SymFloat)
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymFloat c10::operator-(const c10::SymInt&, float)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:53: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘float’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:355:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    355 | DECLARE_SYMINT_OP(float, SymFloat) // just for completeness
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymFloat c10::operator-(float, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:53: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const c10::SymInt&’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                                       ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:355:1: note: in expansion of macro ‘DECLARE_SYMINT_OP’
    355 | DECLARE_SYMINT_OP(float, SymFloat) // just for completeness
        | ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:367:16: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&)’
    367 | C10_API SymInt operator-(const SymInt& s);
        |                ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:367:16: note:   candidate expects 1 argument, 2 provided
  In file included from /usr/local/cuda/include/cuda_fp16.h:5293,
                   from /usr/local/cuda/include/cublas_api.h:77,
                   from /usr/local/cuda/include/cublas_v2.h:69,
                   from /workspace/nunchaku/src/common.h:23,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/local/cuda/include/cuda_fp16.hpp:222:54: note: candidate: ‘__half operator-(const __half&, const __half&)’
    222 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half operator-(const __half &lh, const __half &rh) { return __hsub(lh, rh); }
        |                                                      ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:222:96: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const __half&’
    222 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half operator-(const __half &lh, const __half &rh) { return __hsub(lh, rh); }
        |                                                                                  ~~~~~~~~~~~~~~^~
  /usr/local/cuda/include/cuda_fp16.hpp:254:54: note: candidate: ‘__half operator-(const __half&)’
    254 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half operator-(const __half &h) { return __hneg(h); }
        |                                                      ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:254:54: note:   candidate expects 1 argument, 2 provided
  /usr/local/cuda/include/cuda_fp16.hpp:308:55: note: candidate: ‘__half2 operator-(const __half2&, const __half2&)’
    308 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half2 operator-(const __half2 &lh, const __half2 &rh) { return __hsub2(lh, rh); }
        |                                                       ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:308:80: note:   no known conversion for argument 1 from ‘int’ to ‘const __half2&’
    308 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half2 operator-(const __half2 &lh, const __half2 &rh) { return __hsub2(lh, rh); }
        |                                                                 ~~~~~~~~~~~~~~~^~
  /usr/local/cuda/include/cuda_fp16.hpp:342:55: note: candidate: ‘__half2 operator-(const __half2&)’
    342 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half2 operator-(const __half2 &h) { return __hneg2(h); }
        |                                                       ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:342:55: note:   candidate expects 1 argument, 2 provided
  In file included from /usr/local/cuda/include/cuda_bf16.h:5079,
                   from /usr/local/cuda/include/cublas_api.h:78,
                   from /usr/local/cuda/include/cublas_v2.h:69,
                   from /workspace/nunchaku/src/common.h:23,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/local/cuda/include/cuda_bf16.hpp:203:61: note: candidate: ‘__nv_bfloat16 operator-(const __nv_bfloat16&, const __nv_bfloat16&)’
    203 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat16 operator-(const __nv_bfloat16 &lh, const __nv_bfloat16 &rh) { return __hsub(lh, rh); }
        |                                                             ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:203:117: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const __nv_bfloat16&’
    203 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat16 operator-(const __nv_bfloat16 &lh, const __nv_bfloat16 &rh) { return __hsub(lh, rh); }
        |                                                                                                ~~~~~~~~~~~~~~~~~~~~~^~
  /usr/local/cuda/include/cuda_bf16.hpp:235:61: note: candidate: ‘__nv_bfloat16 operator-(const __nv_bfloat16&)’
    235 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat16 operator-(const __nv_bfloat16 &h) { return __hneg(h); }
        |                                                             ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:235:61: note:   candidate expects 1 argument, 2 provided
  /usr/local/cuda/include/cuda_bf16.hpp:320:62: note: candidate: ‘__nv_bfloat162 operator-(const __nv_bfloat162&, const __nv_bfloat162&)’
    320 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat162 operator-(const __nv_bfloat162 &lh, const __nv_bfloat162 &rh) { return __hsub2(lh, rh); }
        |                                                              ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:320:94: note:   no known conversion for argument 1 from ‘int’ to ‘const __nv_bfloat162&’
    320 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat162 operator-(const __nv_bfloat162 &lh, const __nv_bfloat162 &rh) { return __hsub2(lh, rh); }
        |                                                                        ~~~~~~~~~~~~~~~~~~~~~~^~
  /usr/local/cuda/include/cuda_bf16.hpp:354:62: note: candidate: ‘__nv_bfloat162 operator-(const __nv_bfloat162&)’
    354 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat162 operator-(const __nv_bfloat162 &h) { return __hneg2(h); }
        |                                                              ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:354:62: note:   candidate expects 1 argument, 2 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ATen.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:17: note: candidate: ‘at::Tensor at::operator-(const at::Tensor&, const at::Tensor&)’
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:17: note: in definition of macro ‘DEFINE_OPERATOR’
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:43: note:   no known conversion for argument 1 from ‘int’ to ‘const at::Tensor&’
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                             ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:17:3: note: in expansion of macro ‘DEFINE_OPERATOR’
     17 |   _(-,                                                                      \
        |   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:17: note: candidate: ‘at::Tensor at::operator-(const at::Tensor&, const c10::Scalar&)’
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:17: note: in definition of macro ‘DEFINE_OPERATOR’
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:43: note:   no known conversion for argument 1 from ‘int’ to ‘const at::Tensor&’
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                             ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:17:3: note: in expansion of macro ‘DEFINE_OPERATOR’
     17 |   _(-,                                                                      \
        |   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:17: note: candidate: ‘at::Tensor at::operator-(const c10::Scalar&, const at::Tensor&)’
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:17: note: in definition of macro ‘DEFINE_OPERATOR’
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:60: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                                              ~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:17:3: note: in expansion of macro ‘DEFINE_OPERATOR’
     17 |   _(-,                                                                      \
        |   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:543:43: error: no match for ‘operator-’ (operand type is ‘const torch::Tensor’)
    543 |         (1 - target) * torch::log_sigmoid(-input));
        |                                           ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:358:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const c10::complex<U>&)’
    358 | constexpr complex<T> operator-(const complex<T>& val) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:358:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:543:44: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    543 |         (1 - target) * torch::log_sigmoid(-input));
        |                                            ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:380:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const c10::complex<U>&, const c10::complex<U>&)’
    380 | constexpr complex<T> operator-(const complex<T>& lhs, const complex<T>& rhs) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:380:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:543:44: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    543 |         (1 - target) * torch::log_sigmoid(-input));
        |                                            ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:386:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const c10::complex<U>&, const T&)’
    386 | constexpr complex<T> operator-(const complex<T>& lhs, const T& rhs) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:386:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:543:44: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    543 |         (1 - target) * torch::log_sigmoid(-input));
        |                                            ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:392:22: note: candidate: ‘template<class T> constexpr c10::complex<U> c10::operator-(const T&, const c10::complex<U>&)’
    392 | constexpr complex<T> operator-(const T& lhs, const complex<T>& rhs) {
        |                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:392:22: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:543:44: note:   candidate expects 2 arguments, 1 provided
    543 |         (1 - target) * torch::log_sigmoid(-input));
        |                                            ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:453:28: note: candidate: ‘template<class fT, class iT, typename std::enable_if<(is_floating_point_v<fT> && is_integral_v<iT>), int>::type <anonymous> > constexpr c10::complex<U> c10::operator-(const c10::complex<U>&, const iT&)’
    453 | constexpr c10::complex<fT> operator-(const c10::complex<fT>& a, const iT& b) {
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:453:28: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:543:44: note:   ‘const torch::Tensor’ is not derived from ‘const c10::complex<U>’
    543 |         (1 - target) * torch::log_sigmoid(-input));
        |                                            ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:458:28: note: candidate: ‘template<class fT, class iT, typename std::enable_if<(is_floating_point_v<fT> && is_integral_v<iT>), int>::type <anonymous> > constexpr c10::complex<U> c10::operator-(const iT&, const c10::complex<U>&)’
    458 | constexpr c10::complex<fT> operator-(const iT& a, const c10::complex<fT>& b) {
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/complex.h:458:28: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:543:44: note:   candidate expects 2 arguments, 1 provided
    543 |         (1 - target) * torch::log_sigmoid(-input));
        |                                            ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16.h:130,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:91:1: note: candidate: ‘c10::BFloat16 c10::operator-(const c10::BFloat16&, const c10::BFloat16&)’
     91 | operator-(const BFloat16& a, const BFloat16& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:91:1: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:105:33: note: candidate: ‘c10::BFloat16 c10::operator-(const c10::BFloat16&)’
    105 | inline C10_HOST_DEVICE BFloat16 operator-(const BFloat16& a) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:105:59: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::BFloat16&’
    105 | inline C10_HOST_DEVICE BFloat16 operator-(const BFloat16& a) {
        |                                           ~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:149:30: note: candidate: ‘float c10::operator-(c10::BFloat16, float)’
    149 | inline C10_HOST_DEVICE float operator-(BFloat16 a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:149:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:162:30: note: candidate: ‘float c10::operator-(float, c10::BFloat16)’
    162 | inline C10_HOST_DEVICE float operator-(float a, BFloat16 b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:162:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:190:31: note: candidate: ‘double c10::operator-(c10::BFloat16, double)’
    190 | inline C10_HOST_DEVICE double operator-(BFloat16 a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:190:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:203:31: note: candidate: ‘double c10::operator-(double, c10::BFloat16)’
    203 | inline C10_HOST_DEVICE double operator-(double a, BFloat16 b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:203:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:218:33: note: candidate: ‘c10::BFloat16 c10::operator-(c10::BFloat16, int)’
    218 | inline C10_HOST_DEVICE BFloat16 operator-(BFloat16 a, int b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:218:33: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:231:33: note: candidate: ‘c10::BFloat16 c10::operator-(int, c10::BFloat16)’
    231 | inline C10_HOST_DEVICE BFloat16 operator-(int a, BFloat16 b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:231:33: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:246:33: note: candidate: ‘c10::BFloat16 c10::operator-(c10::BFloat16, int64_t)’
    246 | inline C10_HOST_DEVICE BFloat16 operator-(BFloat16 a, int64_t b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:246:33: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:259:33: note: candidate: ‘c10::BFloat16 c10::operator-(int64_t, c10::BFloat16)’
    259 | inline C10_HOST_DEVICE BFloat16 operator-(int64_t a, BFloat16 b) {
        |                                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/BFloat16-inl.h:259:33: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn.h:240,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:39:1: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(const c10::Float8_e4m3fn&, const c10::Float8_e4m3fn&)’
     39 | operator-(const Float8_e4m3fn& a, const Float8_e4m3fn& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:39:1: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:54:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(const c10::Float8_e4m3fn&)’
     54 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(const Float8_e4m3fn& a) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:54:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Float8_e4m3fn&’
     54 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(const Float8_e4m3fn& a) {
        |                                                ~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:91:30: note: candidate: ‘float c10::operator-(c10::Float8_e4m3fn, float)’
     91 | inline C10_HOST_DEVICE float operator-(Float8_e4m3fn a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:91:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:105:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e4m3fn)’
    105 | inline C10_HOST_DEVICE float operator-(float a, Float8_e4m3fn b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:105:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:134:31: note: candidate: ‘double c10::operator-(c10::Float8_e4m3fn, double)’
    134 | inline C10_HOST_DEVICE double operator-(Float8_e4m3fn a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:134:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:148:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e4m3fn)’
    148 | inline C10_HOST_DEVICE double operator-(double a, Float8_e4m3fn b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:148:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:164:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(c10::Float8_e4m3fn, int)’
    164 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(Float8_e4m3fn a, int b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:164:38: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:177:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(int, c10::Float8_e4m3fn)’
    177 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(int a, Float8_e4m3fn b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:177:38: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:192:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(c10::Float8_e4m3fn, int64_t)’
    192 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(Float8_e4m3fn a, int64_t b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:192:38: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:205:38: note: candidate: ‘c10::Float8_e4m3fn c10::operator-(int64_t, c10::Float8_e4m3fn)’
    205 | inline C10_HOST_DEVICE Float8_e4m3fn operator-(int64_t a, Float8_e4m3fn b) {
        |                                      ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fn-inl.h:205:38: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz.h:139,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:40:1: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(const c10::Float8_e4m3fnuz&, const c10::Float8_e4m3fnuz&)’
     40 | operator-(const Float8_e4m3fnuz& a, const Float8_e4m3fnuz& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:40:1: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:55:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(const c10::Float8_e4m3fnuz&)’
     55 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(const Float8_e4m3fnuz& a) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:55:73: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Float8_e4m3fnuz&’
     55 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(const Float8_e4m3fnuz& a) {
        |                                                  ~~~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:92:30: note: candidate: ‘float c10::operator-(c10::Float8_e4m3fnuz, float)’
     92 | inline C10_HOST_DEVICE float operator-(Float8_e4m3fnuz a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:92:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:106:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e4m3fnuz)’
    106 | inline C10_HOST_DEVICE float operator-(float a, Float8_e4m3fnuz b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:106:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:135:31: note: candidate: ‘double c10::operator-(c10::Float8_e4m3fnuz, double)’
    135 | inline C10_HOST_DEVICE double operator-(Float8_e4m3fnuz a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:135:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:149:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e4m3fnuz)’
    149 | inline C10_HOST_DEVICE double operator-(double a, Float8_e4m3fnuz b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:149:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:165:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(c10::Float8_e4m3fnuz, int)’
    165 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(Float8_e4m3fnuz a, int b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:165:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:178:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(int, c10::Float8_e4m3fnuz)’
    178 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(int a, Float8_e4m3fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:178:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:193:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(c10::Float8_e4m3fnuz, int64_t)’
    193 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(Float8_e4m3fnuz a, int64_t b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:193:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:206:40: note: candidate: ‘c10::Float8_e4m3fnuz c10::operator-(int64_t, c10::Float8_e4m3fnuz)’
    206 | inline C10_HOST_DEVICE Float8_e4m3fnuz operator-(int64_t a, Float8_e4m3fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e4m3fnuz-inl.h:206:40: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half.h:423,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:111:29: note: candidate: ‘c10::Half c10::operator-(const c10::Half&, const c10::Half&)’
    111 | inline C10_HOST_DEVICE Half operator-(const Half& a, const Half& b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:111:29: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:124:29: note: candidate: ‘c10::Half c10::operator-(const c10::Half&)’
    124 | inline C10_HOST_DEVICE Half operator-(const Half& a) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:124:51: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Half&’
    124 | inline C10_HOST_DEVICE Half operator-(const Half& a) {
        |                                       ~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:160:30: note: candidate: ‘float c10::operator-(c10::Half, float)’
    160 | inline C10_HOST_DEVICE float operator-(Half a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:160:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:174:30: note: candidate: ‘float c10::operator-(float, c10::Half)’
    174 | inline C10_HOST_DEVICE float operator-(float a, Half b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:174:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:203:31: note: candidate: ‘double c10::operator-(c10::Half, double)’
    203 | inline C10_HOST_DEVICE double operator-(Half a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:203:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:217:31: note: candidate: ‘double c10::operator-(double, c10::Half)’
    217 | inline C10_HOST_DEVICE double operator-(double a, Half b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:217:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:233:29: note: candidate: ‘c10::Half c10::operator-(c10::Half, int)’
    233 | inline C10_HOST_DEVICE Half operator-(Half a, int b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:233:29: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:246:29: note: candidate: ‘c10::Half c10::operator-(int, c10::Half)’
    246 | inline C10_HOST_DEVICE Half operator-(int a, Half b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:246:29: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:261:29: note: candidate: ‘c10::Half c10::operator-(c10::Half, int64_t)’
    261 | inline C10_HOST_DEVICE Half operator-(Half a, int64_t b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:261:29: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:274:29: note: candidate: ‘c10::Half c10::operator-(int64_t, c10::Half)’
    274 | inline C10_HOST_DEVICE Half operator-(int64_t a, Half b) {
        |                             ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Half-inl.h:274:29: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2.h:148,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:47:1: note: candidate: ‘c10::Float8_e5m2 c10::operator-(const c10::Float8_e5m2&, const c10::Float8_e5m2&)’
     47 | operator-(const Float8_e5m2& a, const Float8_e5m2& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:47:1: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:62:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(const c10::Float8_e5m2&)’
     62 | inline C10_HOST_DEVICE Float8_e5m2 operator-(const Float8_e5m2& a) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:62:65: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Float8_e5m2&’
     62 | inline C10_HOST_DEVICE Float8_e5m2 operator-(const Float8_e5m2& a) {
        |                                              ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:99:30: note: candidate: ‘float c10::operator-(c10::Float8_e5m2, float)’
     99 | inline C10_HOST_DEVICE float operator-(Float8_e5m2 a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:99:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:113:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e5m2)’
    113 | inline C10_HOST_DEVICE float operator-(float a, Float8_e5m2 b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:113:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:142:31: note: candidate: ‘double c10::operator-(c10::Float8_e5m2, double)’
    142 | inline C10_HOST_DEVICE double operator-(Float8_e5m2 a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:142:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:156:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e5m2)’
    156 | inline C10_HOST_DEVICE double operator-(double a, Float8_e5m2 b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:156:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:172:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(c10::Float8_e5m2, int)’
    172 | inline C10_HOST_DEVICE Float8_e5m2 operator-(Float8_e5m2 a, int b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:172:36: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:185:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(int, c10::Float8_e5m2)’
    185 | inline C10_HOST_DEVICE Float8_e5m2 operator-(int a, Float8_e5m2 b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:185:36: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:200:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(c10::Float8_e5m2, int64_t)’
    200 | inline C10_HOST_DEVICE Float8_e5m2 operator-(Float8_e5m2 a, int64_t b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:200:36: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:213:36: note: candidate: ‘c10::Float8_e5m2 c10::operator-(int64_t, c10::Float8_e5m2)’
    213 | inline C10_HOST_DEVICE Float8_e5m2 operator-(int64_t a, Float8_e5m2 b) {
        |                                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2-inl.h:213:36: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz.h:138,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/ScalarType.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:44:1: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(const c10::Float8_e5m2fnuz&, const c10::Float8_e5m2fnuz&)’
     44 | operator-(const Float8_e5m2fnuz& a, const Float8_e5m2fnuz& b) {
        | ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:44:1: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:59:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(const c10::Float8_e5m2fnuz&)’
     59 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(const Float8_e5m2fnuz& a) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:59:73: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Float8_e5m2fnuz&’
     59 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(const Float8_e5m2fnuz& a) {
        |                                                  ~~~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:96:30: note: candidate: ‘float c10::operator-(c10::Float8_e5m2fnuz, float)’
     96 | inline C10_HOST_DEVICE float operator-(Float8_e5m2fnuz a, float b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:96:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:110:30: note: candidate: ‘float c10::operator-(float, c10::Float8_e5m2fnuz)’
    110 | inline C10_HOST_DEVICE float operator-(float a, Float8_e5m2fnuz b) {
        |                              ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:110:30: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:139:31: note: candidate: ‘double c10::operator-(c10::Float8_e5m2fnuz, double)’
    139 | inline C10_HOST_DEVICE double operator-(Float8_e5m2fnuz a, double b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:139:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:153:31: note: candidate: ‘double c10::operator-(double, c10::Float8_e5m2fnuz)’
    153 | inline C10_HOST_DEVICE double operator-(double a, Float8_e5m2fnuz b) {
        |                               ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:153:31: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:169:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(c10::Float8_e5m2fnuz, int)’
    169 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(Float8_e5m2fnuz a, int b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:169:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:182:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(int, c10::Float8_e5m2fnuz)’
    182 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(int a, Float8_e5m2fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:182:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:197:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(c10::Float8_e5m2fnuz, int64_t)’
    197 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(Float8_e5m2fnuz a, int64_t b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:197:40: note:   candidate expects 2 arguments, 1 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:210:40: note: candidate: ‘c10::Float8_e5m2fnuz c10::operator-(int64_t, c10::Float8_e5m2fnuz)’
    210 | inline C10_HOST_DEVICE Float8_e5m2fnuz operator-(int64_t a, Float8_e5m2fnuz b) {
        |                                        ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Float8_e5m2fnuz-inl.h:210:40: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Scalar.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, int64_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(int64_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, int32_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(int32_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, uint64_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(uint64_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&, uint32_t)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymInt c10::operator-(uint32_t, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymFloat c10::operator-(const c10::SymInt&, double)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymFloat c10::operator-(double, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: candidate: ‘c10::SymFloat c10::operator-(const c10::SymInt&, float)’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note:   candidate expects 2 arguments, 1 provided
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:326:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    326 |   C10_API RetTy operator-(const SymInt& a, scalar_t b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: candidate: ‘c10::SymFloat c10::operator-(float, const c10::SymInt&)’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note:   candidate expects 2 arguments, 1 provided
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:330:17: note: in definition of macro ‘DECLARE_SYMINT_OP’
    330 |   C10_API RetTy operator-(scalar_t a, const SymInt& b); \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:367:16: note: candidate: ‘c10::SymInt c10::operator-(const c10::SymInt&)’
    367 | C10_API SymInt operator-(const SymInt& s);
        |                ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/SymInt.h:367:40: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::SymInt&’
    367 | C10_API SymInt operator-(const SymInt& s);
        |                          ~~~~~~~~~~~~~~^
  In file included from /usr/local/cuda/include/cuda_fp16.h:5293,
                   from /usr/local/cuda/include/cublas_api.h:77,
                   from /usr/local/cuda/include/cublas_v2.h:69,
                   from /workspace/nunchaku/src/common.h:23,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/local/cuda/include/cuda_fp16.hpp:222:54: note: candidate: ‘__half operator-(const __half&, const __half&)’
    222 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half operator-(const __half &lh, const __half &rh) { return __hsub(lh, rh); }
        |                                                      ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:222:54: note:   candidate expects 2 arguments, 1 provided
  /usr/local/cuda/include/cuda_fp16.hpp:254:54: note: candidate: ‘__half operator-(const __half&)’
    254 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half operator-(const __half &h) { return __hneg(h); }
        |                                                      ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:254:78: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const __half&’
    254 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half operator-(const __half &h) { return __hneg(h); }
        |                                                                ~~~~~~~~~~~~~~^
  /usr/local/cuda/include/cuda_fp16.hpp:308:55: note: candidate: ‘__half2 operator-(const __half2&, const __half2&)’
    308 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half2 operator-(const __half2 &lh, const __half2 &rh) { return __hsub2(lh, rh); }
        |                                                       ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:308:55: note:   candidate expects 2 arguments, 1 provided
  /usr/local/cuda/include/cuda_fp16.hpp:342:55: note: candidate: ‘__half2 operator-(const __half2&)’
    342 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half2 operator-(const __half2 &h) { return __hneg2(h); }
        |                                                       ^~~~~~~~
  /usr/local/cuda/include/cuda_fp16.hpp:342:80: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const __half2&’
    342 | __CUDA_HOSTDEVICE__ __CUDA_FP16_FORCEINLINE__ __half2 operator-(const __half2 &h) { return __hneg2(h); }
        |                                                                 ~~~~~~~~~~~~~~~^
  In file included from /usr/local/cuda/include/cuda_bf16.h:5079,
                   from /usr/local/cuda/include/cublas_api.h:78,
                   from /usr/local/cuda/include/cublas_v2.h:69,
                   from /workspace/nunchaku/src/common.h:23,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/local/cuda/include/cuda_bf16.hpp:203:61: note: candidate: ‘__nv_bfloat16 operator-(const __nv_bfloat16&, const __nv_bfloat16&)’
    203 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat16 operator-(const __nv_bfloat16 &lh, const __nv_bfloat16 &rh) { return __hsub(lh, rh); }
        |                                                             ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:203:61: note:   candidate expects 2 arguments, 1 provided
  /usr/local/cuda/include/cuda_bf16.hpp:235:61: note: candidate: ‘__nv_bfloat16 operator-(const __nv_bfloat16&)’
    235 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat16 operator-(const __nv_bfloat16 &h) { return __hneg(h); }
        |                                                             ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:235:92: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const __nv_bfloat16&’
    235 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat16 operator-(const __nv_bfloat16 &h) { return __hneg(h); }
        |                                                                       ~~~~~~~~~~~~~~~~~~~~~^
  /usr/local/cuda/include/cuda_bf16.hpp:320:62: note: candidate: ‘__nv_bfloat162 operator-(const __nv_bfloat162&, const __nv_bfloat162&)’
    320 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat162 operator-(const __nv_bfloat162 &lh, const __nv_bfloat162 &rh) { return __hsub2(lh, rh); }
        |                                                              ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:320:62: note:   candidate expects 2 arguments, 1 provided
  /usr/local/cuda/include/cuda_bf16.hpp:354:62: note: candidate: ‘__nv_bfloat162 operator-(const __nv_bfloat162&)’
    354 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat162 operator-(const __nv_bfloat162 &h) { return __hneg2(h); }
        |                                                              ^~~~~~~~
  /usr/local/cuda/include/cuda_bf16.hpp:354:94: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const __nv_bfloat162&’
    354 | __CUDA_HOSTDEVICE__ __CUDA_BF16_FORCEINLINE__ __nv_bfloat162 operator-(const __nv_bfloat162 &h) { return __hneg2(h); }
        |                                                                        ~~~~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ATen.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:17: note: candidate: ‘at::Tensor at::operator-(const at::Tensor&, const at::Tensor&)’
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:17: note: in definition of macro ‘DEFINE_OPERATOR’
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:17: note:   candidate expects 2 arguments, 1 provided
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:37:17: note: in definition of macro ‘DEFINE_OPERATOR’
     37 |   inline Tensor operator op(const Tensor& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:17: note: candidate: ‘at::Tensor at::operator-(const at::Tensor&, const c10::Scalar&)’
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:17: note: in definition of macro ‘DEFINE_OPERATOR’
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:17: note:   candidate expects 2 arguments, 1 provided
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:40:17: note: in definition of macro ‘DEFINE_OPERATOR’
     40 |   inline Tensor operator op(const Tensor& x, const Scalar& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:17: note: candidate: ‘at::Tensor at::operator-(const c10::Scalar&, const at::Tensor&)’
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:17: note: in definition of macro ‘DEFINE_OPERATOR’
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:17: note:   candidate expects 2 arguments, 1 provided
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:43:17: note: in definition of macro ‘DEFINE_OPERATOR’
     43 |   inline Tensor operator op(const Scalar& x, const Tensor& y) { \
        |                 ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorOperators.h:47:1: note: in expansion of macro ‘AT_FORALL_BINARY_OPS’
     47 | AT_FORALL_BINARY_OPS(DEFINE_OPERATOR)
        | ^~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:544:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    544 |   if (weight.defined()) {
        |       ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:548:20: error: invalid use of incomplete type ‘const class torch::Tensor’
    548 |   auto class_dim = input.dim() - 1;
        |                    ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:549:12: error: invalid use of incomplete type ‘const class torch::Tensor’
    549 |   auto C = input.size(class_dim);
        |            ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:552:10: error: aggregate ‘torch::Tensor ret’ has incomplete type and cannot be defined
    552 |   Tensor ret;
        |          ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:587:60: error: return type ‘class torch::Tensor’ is incomplete
    587 |     const MultilabelSoftMarginLossFuncOptions& options = {}) {
        |                                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:604:56: error: return type ‘class torch::Tensor’ is incomplete
    604 |     TripletMarginLossFuncOptions::reduction_t reduction) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::triplet_margin_loss(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, double, double, double, bool, torch::nn::TripletMarginLossOptions::reduction_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:606:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    606 |       anchor,
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1335,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/triplet_margin_loss.h:26:58: note: in passing argument 1 of ‘at::Tensor at::triplet_margin_loss(const at::Tensor&, const at::Tensor&, const at::Tensor&, double, double, double, bool, int64_t)’
     26 | inline at::Tensor triplet_margin_loss(const at::Tensor & anchor, const at::Tensor & positive, const at::Tensor & negative, double margin=1.0, double p=2, double eps=1e-06, bool swap=false, int64_t reduction=at::Reduction::Mean) {
        |                                       ~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:636:53: error: return type ‘class torch::Tensor’ is incomplete
    636 |     const TripletMarginLossFuncOptions& options = {}) {
        |                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:660:68: error: return type ‘class torch::Tensor’ is incomplete
    660 |     TripletMarginWithDistanceLossFuncOptions::reduction_t reduction) {
        |                                                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::triplet_margin_with_distance_loss(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, std::optional<std::function<torch::Tensor(const torch::Tensor&, const torch::Tensor&)> >, double, bool, torch::nn::TripletMarginWithDistanceLossOptions::reduction_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:661:10: error: aggregate ‘torch::Tensor dist_pos’ has incomplete type and cannot be defined
    661 |   Tensor dist_pos, dist_neg;
        |          ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:661:20: error: aggregate ‘torch::Tensor dist_neg’ has incomplete type and cannot be defined
    661 |   Tensor dist_pos, dist_neg;
        |                    ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:664:38: error: invalid use of incomplete type ‘class torch::Tensor’
    664 |     dist_pos = distance_function_impl(anchor, positive);
        |                ~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:665:38: error: invalid use of incomplete type ‘class torch::Tensor’
    665 |     dist_neg = distance_function_impl(anchor, negative);
        |                ~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:667:33: error: too few arguments to function ‘void torch::nn::functional::detail::pairwise_distance(const torch::Tensor&, const torch::Tensor&, double, double, bool)’
    667 |     dist_pos = pairwise_distance(anchor, positive);
        |                ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/distance.h:44:15: note: declared here
     44 | inline Tensor pairwise_distance(
        |               ^~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:668:33: error: too few arguments to function ‘void torch::nn::functional::detail::pairwise_distance(const torch::Tensor&, const torch::Tensor&, double, double, bool)’
    668 |     dist_neg = pairwise_distance(anchor, negative);
        |                ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/distance.h:44:15: note: declared here
     44 | inline Tensor pairwise_distance(
        |               ^~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:672:12: error: aggregate ‘torch::Tensor dist_swap’ has incomplete type and cannot be defined
    672 |     Tensor dist_swap;
        |            ^~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:674:44: error: invalid use of incomplete type ‘class torch::Tensor’
    674 |       dist_swap = distance_function.value()(positive, negative);
        |                   ~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:676:36: error: too few arguments to function ‘void torch::nn::functional::detail::pairwise_distance(const torch::Tensor&, const torch::Tensor&, double, double, bool)’
    676 |       dist_swap = pairwise_distance(positive, negative);
        |                   ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/distance.h:44:15: note: declared here
     44 | inline Tensor pairwise_distance(
        |               ^~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:683:10: error: aggregate ‘torch::Tensor ret’ has incomplete type and cannot be defined
    683 |   Tensor ret;
        |          ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:718:65: error: return type ‘class torch::Tensor’ is incomplete
    718 |     const TripletMarginWithDistanceLossFuncOptions& options = {}) {
        |                                                                 ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:740:23: error: return type ‘class torch::Tensor’ is incomplete
    740 |     bool zero_infinity) {
        |                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::ctc_loss(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, int64_t, torch::nn::CTCLossOptions::reduction_t, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:741:25: error: no matching function for call to ‘ctc_loss(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, int64_t&, at::Reduction::Reduction, bool&)’
    741 |   return torch::ctc_loss(
        |          ~~~~~~~~~~~~~~~^
    742 |       log_probs,
        |       ~~~~~~~~~~
    743 |       targets,
        |       ~~~~~~~~
    744 |       input_lengths,
        |       ~~~~~~~~~~~~~~
    745 |       target_lengths,
        |       ~~~~~~~~~~~~~~~
    746 |       blank,
        |       ~~~~~~
    747 |       enumtype::reduction_get_enum(reduction),
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    748 |       zero_infinity);
        |       ~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:619,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/ctc_loss.h:26:19: note: candidate: ‘at::Tensor at::ctc_loss(const at::Tensor&, const at::Tensor&, at::IntArrayRef, at::IntArrayRef, int64_t, int64_t, bool)’
     26 | inline at::Tensor ctc_loss(const at::Tensor & log_probs, const at::Tensor & targets, at::IntArrayRef input_lengths, at::IntArrayRef target_lengths, int64_t blank=0, int64_t reduction=at::Reduction::Mean, bool zero_infinity=false) {
        |                   ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/ctc_loss.h:26:47: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor ctc_loss(const at::Tensor & log_probs, const at::Tensor & targets, at::IntArrayRef input_lengths, at::IntArrayRef target_lengths, int64_t blank=0, int64_t reduction=at::Reduction::Mean, bool zero_infinity=false) {
        |                            ~~~~~~~~~~~~~~~~~~~^~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/ctc_loss.h:31:19: note: candidate: ‘at::Tensor at::ctc_loss(const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, int64_t, int64_t, bool)’
     31 | inline at::Tensor ctc_loss(const at::Tensor & log_probs, const at::Tensor & targets, const at::Tensor & input_lengths, const at::Tensor & target_lengths, int64_t blank=0, int64_t reduction=at::Reduction::Mean, bool zero_infinity=false) {
        |                   ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/ctc_loss.h:31:47: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     31 | inline at::Tensor ctc_loss(const at::Tensor & log_probs, const at::Tensor & targets, const at::Tensor & input_lengths, const at::Tensor & target_lengths, int64_t blank=0, int64_t reduction=at::Reduction::Mean, bool zero_infinity=false) {
        |                            ~~~~~~~~~~~~~~~~~~~^~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:771:43: error: return type ‘class torch::Tensor’ is incomplete
    771 |     const CTCLossFuncOptions& options = {}) {
        |                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:792:53: error: return type ‘class torch::Tensor’ is incomplete
    792 |     PoissonNLLLossFuncOptions::reduction_t reduction) {
        |                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::poisson_nll_loss(const torch::Tensor&, const torch::Tensor&, bool, bool, double, torch::nn::PoissonNLLLossOptions::reduction_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:794:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    794 |       input,
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1069,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/poisson_nll_loss.h:26:55: note: in passing argument 1 of ‘at::Tensor at::poisson_nll_loss(const at::Tensor&, const at::Tensor&, bool, bool, double, int64_t)’
     26 | inline at::Tensor poisson_nll_loss(const at::Tensor & input, const at::Tensor & target, bool log_input, bool full, double eps, int64_t reduction) {
        |                                    ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:820:50: error: return type ‘class torch::Tensor’ is incomplete
    820 |     const PoissonNLLLossFuncOptions& options = {}) {
        |                                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:839:56: error: return type ‘class torch::Tensor’ is incomplete
    839 |     MarginRankingLossFuncOptions::reduction_t reduction) {
        |                                                        ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::margin_ranking_loss(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, double, torch::nn::MarginRankingLossOptions::reduction_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:841:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    841 |       input1.dim() == input2.dim() && input1.dim() == target.dim(),
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:840:3: note: in expansion of macro ‘TORCH_CHECK’
    840 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:841:23: error: invalid use of incomplete type ‘const class torch::Tensor’
    841 |       input1.dim() == input2.dim() && input1.dim() == target.dim(),
        |                       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:840:3: note: in expansion of macro ‘TORCH_CHECK’
    840 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:841:39: error: invalid use of incomplete type ‘const class torch::Tensor’
    841 |       input1.dim() == input2.dim() && input1.dim() == target.dim(),
        |                                       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:840:3: note: in expansion of macro ‘TORCH_CHECK’
    840 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:841:55: error: invalid use of incomplete type ‘const class torch::Tensor’
    841 |       input1.dim() == input2.dim() && input1.dim() == target.dim(),
        |                                                       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:840:3: note: in expansion of macro ‘TORCH_CHECK’
    840 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:844:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    844 |       input1.sizes(),
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:840:3: note: in expansion of macro ‘TORCH_CHECK’
    840 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:846:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    846 |       input2.sizes(),
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:840:3: note: in expansion of macro ‘TORCH_CHECK’
    840 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:848:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    848 |       target.sizes());
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:840:3: note: in expansion of macro ‘TORCH_CHECK’
    840 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:850:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    850 |       input1, input2, target, margin, enumtype::reduction_get_enum(reduction));
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:932,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/margin_ranking_loss.h:26:58: note: in passing argument 1 of ‘at::Tensor at::margin_ranking_loss(const at::Tensor&, const at::Tensor&, const at::Tensor&, double, int64_t)’
     26 | inline at::Tensor margin_ranking_loss(const at::Tensor & input1, const at::Tensor & input2, const at::Tensor & target, double margin=0.0, int64_t reduction=at::Reduction::Mean) {
        |                                       ~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:873:53: error: return type ‘class torch::Tensor’ is incomplete
    873 |     const MarginRankingLossFuncOptions& options = {}) {
        |                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:887:53: error: return type ‘class torch::Tensor’ is incomplete
    887 |     const NLLLossFuncOptions::reduction_t& reduction) {
        |                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::nll_loss(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, int64_t, const reduction_t&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:888:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    888 |   if (input.dim() < 2) {
        |       ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:889:63: error: invalid use of incomplete type ‘const class torch::Tensor’
    889 |     TORCH_CHECK(false, "Expected 2 or more dimensions (got ", input.dim(), ")");
        |                                                               ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:889:5: note: in expansion of macro ‘TORCH_CHECK’
    889 |     TORCH_CHECK(false, "Expected 2 or more dimensions (got ", input.dim(), ")");
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:892:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    892 |   if (input.sizes()[0] != target.sizes()[0]) {
        |       ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:892:27: error: invalid use of incomplete type ‘const class torch::Tensor’
    892 |   if (input.sizes()[0] != target.sizes()[0]) {
        |                           ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:896:9: error: invalid use of incomplete type ‘const class torch::Tensor’
    896 |         input.sizes()[0],
        |         ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:893:5: note: in expansion of macro ‘TORCH_CHECK’
    893 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:898:9: error: invalid use of incomplete type ‘const class torch::Tensor’
    898 |         target.sizes()[0],
        |         ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:893:5: note: in expansion of macro ‘TORCH_CHECK’
    893 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:903:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    903 |       input,
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1040,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/nll_loss_nd.h:26:50: note: in passing argument 1 of ‘at::Tensor at::nll_loss_nd(const at::Tensor&, const at::Tensor&, const std::optional<at::Tensor>&, int64_t, int64_t)’
     26 | inline at::Tensor nll_loss_nd(const at::Tensor & self, const at::Tensor & target, const ::std::optional<at::Tensor> & weight={}, int64_t reduction=at::Reduction::Mean, int64_t ignore_index=-100) {
        |                               ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:928:43: error: return type ‘class torch::Tensor’ is incomplete
    928 |     const NLLLossFuncOptions& options = {}) {
        |                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:947:27: error: return type ‘class torch::Tensor’ is incomplete
    947 |     double label_smoothing) {
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::cross_entropy(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, int64_t, torch::nn::CrossEntropyLossOptions::reduction_t, double)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:949:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    949 |       input,
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:616,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cross_entropy_loss.h:26:57: note: in passing argument 1 of ‘at::Tensor at::cross_entropy_loss(const at::Tensor&, const at::Tensor&, const std::optional<at::Tensor>&, int64_t, int64_t, double)’
     26 | inline at::Tensor cross_entropy_loss(const at::Tensor & self, const at::Tensor & target, const ::std::optional<at::Tensor> & weight={}, int64_t reduction=at::Reduction::Mean, int64_t ignore_index=-100, double label_smoothing=0.0) {
        |                                      ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:975:48: error: return type ‘class torch::Tensor’ is incomplete
    975 |     const CrossEntropyFuncOptions& options = {}) {
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:994:29: error: return type ‘class torch::Tensor’ is incomplete
    994 |     const Tensor& pos_weight) {
        |                             ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: In function ‘void torch::nn::functional::detail::binary_cross_entropy_with_logits(const torch::Tensor&, const torch::Tensor&, const torch::Tensor&, torch::nn::BCEWithLogitsLossOptions::reduction_t, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:996:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    996 |       target.sizes() == input.sizes(),
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:995:3: note: in expansion of macro ‘TORCH_CHECK’
    995 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:996:25: error: invalid use of incomplete type ‘const class torch::Tensor’
    996 |       target.sizes() == input.sizes(),
        |                         ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:995:3: note: in expansion of macro ‘TORCH_CHECK’
    995 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:998:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    998 |       target.sizes(),
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:995:3: note: in expansion of macro ‘TORCH_CHECK’
    995 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:1000:7: error: invalid use of incomplete type ‘const class torch::Tensor’
   1000 |       input.sizes(),
        |       ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:995:3: note: in expansion of macro ‘TORCH_CHECK’
    995 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:1004:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
   1004 |       input,
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:542,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/binary_cross_entropy_with_logits.h:26:71: note: in passing argument 1 of ‘at::Tensor at::binary_cross_entropy_with_logits(const at::Tensor&, const at::Tensor&, const std::optional<at::Tensor>&, const std::optional<at::Tensor>&, int64_t)’
     26 | inline at::Tensor binary_cross_entropy_with_logits(const at::Tensor & self, const at::Tensor & target, const ::std::optional<at::Tensor> & weight={}, const ::std::optional<at::Tensor> & pos_weight={}, int64_t reduction=at::Reduction::Mean) {
        |                                                    ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:1030:64: error: return type ‘class torch::Tensor’ is incomplete
   1030 |     const BinaryCrossEntropyWithLogitsFuncOptions& options = {}) {
        |                                                                ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/padding.h:14:17: error: return type ‘class torch::Tensor’ is incomplete
     14 |     double value) {
        |                 ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/padding.h: In function ‘void torch::nn::functional::detail::pad(const torch::Tensor&, c10::IntArrayRef, torch::nn::functional::PadFuncOptions::mode_t, double)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/padding.h:32:24: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     32 |   return at::_pad_enum(input, pad, static_cast<int64_t>(mode_enum), fill_value);
        |                        ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:310,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_pad_enum.h:26:48: note: in passing argument 1 of ‘at::Tensor at::_pad_enum(const at::Tensor&, at::IntArrayRef, int64_t, std::optional<double>)’
     26 | inline at::Tensor _pad_enum(const at::Tensor & self, at::IntArrayRef pad, int64_t mode, ::std::optional<double> value=::std::nullopt) {
        |                             ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/padding.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/padding.h:50:69: error: return type ‘class torch::Tensor’ is incomplete
     50 | inline Tensor pad(const Tensor& input, const PadFuncOptions& options) {
        |                                                                     ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:459:28: error: field ‘_random_samples_’ has incomplete type ‘torch::Tensor’
    459 |   TORCH_ARG(torch::Tensor, _random_samples) = Tensor();
        |                            ^~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:18:27: error: return type ‘class torch::Tensor’ is incomplete
     18 |     bool count_include_pad) {
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘void torch::nn::functional::detail::avg_pool1d(const torch::Tensor&, torch::ExpandingArray<1>, torch::ExpandingArray<1>, torch::ExpandingArray<1>, bool, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:20:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     20 |       input, kernel_size, stride, padding, ceil_mode, count_include_pad);
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:522,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/avg_pool1d.h:26:49: note: in passing argument 1 of ‘at::Tensor at::avg_pool1d(const at::Tensor&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, bool, bool)’
     26 | inline at::Tensor avg_pool1d(const at::Tensor & self, at::IntArrayRef kernel_size, at::IntArrayRef stride={}, at::IntArrayRef padding=0, bool ceil_mode=false, bool count_include_pad=true) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:39:40: error: return type ‘class torch::Tensor’ is incomplete
     39 |     const AvgPool1dFuncOptions& options) {
        |                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘void torch::nn::functional::avg_pool1d(const torch::Tensor&, const AvgPool1dFuncOptions&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:40:20: error: too many arguments to function ‘void torch::nn::functional::avg_pool1d(const torch::Tensor&, const AvgPool1dFuncOptions&)’
     40 |   return avg_pool1d(
        |          ~~~~~~~~~~^
     41 |       input,
        |       ~~~~~~
     42 |       options.kernel_size(),
        |       ~~~~~~~~~~~~~~~~~~~~~~
     43 |       options.stride(),
        |       ~~~~~~~~~~~~~~~~~
     44 |       options.padding(),
        |       ~~~~~~~~~~~~~~~~~~
     45 |       options.ceil_mode(),
        |       ~~~~~~~~~~~~~~~~~~~~
     46 |       options.count_include_pad());
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:37:15: note: declared here
     37 | inline Tensor avg_pool1d(
        |               ^~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:58:44: error: return type ‘class torch::Tensor’ is incomplete
     58 |     std::optional<int64_t> divisor_override) {
        |                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘void torch::nn::functional::detail::avg_pool2d(const torch::Tensor&, torch::ExpandingArray<2>, torch::ExpandingArray<2>, torch::ExpandingArray<2>, bool, bool, std::optional<long int>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:60:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     60 |       input,
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:523,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/avg_pool2d.h:35:49: note: in passing argument 1 of ‘at::Tensor at::avg_pool2d(const at::Tensor&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, bool, bool, std::optional<long int>)’
     35 | inline at::Tensor avg_pool2d(const at::Tensor & self, at::IntArrayRef kernel_size, at::IntArrayRef stride={}, at::IntArrayRef padding=0, bool ceil_mode=false, bool count_include_pad=true, ::std::optional<int64_t> divisor_override=::std::nullopt) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:85:40: error: return type ‘class torch::Tensor’ is incomplete
     85 |     const AvgPool2dFuncOptions& options) {
        |                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:105:44: error: return type ‘class torch::Tensor’ is incomplete
    105 |     std::optional<int64_t> divisor_override) {
        |                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘void torch::nn::functional::detail::avg_pool3d(const torch::Tensor&, torch::ExpandingArray<3>, torch::ExpandingArray<3>, torch::ExpandingArray<3>, bool, bool, std::optional<long int>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:107:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    107 |       input,
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:525,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/avg_pool3d.h:35:49: note: in passing argument 1 of ‘at::Tensor at::avg_pool3d(const at::Tensor&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, bool, bool, std::optional<long int>)’
     35 | inline at::Tensor avg_pool3d(const at::Tensor & self, at::IntArrayRef kernel_size, at::IntArrayRef stride={}, at::IntArrayRef padding=0, bool ceil_mode=false, bool count_include_pad=true, ::std::optional<int64_t> divisor_override=::std::nullopt) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:132:40: error: return type ‘class torch::Tensor’ is incomplete
    132 |     const AvgPool3dFuncOptions& options) {
        |                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:153:19: error: return type ‘class torch::Tensor’ is incomplete
    153 |     bool ceil_mode) {
        |                   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘void torch::nn::functional::detail::max_pool1d(const torch::Tensor&, torch::ExpandingArray<1>, torch::ExpandingArray<1>, torch::ExpandingArray<1>, torch::ExpandingArray<1>, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:155:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    155 |       input, kernel_size, stride, padding, dilation, ceil_mode);
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:945,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/max_pool1d.h:26:49: note: in passing argument 1 of ‘at::Tensor at::max_pool1d(const at::Tensor&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, bool)’
     26 | inline at::Tensor max_pool1d(const at::Tensor & self, at::IntArrayRef kernel_size, at::IntArrayRef stride={}, at::IntArrayRef padding=0, at::IntArrayRef dilation=1, bool ceil_mode=false) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:174:40: error: return type ‘class torch::Tensor’ is incomplete
    174 |     const MaxPool1dFuncOptions& options) {
        |                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘std::tuple<torch::Tensor, torch::Tensor> torch::nn::functional::detail::max_pool1d_with_indices(const torch::Tensor&, torch::ExpandingArray<1>, torch::ExpandingArray<1>, torch::ExpandingArray<1>, torch::ExpandingArray<1>, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:194:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    194 |       input, kernel_size, stride, padding, dilation, ceil_mode);
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:946,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/max_pool1d_with_indices.h:26:87: note: in passing argument 1 of ‘std::tuple<at::Tensor, at::Tensor> at::max_pool1d_with_indices(const at::Tensor&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, bool)’
     26 | inline ::std::tuple<at::Tensor,at::Tensor> max_pool1d_with_indices(const at::Tensor & self, at::IntArrayRef kernel_size, at::IntArrayRef stride={}, at::IntArrayRef padding=0, at::IntArrayRef dilation=1, bool ceil_mode=false) {
        |                                                                    ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:227:19: error: return type ‘class torch::Tensor’ is incomplete
    227 |     bool ceil_mode) {
        |                   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘void torch::nn::functional::detail::max_pool2d(const torch::Tensor&, torch::ExpandingArray<2>, torch::ExpandingArray<2>, torch::ExpandingArray<2>, torch::ExpandingArray<2>, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:229:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    229 |       input, kernel_size, stride, padding, dilation, ceil_mode);
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:947,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/max_pool2d.h:26:49: note: in passing argument 1 of ‘at::Tensor at::max_pool2d(const at::Tensor&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, bool)’
     26 | inline at::Tensor max_pool2d(const at::Tensor & self, at::IntArrayRef kernel_size, at::IntArrayRef stride={}, at::IntArrayRef padding=0, at::IntArrayRef dilation=1, bool ceil_mode=false) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:248:40: error: return type ‘class torch::Tensor’ is incomplete
    248 |     const MaxPool2dFuncOptions& options) {
        |                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘std::tuple<torch::Tensor, torch::Tensor> torch::nn::functional::detail::max_pool2d_with_indices(const torch::Tensor&, torch::ExpandingArray<2>, torch::ExpandingArray<2>, torch::ExpandingArray<2>, torch::ExpandingArray<2>, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:268:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    268 |       input, kernel_size, stride, padding, dilation, ceil_mode);
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:949,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/max_pool2d_with_indices.h:35:87: note: in passing argument 1 of ‘std::tuple<at::Tensor, at::Tensor> at::max_pool2d_with_indices(const at::Tensor&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, bool)’
     35 | inline ::std::tuple<at::Tensor,at::Tensor> max_pool2d_with_indices(const at::Tensor & self, at::IntArrayRef kernel_size, at::IntArrayRef stride={}, at::IntArrayRef padding=0, at::IntArrayRef dilation=1, bool ceil_mode=false) {
        |                                                                    ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:301:19: error: return type ‘class torch::Tensor’ is incomplete
    301 |     bool ceil_mode) {
        |                   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘void torch::nn::functional::detail::max_pool3d(const torch::Tensor&, torch::ExpandingArray<3>, torch::ExpandingArray<3>, torch::ExpandingArray<3>, torch::ExpandingArray<3>, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:303:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    303 |       input, kernel_size, stride, padding, dilation, ceil_mode);
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:951,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/max_pool3d.h:26:49: note: in passing argument 1 of ‘at::Tensor at::max_pool3d(const at::Tensor&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, bool)’
     26 | inline at::Tensor max_pool3d(const at::Tensor & self, at::IntArrayRef kernel_size, at::IntArrayRef stride={}, at::IntArrayRef padding=0, at::IntArrayRef dilation=1, bool ceil_mode=false) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:322:40: error: return type ‘class torch::Tensor’ is incomplete
    322 |     const MaxPool3dFuncOptions& options) {
        |                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘std::tuple<torch::Tensor, torch::Tensor> torch::nn::functional::detail::max_pool3d_with_indices(const torch::Tensor&, torch::ExpandingArray<3>, torch::ExpandingArray<3>, torch::ExpandingArray<3>, torch::ExpandingArray<3>, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:342:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    342 |       input, kernel_size, stride, padding, dilation, ceil_mode);
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:952,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/max_pool3d_with_indices.h:35:87: note: in passing argument 1 of ‘std::tuple<at::Tensor, at::Tensor> at::max_pool3d_with_indices(const at::Tensor&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef, bool)’
     35 | inline ::std::tuple<at::Tensor,at::Tensor> max_pool3d_with_indices(const at::Tensor & self, at::IntArrayRef kernel_size, at::IntArrayRef stride={}, at::IntArrayRef padding=0, at::IntArrayRef dilation=1, bool ceil_mode=false) {
        |                                                                    ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘std::tuple<torch::Tensor, torch::Tensor> torch::nn::functional::detail::adaptive_max_pool1d_with_indices(const torch::Tensor&, torch::ExpandingArray<1>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:374:37: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    374 |   return torch::adaptive_max_pool1d(input, output_size);
        |                                     ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:470,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/adaptive_max_pool1d.h:26:83: note: in passing argument 1 of ‘std::tuple<at::Tensor, at::Tensor> at::adaptive_max_pool1d(const at::Tensor&, at::IntArrayRef)’
     26 | inline ::std::tuple<at::Tensor,at::Tensor> adaptive_max_pool1d(const at::Tensor & self, at::IntArrayRef output_size) {
        |                                                                ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:396:34: error: return type ‘class torch::Tensor’ is incomplete
    396 |     ExpandingArray<1> output_size) {
        |                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:417:48: error: return type ‘class torch::Tensor’ is incomplete
    417 |     const AdaptiveMaxPool1dFuncOptions& options) {
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘std::tuple<torch::Tensor, torch::Tensor> torch::nn::functional::detail::adaptive_max_pool2d_with_indices(const torch::Tensor&, torch::ExpandingArrayWithOptionalElem<2>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:427:66: error: invalid use of incomplete type ‘const class torch::Tensor’
    427 |       torch::nn::modules::utils::_list_with_default(output_size, input.sizes());
        |                                                                  ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:452:50: error: return type ‘class torch::Tensor’ is incomplete
    452 |     ExpandingArrayWithOptionalElem<2> output_size) {
        |                                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:473:48: error: return type ‘class torch::Tensor’ is incomplete
    473 |     const AdaptiveMaxPool2dFuncOptions& options) {
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘std::tuple<torch::Tensor, torch::Tensor> torch::nn::functional::detail::adaptive_max_pool3d_with_indices(const torch::Tensor&, torch::ExpandingArrayWithOptionalElem<3>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:483:66: error: invalid use of incomplete type ‘const class torch::Tensor’
    483 |       torch::nn::modules::utils::_list_with_default(output_size, input.sizes());
        |                                                                  ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:508:50: error: return type ‘class torch::Tensor’ is incomplete
    508 |     ExpandingArrayWithOptionalElem<3> output_size) {
        |                                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:529:48: error: return type ‘class torch::Tensor’ is incomplete
    529 |     const AdaptiveMaxPool3dFuncOptions& options) {
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:539:34: error: return type ‘class torch::Tensor’ is incomplete
    539 |     ExpandingArray<1> output_size) {
        |                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘void torch::nn::functional::detail::adaptive_avg_pool1d(const torch::Tensor&, torch::ExpandingArray<1>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:540:37: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    540 |   return torch::adaptive_avg_pool1d(input, output_size);
        |                                     ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:466,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/adaptive_avg_pool1d.h:26:58: note: in passing argument 1 of ‘at::Tensor at::adaptive_avg_pool1d(const at::Tensor&, at::IntArrayRef)’
     26 | inline at::Tensor adaptive_avg_pool1d(const at::Tensor & self, at::IntArrayRef output_size) {
        |                                       ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:560:48: error: return type ‘class torch::Tensor’ is incomplete
    560 |     const AdaptiveAvgPool1dFuncOptions& options) {
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:568:50: error: return type ‘class torch::Tensor’ is incomplete
    568 |     ExpandingArrayWithOptionalElem<2> output_size) {
        |                                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘void torch::nn::functional::detail::adaptive_avg_pool2d(const torch::Tensor&, torch::ExpandingArrayWithOptionalElem<2>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:570:66: error: invalid use of incomplete type ‘const class torch::Tensor’
    570 |       torch::nn::modules::utils::_list_with_default(output_size, input.sizes());
        |                                                                  ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:591:48: error: return type ‘class torch::Tensor’ is incomplete
    591 |     const AdaptiveAvgPool2dFuncOptions& options) {
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:599:50: error: return type ‘class torch::Tensor’ is incomplete
    599 |     ExpandingArrayWithOptionalElem<3> output_size) {
        |                                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘void torch::nn::functional::detail::adaptive_avg_pool3d(const torch::Tensor&, torch::ExpandingArrayWithOptionalElem<3>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:601:66: error: invalid use of incomplete type ‘const class torch::Tensor’
    601 |       torch::nn::modules::utils::_list_with_default(output_size, input.sizes());
        |                                                                  ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:622:48: error: return type ‘class torch::Tensor’ is incomplete
    622 |     const AdaptiveAvgPool3dFuncOptions& options) {
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘std::vector<long int> torch::nn::functional::_unpool_output_size(const torch::Tensor&, const IntArrayRef&, const IntArrayRef&, const IntArrayRef&, const std::optional<std::vector<long int> >&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:634:21: error: invalid use of incomplete type ‘const class torch::Tensor’
    634 |   auto input_size = input.sizes();
        |                     ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:689:59: error: return type ‘class torch::Tensor’ is incomplete
    689 |     const std::optional<std::vector<int64_t>>& output_size) {
        |                                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘void torch::nn::functional::detail::max_unpool1d(const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<1>, torch::ExpandingArray<1>, torch::ExpandingArray<1>, const std::optional<std::vector<long int> >&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:694:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    694 |              input.unsqueeze(-1), indices.unsqueeze(-1), output_size_)
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:694:35: error: invalid use of incomplete type ‘const class torch::Tensor’
    694 |              input.unsqueeze(-1), indices.unsqueeze(-1), output_size_)
        |                                   ^~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:716:42: error: return type ‘class torch::Tensor’ is incomplete
    716 |     const MaxUnpool1dFuncOptions& options) {
        |                                          ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:734:59: error: return type ‘class torch::Tensor’ is incomplete
    734 |     const std::optional<std::vector<int64_t>>& output_size) {
        |                                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘void torch::nn::functional::detail::max_unpool2d(const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<2>, torch::ExpandingArray<2>, torch::ExpandingArray<2>, const std::optional<std::vector<long int> >&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:738:30: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    738 |   return torch::max_unpool2d(input, indices, output_size_);
        |                              ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:954,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/max_unpool2d.h:70:51: note: in passing argument 1 of ‘at::Tensor at::max_unpool2d(const at::Tensor&, const at::Tensor&, at::IntArrayRef)’
     70 | inline at::Tensor max_unpool2d(const at::Tensor & self, const at::Tensor & indices, at::IntArrayRef output_size) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:759:42: error: return type ‘class torch::Tensor’ is incomplete
    759 |     const MaxUnpool2dFuncOptions& options) {
        |                                          ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:777:59: error: return type ‘class torch::Tensor’ is incomplete
    777 |     const std::optional<std::vector<int64_t>>& output_size) {
        |                                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘void torch::nn::functional::detail::max_unpool3d(const torch::Tensor&, const torch::Tensor&, torch::ExpandingArray<3>, torch::ExpandingArray<3>, torch::ExpandingArray<3>, const std::optional<std::vector<long int> >&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:781:30: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    781 |   return torch::max_unpool3d(input, indices, output_size_, stride, padding);
        |                              ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:955,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/max_unpool3d.h:70:51: note: in passing argument 1 of ‘at::Tensor at::max_unpool3d(const at::Tensor&, const at::Tensor&, at::IntArrayRef, at::IntArrayRef, at::IntArrayRef)’
     70 | inline at::Tensor max_unpool3d(const at::Tensor & self, const at::Tensor & indices, at::IntArrayRef output_size, at::IntArrayRef stride, at::IntArrayRef padding) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:801:42: error: return type ‘class torch::Tensor’ is incomplete
    801 |     const MaxUnpool3dFuncOptions& options) {
        |                                          ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘std::tuple<torch::Tensor, torch::Tensor> torch::nn::functional::detail::fractional_max_pool2d_with_indices(const torch::Tensor&, const torch::ExpandingArray<2>&, const std::optional<torch::ExpandingArray<2> >&, const std::optional<torch::ExpandingArray<2, double> >&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:831:39: error: invalid use of incomplete type ‘const class torch::Tensor’
    831 |         (int64_t)(static_cast<double>(input.size(-2)) *
        |                                       ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:833:39: error: invalid use of incomplete type ‘const class torch::Tensor’
    833 |         (int64_t)(static_cast<double>(input.size(-1)) *
        |                                       ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:834:46: error: no match for ‘operator=’ (operand types are ‘std::optional<torch::ExpandingArray<2> >’ and ‘<brace-enclosed initializer list>’)
    834 |                   (*output_ratio.value())[1])};
        |                                              ^
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:803:9: note: candidate: ‘constexpr std::enable_if_t<__and_v<std::__not_<std::is_same<std::optional<_Tp>, typename std::remove_cv<typename std::remove_reference<_Iter>::type>::type> >, std::__not_<std::__and_<std::is_scalar<_Tp>, std::is_same<_Tp, typename std::decay<_Up>::type> > >, std::is_constructible<_Tp, _Up>, std::is_assignable<_T1&, _U1> >, std::optional<_Tp>&> std::optional<_Tp>::operator=(_Up&&) [with _Up = torch::ExpandingArray<2>; _Tp = torch::ExpandingArray<2>; std::enable_if_t<__and_v<std::__not_<std::is_same<std::optional<_Tp>, typename std::remove_cv<typename std::remove_reference<_Iter>::type>::type> >, std::__not_<std::__and_<std::is_scalar<_Tp>, std::is_same<_Tp, typename std::decay<_Up>::type> > >, std::is_constructible<_Tp, _Up>, std::is_assignable<_T1&, _U1> >, std::optional<_Tp>&> = std::optional<torch::ExpandingArray<2> >&; typename std::decay<_Up>::type = std::decay<torch::ExpandingArray<2> >::type; typename std::remove_cv<typename std::remove_reference<_Iter>::type>::type = torch::ExpandingArray<2>; typename std::remove_reference<_Iter>::type = torch::ExpandingArray<2>]’
    803 |         operator=(_Up&& __u)
        |         ^~~~~~~~
  /usr/include/c++/11/optional:803:25: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘torch::ExpandingArray<2>&&’
    803 |         operator=(_Up&& __u)
        |                   ~~~~~~^~~
  /usr/include/c++/11/optional:823:9: note: candidate: ‘template<class _Up> constexpr std::enable_if_t<__and_v<std::__not_<std::is_same<_T1, _U1> >, std::is_constructible<_Tp, const _Up&>, std::is_assignable<_T1&, const _U1&>, std::__not_<std::__or_<std::is_constructible<_Tp, const std::optional<_Up>&>, std::is_constructible<_Tp, std::optional<_Up>&>, std::is_constructible<_Tp, const std::optional<_Up>&&>, std::is_constructible<_Tp, std::optional<_Up>&&>, std::is_convertible<const std::optional<_Up>&, _Tp>, std::is_convertible<std::optional<_Up>&, _Tp>, std::is_convertible<const std::optional<_Up>&&, _Tp>, std::is_convertible<std::optional<_Up>&&, _Tp> > >, std::__not_<std::__or_<std::is_assignable<_Tp&, const std::optional<_Up>&>, std::is_assignable<_Tp&, std::optional<_Up>&>, std::is_assignable<_Tp&, const std::optional<_Up>&&>, std::is_assignable<_Tp&, std::optional<_Up>&&> > > >, std::optional<_Tp>&> std::optional<_Tp>::operator=(const std::optional<_Up>&) [with _Up = _Up; _Tp = torch::ExpandingArray<2>]’
    823 |         operator=(const optional<_Up>& __u)
        |         ^~~~~~~~
  /usr/include/c++/11/optional:823:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:834:46: note:   couldn’t deduce template parameter ‘_Up’
    834 |                   (*output_ratio.value())[1])};
        |                                              ^
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:849:9: note: candidate: ‘template<class _Up> constexpr std::enable_if_t<__and_v<std::__not_<std::is_same<_T1, _U1> >, std::is_constructible<_Tp, _Up>, std::is_assignable<_T1&, _U1>, std::__not_<std::__or_<std::is_constructible<_Tp, const std::optional<_Up>&>, std::is_constructible<_Tp, std::optional<_Up>&>, std::is_constructible<_Tp, const std::optional<_Up>&&>, std::is_constructible<_Tp, std::optional<_Up>&&>, std::is_convertible<const std::optional<_Up>&, _Tp>, std::is_convertible<std::optional<_Up>&, _Tp>, std::is_convertible<const std::optional<_Up>&&, _Tp>, std::is_convertible<std::optional<_Up>&&, _Tp> > >, std::__not_<std::__or_<std::is_assignable<_Tp&, const std::optional<_Up>&>, std::is_assignable<_Tp&, std::optional<_Up>&>, std::is_assignable<_Tp&, const std::optional<_Up>&&>, std::is_assignable<_Tp&, std::optional<_Up>&&> > > >, std::optional<_Tp>&> std::optional<_Tp>::operator=(std::optional<_Up>&&) [with _Up = _Up; _Tp = torch::ExpandingArray<2>]’
    849 |         operator=(optional<_Up>&& __u)
        |         ^~~~~~~~
  /usr/include/c++/11/optional:849:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:834:46: note:   couldn’t deduce template parameter ‘_Up’
    834 |                   (*output_ratio.value())[1])};
        |                                              ^
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:789:7: note: candidate: ‘constexpr std::optional<_Tp>& std::optional<_Tp>::operator=(std::nullopt_t) [with _Tp = torch::ExpandingArray<2>]’
    789 |       operator=(nullopt_t) noexcept
        |       ^~~~~~~~
  /usr/include/c++/11/optional:789:17: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::nullopt_t’
    789 |       operator=(nullopt_t) noexcept
        |                 ^~~~~~~~~
  /usr/include/c++/11/optional:662:11: note: candidate: ‘constexpr std::optional<torch::ExpandingArray<2> >& std::optional<torch::ExpandingArray<2> >::operator=(const std::optional<torch::ExpandingArray<2> >&)’
    662 |     class optional
        |           ^~~~~~~~
  /usr/include/c++/11/optional:662:11: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::optional<torch::ExpandingArray<2> >&’
  /usr/include/c++/11/optional:662:11: note: candidate: ‘constexpr std::optional<torch::ExpandingArray<2> >& std::optional<torch::ExpandingArray<2> >::operator=(std::optional<torch::ExpandingArray<2> >&&)’
  /usr/include/c++/11/optional:662:11: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::optional<torch::ExpandingArray<2> >&&’
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:837:10: error: variable ‘torch::Tensor _random_samples_’ has initializer but incomplete type
    837 |   Tensor _random_samples_ = _random_samples;
        |          ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:839:20: error: invalid use of incomplete type ‘const class torch::Tensor’
    839 |     auto n_batch = input.dim() == 3 ? 1 : input.size(0);
        |                    ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:839:43: error: invalid use of incomplete type ‘const class torch::Tensor’
    839 |     auto n_batch = input.dim() == 3 ? 1 : input.size(0);
        |                                           ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:841:19: error: invalid use of incomplete type ‘const class torch::Tensor’
    841 |         {n_batch, input.size(-3), 2},
        |                   ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:842:38: error: invalid use of incomplete type ‘const class torch::Tensor’
    842 |         torch::TensorOptions().dtype(input.dtype()).device(input.device()));
        |                                      ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:842:60: error: invalid use of incomplete type ‘const class torch::Tensor’
    842 |         torch::TensorOptions().dtype(input.dtype()).device(input.device()));
        |                                                            ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:878:34: error: return type ‘class torch::Tensor’ is incomplete
    878 |     const Tensor& _random_samples) {
        |                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:897:50: error: return type ‘class torch::Tensor’ is incomplete
    897 |     const FractionalMaxPool2dFuncOptions& options) {
        |                                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘std::tuple<torch::Tensor, torch::Tensor> torch::nn::functional::detail::fractional_max_pool3d_with_indices(const torch::Tensor&, const torch::ExpandingArray<3>&, const std::optional<torch::ExpandingArray<3> >&, const std::optional<torch::ExpandingArray<3, double> >&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:925:39: error: invalid use of incomplete type ‘const class torch::Tensor’
    925 |         (int64_t)(static_cast<double>(input.size(-3)) *
        |                                       ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:927:39: error: invalid use of incomplete type ‘const class torch::Tensor’
    927 |         (int64_t)(static_cast<double>(input.size(-2)) *
        |                                       ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:929:39: error: invalid use of incomplete type ‘const class torch::Tensor’
    929 |         (int64_t)(static_cast<double>(input.size(-1)) *
        |                                       ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:930:46: error: no match for ‘operator=’ (operand types are ‘std::optional<torch::ExpandingArray<3> >’ and ‘<brace-enclosed initializer list>’)
    930 |                   (*output_ratio.value())[2])};
        |                                              ^
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:803:9: note: candidate: ‘constexpr std::enable_if_t<__and_v<std::__not_<std::is_same<std::optional<_Tp>, typename std::remove_cv<typename std::remove_reference<_Iter>::type>::type> >, std::__not_<std::__and_<std::is_scalar<_Tp>, std::is_same<_Tp, typename std::decay<_Up>::type> > >, std::is_constructible<_Tp, _Up>, std::is_assignable<_T1&, _U1> >, std::optional<_Tp>&> std::optional<_Tp>::operator=(_Up&&) [with _Up = torch::ExpandingArray<3>; _Tp = torch::ExpandingArray<3>; std::enable_if_t<__and_v<std::__not_<std::is_same<std::optional<_Tp>, typename std::remove_cv<typename std::remove_reference<_Iter>::type>::type> >, std::__not_<std::__and_<std::is_scalar<_Tp>, std::is_same<_Tp, typename std::decay<_Up>::type> > >, std::is_constructible<_Tp, _Up>, std::is_assignable<_T1&, _U1> >, std::optional<_Tp>&> = std::optional<torch::ExpandingArray<3> >&; typename std::decay<_Up>::type = std::decay<torch::ExpandingArray<3> >::type; typename std::remove_cv<typename std::remove_reference<_Iter>::type>::type = torch::ExpandingArray<3>; typename std::remove_reference<_Iter>::type = torch::ExpandingArray<3>]’
    803 |         operator=(_Up&& __u)
        |         ^~~~~~~~
  /usr/include/c++/11/optional:803:25: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘torch::ExpandingArray<3>&&’
    803 |         operator=(_Up&& __u)
        |                   ~~~~~~^~~
  /usr/include/c++/11/optional:823:9: note: candidate: ‘template<class _Up> constexpr std::enable_if_t<__and_v<std::__not_<std::is_same<_T1, _U1> >, std::is_constructible<_Tp, const _Up&>, std::is_assignable<_T1&, const _U1&>, std::__not_<std::__or_<std::is_constructible<_Tp, const std::optional<_Up>&>, std::is_constructible<_Tp, std::optional<_Up>&>, std::is_constructible<_Tp, const std::optional<_Up>&&>, std::is_constructible<_Tp, std::optional<_Up>&&>, std::is_convertible<const std::optional<_Up>&, _Tp>, std::is_convertible<std::optional<_Up>&, _Tp>, std::is_convertible<const std::optional<_Up>&&, _Tp>, std::is_convertible<std::optional<_Up>&&, _Tp> > >, std::__not_<std::__or_<std::is_assignable<_Tp&, const std::optional<_Up>&>, std::is_assignable<_Tp&, std::optional<_Up>&>, std::is_assignable<_Tp&, const std::optional<_Up>&&>, std::is_assignable<_Tp&, std::optional<_Up>&&> > > >, std::optional<_Tp>&> std::optional<_Tp>::operator=(const std::optional<_Up>&) [with _Up = _Up; _Tp = torch::ExpandingArray<3>]’
    823 |         operator=(const optional<_Up>& __u)
        |         ^~~~~~~~
  /usr/include/c++/11/optional:823:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:930:46: note:   couldn’t deduce template parameter ‘_Up’
    930 |                   (*output_ratio.value())[2])};
        |                                              ^
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:849:9: note: candidate: ‘template<class _Up> constexpr std::enable_if_t<__and_v<std::__not_<std::is_same<_T1, _U1> >, std::is_constructible<_Tp, _Up>, std::is_assignable<_T1&, _U1>, std::__not_<std::__or_<std::is_constructible<_Tp, const std::optional<_Up>&>, std::is_constructible<_Tp, std::optional<_Up>&>, std::is_constructible<_Tp, const std::optional<_Up>&&>, std::is_constructible<_Tp, std::optional<_Up>&&>, std::is_convertible<const std::optional<_Up>&, _Tp>, std::is_convertible<std::optional<_Up>&, _Tp>, std::is_convertible<const std::optional<_Up>&&, _Tp>, std::is_convertible<std::optional<_Up>&&, _Tp> > >, std::__not_<std::__or_<std::is_assignable<_Tp&, const std::optional<_Up>&>, std::is_assignable<_Tp&, std::optional<_Up>&>, std::is_assignable<_Tp&, const std::optional<_Up>&&>, std::is_assignable<_Tp&, std::optional<_Up>&&> > > >, std::optional<_Tp>&> std::optional<_Tp>::operator=(std::optional<_Up>&&) [with _Up = _Up; _Tp = torch::ExpandingArray<3>]’
    849 |         operator=(optional<_Up>&& __u)
        |         ^~~~~~~~
  /usr/include/c++/11/optional:849:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:930:46: note:   couldn’t deduce template parameter ‘_Up’
    930 |                   (*output_ratio.value())[2])};
        |                                              ^
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:789:7: note: candidate: ‘constexpr std::optional<_Tp>& std::optional<_Tp>::operator=(std::nullopt_t) [with _Tp = torch::ExpandingArray<3>]’
    789 |       operator=(nullopt_t) noexcept
        |       ^~~~~~~~
  /usr/include/c++/11/optional:789:17: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::nullopt_t’
    789 |       operator=(nullopt_t) noexcept
        |                 ^~~~~~~~~
  /usr/include/c++/11/optional:662:11: note: candidate: ‘constexpr std::optional<torch::ExpandingArray<3> >& std::optional<torch::ExpandingArray<3> >::operator=(const std::optional<torch::ExpandingArray<3> >&)’
    662 |     class optional
        |           ^~~~~~~~
  /usr/include/c++/11/optional:662:11: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::optional<torch::ExpandingArray<3> >&’
  /usr/include/c++/11/optional:662:11: note: candidate: ‘constexpr std::optional<torch::ExpandingArray<3> >& std::optional<torch::ExpandingArray<3> >::operator=(std::optional<torch::ExpandingArray<3> >&&)’
  /usr/include/c++/11/optional:662:11: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::optional<torch::ExpandingArray<3> >&&’
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:933:10: error: variable ‘torch::Tensor _random_samples_’ has initializer but incomplete type
    933 |   Tensor _random_samples_ = _random_samples;
        |          ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:935:20: error: invalid use of incomplete type ‘const class torch::Tensor’
    935 |     auto n_batch = input.dim() == 4 ? 1 : input.size(0);
        |                    ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:935:43: error: invalid use of incomplete type ‘const class torch::Tensor’
    935 |     auto n_batch = input.dim() == 4 ? 1 : input.size(0);
        |                                           ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:937:19: error: invalid use of incomplete type ‘const class torch::Tensor’
    937 |         {n_batch, input.size(-4), 3},
        |                   ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:938:38: error: invalid use of incomplete type ‘const class torch::Tensor’
    938 |         torch::TensorOptions().dtype(input.dtype()).device(input.device()));
        |                                      ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:938:60: error: invalid use of incomplete type ‘const class torch::Tensor’
    938 |         torch::TensorOptions().dtype(input.dtype()).device(input.device()));
        |                                                            ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:974:34: error: return type ‘class torch::Tensor’ is incomplete
    974 |     const Tensor& _random_samples) {
        |                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:993:50: error: return type ‘class torch::Tensor’ is incomplete
    993 |     const FractionalMaxPool3dFuncOptions& options) {
        |                                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:1011:19: error: return type ‘class torch::Tensor’ is incomplete
   1011 |     bool ceil_mode) {
        |                   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘void torch::nn::functional::detail::lp_pool1d(const torch::Tensor&, double, torch::ExpandingArray<1>, torch::ExpandingArray<1>, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:1012:10: error: variable ‘torch::Tensor out’ has initializer but incomplete type
   1012 |   Tensor out = detail::avg_pool1d(
        |          ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:1013:7: error: invalid use of incomplete type ‘const class torch::Tensor’
   1013 |       input.pow(norm_type),
        |       ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:1041:39: error: return type ‘class torch::Tensor’ is incomplete
   1041 |     const LPPool1dFuncOptions& options) {
        |                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:1057:19: error: return type ‘class torch::Tensor’ is incomplete
   1057 |     bool ceil_mode) {
        |                   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘void torch::nn::functional::detail::lp_pool2d(const torch::Tensor&, double, torch::ExpandingArray<2>, torch::ExpandingArray<2>, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:1060:10: error: variable ‘torch::Tensor out’ has initializer but incomplete type
   1060 |   Tensor out = detail::avg_pool2d(
        |          ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:1061:7: error: invalid use of incomplete type ‘const class torch::Tensor’
   1061 |       input.pow(norm_type),
        |       ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:1090:39: error: return type ‘class torch::Tensor’ is incomplete
   1090 |     const LPPool2dFuncOptions& options) {
        |                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:1106:19: error: return type ‘class torch::Tensor’ is incomplete
   1106 |     bool ceil_mode) {
        |                   ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: In function ‘void torch::nn::functional::detail::lp_pool3d(const torch::Tensor&, double, torch::ExpandingArray<3>, torch::ExpandingArray<3>, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:1110:10: error: variable ‘torch::Tensor out’ has initializer but incomplete type
   1110 |   Tensor out = detail::avg_pool3d(
        |          ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:1111:7: error: invalid use of incomplete type ‘const class torch::Tensor’
   1111 |       input.pow(norm_type),
        |       ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:1140:39: error: return type ‘class torch::Tensor’ is incomplete
   1140 |     const LPPool3dFuncOptions& options) {
        |                                       ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h:46:21: error: field ‘weight_’ has incomplete type ‘torch::Tensor’
     46 |   TORCH_ARG(Tensor, weight) = {};
        |                     ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h:48:21: error: field ‘bias_’ has incomplete type ‘torch::Tensor’
     48 |   TORCH_ARG(Tensor, bias) = {};
        |                     ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/move.h:57,
                   from /usr/include/c++/11/bits/stl_pair.h:59,
                   from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::__is_trivially_copy_constructible_impl<torch::Tensor, true>’:
  /usr/include/c++/11/type_traits:1254:12:   required from ‘struct std::is_trivially_copy_constructible<torch::Tensor>’
  /usr/include/c++/11/type_traits:3200:43:   required from ‘constexpr const bool std::is_trivially_copy_constructible_v<torch::Tensor>’
  /usr/include/c++/11/optional:662:11:   required from ‘class std::optional<torch::Tensor>’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h:135:48:   required from here
  /usr/include/c++/11/type_traits:1249:25: error: invalid use of incomplete type ‘class torch::Tensor’
   1249 |                         __is_trivially_constructible(_Tp, const _Tp&)>>
        |                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/move.h:57,
                   from /usr/include/c++/11/bits/stl_pair.h:59,
                   from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::is_trivially_copy_constructible<torch::Tensor>’:
  /usr/include/c++/11/type_traits:3200:43:   required from ‘constexpr const bool std::is_trivially_copy_constructible_v<torch::Tensor>’
  /usr/include/c++/11/optional:662:11:   required from ‘class std::optional<torch::Tensor>’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h:135:48:   required from here
  /usr/include/c++/11/type_traits:1257:52: error: static assertion failed: template argument must be a complete class or an unbounded array
   1257 |       static_assert(std::__is_complete_or_unbounded(__type_identity<_Tp>{}),
        |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/type_traits:1257:52: note: ‘std::__is_complete_or_unbounded<std::__type_identity<torch::Tensor> >((std::__type_identity<torch::Tensor>{}, std::__type_identity<torch::Tensor>()))’ evaluates to false
  /usr/include/c++/11/type_traits: In instantiation of ‘constexpr const bool std::is_trivially_copy_constructible_v<torch::Tensor>’:
  /usr/include/c++/11/optional:662:11:   required from ‘class std::optional<torch::Tensor>’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h:135:48:   required from here
  /usr/include/c++/11/type_traits:3200:43: error: ‘value’ is not a member of ‘std::is_trivially_copy_constructible<torch::Tensor>’
   3200 |     is_trivially_copy_constructible<_Tp>::value;
        |                                           ^~~~~
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::__is_trivially_move_constructible_impl<torch::Tensor, true>’:
  /usr/include/c++/11/type_traits:1277:12:   required from ‘struct std::is_trivially_move_constructible<torch::Tensor>’
  /usr/include/c++/11/type_traits:3203:43:   required from ‘constexpr const bool std::is_trivially_move_constructible_v<torch::Tensor>’
  /usr/include/c++/11/optional:662:11:   required from ‘class std::optional<torch::Tensor>’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h:135:48:   required from here
  /usr/include/c++/11/type_traits:1272:25: error: invalid use of incomplete type ‘class torch::Tensor’
   1272 |                         __is_trivially_constructible(_Tp, _Tp&&)>>
        |                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/move.h:57,
                   from /usr/include/c++/11/bits/stl_pair.h:59,
                   from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::is_trivially_move_constructible<torch::Tensor>’:
  /usr/include/c++/11/type_traits:3203:43:   required from ‘constexpr const bool std::is_trivially_move_constructible_v<torch::Tensor>’
  /usr/include/c++/11/optional:662:11:   required from ‘class std::optional<torch::Tensor>’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h:135:48:   required from here
  /usr/include/c++/11/type_traits:1280:52: error: static assertion failed: template argument must be a complete class or an unbounded array
   1280 |       static_assert(std::__is_complete_or_unbounded(__type_identity<_Tp>{}),
        |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/type_traits:1280:52: note: ‘std::__is_complete_or_unbounded<std::__type_identity<torch::Tensor> >((std::__type_identity<torch::Tensor>{}, std::__type_identity<torch::Tensor>()))’ evaluates to false
  /usr/include/c++/11/type_traits: In instantiation of ‘constexpr const bool std::is_trivially_move_constructible_v<torch::Tensor>’:
  /usr/include/c++/11/optional:662:11:   required from ‘class std::optional<torch::Tensor>’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h:135:48:   required from here
  /usr/include/c++/11/type_traits:3203:43: error: ‘value’ is not a member of ‘std::is_trivially_move_constructible<torch::Tensor>’
   3203 |     is_trivially_move_constructible<_Tp>::value;
        |                                           ^~~~~
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::is_copy_constructible<torch::Tensor>’:
  /usr/include/c++/11/type_traits:3180:33:   required from ‘constexpr const bool std::is_copy_constructible_v<torch::Tensor>’
  /usr/include/c++/11/optional:666:2:   required from ‘class std::optional<torch::Tensor>’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h:135:48:   required from here
  /usr/include/c++/11/type_traits:987:52: error: static assertion failed: template argument must be a complete class or an unbounded array
    987 |       static_assert(std::__is_complete_or_unbounded(__type_identity<_Tp>{}),
        |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/type_traits:987:52: note: ‘std::__is_complete_or_unbounded<std::__type_identity<torch::Tensor> >((std::__type_identity<torch::Tensor>{}, std::__type_identity<torch::Tensor>()))’ evaluates to false
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::is_move_constructible<torch::Tensor>’:
  /usr/include/c++/11/type_traits:3183:33:   required from ‘constexpr const bool std::is_move_constructible_v<torch::Tensor>’
  /usr/include/c++/11/optional:670:2:   required from ‘class std::optional<torch::Tensor>’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h:135:48:   required from here
  /usr/include/c++/11/type_traits:1010:52: error: static assertion failed: template argument must be a complete class or an unbounded array
   1010 |       static_assert(std::__is_complete_or_unbounded(__type_identity<_Tp>{}),
        |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/type_traits:1010:52: note: ‘std::__is_complete_or_unbounded<std::__type_identity<torch::Tensor> >((std::__type_identity<torch::Tensor>{}, std::__type_identity<torch::Tensor>()))’ evaluates to false
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h: In member function ‘torch::nn::functional::NormalizeFuncOptions& torch::nn::functional::NormalizeFuncOptions::out(const std::optional<torch::Tensor>&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:8:21: error: use of deleted function ‘std::optional<torch::Tensor>& std::optional<torch::Tensor>::operator=(const std::optional<torch::Tensor>&)’
      8 |     this->name##_ = new_##name;                                           \
        |                     ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:8:21: note: in definition of macro ‘TORCH_ARG’
      8 |     this->name##_ = new_##name;                                           \
        |                     ^~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:662:11: note: ‘std::optional<torch::Tensor>& std::optional<torch::Tensor>::operator=(const std::optional<torch::Tensor>&)’ is implicitly deleted because the default definition would be ill-formed:
    662 |     class optional
        |           ^~~~~~~~
  /usr/include/c++/11/optional:662:11: error: use of deleted function ‘std::_Enable_copy_move<false, false, false, false, _Tag>& std::_Enable_copy_move<false, false, false, false, _Tag>::operator=(const std::_Enable_copy_move<false, false, false, false, _Tag>&) [with _Tag = std::optional<torch::Tensor>]’
  In file included from /usr/include/c++/11/bits/hashtable.h:36,
                   from /usr/include/c++/11/unordered_map:46,
                   from /workspace/nunchaku/src/common.h:15,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/enable_special_members.h:307:5: note: declared here
    307 |     operator=(_Enable_copy_move const&) noexcept                    = delete;
        |     ^~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h: In member function ‘torch::nn::functional::NormalizeFuncOptions& torch::nn::functional::NormalizeFuncOptions::out(std::optional<torch::Tensor>&&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:12:41: error: use of deleted function ‘std::optional<torch::Tensor>& std::optional<torch::Tensor>::operator=(std::optional<torch::Tensor>&&)’
     12 |     this->name##_ = std::move(new_##name);                                \
        |                                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h:135:3: note: in expansion of macro ‘TORCH_ARG’
    135 |   TORCH_ARG(std::optional<Tensor>, out) = std::nullopt;
        |   ^~~~~~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:662:11: note: ‘std::optional<torch::Tensor>& std::optional<torch::Tensor>::operator=(std::optional<torch::Tensor>&&)’ is implicitly deleted because the default definition would be ill-formed:
    662 |     class optional
        |           ^~~~~~~~
  /usr/include/c++/11/optional:662:11: error: use of deleted function ‘std::_Enable_copy_move<false, false, false, false, _Tag>& std::_Enable_copy_move<false, false, false, false, _Tag>::operator=(std::_Enable_copy_move<false, false, false, false, _Tag>&&) [with _Tag = std::optional<torch::Tensor>]’
  In file included from /usr/include/c++/11/bits/hashtable.h:36,
                   from /usr/include/c++/11/unordered_map:46,
                   from /workspace/nunchaku/src/common.h:15,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/enable_special_members.h:309:5: note: declared here
    309 |     operator=(_Enable_copy_move&&) noexcept                         = delete;
        |     ^~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h:180:21: error: field ‘weight_’ has incomplete type ‘torch::Tensor’
    180 |   TORCH_ARG(Tensor, weight) = {};
        |                     ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h:182:21: error: field ‘bias_’ has incomplete type ‘torch::Tensor’
    182 |   TORCH_ARG(Tensor, bias) = {};
        |                     ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:17:30: error: return type ‘class torch::Tensor’ is incomplete
     17 |     std::optional<Tensor> out) {
        |                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h: In function ‘void torch::nn::functional::detail::normalize(const torch::Tensor&, double, int64_t, double, std::optional<torch::Tensor>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:19:18: error: invalid use of incomplete type ‘const class torch::Tensor’
     19 |     auto denom = input.norm(p, dim, true).clamp_min(eps).expand_as(input);
        |                  ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:22:18: error: invalid use of incomplete type ‘const class torch::Tensor’
     22 |     auto denom = input.norm(p, dim, true).clamp_min(eps).expand_as(input);
        |                  ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional: In instantiation of ‘constexpr std::optional<_Tp>::operator bool() const [with _Tp = torch::Tensor]’:
  /usr/include/c++/11/optional:1106:14:   required from ‘constexpr bool std::operator==(const std::optional<_Tp>&, std::nullopt_t) [with _Tp = torch::Tensor]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:18:11:   required from here
  /usr/include/c++/11/optional:942:22: error: ‘const class std::optional<torch::Tensor>’ has no member named ‘_M_is_engaged’
    942 |       { return this->_M_is_engaged(); }
        |                ~~~~~~^~~~~~~~~~~~~
  In file included from /usr/include/c++/11/bits/move.h:57,
                   from /usr/include/c++/11/bits/stl_pair.h:59,
                   from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::is_constructible<torch::Tensor>’:
  /usr/include/c++/11/type_traits:147:12:   required from ‘struct std::__and_<std::is_constructible<torch::Tensor> >’
  /usr/include/c++/11/type_traits:173:53:   required from ‘constexpr const bool std::__and_v<std::is_constructible<torch::Tensor> >’
  /usr/include/c++/11/optional:770:54:   required by substitution of ‘template<class ... _Args, typename std::enable_if<__and_v<std::is_constructible<torch::Tensor, _Args ...> >, bool>::type <anonymous> > constexpr std::optional<torch::Tensor>::optional(std::in_place_t, _Args&& ...) [with _Args = {}; typename std::enable_if<__and_v<std::is_constructible<torch::Tensor, _Args ...> >, bool>::type <anonymous> = <missing>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:43:38:   required from here
  /usr/include/c++/11/type_traits:955:52: error: static assertion failed: template argument must be a complete class or an unbounded array
    955 |       static_assert(std::__is_complete_or_unbounded(__type_identity<_Tp>{}),
        |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/type_traits:955:52: note: ‘std::__is_complete_or_unbounded<std::__type_identity<torch::Tensor> >((std::__type_identity<torch::Tensor>{}, std::__type_identity<torch::Tensor>()))’ evaluates to false
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:43:38: error: return type ‘class torch::Tensor’ is incomplete
     43 |     NormalizeFuncOptions options = {}) {
        |                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h: In function ‘void torch::nn::functional::normalize(const torch::Tensor&, torch::nn::functional::NormalizeFuncOptions)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:44:27: error: use of deleted function ‘std::optional<torch::Tensor>::optional(const std::optional<torch::Tensor>&)’
     44 |   return detail::normalize(
        |          ~~~~~~~~~~~~~~~~~^
     45 |       input, options.p(), options.dim(), options.eps(), options.out());
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:662:11: note: ‘std::optional<torch::Tensor>::optional(const std::optional<torch::Tensor>&)’ is implicitly deleted because the default definition would be ill-formed:
    662 |     class optional
        |           ^~~~~~~~
  /usr/include/c++/11/optional:662:11: error: use of deleted function ‘constexpr std::_Enable_copy_move<false, false, false, false, _Tag>::_Enable_copy_move(const std::_Enable_copy_move<false, false, false, false, _Tag>&) [with _Tag = std::optional<torch::Tensor>]’
  In file included from /usr/include/c++/11/bits/hashtable.h:36,
                   from /usr/include/c++/11/unordered_map:46,
                   from /workspace/nunchaku/src/common.h:15,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/enable_special_members.h:304:15: note: declared here
    304 |     constexpr _Enable_copy_move(_Enable_copy_move const&) noexcept  = delete;
        |               ^~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:17:27: note:   initializing argument 5 of ‘void torch::nn::functional::detail::normalize(const torch::Tensor&, double, int64_t, double, std::optional<torch::Tensor>)’
     17 |     std::optional<Tensor> out) {
        |     ~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:57:15: error: return type ‘class torch::Tensor’ is incomplete
     57 |     double eps) {
        |               ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h: In function ‘void torch::nn::functional::detail::layer_norm(const torch::Tensor&, const std::vector<long int>&, const torch::Tensor&, const torch::Tensor&, double)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:58:28: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     58 |   return torch::layer_norm(input, normalized_shape, weight, bias, eps);
        |                            ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:845,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/layer_norm.h:26:49: note: in passing argument 1 of ‘at::Tensor at::layer_norm(const at::Tensor&, at::IntArrayRef, const std::optional<at::Tensor>&, const std::optional<at::Tensor>&, double, bool)’
     26 | inline at::Tensor layer_norm(const at::Tensor & input, at::IntArrayRef normalized_shape, const ::std::optional<at::Tensor> & weight={}, const ::std::optional<at::Tensor> & bias={}, double eps=1e-05, bool cudnn_enable=true) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:77:40: error: return type ‘class torch::Tensor’ is incomplete
     77 |     const LayerNormFuncOptions& options) {
        |                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:95:13: error: return type ‘class torch::Tensor’ is incomplete
     95 |     double k) {
        |             ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h: In function ‘void torch::nn::functional::detail::local_response_norm(const torch::Tensor&, int64_t, double, double, double)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:96:14: error: invalid use of incomplete type ‘const class torch::Tensor’
     96 |   auto dim = input.dim();
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:102:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    102 |   auto div = input.mul(input).unsqueeze(1);
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:119:18: error: invalid use of incomplete type ‘const class torch::Tensor’
    119 |     auto sizes = input.sizes();
        |                  ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:158:48: error: return type ‘class torch::Tensor’ is incomplete
    158 |     const LocalResponseNormFuncOptions& options) {
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:172:15: error: return type ‘class torch::Tensor’ is incomplete
    172 |     double eps) {
        |               ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h: In function ‘void torch::nn::functional::detail::group_norm(const torch::Tensor&, int64_t, const torch::Tensor&, const torch::Tensor&, double)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:174:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    174 |       input,
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:771,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/group_norm.h:26:49: note: in passing argument 1 of ‘at::Tensor at::group_norm(const at::Tensor&, int64_t, const std::optional<at::Tensor>&, const std::optional<at::Tensor>&, double, bool)’
     26 | inline at::Tensor group_norm(const at::Tensor & input, int64_t num_groups, const ::std::optional<at::Tensor> & weight={}, const ::std::optional<at::Tensor> & bias={}, double eps=1e-05, bool cudnn_enabled=true) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:198:40: error: return type ‘class torch::Tensor’ is incomplete
    198 |     const GroupNormFuncOptions& options) {
        |                                        ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:14,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pixelshuffle.h:9:72: error: return type ‘class torch::Tensor’ is incomplete
      9 | inline Tensor pixel_shuffle(const Tensor& input, int64_t upscale_factor) {
        |                                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pixelshuffle.h: In function ‘void torch::nn::functional::detail::pixel_shuffle(const torch::Tensor&, int64_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pixelshuffle.h:10:31: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     10 |   return torch::pixel_shuffle(input, upscale_factor);
        |                               ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1066,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/pixel_shuffle.h:26:52: note: in passing argument 1 of ‘at::Tensor at::pixel_shuffle(const at::Tensor&, int64_t)’
     26 | inline at::Tensor pixel_shuffle(const at::Tensor & self, int64_t upscale_factor) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:14,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pixelshuffle.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pixelshuffle.h:13:76: error: return type ‘class torch::Tensor’ is incomplete
     13 | inline Tensor pixel_unshuffle(const Tensor& input, int64_t downscale_factor) {
        |                                                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pixelshuffle.h: In function ‘void torch::nn::functional::detail::pixel_unshuffle(const torch::Tensor&, int64_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pixelshuffle.h:14:33: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     14 |   return torch::pixel_unshuffle(input, downscale_factor);
        |                                 ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1067,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/pixel_unshuffle.h:26:54: note: in passing argument 1 of ‘at::Tensor at::pixel_unshuffle(const at::Tensor&, int64_t)’
     26 | inline at::Tensor pixel_unshuffle(const at::Tensor & self, int64_t downscale_factor) {
        |                                   ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:14,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pixelshuffle.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pixelshuffle.h:33:43: error: return type ‘class torch::Tensor’ is incomplete
     33 |     const PixelShuffleFuncOptions& options) {
        |                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pixelshuffle.h:39:45: error: return type ‘class torch::Tensor’ is incomplete
     39 |     const PixelUnshuffleFuncOptions& options) {
        |                                             ^
  In file included from /usr/include/c++/11/bits/unique_ptr.h:37,
                   from /usr/include/c++/11/memory:76,
                   from /workspace/nunchaku/src/common.h:9,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/tuple: In instantiation of ‘struct std::_Tuple_impl<0, torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >’:
  /usr/include/c++/11/tuple:609:11:   required from ‘class std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:18:46:   required from here
  /usr/include/c++/11/tuple:69:28: error: invalid use of incomplete type ‘class torch::Tensor’
     69 |     = typename conditional<__is_final(_Tp), false_type,
        |                            ^~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/unique_ptr.h:37,
                   from /usr/include/c++/11/memory:76,
                   from /workspace/nunchaku/src/common.h:9,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/tuple:69:28: error: invalid use of incomplete type ‘class torch::Tensor’
     69 |     = typename conditional<__is_final(_Tp), false_type,
        |                            ^~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h: In function ‘std::vector<long int> torch::nn::functional::_interp_output_size(int64_t, std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:68:35: error: invalid use of incomplete type ‘std::tuple_element<0, std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> > >::type’ {aka ‘class torch::Tensor’}
     68 |         floor(static_cast<double>(input.size(i + 2)) * scale_factors[i])));
        |                                   ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘std::tuple_element<0, std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> > >::type’ {aka ‘class torch::Tensor’}
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:82:19: error: return type ‘class torch::Tensor’ is incomplete
     82 |     bool antialias) {
        |                   ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h: In function ‘void torch::nn::functional::detail::interpolate(const torch::Tensor&, const std::optional<std::vector<long int> >&, const std::optional<std::vector<double, std::allocator<double> > >&, torch::nn::functional::InterpolateFuncOptions::mode_t, std::optional<bool>, std::optional<bool>, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:105:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    105 |       input.dim() >= 3 && input.dim() <= 5,
        |       ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:104:3: note: in expansion of macro ‘TORCH_CHECK’
    104 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:105:27: error: invalid use of incomplete type ‘const class torch::Tensor’
    105 |       input.dim() >= 3 && input.dim() <= 5,
        |                           ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:104:3: note: in expansion of macro ‘TORCH_CHECK’
    104 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:108:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    108 |       input.dim(),
        |       ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:104:3: note: in expansion of macro ‘TORCH_CHECK’
    104 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:114:27: error: invalid use of incomplete type ‘const class torch::Tensor’
    114 |   auto scale_factor_len = input.dim() - 2;
        |                           ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:126:9: error: invalid use of incomplete type ‘const class torch::Tensor’
    126 |       !(input.dim() == 4 &&
        |         ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/move.h:57,
                   from /usr/include/c++/11/bits/stl_pair.h:59,
                   from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::is_constructible<torch::Tensor, const torch::Tensor&>’:
  /usr/include/c++/11/type_traits:157:12:   required from ‘struct std::__and_<std::is_constructible<torch::Tensor, const torch::Tensor&>, std::is_constructible<std::optional<std::vector<long int, std::allocator<long int> > >, const std::optional<std::vector<long int, std::allocator<long int> > >&>, std::is_constructible<std::optional<std::vector<double, std::allocator<double> > >, const std::optional<std::vector<double, std::allocator<double> > >&>, std::is_constructible<std::optional<bool>, const std::optional<bool>&>, std::is_convertible<const torch::Tensor&, torch::Tensor>, std::is_convertible<const std::optional<std::vector<long int, std::allocator<long int> > >&, std::optional<std::vector<long int, std::allocator<long int> > > >, std::is_convertible<const std::optional<std::vector<double, std::allocator<double> > >&, std::optional<std::vector<double, std::allocator<double> > > >, std::is_convertible<const std::optional<bool>&, std::optional<bool> > >’
  /usr/include/c++/11/tuple:564:7:   required from ‘static constexpr bool std::_TupleConstraints<<anonymous>, _Types>::__is_implicitly_constructible() [with _UTypes = {const torch::Tensor&, const std::optional<std::vector<long int, std::allocator<long int> > >&, const std::optional<std::vector<double, std::allocator<double> > >&, const std::optional<bool>&}; bool <anonymous> = true; _Types = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
  /usr/include/c++/11/tuple:631:65:   required by substitution of ‘template<bool _NotEmpty, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Cond>::__is_implicitly_constructible<const Tensor&, const optional<std::vector<long int, std::allocator<long int> > >&, const optional<std::vector<double, std::allocator<double> > >&, const optional<bool>&>(), bool>::type <anonymous> > constexpr std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::tuple(const torch::Tensor&, const std::optional<std::vector<long int> >&, const std::optional<std::vector<double, std::allocator<double> > >&, const std::optional<bool>&) [with bool _NotEmpty = true; typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Cond>::__is_implicitly_constructible<const Tensor&, const optional<std::vector<long int, std::allocator<long int> > >&, const optional<std::vector<double, std::allocator<double> > >&, const optional<bool>&>(), bool>::type <anonymous> = <missing>]’
  /usr/include/c++/11/tuple:1609:14:   required from ‘constexpr std::tuple<typename std::__strip_reference_wrapper<typename std::decay<_Elements>::type>::__type ...> std::make_tuple(_Elements&& ...) [with _Elements = {const torch::Tensor&, const std::optional<std::vector<long int, std::allocator<long int> > >&, const std::optional<std::vector<double, std::allocator<double> > >&, std::optional<bool>&}]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:135:72:   required from here
  /usr/include/c++/11/type_traits:955:52: error: static assertion failed: template argument must be a complete class or an unbounded array
    955 |       static_assert(std::__is_complete_or_unbounded(__type_identity<_Tp>{}),
        |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/type_traits:955:52: note: ‘std::__is_complete_or_unbounded<std::__type_identity<torch::Tensor> >((std::__type_identity<torch::Tensor>{}, std::__type_identity<torch::Tensor>()))’ evaluates to false
  In file included from /usr/include/c++/11/bits/unique_ptr.h:37,
                   from /usr/include/c++/11/memory:76,
                   from /workspace/nunchaku/src/common.h:9,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/tuple: In instantiation of ‘constexpr std::tuple<typename std::__strip_reference_wrapper<typename std::decay<_Elements>::type>::__type ...> std::make_tuple(_Elements&& ...) [with _Elements = {const torch::Tensor&, const std::optional<std::vector<long int, std::allocator<long int> > >&, const std::optional<std::vector<double, std::allocator<double> > >&, std::optional<bool>&}]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:135:72:   required from here
  /usr/include/c++/11/tuple:1609:14: error: no matching function for call to ‘std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::tuple(const torch::Tensor&, const std::optional<std::vector<long int> >&, const std::optional<std::vector<double, std::allocator<double> > >&, std::optional<bool>&)’
   1609 |       return __result_type(std::forward<_Elements>(__args)...);
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/tuple:888:9: note: candidate: ‘template<class _Alloc, class ... _UElements, bool _Valid, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Valid>::__is_explicitly_constructible<_UElements ...>(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(std::allocator_arg_t, const _Alloc&, std::tuple<_Args2 ...>&&) [with _Alloc = _Alloc; _UElements = {_UElements ...}; bool _Valid = _Valid; typename std::enable_if<std::tuple<_Elements>::_TCC<_Valid>::__is_explicitly_constructible<_UElements ...>(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    888 |         tuple(allocator_arg_t __tag, const _Alloc& __a,
        |         ^~~~~
  /usr/include/c++/11/tuple:888:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:1609:14: note:   types ‘std::tuple<_UTypes ...>’ and ‘const std::optional<std::vector<double, std::allocator<double> > >’ have incompatible cv-qualifiers
   1609 |       return __result_type(std::forward<_Elements>(__args)...);
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/tuple:876:9: note: candidate: ‘template<class _Alloc, class ... _UElements, bool _Valid, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Valid>::__is_implicitly_constructible<_UElements ...>(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(std::allocator_arg_t, const _Alloc&, std::tuple<_Args2 ...>&&) [with _Alloc = _Alloc; _UElements = {_UElements ...}; bool _Valid = _Valid; typename std::enable_if<std::tuple<_Elements>::_TCC<_Valid>::__is_implicitly_constructible<_UElements ...>(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    876 |         tuple(allocator_arg_t __tag, const _Alloc& __a,
        |         ^~~~~
  /usr/include/c++/11/tuple:876:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:1609:14: note:   types ‘std::tuple<_UTypes ...>’ and ‘const std::optional<std::vector<double, std::allocator<double> > >’ have incompatible cv-qualifiers
   1609 |       return __result_type(std::forward<_Elements>(__args)...);
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/tuple:865:9: note: candidate: ‘template<class _Alloc, class ... _UElements, bool _Valid, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Valid>::__is_explicitly_constructible<const _UElements& ...>(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(std::allocator_arg_t, const _Alloc&, const std::tuple<_Args2 ...>&) [with _Alloc = _Alloc; _UElements = {_UElements ...}; bool _Valid = _Valid; typename std::enable_if<std::tuple<_Elements>::_TCC<_Valid>::__is_explicitly_constructible<const _UElements& ...>(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    865 |         tuple(allocator_arg_t __tag, const _Alloc& __a,
        |         ^~~~~
  /usr/include/c++/11/tuple:865:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:1609:14: note:   ‘const std::optional<std::vector<double, std::allocator<double> > >’ is not derived from ‘const std::tuple<_UTypes ...>’
   1609 |       return __result_type(std::forward<_Elements>(__args)...);
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/tuple:853:9: note: candidate: ‘template<class _Alloc, class ... _UElements, bool _Valid, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Valid>::__is_implicitly_constructible<const _UElements& ...>(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(std::allocator_arg_t, const _Alloc&, const std::tuple<_Args2 ...>&) [with _Alloc = _Alloc; _UElements = {_UElements ...}; bool _Valid = _Valid; typename std::enable_if<std::tuple<_Elements>::_TCC<_Valid>::__is_implicitly_constructible<const _UElements& ...>(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    853 |         tuple(allocator_arg_t __tag, const _Alloc& __a,
        |         ^~~~~
  /usr/include/c++/11/tuple:853:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:1609:14: note:   ‘const std::optional<std::vector<double, std::allocator<double> > >’ is not derived from ‘const std::tuple<_UTypes ...>’
   1609 |       return __result_type(std::forward<_Elements>(__args)...);
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/tuple:845:9: note: candidate: ‘template<class _Alloc> constexpr std::tuple<_Elements>::tuple(std::allocator_arg_t, const _Alloc&, std::tuple<_Elements>&&) [with _Alloc = _Alloc; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    845 |         tuple(allocator_arg_t __tag, const _Alloc& __a, tuple&& __in)
        |         ^~~~~
  /usr/include/c++/11/tuple:845:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:1609:14: note:   candidate expects 3 arguments, 4 provided
   1609 |       return __result_type(std::forward<_Elements>(__args)...);
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/tuple:840:9: note: candidate: ‘template<class _Alloc> constexpr std::tuple<_Elements>::tuple(std::allocator_arg_t, const _Alloc&, const std::tuple<_Elements>&) [with _Alloc = _Alloc; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    840 |         tuple(allocator_arg_t __tag, const _Alloc& __a, const tuple& __in)
        |         ^~~~~
  /usr/include/c++/11/tuple:840:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:1609:14: note:   candidate expects 3 arguments, 4 provided
   1609 |       return __result_type(std::forward<_Elements>(__args)...);
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/tuple:833:9: note: candidate: ‘template<class _Alloc, class ... _UElements, bool _Valid, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Valid>::__is_explicitly_constructible<_UElements ...>(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(std::allocator_arg_t, const _Alloc&, _UElements&& ...) [with _Alloc = _Alloc; _UElements = {_UElements ...}; bool _Valid = _Valid; typename std::enable_if<std::tuple<_Elements>::_TCC<_Valid>::__is_explicitly_constructible<_UElements ...>(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    833 |         tuple(allocator_arg_t __tag, const _Alloc& __a,
        |         ^~~~~
  /usr/include/c++/11/tuple:833:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:830:55: error: no type named ‘type’ in ‘struct std::enable_if<false, bool>’
    830 |                _ExplicitCtor<_Valid, _UElements...> = false>
        |                                                       ^~~~~
  /usr/include/c++/11/tuple:823:9: note: candidate: ‘template<class _Alloc, class ... _UElements, bool _Valid, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Valid>::__is_implicitly_constructible<_UElements ...>(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(std::allocator_arg_t, const _Alloc&, _UElements&& ...) [with _Alloc = _Alloc; _UElements = {_UElements ...}; bool _Valid = _Valid; typename std::enable_if<std::tuple<_Elements>::_TCC<_Valid>::__is_implicitly_constructible<_UElements ...>(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    823 |         tuple(allocator_arg_t __tag, const _Alloc& __a,
        |         ^~~~~
  /usr/include/c++/11/tuple:823:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:821:55: error: no type named ‘type’ in ‘struct std::enable_if<false, bool>’
    821 |                _ImplicitCtor<_Valid, _UElements...> = true>
        |                                                       ^~~~
  /usr/include/c++/11/tuple:815:9: note: candidate: ‘template<class _Alloc, bool _NotEmpty, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Valid>::__is_explicitly_constructible<const Tensor&, const optional<std::vector<long int, std::allocator<long int> > >&, const optional<std::vector<double, std::allocator<double> > >&, const optional<bool>&>(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(std::allocator_arg_t, const _Alloc&, const _Elements& ...) [with _Alloc = _Alloc; bool _NotEmpty = _NotEmpty; typename std::enable_if<std::tuple<_Elements>::_TCC<_Valid>::__is_explicitly_constructible<const _Elements& ...>(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    815 |         tuple(allocator_arg_t __tag, const _Alloc& __a,
        |         ^~~~~
  /usr/include/c++/11/tuple:815:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:1609:14: note:   candidate expects 6 arguments, 4 provided
   1609 |       return __result_type(std::forward<_Elements>(__args)...);
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/tuple:807:9: note: candidate: ‘template<class _Alloc, bool _NotEmpty, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Valid>::__is_implicitly_constructible<const Tensor&, const optional<std::vector<long int, std::allocator<long int> > >&, const optional<std::vector<double, std::allocator<double> > >&, const optional<bool>&>(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(std::allocator_arg_t, const _Alloc&, const _Elements& ...) [with _Alloc = _Alloc; bool _NotEmpty = _NotEmpty; typename std::enable_if<std::tuple<_Elements>::_TCC<_Valid>::__is_implicitly_constructible<const _Elements& ...>(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    807 |         tuple(allocator_arg_t __tag, const _Alloc& __a,
        |         ^~~~~
  /usr/include/c++/11/tuple:807:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:1609:14: note:   candidate expects 6 arguments, 4 provided
   1609 |       return __result_type(std::forward<_Elements>(__args)...);
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/tuple:801:9: note: candidate: ‘template<class _Alloc, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<std::is_object<_Tp>::value>::__is_implicitly_default_constructible(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(std::allocator_arg_t, const _Alloc&) [with _Alloc = _Alloc; typename std::enable_if<std::tuple<_Elements>::_TCC<std::is_object<_Alloc>::value>::__is_implicitly_default_constructible(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    801 |         tuple(allocator_arg_t __tag, const _Alloc& __a)
        |         ^~~~~
  /usr/include/c++/11/tuple:801:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:1609:14: note:   candidate expects 2 arguments, 4 provided
   1609 |       return __result_type(std::forward<_Elements>(__args)...);
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/tuple:792:9: note: candidate: ‘template<class ... _UElements, bool _Valid, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Valid>::__is_explicitly_constructible<_UElements ...>(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(std::tuple<_Args1 ...>&&) [with _UElements = {_UElements ...}; bool _Valid = _Valid; typename std::enable_if<std::tuple<_Elements>::_TCC<_Valid>::__is_explicitly_constructible<_UElements ...>(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    792 |         tuple(tuple<_UElements...>&& __in)
        |         ^~~~~
  /usr/include/c++/11/tuple:792:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:1609:14: note:   types ‘std::tuple<_Tps ...>’ and ‘const torch::Tensor’ have incompatible cv-qualifiers
   1609 |       return __result_type(std::forward<_Elements>(__args)...);
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/tuple:783:9: note: candidate: ‘template<class ... _UElements, bool _Valid, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Valid>::__is_implicitly_constructible<_UElements ...>(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(std::tuple<_Args1 ...>&&) [with _UElements = {_UElements ...}; bool _Valid = _Valid; typename std::enable_if<std::tuple<_Elements>::_TCC<_Valid>::__is_implicitly_constructible<_UElements ...>(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    783 |         tuple(tuple<_UElements...>&& __in)
        |         ^~~~~
  /usr/include/c++/11/tuple:783:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:1609:14: note:   types ‘std::tuple<_Tps ...>’ and ‘const torch::Tensor’ have incompatible cv-qualifiers
   1609 |       return __result_type(std::forward<_Elements>(__args)...);
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/tuple:773:9: note: candidate: ‘template<class ... _UElements, bool _Valid, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Valid>::__is_explicitly_constructible<const _UElements& ...>(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(const std::tuple<_Args1 ...>&) [with _UElements = {_UElements ...}; bool _Valid = _Valid; typename std::enable_if<std::tuple<_Elements>::_TCC<_Valid>::__is_explicitly_constructible<const _UElements& ...>(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    773 |         tuple(const tuple<_UElements...>& __in)
        |         ^~~~~
  /usr/include/c++/11/tuple:773:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:1609:14: note:   ‘const torch::Tensor’ is not derived from ‘const std::tuple<_Tps ...>’
   1609 |       return __result_type(std::forward<_Elements>(__args)...);
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/tuple:763:9: note: candidate: ‘template<class ... _UElements, bool _Valid, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Valid>::__is_implicitly_constructible<const _UElements& ...>(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(const std::tuple<_Args1 ...>&) [with _UElements = {_UElements ...}; bool _Valid = _Valid; typename std::enable_if<std::tuple<_Elements>::_TCC<_Valid>::__is_implicitly_constructible<const _UElements& ...>(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    763 |         tuple(const tuple<_UElements...>& __in)
        |         ^~~~~
  /usr/include/c++/11/tuple:763:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:1609:14: note:   ‘const torch::Tensor’ is not derived from ‘const std::tuple<_Tps ...>’
   1609 |       return __result_type(std::forward<_Elements>(__args)...);
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/tuple:750:9: note: candidate: ‘template<class ... _UElements, bool _Valid, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Valid>::__is_explicitly_constructible<_UElements ...>(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(_UElements&& ...) [with _UElements = {_UElements ...}; bool _Valid = _Valid; typename std::enable_if<std::tuple<_Elements>::_TCC<_Valid>::__is_explicitly_constructible<_UElements ...>(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    750 |         tuple(_UElements&&... __elements)
        |         ^~~~~
  /usr/include/c++/11/tuple:750:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:748:55: error: no type named ‘type’ in ‘struct std::enable_if<false, bool>’
    748 |                _ExplicitCtor<_Valid, _UElements...> = false>
        |                                                       ^~~~~
  /usr/include/c++/11/tuple:742:9: note: candidate: ‘template<class ... _UElements, bool _Valid, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Valid>::__is_implicitly_constructible<_UElements ...>(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(_UElements&& ...) [with _UElements = {_UElements ...}; bool _Valid = _Valid; typename std::enable_if<std::tuple<_Elements>::_TCC<_Valid>::__is_implicitly_constructible<_UElements ...>(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    742 |         tuple(_UElements&&... __elements)
        |         ^~~~~
  /usr/include/c++/11/tuple:742:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:740:55: error: no type named ‘type’ in ‘struct std::enable_if<false, bool>’
    740 |                _ImplicitCtor<_Valid, _UElements...> = true>
        |                                                       ^~~~
  /usr/include/c++/11/tuple:734:9: note: candidate: ‘template<bool _NotEmpty, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Cond>::__is_explicitly_constructible<const Tensor&, const optional<std::vector<long int, std::allocator<long int> > >&, const optional<std::vector<double, std::allocator<double> > >&, const optional<bool>&>(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(const _Elements& ...) [with bool _NotEmpty = _NotEmpty; typename std::enable_if<std::tuple<_Elements>::_TCC<_Dummy>::__is_explicitly_constructible<const _Elements& ...>(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    734 |         tuple(const _Elements&... __elements)
        |         ^~~~~
  /usr/include/c++/11/tuple:734:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:732:64: error: no type named ‘type’ in ‘struct std::enable_if<false, bool>’
    732 |                _ExplicitCtor<_NotEmpty, const _Elements&...> = false>
        |                                                                ^~~~~
  /usr/include/c++/11/tuple:727:9: note: candidate: ‘template<bool _NotEmpty, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<_Cond>::__is_implicitly_constructible<const Tensor&, const optional<std::vector<long int, std::allocator<long int> > >&, const optional<std::vector<double, std::allocator<double> > >&, const optional<bool>&>(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple(const _Elements& ...) [with bool _NotEmpty = _NotEmpty; typename std::enable_if<std::tuple<_Elements>::_TCC<_Dummy>::__is_implicitly_constructible<const _Elements& ...>(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    727 |         tuple(const _Elements&... __elements)
        |         ^~~~~
  /usr/include/c++/11/tuple:727:9: note:   substitution of deduced template arguments resulted in errors seen above
  /usr/include/c++/11/tuple:720:9: note: candidate: ‘template<class _Dummy, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<std::is_void<_Tp>::value>::__is_explicitly_default_constructible(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple() [with _Dummy = _Dummy; typename std::enable_if<std::tuple<_Elements>::_TCC<std::is_void<_Dummy>::value>::__is_explicitly_default_constructible(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    720 |         tuple()
        |         ^~~~~
  /usr/include/c++/11/tuple:720:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:1609:14: note:   candidate expects 0 arguments, 4 provided
   1609 |       return __result_type(std::forward<_Elements>(__args)...);
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/tuple:713:9: note: candidate: ‘template<class _Dummy, typename std::enable_if<std::tuple<torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool> >::_TCC<std::is_void<_Tp>::value>::__is_implicitly_default_constructible(), bool>::type <anonymous> > constexpr std::tuple<_Elements>::tuple() [with _Dummy = _Dummy; typename std::enable_if<std::tuple<_Elements>::_TCC<std::is_void<_Dummy>::value>::__is_implicitly_default_constructible(), bool>::type <anonymous> = <anonymous>; _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    713 |         tuple()
        |         ^~~~~
  /usr/include/c++/11/tuple:713:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/tuple:1609:14: note:   candidate expects 0 arguments, 4 provided
   1609 |       return __result_type(std::forward<_Elements>(__args)...);
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/tuple:756:17: note: candidate: ‘constexpr std::tuple<_Elements>::tuple(std::tuple<_Elements>&&) [with _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    756 |       constexpr tuple(tuple&&) = default;
        |                 ^~~~~
  /usr/include/c++/11/tuple:756:17: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/tuple:754:17: note: candidate: ‘constexpr std::tuple<_Elements>::tuple(const std::tuple<_Elements>&) [with _Elements = {torch::Tensor, std::optional<std::vector<long int, std::allocator<long int> > >, std::optional<std::vector<double, std::allocator<double> > >, std::optional<bool>}]’
    754 |       constexpr tuple(const tuple&) = default;
        |                 ^~~~~
  /usr/include/c++/11/tuple:754:17: note:   candidate expects 1 argument, 4 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:136:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    136 |   if (input.dim() == 3 && std::get_if<enumtype::kNearest>(&mode)) {
        |       ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:137:37: error: no matching function for call to ‘upsample_nearest1d(const torch::Tensor&, std::vector<long int>, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&)’
    137 |     return torch::upsample_nearest1d(
        |            ~~~~~~~~~~~~~~~~~~~~~~~~~^
    138 |         input,
        |         ~~~~~~
    139 |         _interp_output_size(1, std::move(closed_over_args)),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    140 |         scale_factor_list.at(0));
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1363,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_nearest1d.h:26:19: note: candidate: ‘at::Tensor at::upsample_nearest1d(const at::Tensor&, at::OptionalIntArrayRef, std::optional<c10::ArrayRef<double> >)’
     26 | inline at::Tensor upsample_nearest1d(const at::Tensor & input, at::OptionalIntArrayRef output_size, ::std::optional<at::ArrayRef<double>> scale_factors) {
        |                   ^~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_nearest1d.h:26:57: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor upsample_nearest1d(const at::Tensor & input, at::OptionalIntArrayRef output_size, ::std::optional<at::ArrayRef<double>> scale_factors) {
        |                                      ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1363,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_nearest1d.h:92:19: note: candidate: ‘at::Tensor at::upsample_nearest1d(const at::Tensor&, at::IntArrayRef, std::optional<double>)’
     92 | inline at::Tensor upsample_nearest1d(const at::Tensor & self, at::IntArrayRef output_size, ::std::optional<double> scales=::std::nullopt) {
        |                   ^~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_nearest1d.h:92:57: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     92 | inline at::Tensor upsample_nearest1d(const at::Tensor & self, at::IntArrayRef output_size, ::std::optional<double> scales=::std::nullopt) {
        |                                      ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:141:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    141 |   } else if (input.dim() == 4 && std::get_if<enumtype::kNearest>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:142:37: error: no matching function for call to ‘upsample_nearest2d(const torch::Tensor&, std::vector<long int>, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&)’
    142 |     return torch::upsample_nearest2d(
        |            ~~~~~~~~~~~~~~~~~~~~~~~~~^
    143 |         input,
        |         ~~~~~~
    144 |         _interp_output_size(2, std::move(closed_over_args)),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    145 |         scale_factor_list.at(0),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
    146 |         scale_factor_list.at(1));
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1365,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_nearest2d.h:26:19: note: candidate: ‘at::Tensor at::upsample_nearest2d(const at::Tensor&, at::OptionalIntArrayRef, std::optional<c10::ArrayRef<double> >)’
     26 | inline at::Tensor upsample_nearest2d(const at::Tensor & input, at::OptionalIntArrayRef output_size, ::std::optional<at::ArrayRef<double>> scale_factors) {
        |                   ^~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_nearest2d.h:26:19: note:   candidate expects 3 arguments, 4 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1365,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_nearest2d.h:92:19: note: candidate: ‘at::Tensor at::upsample_nearest2d(const at::Tensor&, at::IntArrayRef, std::optional<double>, std::optional<double>)’
     92 | inline at::Tensor upsample_nearest2d(const at::Tensor & self, at::IntArrayRef output_size, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                   ^~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_nearest2d.h:92:57: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     92 | inline at::Tensor upsample_nearest2d(const at::Tensor & self, at::IntArrayRef output_size, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                                      ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:147:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    147 |   } else if (input.dim() == 5 && std::get_if<enumtype::kNearest>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:148:37: error: no matching function for call to ‘upsample_nearest3d(const torch::Tensor&, std::vector<long int>, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&)’
    148 |     return torch::upsample_nearest3d(
        |            ~~~~~~~~~~~~~~~~~~~~~~~~~^
    149 |         input,
        |         ~~~~~~
    150 |         _interp_output_size(3, std::move(closed_over_args)),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    151 |         scale_factor_list.at(0),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
    152 |         scale_factor_list.at(1),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
    153 |         scale_factor_list.at(2));
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1367,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_nearest3d.h:26:19: note: candidate: ‘at::Tensor at::upsample_nearest3d(const at::Tensor&, at::OptionalIntArrayRef, std::optional<c10::ArrayRef<double> >)’
     26 | inline at::Tensor upsample_nearest3d(const at::Tensor & input, at::OptionalIntArrayRef output_size, ::std::optional<at::ArrayRef<double>> scale_factors) {
        |                   ^~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_nearest3d.h:26:19: note:   candidate expects 3 arguments, 5 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1367,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_nearest3d.h:92:19: note: candidate: ‘at::Tensor at::upsample_nearest3d(const at::Tensor&, at::IntArrayRef, std::optional<double>, std::optional<double>, std::optional<double>)’
     92 | inline at::Tensor upsample_nearest3d(const at::Tensor & self, at::IntArrayRef output_size, ::std::optional<double> scales_d=::std::nullopt, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                   ^~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_nearest3d.h:92:57: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     92 | inline at::Tensor upsample_nearest3d(const at::Tensor & self, at::IntArrayRef output_size, ::std::optional<double> scales_d=::std::nullopt, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                                      ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:154:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    154 |   } else if (input.dim() == 3 && std::get_if<enumtype::kNearestExact>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:155:44: error: no matching function for call to ‘_upsample_nearest_exact1d(const torch::Tensor&, std::vector<long int>, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&)’
    155 |     return torch::_upsample_nearest_exact1d(
        |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    156 |         input,
        |         ~~~~~~
    157 |         _interp_output_size(1, std::move(closed_over_args)),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    158 |         scale_factor_list.at(0));
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:435,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_nearest_exact1d.h:26:19: note: candidate: ‘at::Tensor at::_upsample_nearest_exact1d(const at::Tensor&, at::OptionalIntArrayRef, std::optional<c10::ArrayRef<double> >)’
     26 | inline at::Tensor _upsample_nearest_exact1d(const at::Tensor & input, at::OptionalIntArrayRef output_size, ::std::optional<at::ArrayRef<double>> scale_factors) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_nearest_exact1d.h:26:64: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor _upsample_nearest_exact1d(const at::Tensor & input, at::OptionalIntArrayRef output_size, ::std::optional<at::ArrayRef<double>> scale_factors) {
        |                                             ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:435,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_nearest_exact1d.h:92:19: note: candidate: ‘at::Tensor at::_upsample_nearest_exact1d(const at::Tensor&, at::IntArrayRef, std::optional<double>)’
     92 | inline at::Tensor _upsample_nearest_exact1d(const at::Tensor & self, at::IntArrayRef output_size, ::std::optional<double> scales=::std::nullopt) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_nearest_exact1d.h:92:64: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     92 | inline at::Tensor _upsample_nearest_exact1d(const at::Tensor & self, at::IntArrayRef output_size, ::std::optional<double> scales=::std::nullopt) {
        |                                             ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:159:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    159 |   } else if (input.dim() == 4 && std::get_if<enumtype::kNearestExact>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:160:44: error: no matching function for call to ‘_upsample_nearest_exact2d(const torch::Tensor&, std::vector<long int>, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&)’
    160 |     return torch::_upsample_nearest_exact2d(
        |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    161 |         input,
        |         ~~~~~~
    162 |         _interp_output_size(2, std::move(closed_over_args)),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    163 |         scale_factor_list.at(0),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
    164 |         scale_factor_list.at(1));
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:437,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_nearest_exact2d.h:26:19: note: candidate: ‘at::Tensor at::_upsample_nearest_exact2d(const at::Tensor&, at::OptionalIntArrayRef, std::optional<c10::ArrayRef<double> >)’
     26 | inline at::Tensor _upsample_nearest_exact2d(const at::Tensor & input, at::OptionalIntArrayRef output_size, ::std::optional<at::ArrayRef<double>> scale_factors) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_nearest_exact2d.h:26:19: note:   candidate expects 3 arguments, 4 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:437,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_nearest_exact2d.h:92:19: note: candidate: ‘at::Tensor at::_upsample_nearest_exact2d(const at::Tensor&, at::IntArrayRef, std::optional<double>, std::optional<double>)’
     92 | inline at::Tensor _upsample_nearest_exact2d(const at::Tensor & self, at::IntArrayRef output_size, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_nearest_exact2d.h:92:64: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     92 | inline at::Tensor _upsample_nearest_exact2d(const at::Tensor & self, at::IntArrayRef output_size, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                                             ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:165:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    165 |   } else if (input.dim() == 5 && std::get_if<enumtype::kNearestExact>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:166:44: error: no matching function for call to ‘_upsample_nearest_exact3d(const torch::Tensor&, std::vector<long int>, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&)’
    166 |     return torch::_upsample_nearest_exact3d(
        |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    167 |         input,
        |         ~~~~~~
    168 |         _interp_output_size(3, std::move(closed_over_args)),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    169 |         scale_factor_list.at(0),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
    170 |         scale_factor_list.at(1),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
    171 |         scale_factor_list.at(2));
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:439,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_nearest_exact3d.h:26:19: note: candidate: ‘at::Tensor at::_upsample_nearest_exact3d(const at::Tensor&, at::OptionalIntArrayRef, std::optional<c10::ArrayRef<double> >)’
     26 | inline at::Tensor _upsample_nearest_exact3d(const at::Tensor & input, at::OptionalIntArrayRef output_size, ::std::optional<at::ArrayRef<double>> scale_factors) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_nearest_exact3d.h:26:19: note:   candidate expects 3 arguments, 5 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:439,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_nearest_exact3d.h:92:19: note: candidate: ‘at::Tensor at::_upsample_nearest_exact3d(const at::Tensor&, at::IntArrayRef, std::optional<double>, std::optional<double>, std::optional<double>)’
     92 | inline at::Tensor _upsample_nearest_exact3d(const at::Tensor & self, at::IntArrayRef output_size, ::std::optional<double> scales_d=::std::nullopt, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_nearest_exact3d.h:92:64: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     92 | inline at::Tensor _upsample_nearest_exact3d(const at::Tensor & self, at::IntArrayRef output_size, ::std::optional<double> scales_d=::std::nullopt, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                                             ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:172:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    172 |   } else if (input.dim() == 3 && std::get_if<enumtype::kArea>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:175:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    175 |   } else if (input.dim() == 4 && std::get_if<enumtype::kArea>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:178:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    178 |   } else if (input.dim() == 5 && std::get_if<enumtype::kArea>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:181:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    181 |   } else if (input.dim() == 3 && std::get_if<enumtype::kLinear>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:184:36: error: no matching function for call to ‘upsample_linear1d(const torch::Tensor&, std::vector<long int>, bool&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&)’
    184 |     return torch::upsample_linear1d(
        |            ~~~~~~~~~~~~~~~~~~~~~~~~^
    185 |         input,
        |         ~~~~~~
    186 |         _interp_output_size(1, std::move(closed_over_args)),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    187 |         *align_corners,
        |         ~~~~~~~~~~~~~~~
    188 |         scale_factor_list.at(0));
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1361,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_linear1d.h:26:19: note: candidate: ‘at::Tensor at::upsample_linear1d(const at::Tensor&, at::OptionalIntArrayRef, bool, std::optional<c10::ArrayRef<double> >)’
     26 | inline at::Tensor upsample_linear1d(const at::Tensor & input, at::OptionalIntArrayRef output_size, bool align_corners, ::std::optional<at::ArrayRef<double>> scale_factors) {
        |                   ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_linear1d.h:26:56: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor upsample_linear1d(const at::Tensor & input, at::OptionalIntArrayRef output_size, bool align_corners, ::std::optional<at::ArrayRef<double>> scale_factors) {
        |                                     ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1361,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_linear1d.h:92:19: note: candidate: ‘at::Tensor at::upsample_linear1d(const at::Tensor&, at::IntArrayRef, bool, std::optional<double>)’
     92 | inline at::Tensor upsample_linear1d(const at::Tensor & self, at::IntArrayRef output_size, bool align_corners, ::std::optional<double> scales=::std::nullopt) {
        |                   ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_linear1d.h:92:56: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     92 | inline at::Tensor upsample_linear1d(const at::Tensor & self, at::IntArrayRef output_size, bool align_corners, ::std::optional<double> scales=::std::nullopt) {
        |                                     ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:189:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    189 |   } else if (input.dim() == 3 && std::get_if<enumtype::kBilinear>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:191:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    191 |   } else if (input.dim() == 3 && std::get_if<enumtype::kTrilinear>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:193:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    193 |   } else if (input.dim() == 4 && std::get_if<enumtype::kLinear>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:195:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    195 |   } else if (input.dim() == 4 && std::get_if<enumtype::kBilinear>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:199:44: error: no matching function for call to ‘_upsample_bilinear2d_aa(const torch::Tensor&, std::vector<long int>, bool&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&)’
    199 |       return torch::_upsample_bilinear2d_aa(
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    200 |           input,
        |           ~~~~~~
    201 |           _interp_output_size(2, std::move(closed_over_args)),
        |           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    202 |           *align_corners,
        |           ~~~~~~~~~~~~~~~
    203 |           scale_factor_list.at(0),
        |           ~~~~~~~~~~~~~~~~~~~~~~~~
    204 |           scale_factor_list.at(1));
        |           ~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:433,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_bilinear2d_aa.h:26:19: note: candidate: ‘at::Tensor at::_upsample_bilinear2d_aa(const at::Tensor&, at::OptionalIntArrayRef, bool, std::optional<c10::ArrayRef<double> >)’
     26 | inline at::Tensor _upsample_bilinear2d_aa(const at::Tensor & input, at::OptionalIntArrayRef output_size, bool align_corners, ::std::optional<at::ArrayRef<double>> scale_factors) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_bilinear2d_aa.h:26:19: note:   candidate expects 4 arguments, 5 provided
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_bilinear2d_aa.h:92:19: note: candidate: ‘at::Tensor at::_upsample_bilinear2d_aa(const at::Tensor&, at::IntArrayRef, bool, std::optional<double>, std::optional<double>)’
     92 | inline at::Tensor _upsample_bilinear2d_aa(const at::Tensor & self, at::IntArrayRef output_size, bool align_corners, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_bilinear2d_aa.h:92:62: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     92 | inline at::Tensor _upsample_bilinear2d_aa(const at::Tensor & self, at::IntArrayRef output_size, bool align_corners, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                                           ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:206:38: error: no matching function for call to ‘upsample_bilinear2d(const torch::Tensor&, std::vector<long int>, bool&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&)’
    206 |     return torch::upsample_bilinear2d(
        |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^
    207 |         input,
        |         ~~~~~~
    208 |         _interp_output_size(2, std::move(closed_over_args)),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    209 |         *align_corners,
        |         ~~~~~~~~~~~~~~~
    210 |         scale_factor_list.at(0),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
    211 |         scale_factor_list.at(1));
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1359,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_bilinear2d.h:26:19: note: candidate: ‘at::Tensor at::upsample_bilinear2d(const at::Tensor&, at::OptionalIntArrayRef, bool, std::optional<c10::ArrayRef<double> >)’
     26 | inline at::Tensor upsample_bilinear2d(const at::Tensor & input, at::OptionalIntArrayRef output_size, bool align_corners, ::std::optional<at::ArrayRef<double>> scale_factors) {
        |                   ^~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_bilinear2d.h:26:19: note:   candidate expects 4 arguments, 5 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1359,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_bilinear2d.h:92:19: note: candidate: ‘at::Tensor at::upsample_bilinear2d(const at::Tensor&, at::IntArrayRef, bool, std::optional<double>, std::optional<double>)’
     92 | inline at::Tensor upsample_bilinear2d(const at::Tensor & self, at::IntArrayRef output_size, bool align_corners, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                   ^~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_bilinear2d.h:92:58: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     92 | inline at::Tensor upsample_bilinear2d(const at::Tensor & self, at::IntArrayRef output_size, bool align_corners, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                                       ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:212:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    212 |   } else if (input.dim() == 4 && std::get_if<enumtype::kTrilinear>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:214:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    214 |   } else if (input.dim() == 5 && std::get_if<enumtype::kLinear>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:216:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    216 |   } else if (input.dim() == 5 && std::get_if<enumtype::kBilinear>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:218:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    218 |   } else if (input.dim() == 5 && std::get_if<enumtype::kTrilinear>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:221:39: error: no matching function for call to ‘upsample_trilinear3d(const torch::Tensor&, std::vector<long int>, bool&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&)’
    221 |     return torch::upsample_trilinear3d(
        |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    222 |         input,
        |         ~~~~~~
    223 |         _interp_output_size(3, std::move(closed_over_args)),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    224 |         *align_corners,
        |         ~~~~~~~~~~~~~~~
    225 |         scale_factor_list.at(0),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
    226 |         scale_factor_list.at(1),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
    227 |         scale_factor_list.at(2));
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1369,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_trilinear3d.h:26:19: note: candidate: ‘at::Tensor at::upsample_trilinear3d(const at::Tensor&, at::OptionalIntArrayRef, bool, std::optional<c10::ArrayRef<double> >)’
     26 | inline at::Tensor upsample_trilinear3d(const at::Tensor & input, at::OptionalIntArrayRef output_size, bool align_corners, ::std::optional<at::ArrayRef<double>> scale_factors) {
        |                   ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_trilinear3d.h:26:19: note:   candidate expects 4 arguments, 6 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1369,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_trilinear3d.h:92:19: note: candidate: ‘at::Tensor at::upsample_trilinear3d(const at::Tensor&, at::IntArrayRef, bool, std::optional<double>, std::optional<double>, std::optional<double>)’
     92 | inline at::Tensor upsample_trilinear3d(const at::Tensor & self, at::IntArrayRef output_size, bool align_corners, ::std::optional<double> scales_d=::std::nullopt, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                   ^~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_trilinear3d.h:92:59: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     92 | inline at::Tensor upsample_trilinear3d(const at::Tensor & self, at::IntArrayRef output_size, bool align_corners, ::std::optional<double> scales_d=::std::nullopt, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                                        ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:228:14: error: invalid use of incomplete type ‘const class torch::Tensor’
    228 |   } else if (input.dim() == 4 && std::get_if<enumtype::kBicubic>(&mode)) {
        |              ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:232:43: error: no matching function for call to ‘_upsample_bicubic2d_aa(const torch::Tensor&, std::vector<long int>, bool&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&)’
    232 |       return torch::_upsample_bicubic2d_aa(
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    233 |           input,
        |           ~~~~~~
    234 |           _interp_output_size(2, std::move(closed_over_args)),
        |           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    235 |           *align_corners,
        |           ~~~~~~~~~~~~~~~
    236 |           scale_factor_list.at(0),
        |           ~~~~~~~~~~~~~~~~~~~~~~~~
    237 |           scale_factor_list.at(1));
        |           ~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:431,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_bicubic2d_aa.h:26:19: note: candidate: ‘at::Tensor at::_upsample_bicubic2d_aa(const at::Tensor&, at::OptionalIntArrayRef, bool, std::optional<c10::ArrayRef<double> >)’
     26 | inline at::Tensor _upsample_bicubic2d_aa(const at::Tensor & input, at::OptionalIntArrayRef output_size, bool align_corners, ::std::optional<at::ArrayRef<double>> scale_factors) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_bicubic2d_aa.h:26:19: note:   candidate expects 4 arguments, 5 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:431,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_bicubic2d_aa.h:92:19: note: candidate: ‘at::Tensor at::_upsample_bicubic2d_aa(const at::Tensor&, at::IntArrayRef, bool, std::optional<double>, std::optional<double>)’
     92 | inline at::Tensor _upsample_bicubic2d_aa(const at::Tensor & self, at::IntArrayRef output_size, bool align_corners, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_upsample_bicubic2d_aa.h:92:61: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     92 | inline at::Tensor _upsample_bicubic2d_aa(const at::Tensor & self, at::IntArrayRef output_size, bool align_corners, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                                          ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:239:37: error: no matching function for call to ‘upsample_bicubic2d(const torch::Tensor&, std::vector<long int>, bool&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&, __gnu_cxx::__alloc_traits<std::allocator<std::optional<double> >, std::optional<double> >::value_type&)’
    239 |     return torch::upsample_bicubic2d(
        |            ~~~~~~~~~~~~~~~~~~~~~~~~~^
    240 |         input,
        |         ~~~~~~
    241 |         _interp_output_size(2, std::move(closed_over_args)),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    242 |         *align_corners,
        |         ~~~~~~~~~~~~~~~
    243 |         scale_factor_list.at(0),
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
    244 |         scale_factor_list.at(1));
        |         ~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1357,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_bicubic2d.h:26:19: note: candidate: ‘at::Tensor at::upsample_bicubic2d(const at::Tensor&, at::OptionalIntArrayRef, bool, std::optional<c10::ArrayRef<double> >)’
     26 | inline at::Tensor upsample_bicubic2d(const at::Tensor & input, at::OptionalIntArrayRef output_size, bool align_corners, ::std::optional<at::ArrayRef<double>> scale_factors) {
        |                   ^~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_bicubic2d.h:26:19: note:   candidate expects 4 arguments, 5 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1357,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_bicubic2d.h:92:19: note: candidate: ‘at::Tensor at::upsample_bicubic2d(const at::Tensor&, at::IntArrayRef, bool, std::optional<double>, std::optional<double>)’
     92 | inline at::Tensor upsample_bicubic2d(const at::Tensor & self, at::IntArrayRef output_size, bool align_corners, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                   ^~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/upsample_bicubic2d.h:92:57: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     92 | inline at::Tensor upsample_bicubic2d(const at::Tensor & self, at::IntArrayRef output_size, bool align_corners, ::std::optional<double> scales_h=::std::nullopt, ::std::optional<double> scales_w=::std::nullopt) {
        |                                      ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:250:9: error: invalid use of incomplete type ‘const class torch::Tensor’
    250 |         input.dim(),
        |         ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:246:5: note: in expansion of macro ‘TORCH_CHECK’
    246 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:275:47: error: return type ‘class torch::Tensor’ is incomplete
    275 |     const InterpolateFuncOptions& options = {}) {
        |                                               ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:11:31: error: return type ‘class torch::Tensor’ is incomplete
     11 |     bool align_corners = false) {
        |                               ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h: In function ‘void torch::nn::functional::affine_grid(const torch::Tensor&, const IntArrayRef&, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:14:7: error: invalid use of incomplete type ‘const class torch::Tensor’
     14 |       theta.is_floating_point(),
        |       ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:13:3: note: in expansion of macro ‘TORCH_CHECK’
     13 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:16:7: error: invalid use of incomplete type ‘const class torch::Tensor’
     16 |       theta.dtype());
        |       ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:13:3: note: in expansion of macro ‘TORCH_CHECK’
     13 |   TORCH_CHECK(
        |   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:21:9: error: invalid use of incomplete type ‘const class torch::Tensor’
     21 |         theta.dim() == 3 && theta.size(-2) == 2 && theta.size(-1) == 3,
        |         ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:20:5: note: in expansion of macro ‘TORCH_CHECK’
     20 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:21:29: error: invalid use of incomplete type ‘const class torch::Tensor’
     21 |         theta.dim() == 3 && theta.size(-2) == 2 && theta.size(-1) == 3,
        |                             ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:20:5: note: in expansion of macro ‘TORCH_CHECK’
     20 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:21:52: error: invalid use of incomplete type ‘const class torch::Tensor’
     21 |         theta.dim() == 3 && theta.size(-2) == 2 && theta.size(-1) == 3,
        |                                                    ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:20:5: note: in expansion of macro ‘TORCH_CHECK’
     20 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:25:9: error: invalid use of incomplete type ‘const class torch::Tensor’
     25 |         theta.sizes(),
        |         ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:20:5: note: in expansion of macro ‘TORCH_CHECK’
     20 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:29:9: error: invalid use of incomplete type ‘const class torch::Tensor’
     29 |         theta.dim() == 3 && theta.size(-2) == 3 && theta.size(-1) == 4,
        |         ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:28:5: note: in expansion of macro ‘TORCH_CHECK’
     28 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:29:29: error: invalid use of incomplete type ‘const class torch::Tensor’
     29 |         theta.dim() == 3 && theta.size(-2) == 3 && theta.size(-1) == 4,
        |                             ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:28:5: note: in expansion of macro ‘TORCH_CHECK’
     28 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:29:52: error: invalid use of incomplete type ‘const class torch::Tensor’
     29 |         theta.dim() == 3 && theta.size(-2) == 3 && theta.size(-1) == 4,
        |                                                    ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:28:5: note: in expansion of macro ‘TORCH_CHECK’
     28 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:33:9: error: invalid use of incomplete type ‘const class torch::Tensor’
     33 |         theta.sizes(),
        |         ^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:479:9: note: in definition of macro ‘TORCH_CHECK_MSG’
    479 |       ##__VA_ARGS__))
        |         ^~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:28:5: note: in expansion of macro ‘TORCH_CHECK’
     28 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:48:39: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     48 |   return torch::affine_grid_generator(theta, size, align_corners);
        |                                       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:483,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/affine_grid_generator.h:26:60: note: in passing argument 1 of ‘at::Tensor at::affine_grid_generator(const at::Tensor&, at::IntArrayRef, bool)’
     26 | inline at::Tensor affine_grid_generator(const at::Tensor & theta, at::IntArrayRef size, bool align_corners) {
        |                                         ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:60:38: error: return type ‘class torch::Tensor’ is incomplete
     60 |     std::optional<bool> align_corners) {
        |                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h: In function ‘void torch::nn::functional::detail::grid_sample(const torch::Tensor&, const torch::Tensor&, torch::nn::functional::GridSampleFuncOptions::mode_t, torch::nn::functional::GridSampleFuncOptions::padding_mode_t, std::optional<bool>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:89:7: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     89 |       input, grid, mode_enum, padding_mode_enum, align_corners.value());
        |       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:766,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/grid_sampler.h:26:51: note: in passing argument 1 of ‘at::Tensor at::grid_sampler(const at::Tensor&, const at::Tensor&, int64_t, int64_t, bool)’
     26 | inline at::Tensor grid_sampler(const at::Tensor & input, const at::Tensor & grid, int64_t interpolation_mode, int64_t padding_mode, bool align_corners) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/vision.h:110:46: error: return type ‘class torch::Tensor’ is incomplete
    110 |     const GridSampleFuncOptions& options = {}) {
        |                                              ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any.h:129:39: error: template argument 1 is invalid
    129 |   AnyModule clone(std::optional<Device> device = std::nullopt) const;
        |                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any.h:129:39: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any.h:129:39: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any.h:129:39: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any.h:129:19: error: invalid template-id
    129 |   AnyModule clone(std::optional<Device> device = std::nullopt) const;
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any.h:129:33: error: reference to ‘Device’ is ambiguous
    129 |   AnyModule clone(std::optional<Device> device = std::nullopt) const;
        |                                 ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any.h:129:19: error: class template placeholder ‘std::optional’ not permitted in this context
    129 |   AnyModule clone(std::optional<Device> device = std::nullopt) const;
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any.h:129:19: note: use ‘auto’ for an abbreviated function template
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any.h:246:55: error: template argument 1 is invalid
    246 | inline AnyModule AnyModule::clone(std::optional<Device> device) const {
        |                                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any.h:246:55: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any.h:246:55: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any.h:246:55: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any.h:246:35: error: invalid template-id
    246 | inline AnyModule AnyModule::clone(std::optional<Device> device) const {
        |                                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any.h:246:18: error: ‘torch::nn::AnyModule torch::nn::AnyModule::clone’ is not a static data member of ‘class torch::nn::AnyModule’
    246 | inline AnyModule AnyModule::clone(std::optional<Device> device) const {
        |                  ^~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any.h:246:57: error: missing template arguments before ‘device’
    246 | inline AnyModule AnyModule::clone(std::optional<Device> device) const {
        |                                                         ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any.h:246:65: error: expected ‘,’ or ‘;’ before ‘const’
    246 | inline AnyModule AnyModule::clone(std::optional<Device> device) const {
        |                                                                 ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/moduledict.h:148:33: error: template argument 1 is invalid
    148 |       const std::optional<Device>& device = std::nullopt) const override {
        |                                 ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/moduledict.h:148:33: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/moduledict.h:148:33: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/moduledict.h:148:33: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/moduledict.h:148:13: error: invalid template-id
    148 |       const std::optional<Device>& device = std::nullopt) const override {
        |             ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/moduledict.h:148:27: error: reference to ‘Device’ is ambiguous
    148 |       const std::optional<Device>& device = std::nullopt) const override {
        |                           ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/moduledict.h:148:7: error: template placeholder type ‘const optional<...auto...>’ must be followed by a simple declarator-id
    148 |       const std::optional<Device>& device = std::nullopt) const override {
        |       ^~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:65:11: note: ‘template<class _Tp> class std::optional’ declared here
     65 |     class optional;
        |           ^~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/modulelist.h:73:33: error: template argument 1 is invalid
     73 |       const std::optional<Device>& device = std::nullopt) const override {
        |                                 ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/modulelist.h:73:33: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/modulelist.h:73:33: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/modulelist.h:73:33: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/modulelist.h:73:13: error: invalid template-id
     73 |       const std::optional<Device>& device = std::nullopt) const override {
        |             ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/modulelist.h:73:27: error: reference to ‘Device’ is ambiguous
     73 |       const std::optional<Device>& device = std::nullopt) const override {
        |                           ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/modulelist.h:73:7: error: template placeholder type ‘const optional<...auto...>’ must be followed by a simple declarator-id
     73 |       const std::optional<Device>& device = std::nullopt) const override {
        |       ^~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:65:11: note: ‘template<class _Tp> class std::optional’ declared here
     65 |     class optional;
        |           ^~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterdict.h: In member function ‘virtual void torch::nn::ParameterDictImpl::pretty_print(std::ostream&) const’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterdict.h:32:58: error: invalid use of incomplete type ‘const class torch::Tensor’
     32 |              << ": Parameter containing: [" << pair.value().scalar_type()
        |                                                ~~~~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterdict.h:33:42: error: invalid use of incomplete type ‘const class torch::Tensor’
     33 |              << " of size " << pair.value().sizes() << "]";
        |                                ~~~~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterdict.h: In member function ‘torch::Tensor& torch::nn::ParameterDictImpl::insert(const string&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterdict.h:43:26: error: invalid use of incomplete type ‘const class torch::Tensor’
     43 |     bool requires_grad = param.requires_grad();
        |                          ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterdict.h:44:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     44 |     return register_parameter(key, param, requires_grad);
        |                                    ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterdict.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterdict.h:50:38: error: return type ‘class torch::Tensor’ is incomplete
     50 |   Tensor pop(const std::string& key) {
        |                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterdict.h: In member function ‘void torch::nn::ParameterDictImpl::pop(const string&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterdict.h:51:19: error: variable ‘torch::Tensor v’ has initializer but incomplete type
     51 |     torch::Tensor v = parameters_[key];
        |                   ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterlist.h: In member function ‘virtual void torch::nn::ParameterListImpl::pretty_print(std::ostream&) const’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterlist.h:40:58: error: invalid use of incomplete type ‘const class torch::Tensor’
     40 |              << ": Parameter containing: [" << pair.value().scalar_type()
        |                                                ~~~~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterlist.h:41:42: error: invalid use of incomplete type ‘const class torch::Tensor’
     41 |              << " of size " << pair.value().sizes() << "]";
        |                                ~~~~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterlist.h: In member function ‘void torch::nn::ParameterListImpl::append(torch::Tensor&&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterlist.h:50:26: error: invalid use of incomplete type ‘class torch::Tensor’
     50 |     bool requires_grad = param.requires_grad();
        |                          ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterlist.h:52:54: error: invalid use of incomplete type ‘std::remove_reference<torch::Tensor&>::type’ {aka ‘class torch::Tensor’}
     52 |         std::to_string(parameters_.size()), std::move(param), requires_grad);
        |                                             ~~~~~~~~~^~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘std::remove_reference<torch::Tensor&>::type’ {aka ‘class torch::Tensor’}
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterlist.h: In member function ‘void torch::nn::ParameterListImpl::append(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterlist.h:57:26: error: invalid use of incomplete type ‘const class torch::Tensor’
     57 |     bool requires_grad = param.requires_grad();
        |                          ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterlist.h:59:45: error: invalid use of incomplete type ‘const class torch::Tensor’
     59 |         std::to_string(parameters_.size()), param, requires_grad);
        |                                             ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterlist.h: In member function ‘void torch::nn::ParameterListImpl::append(const torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterlist.h:69:19: error: invalid use of incomplete type ‘const class torch::Tensor’
     69 |         pair.value().requires_grad());
        |         ~~~~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterlist.h: In member function ‘at::Tensor& torch::nn::ParameterListImpl::at(size_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterlist.h:113:43: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    113 |     return parameters_[std::to_string(idx)];
        |                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterlist.h: In member function ‘const at::Tensor& torch::nn::ParameterListImpl::at(size_t) const’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterlist.h:121:43: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    121 |     return parameters_[std::to_string(idx)];
        |                                           ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:14,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/sequential.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/sequential.h:127:33: error: template argument 1 is invalid
    127 |       const std::optional<Device>& device = std::nullopt) const override {
        |                                 ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/sequential.h:127:33: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/sequential.h:127:33: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/sequential.h:127:33: error: template argument 1 is invalid
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/sequential.h:127:13: error: invalid template-id
    127 |       const std::optional<Device>& device = std::nullopt) const override {
        |             ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/sequential.h:127:27: error: reference to ‘Device’ is ambiguous
    127 |       const std::optional<Device>& device = std::nullopt) const override {
        |                           ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:14,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/sequential.h:127:7: error: template placeholder type ‘const optional<...auto...>’ must be followed by a simple declarator-id
    127 |       const std::optional<Device>& device = std::nullopt) const override {
        |       ^~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:65:11: note: ‘template<class _Tp> class std::optional’ declared here
     65 |     class optional;
        |           ^~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/linear.h:71:10: error: field ‘weight’ has incomplete type ‘torch::Tensor’
     71 |   Tensor weight;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/linear.h:75:10: error: field ‘bias’ has incomplete type ‘torch::Tensor’
     75 |   Tensor bias;
        |          ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/linear.h:200:10: error: field ‘weight’ has incomplete type ‘torch::Tensor’
    200 |   Tensor weight;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/linear.h:204:10: error: field ‘bias’ has incomplete type ‘torch::Tensor’
    204 |   Tensor bias;
        |          ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:365:10: error: field ‘weight’ has incomplete type ‘torch::Tensor’
    365 |   Tensor weight;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:855:10: error: field ‘in_proj_weight’ has incomplete type ‘torch::Tensor’
    855 |   Tensor in_proj_weight;
        |          ^~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:856:10: error: field ‘in_proj_bias’ has incomplete type ‘torch::Tensor’
    856 |   Tensor in_proj_bias;
        |          ^~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:857:10: error: field ‘bias_k’ has incomplete type ‘torch::Tensor’
    857 |   Tensor bias_k;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:858:10: error: field ‘bias_v’ has incomplete type ‘torch::Tensor’
    858 |   Tensor bias_v;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:860:10: error: field ‘q_proj_weight’ has incomplete type ‘torch::Tensor’
    860 |   Tensor q_proj_weight;
        |          ^~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:861:10: error: field ‘k_proj_weight’ has incomplete type ‘torch::Tensor’
    861 |   Tensor k_proj_weight;
        |          ^~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:862:10: error: field ‘v_proj_weight’ has incomplete type ‘torch::Tensor’
    862 |   Tensor v_proj_weight;
        |          ^~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:834:41: error: invalid use of incomplete type ‘const class torch::Tensor’
    834 |       const Tensor& key_padding_mask = {},
        |                                         ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:17,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:836:34: error: invalid use of incomplete type ‘const class torch::Tensor’
    836 |       const Tensor& attn_mask = {},
        |                                  ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h: In member function ‘virtual unsigned int torch::nn::MultiheadAttentionImpl::_forward_num_required_args()’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:841:27: error: invalid use of incomplete type ‘class torch::Tensor’
    841 |       {3, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:843:27: error: invalid use of incomplete type ‘class torch::Tensor’
    843 |       {5, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:840:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    840 |   FORWARD_HAS_DEFAULT_ARGS(
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: note:   candidate expects 3 arguments, 4 provided
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:840:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    840 |   FORWARD_HAS_DEFAULT_ARGS(
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 4 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h: In member function ‘virtual std::vector<torch::nn::AnyValue> torch::nn::MultiheadAttentionImpl::_forward_populate_default_args(std::vector<torch::nn::AnyValue>&&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:841:27: error: invalid use of incomplete type ‘class torch::Tensor’
    841 |       {3, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:843:27: error: invalid use of incomplete type ‘class torch::Tensor’
    843 |       {5, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:840:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    840 |   FORWARD_HAS_DEFAULT_ARGS(
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: note:   candidate expects 3 arguments, 4 provided
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/activation.h:840:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    840 |   FORWARD_HAS_DEFAULT_ARGS(
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 4 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:18,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/adaptive.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/adaptive.h:21:10: error: field ‘output’ has incomplete type ‘torch::Tensor’
     21 |   Tensor output;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/batchnorm.h:74:10: error: field ‘weight’ has incomplete type ‘torch::Tensor’
     74 |   Tensor weight;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/batchnorm.h:78:10: error: field ‘bias’ has incomplete type ‘torch::Tensor’
     78 |   Tensor bias;
        |          ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/batchnorm.h:83:10: error: field ‘running_mean’ has incomplete type ‘torch::Tensor’
     83 |   Tensor running_mean;
        |          ^~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/batchnorm.h:88:10: error: field ‘running_var’ has incomplete type ‘torch::Tensor’
     88 |   Tensor running_var;
        |          ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/batchnorm.h:93:10: error: field ‘num_batches_tracked’ has incomplete type ‘torch::Tensor’
     93 |   Tensor num_batches_tracked;
        |          ^~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/batchnorm.h:102:39: error: return type ‘class torch::Tensor’ is incomplete
    102 |   Tensor forward(const Tensor& input) {
        |                                       ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:156:10: error: field ‘weight’ has incomplete type ‘torch::Tensor’
    156 |   Tensor weight;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:160:10: error: field ‘bias’ has incomplete type ‘torch::Tensor’
    160 |   Tensor bias;
        |          ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:23,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:51:10: error: field ‘weight’ has incomplete type ‘torch::Tensor’
     51 |   Tensor weight;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h: In static member function ‘static torch::nn::Embedding torch::nn::Embedding::from_pretrained(const torch::Tensor&, const torch::nn::EmbeddingFromPretrainedOptions&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:69:9: error: invalid use of incomplete type ‘const class torch::Tensor’
     69 |         embeddings.dim() == 2,
        |         ^~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:68:5: note: in expansion of macro ‘TORCH_CHECK’
     68 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:23,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:72:17: error: invalid use of incomplete type ‘const class torch::Tensor’
     72 |     auto rows = embeddings.size(0);
        |                 ^~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:23,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:73:17: error: invalid use of incomplete type ‘const class torch::Tensor’
     73 |     auto cols = embeddings.size(1);
        |                 ^~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:23,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:120:10: error: field ‘weight’ has incomplete type ‘torch::Tensor’
    120 |   Tensor weight;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:23,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:124:32: error: invalid use of incomplete type ‘const class torch::Tensor’
    124 |       const Tensor& offsets = {},
        |                                ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:23,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:125:43: error: invalid use of incomplete type ‘const class torch::Tensor’
    125 |       const Tensor& per_sample_weights = {});
        |                                           ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h: In member function ‘virtual unsigned int torch::nn::EmbeddingBagImpl::_forward_num_required_args()’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:128:48: error: invalid use of incomplete type ‘class torch::Tensor’
    128 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:128:73: error: invalid use of incomplete type ‘class torch::Tensor’
    128 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |                                                                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:128:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    128 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: note:   couldn’t deduce template parameter ‘_InputIterator’
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:128:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    128 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:43: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::initializer_list<std::pair<unsigned int, torch::nn::AnyValue> >’
    625 |       vector(initializer_list<value_type> __l,
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:23: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&&’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |              ~~~~~~~~~^~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:28: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |              ~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    522 |       vector(size_type __n, const value_type& __value,
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 2 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h: In member function ‘virtual std::vector<torch::nn::AnyValue> torch::nn::EmbeddingBagImpl::_forward_populate_default_args(std::vector<torch::nn::AnyValue>&&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:128:48: error: invalid use of incomplete type ‘class torch::Tensor’
    128 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:128:73: error: invalid use of incomplete type ‘class torch::Tensor’
    128 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |                                                                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:128:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    128 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: note:   couldn’t deduce template parameter ‘_InputIterator’
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:128:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    128 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:43: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::initializer_list<std::pair<unsigned int, torch::nn::AnyValue> >’
    625 |       vector(initializer_list<value_type> __l,
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:23: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&&’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |              ~~~~~~~~~^~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:28: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |              ~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    522 |       vector(size_type __n, const value_type& __value,
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 2 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h: In static member function ‘static torch::nn::EmbeddingBag torch::nn::EmbeddingBag::from_pretrained(const torch::Tensor&, const torch::nn::EmbeddingBagFromPretrainedOptions&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:146:9: error: invalid use of incomplete type ‘const class torch::Tensor’
    146 |         embeddings.dim() == 2,
        |         ^~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/macros/Macros.h:193:64: note: in definition of macro ‘C10_UNLIKELY’
    193 | #define C10_UNLIKELY(expr) (__builtin_expect(static_cast<bool>(expr), 0))
        |                                                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/Exception.h:575:7: note: in expansion of macro ‘C10_UNLIKELY_OR_CONST’
    575 |   if (C10_UNLIKELY_OR_CONST(!(cond))) {            \
        |       ^~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:145:5: note: in expansion of macro ‘TORCH_CHECK’
    145 |     TORCH_CHECK(
        |     ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:23,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:149:17: error: invalid use of incomplete type ‘const class torch::Tensor’
    149 |     auto rows = embeddings.size(0);
        |                 ^~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:23,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/embedding.h:150:17: error: invalid use of incomplete type ‘const class torch::Tensor’
    150 |     auto cols = embeddings.size(1);
        |                 ^~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:25,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/instancenorm.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/instancenorm.h:15:58: error: return type ‘class torch::Tensor’ is incomplete
     15 |   inline Tensor apply_instance_norm(const Tensor& input) {
        |                                                          ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/instancenorm.h:27:60: error: return type ‘class torch::Tensor’ is incomplete
     27 |   inline Tensor handle_no_batch_input(const Tensor& input) {
        |                                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/instancenorm.h: In member function ‘void torch::nn::InstanceNormImpl<D, Derived>::handle_no_batch_input(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/instancenorm.h:28:38: warning: invalid use of incomplete type ‘const class torch::Tensor’
     28 |     return this->apply_instance_norm(input.unsqueeze(0)).squeeze(0);
        |                                      ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:25,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/instancenorm.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/instancenorm.h:34:39: error: return type ‘class torch::Tensor’ is incomplete
     34 |   Tensor forward(const Tensor& input) {
        |                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/instancenorm.h: In member function ‘void torch::nn::InstanceNormImpl<D, Derived>::forward(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/instancenorm.h:41:9: warning: invalid use of incomplete type ‘const class torch::Tensor’
     41 |     if (input.dim() == D + 1) {
        |         ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:27,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/loss.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/loss.h:707:10: error: field ‘weight’ has incomplete type ‘torch::Tensor’
    707 |   Tensor weight;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:27,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/loss.h:747:10: error: field ‘weight’ has incomplete type ‘torch::Tensor’
    747 |   Tensor weight;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:27,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/loss.h:790:10: error: field ‘weight’ has incomplete type ‘torch::Tensor’
    790 |   Tensor weight;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:27,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/loss.h:793:10: error: field ‘pos_weight’ has incomplete type ‘torch::Tensor’
    793 |   Tensor pos_weight;
        |          ^~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:28,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/normalization.h:60:10: error: field ‘weight’ has incomplete type ‘torch::Tensor’
     60 |   Tensor weight;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:28,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/normalization.h:65:10: error: field ‘bias’ has incomplete type ‘torch::Tensor’
     65 |   Tensor bias;
        |          ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:28,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/normalization.h:184:10: error: field ‘weight’ has incomplete type ‘torch::Tensor’
    184 |   Tensor weight;
        |          ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:28,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/normalization.h:187:10: error: field ‘bias’ has incomplete type ‘torch::Tensor’
    187 |   Tensor bias;
        |          ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:31,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/pooling.h:621:10: error: field ‘_random_samples’ has incomplete type ‘torch::Tensor’
    621 |   Tensor _random_samples;
        |          ^~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:31,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/pooling.h:666:10: error: field ‘_random_samples’ has incomplete type ‘torch::Tensor’
    666 |   Tensor _random_samples;
        |          ^~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:10:59: error: return type ‘class torch::Tensor’ is incomplete
     10 | inline Tensor invert_permutation(const Tensor& permutation) {
        |                                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h: In function ‘void torch::nn::utils::rnn::invert_permutation(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:11:8: error: invalid use of incomplete type ‘const class torch::Tensor’
     11 |   if (!permutation.defined()) {
        |        ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:12:26: error: invalid use of incomplete type ‘class torch::Tensor’
     12 |     return torch::Tensor();
        |                          ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:14:10: error: variable ‘torch::Tensor output’ has initializer but incomplete type
     14 |   Tensor output =
        |          ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:15:25: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     15 |       torch::empty_like(permutation, torch::MemoryFormat::Contiguous);
        |                         ^~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/types.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/generated/variable_factories.h:304:49: note: in passing argument 1 of ‘at::Tensor torch::empty_like(const at::Tensor&, c10::TensorOptions, std::optional<c10::MemoryFormat>)’
    304 | inline at::Tensor empty_like(const at::Tensor & self, at::TensorOptions options = {}, ::std::optional<at::MemoryFormat> memory_format = ::std::nullopt) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:19:24: error: invalid use of incomplete type ‘const class torch::Tensor’
     19 |       torch::arange(0, permutation.numel(), permutation.device()));
        |                        ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:19:45: error: invalid use of incomplete type ‘const class torch::Tensor’
     19 |       torch::arange(0, permutation.numel(), permutation.device()));
        |                                             ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:158:10: error: field ‘data_’ has incomplete type ‘torch::Tensor’
    158 |   Tensor data_;
        |          ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:159:10: error: field ‘batch_sizes_’ has incomplete type ‘torch::Tensor’
    159 |   Tensor batch_sizes_;
        |          ^~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:160:10: error: field ‘sorted_indices_’ has incomplete type ‘torch::Tensor’
    160 |   Tensor sorted_indices_;
        |          ^~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:161:10: error: field ‘unsorted_indices_’ has incomplete type ‘torch::Tensor’
    161 |   Tensor unsorted_indices_;
        |          ^~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:61:32: error: invalid use of incomplete type ‘class torch::Tensor’
     61 |       Tensor sorted_indices = {},
        |                                ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:62:34: error: invalid use of incomplete type ‘class torch::Tensor’
     62 |       Tensor unsorted_indices = {}) {
        |                                  ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:59:14: error: ‘data’ has incomplete type
     59 |       Tensor data,
        |       ~~~~~~~^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:60:14: error: ‘batch_sizes’ has incomplete type
     60 |       Tensor batch_sizes,
        |       ~~~~~~~^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:61:14: error: ‘sorted_indices’ has incomplete type
     61 |       Tensor sorted_indices = {},
        |       ~~~~~~~^~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:62:14: error: ‘unsorted_indices’ has incomplete type
     62 |       Tensor unsorted_indices = {}) {
        |       ~~~~~~~^~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h: In member function ‘torch::nn::utils::rnn::PackedSequence torch::nn::utils::rnn::PackedSequence::pin_memory() const’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:104:75: error: invalid use of incomplete type ‘class torch::Tensor’
    104 |         sorted_indices_.defined() ? sorted_indices_.pin_memory() : Tensor(),
        |                                                                           ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:106:46: error: invalid use of incomplete type ‘class torch::Tensor’
    106 |                                     : Tensor());
        |                                              ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h: In member function ‘torch::nn::utils::rnn::PackedSequence torch::nn::utils::rnn::PackedSequence::to(c10::TensorOptions) const’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:118:12: error: variable ‘torch::Tensor data’ has initializer but incomplete type
    118 |     Tensor data = data_.to(options);
        |            ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:123:14: error: variable ‘torch::Tensor sorted_indices’ has initializer but incomplete type
    123 |       Tensor sorted_indices = sorted_indices_.defined()
        |              ^~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:126:20: error: invalid use of incomplete type ‘class torch::Tensor’
    126 |           : Tensor();
        |                    ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:127:14: error: variable ‘torch::Tensor unsorted_indices’ has initializer but incomplete type
    127 |       Tensor unsorted_indices = unsorted_indices_.defined()
        |              ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:130:20: error: invalid use of incomplete type ‘class torch::Tensor’
    130 |           : Tensor();
        |                    ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:196:12: error: ‘input’ has incomplete type
    196 |     Tensor input,
        |     ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:197:12: error: ‘lengths’ has incomplete type
    197 |     Tensor lengths,
        |     ~~~~~~~^~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h: In function ‘torch::nn::utils::rnn::PackedSequence torch::nn::utils::rnn::pack_padded_sequence(torch::Tensor, torch::Tensor, bool, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:201:10: error: aggregate ‘torch::Tensor sorted_indices’ has incomplete type and cannot be defined
    201 |   Tensor sorted_indices;
        |          ^~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:203:29: error: invalid use of incomplete type ‘class torch::Tensor’
    203 |     sorted_indices = Tensor();
        |                             ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h: In function ‘std::tuple<torch::Tensor, torch::Tensor> torch::nn::utils::rnn::pad_packed_sequence(const torch::nn::utils::rnn::PackedSequence&, bool, double, std::optional<long int>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:248:48: error: invalid use of incomplete type ‘const class torch::Tensor’
    248 |   int64_t max_seq_length = sequence.batch_sizes().size(0);
        |                            ~~~~~~~~~~~~~~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:262:20: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    262 |       sequence.data(),
        |       ~~~~~~~~~~~~~^~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:311,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/_pad_packed_sequence.h:26:84: note: in passing argument 1 of ‘std::tuple<at::Tensor, at::Tensor> at::_pad_packed_sequence(const at::Tensor&, const at::Tensor&, bool, const c10::Scalar&, int64_t)’
     26 | inline ::std::tuple<at::Tensor,at::Tensor> _pad_packed_sequence(const at::Tensor & data, const at::Tensor & batch_sizes, bool batch_first, const at::Scalar & padding_value, int64_t total_length) {
        |                                                                 ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:268:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    268 |   if (unsorted_indices.defined()) {
        |       ^~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:272:24: error: invalid use of incomplete type ‘const class torch::Tensor’
    272 |         lengths.index({unsorted_indices.cpu()}));
        |                        ^~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:310:44: error: return type ‘class torch::Tensor’ is incomplete
    310 |     c10::string_view padding_side = "right") {
        |                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h: In function ‘void torch::nn::utils::rnn::pad_sequence(c10::ArrayRef<torch::Tensor>, bool, double, c10::string_view)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:311:27: error: could not convert ‘sequences’ from ‘ArrayRef<torch::Tensor>’ to ‘ArrayRef<at::Tensor>’
    311 |   return at::pad_sequence(sequences, batch_first, padding_value, padding_side);
        |                           ^~~~~~~~~
        |                           |
        |                           ArrayRef<torch::Tensor>
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h: In function ‘torch::nn::utils::rnn::PackedSequence torch::nn::utils::rnn::pack_sequence(c10::ArrayRef<torch::Tensor>, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:337:10: error: variable ‘torch::Tensor lengths’ has initializer but incomplete type
    337 |   Tensor lengths = torch::empty({(int64_t)sequences.size()}, kInt64);
        |          ^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:339:52: error: invalid use of incomplete type ‘const class torch::Tensor’
    339 |     lengths[static_cast<int64_t>(i)] = sequences[i].size(0);
        |                                                    ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:342:24: error: could not convert ‘sequences’ from ‘ArrayRef<torch::Tensor>’ to ‘ArrayRef<at::Tensor>’
    342 |       at::pad_sequence(sequences),
        |                        ^~~~~~~~~
        |                        |
        |                        ArrayRef<torch::Tensor>
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:110:72: error: invalid use of incomplete type ‘class torch::Tensor’
    110 |   std::tuple<Tensor, Tensor> forward(const Tensor& input, Tensor hx = {});
        |                                                                        ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:119:20: error: invalid use of incomplete type ‘class torch::Tensor’
    119 |       Tensor hx = {});
        |                    ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h: In member function ‘virtual unsigned int torch::nn::RNNImpl::_forward_num_required_args()’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:113:48: error: invalid use of incomplete type ‘class torch::Tensor’
    113 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:113:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    113 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: note:   candidate expects 3 arguments, 1 provided
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:113:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    113 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:43: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::initializer_list<std::pair<unsigned int, torch::nn::AnyValue> >’
    625 |       vector(initializer_list<value_type> __l,
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note:   candidate expects 2 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:7: note:   candidate expects 2 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:14: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&&’
    572 |       vector(vector&&) noexcept = default;
        |              ^~~~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:28: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&’
    553 |       vector(const vector& __x)
        |              ~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:36: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const allocator_type&’ {aka ‘const std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >&’}
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |              ~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h: In member function ‘virtual std::vector<torch::nn::AnyValue> torch::nn::RNNImpl::_forward_populate_default_args(std::vector<torch::nn::AnyValue>&&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:113:48: error: invalid use of incomplete type ‘class torch::Tensor’
    113 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:113:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    113 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: note:   candidate expects 3 arguments, 1 provided
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:113:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    113 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:43: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::initializer_list<std::pair<unsigned int, torch::nn::AnyValue> >’
    625 |       vector(initializer_list<value_type> __l,
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note:   candidate expects 2 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:7: note:   candidate expects 2 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:14: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&&’
    572 |       vector(vector&&) noexcept = default;
        |              ^~~~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:28: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&’
    553 |       vector(const vector& __x)
        |              ~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:36: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const allocator_type&’ {aka ‘const std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >&’}
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |              ~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 1 provided
  In file included from /usr/include/c++/11/bits/move.h:57,
                   from /usr/include/c++/11/bits/stl_pair.h:59,
                   from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/type_traits: In substitution of ‘template<class _Tp, class ... _Args> using __is_nothrow_constructible_impl = std::__bool_constant<__is_nothrow_constructible(_Tp)> [with _Tp = torch::Tensor; _Args = {torch::Tensor&&}]’:
  /usr/include/c++/11/type_traits:1070:12:   required from ‘struct std::__is_nothrow_move_constructible_impl<torch::Tensor, true>’
  /usr/include/c++/11/type_traits:1077:12:   required from ‘struct std::is_nothrow_move_constructible<torch::Tensor>’
  /usr/include/c++/11/type_traits:1272:4:   recursively required from ‘constexpr std::tuple<_T1, _T2>::tuple(std::tuple<_T1, _T2>&&) [with _T1 = torch::Tensor; _T2 = torch::Tensor]’
  /usr/include/c++/11/type_traits:1272:4:   required from ‘struct std::__is_trivially_move_constructible_impl<std::tuple<torch::Tensor, torch::Tensor>, true>’
  /usr/include/c++/11/type_traits:1277:12:   required from ‘struct std::is_trivially_move_constructible<std::tuple<torch::Tensor, torch::Tensor> >’
  /usr/include/c++/11/type_traits:3203:43:   required from ‘constexpr const bool std::is_trivially_move_constructible_v<std::tuple<torch::Tensor, torch::Tensor> >’
  /usr/include/c++/11/optional:662:11:   required from ‘class std::optional<std::tuple<torch::Tensor, torch::Tensor> >’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:161:59:   required from here
  /usr/include/c++/11/type_traits:1017:25: error: invalid use of incomplete type ‘class torch::Tensor’
   1017 |       = __bool_constant<__is_nothrow_constructible(_Tp, _Args...)>;
        |                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/move.h:57,
                   from /usr/include/c++/11/bits/stl_pair.h:59,
                   from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::is_nothrow_move_constructible<torch::Tensor>’:
  /usr/include/c++/11/type_traits:1272:4:   recursively required from ‘constexpr std::tuple<_T1, _T2>::tuple(std::tuple<_T1, _T2>&&) [with _T1 = torch::Tensor; _T2 = torch::Tensor]’
  /usr/include/c++/11/type_traits:1272:4:   required from ‘struct std::__is_trivially_move_constructible_impl<std::tuple<torch::Tensor, torch::Tensor>, true>’
  /usr/include/c++/11/type_traits:1277:12:   required from ‘struct std::is_trivially_move_constructible<std::tuple<torch::Tensor, torch::Tensor> >’
  /usr/include/c++/11/type_traits:3203:43:   required from ‘constexpr const bool std::is_trivially_move_constructible_v<std::tuple<torch::Tensor, torch::Tensor> >’
  /usr/include/c++/11/optional:662:11:   required from ‘class std::optional<std::tuple<torch::Tensor, torch::Tensor> >’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:161:59:   required from here
  /usr/include/c++/11/type_traits:1077:12: error: no type named ‘type’ in ‘struct std::__is_nothrow_move_constructible_impl<torch::Tensor, true>’
   1077 |     struct is_nothrow_move_constructible
        |            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/type_traits:1080:52: error: static assertion failed: template argument must be a complete class or an unbounded array
   1080 |       static_assert(std::__is_complete_or_unbounded(__type_identity<_Tp>{}),
        |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/type_traits:1080:52: note: ‘std::__is_complete_or_unbounded<std::__type_identity<torch::Tensor> >((std::__type_identity<torch::Tensor>{}, std::__type_identity<torch::Tensor>()))’ evaluates to false
  In file included from /usr/include/c++/11/bits/unique_ptr.h:37,
                   from /usr/include/c++/11/memory:76,
                   from /workspace/nunchaku/src/common.h:9,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/tuple: In instantiation of ‘constexpr std::_Tuple_impl<_Idx, _Head>::_Tuple_impl(std::_Tuple_impl<_Idx, _Head>&&) [with long unsigned int _Idx = 1; _Head = torch::Tensor]’:
  /usr/include/c++/11/type_traits:1272:4:   recursively required from ‘constexpr std::tuple<_T1, _T2>::tuple(std::tuple<_T1, _T2>&&) [with _T1 = torch::Tensor; _T2 = torch::Tensor]’
  /usr/include/c++/11/type_traits:1272:4:   required from ‘struct std::__is_trivially_move_constructible_impl<std::tuple<torch::Tensor, torch::Tensor>, true>’
  /usr/include/c++/11/type_traits:1277:12:   required from ‘struct std::is_trivially_move_constructible<std::tuple<torch::Tensor, torch::Tensor> >’
  /usr/include/c++/11/type_traits:3203:43:   required from ‘constexpr const bool std::is_trivially_move_constructible_v<std::tuple<torch::Tensor, torch::Tensor> >’
  /usr/include/c++/11/optional:662:11:   required from ‘class std::optional<std::tuple<torch::Tensor, torch::Tensor> >’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:161:59:   required from here
  /usr/include/c++/11/tuple:455:54: error: ‘value’ is not a member of ‘std::is_nothrow_move_constructible<torch::Tensor>’
    455 |       noexcept(is_nothrow_move_constructible<_Head>::value)
        |                                                      ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:224:72: error: invalid use of incomplete type ‘class torch::Tensor’
    224 |   std::tuple<Tensor, Tensor> forward(const Tensor& input, Tensor hx = {});
        |                                                                        ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:233:20: error: invalid use of incomplete type ‘class torch::Tensor’
    233 |       Tensor hx = {});
        |                    ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h: In member function ‘virtual unsigned int torch::nn::GRUImpl::_forward_num_required_args()’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:227:55: error: invalid use of incomplete type ‘class torch::Tensor’
    227 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(torch::Tensor())})
        |                                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:227:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    227 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(torch::Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: note:   candidate expects 3 arguments, 1 provided
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:227:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    227 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(torch::Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:43: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::initializer_list<std::pair<unsigned int, torch::nn::AnyValue> >’
    625 |       vector(initializer_list<value_type> __l,
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note:   candidate expects 2 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:7: note:   candidate expects 2 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:14: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&&’
    572 |       vector(vector&&) noexcept = default;
        |              ^~~~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:28: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&’
    553 |       vector(const vector& __x)
        |              ~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:36: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const allocator_type&’ {aka ‘const std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >&’}
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |              ~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h: In member function ‘virtual std::vector<torch::nn::AnyValue> torch::nn::GRUImpl::_forward_populate_default_args(std::vector<torch::nn::AnyValue>&&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:227:55: error: invalid use of incomplete type ‘class torch::Tensor’
    227 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(torch::Tensor())})
        |                                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:227:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    227 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(torch::Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: note:   candidate expects 3 arguments, 1 provided
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:227:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    227 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(torch::Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:43: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::initializer_list<std::pair<unsigned int, torch::nn::AnyValue> >’
    625 |       vector(initializer_list<value_type> __l,
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note:   candidate expects 2 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:7: note:   candidate expects 2 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:14: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&&’
    572 |       vector(vector&&) noexcept = default;
        |              ^~~~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:28: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&’
    553 |       vector(const vector& __x)
        |              ~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:36: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const allocator_type&’ {aka ‘const std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >&’}
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |              ~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:273:10: error: field ‘weight_ih’ has incomplete type ‘torch::Tensor’
    273 |   Tensor weight_ih;
        |          ^~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:274:10: error: field ‘weight_hh’ has incomplete type ‘torch::Tensor’
    274 |   Tensor weight_hh;
        |          ^~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:275:10: error: field ‘bias_ih’ has incomplete type ‘torch::Tensor’
    275 |   Tensor bias_ih;
        |          ^~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:276:10: error: field ‘bias_hh’ has incomplete type ‘torch::Tensor’
    276 |   Tensor bias_hh;
        |          ^~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:305:59: error: invalid use of incomplete type ‘const class torch::Tensor’
    305 |   Tensor forward(const Tensor& input, const Tensor& hx = {});
        |                                                           ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h: In member function ‘virtual unsigned int torch::nn::RNNCellImpl::_forward_num_required_args()’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:308:48: error: invalid use of incomplete type ‘class torch::Tensor’
    308 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:308:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    308 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: note:   candidate expects 3 arguments, 1 provided
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:308:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    308 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:43: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::initializer_list<std::pair<unsigned int, torch::nn::AnyValue> >’
    625 |       vector(initializer_list<value_type> __l,
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note:   candidate expects 2 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:7: note:   candidate expects 2 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:14: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&&’
    572 |       vector(vector&&) noexcept = default;
        |              ^~~~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:28: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&’
    553 |       vector(const vector& __x)
        |              ~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:36: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const allocator_type&’ {aka ‘const std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >&’}
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |              ~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h: In member function ‘virtual std::vector<torch::nn::AnyValue> torch::nn::RNNCellImpl::_forward_populate_default_args(std::vector<torch::nn::AnyValue>&&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:308:48: error: invalid use of incomplete type ‘class torch::Tensor’
    308 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:308:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    308 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: note:   candidate expects 3 arguments, 1 provided
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:308:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    308 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:43: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::initializer_list<std::pair<unsigned int, torch::nn::AnyValue> >’
    625 |       vector(initializer_list<value_type> __l,
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note:   candidate expects 2 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:7: note:   candidate expects 2 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:14: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&&’
    572 |       vector(vector&&) noexcept = default;
        |              ^~~~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:28: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&’
    553 |       vector(const vector& __x)
        |              ~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:36: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const allocator_type&’ {aka ‘const std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >&’}
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |              ~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:32,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:383:59: error: invalid use of incomplete type ‘const class torch::Tensor’
    383 |   Tensor forward(const Tensor& input, const Tensor& hx = {});
        |                                                           ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h: In member function ‘virtual unsigned int torch::nn::GRUCellImpl::_forward_num_required_args()’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:386:48: error: invalid use of incomplete type ‘class torch::Tensor’
    386 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:386:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    386 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: note:   candidate expects 3 arguments, 1 provided
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:386:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    386 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:43: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::initializer_list<std::pair<unsigned int, torch::nn::AnyValue> >’
    625 |       vector(initializer_list<value_type> __l,
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note:   candidate expects 2 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:7: note:   candidate expects 2 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:14: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&&’
    572 |       vector(vector&&) noexcept = default;
        |              ^~~~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:28: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&’
    553 |       vector(const vector& __x)
        |              ~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:36: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const allocator_type&’ {aka ‘const std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >&’}
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |              ~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h: In member function ‘virtual std::vector<torch::nn::AnyValue> torch::nn::GRUCellImpl::_forward_populate_default_args(std::vector<torch::nn::AnyValue>&&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:386:48: error: invalid use of incomplete type ‘class torch::Tensor’
    386 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:386:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    386 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: note:   candidate expects 3 arguments, 1 provided
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:386:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    386 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:43: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::initializer_list<std::pair<unsigned int, torch::nn::AnyValue> >’
    625 |       vector(initializer_list<value_type> __l,
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note:   candidate expects 2 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:7: note:   candidate expects 2 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:14: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&&’
    572 |       vector(vector&&) noexcept = default;
        |              ^~~~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:28: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&’
    553 |       vector(const vector& __x)
        |              ~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note:   candidate expects 3 arguments, 1 provided
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:36: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const allocator_type&’ {aka ‘const std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >&’}
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |              ~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:33,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:89:33: error: invalid use of incomplete type ‘const class torch::Tensor’
     89 |       const Tensor& src_mask = {},
        |                                 ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:33,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:90:33: error: invalid use of incomplete type ‘const class torch::Tensor’
     90 |       const Tensor& tgt_mask = {},
        |                                 ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:33,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:91:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     91 |       const Tensor& memory_mask = {},
        |                                    ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:33,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:92:45: error: invalid use of incomplete type ‘const class torch::Tensor’
     92 |       const Tensor& src_key_padding_mask = {},
        |                                             ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:33,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:93:45: error: invalid use of incomplete type ‘const class torch::Tensor’
     93 |       const Tensor& tgt_key_padding_mask = {},
        |                                             ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:33,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:94:48: error: invalid use of incomplete type ‘const class torch::Tensor’
     94 |       const Tensor& memory_key_padding_mask = {});
        |                                                ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h: In member function ‘virtual unsigned int torch::nn::TransformerImpl::_forward_num_required_args()’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:115:27: error: invalid use of incomplete type ‘class torch::Tensor’
    115 |       {2, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:116:27: error: invalid use of incomplete type ‘class torch::Tensor’
    116 |       {3, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:117:27: error: invalid use of incomplete type ‘class torch::Tensor’
    117 |       {4, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:118:27: error: invalid use of incomplete type ‘class torch::Tensor’
    118 |       {5, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:119:27: error: invalid use of incomplete type ‘class torch::Tensor’
    119 |       {6, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:120:27: error: invalid use of incomplete type ‘class torch::Tensor’
    120 |       {7, AnyValue(Tensor())})
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:114:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    114 |   FORWARD_HAS_DEFAULT_ARGS(
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: note:   candidate expects 3 arguments, 6 provided
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:114:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    114 |   FORWARD_HAS_DEFAULT_ARGS(
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:7: note:   candidate expects 2 arguments, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note:   candidate expects 2 arguments, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:7: note:   candidate expects 2 arguments, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note:   candidate expects 1 argument, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note:   candidate expects 1 argument, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note:   candidate expects 3 arguments, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:7: note:   candidate expects 2 arguments, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note:   candidate expects 1 argument, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 6 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h: In member function ‘virtual std::vector<torch::nn::AnyValue> torch::nn::TransformerImpl::_forward_populate_default_args(std::vector<torch::nn::AnyValue>&&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:115:27: error: invalid use of incomplete type ‘class torch::Tensor’
    115 |       {2, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:116:27: error: invalid use of incomplete type ‘class torch::Tensor’
    116 |       {3, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:117:27: error: invalid use of incomplete type ‘class torch::Tensor’
    117 |       {4, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:118:27: error: invalid use of incomplete type ‘class torch::Tensor’
    118 |       {5, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:119:27: error: invalid use of incomplete type ‘class torch::Tensor’
    119 |       {6, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:120:27: error: invalid use of incomplete type ‘class torch::Tensor’
    120 |       {7, AnyValue(Tensor())})
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:114:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    114 |   FORWARD_HAS_DEFAULT_ARGS(
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: note:   candidate expects 3 arguments, 6 provided
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformer.h:114:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    114 |   FORWARD_HAS_DEFAULT_ARGS(
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:7: note:   candidate expects 2 arguments, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note:   candidate expects 2 arguments, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:7: note:   candidate expects 2 arguments, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note:   candidate expects 1 argument, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note:   candidate expects 1 argument, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note:   candidate expects 3 arguments, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:7: note:   candidate expects 2 arguments, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note:   candidate expects 1 argument, 6 provided
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 6 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/transformercoder.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:34,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:45:33: error: invalid use of incomplete type ‘const class torch::Tensor’
     45 |       const Tensor& src_mask = {},
        |                                 ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/transformercoder.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:34,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:46:45: error: invalid use of incomplete type ‘const class torch::Tensor’
     46 |       const Tensor& src_key_padding_mask = {});
        |                                             ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h: In member function ‘virtual unsigned int torch::nn::TransformerEncoderLayerImpl::_forward_num_required_args()’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:53:48: error: invalid use of incomplete type ‘class torch::Tensor’
     53 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:53:73: error: invalid use of incomplete type ‘class torch::Tensor’
     53 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |                                                                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:53:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     53 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: note:   couldn’t deduce template parameter ‘_InputIterator’
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:53:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     53 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:43: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::initializer_list<std::pair<unsigned int, torch::nn::AnyValue> >’
    625 |       vector(initializer_list<value_type> __l,
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:23: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&&’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |              ~~~~~~~~~^~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:28: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |              ~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    522 |       vector(size_type __n, const value_type& __value,
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 2 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h: In member function ‘virtual std::vector<torch::nn::AnyValue> torch::nn::TransformerEncoderLayerImpl::_forward_populate_default_args(std::vector<torch::nn::AnyValue>&&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:53:48: error: invalid use of incomplete type ‘class torch::Tensor’
     53 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:53:73: error: invalid use of incomplete type ‘class torch::Tensor’
     53 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |                                                                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:53:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     53 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: note:   couldn’t deduce template parameter ‘_InputIterator’
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:53:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     53 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:43: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::initializer_list<std::pair<unsigned int, torch::nn::AnyValue> >’
    625 |       vector(initializer_list<value_type> __l,
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:23: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&&’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |              ~~~~~~~~~^~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:28: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |              ~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    522 |       vector(size_type __n, const value_type& __value,
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 2 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/transformercoder.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:34,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:134:33: error: invalid use of incomplete type ‘const class torch::Tensor’
    134 |       const Tensor& tgt_mask = {},
        |                                 ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/transformercoder.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:34,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:135:36: error: invalid use of incomplete type ‘const class torch::Tensor’
    135 |       const Tensor& memory_mask = {},
        |                                    ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/transformercoder.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:34,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:136:45: error: invalid use of incomplete type ‘const class torch::Tensor’
    136 |       const Tensor& tgt_key_padding_mask = {},
        |                                             ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/options/transformercoder.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:34,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:137:48: error: invalid use of incomplete type ‘const class torch::Tensor’
    137 |       const Tensor& memory_key_padding_mask = {});
        |                                                ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h: In member function ‘virtual unsigned int torch::nn::TransformerDecoderLayerImpl::_forward_num_required_args()’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:177:27: error: invalid use of incomplete type ‘class torch::Tensor’
    177 |       {2, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:178:27: error: invalid use of incomplete type ‘class torch::Tensor’
    178 |       {3, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:179:27: error: invalid use of incomplete type ‘class torch::Tensor’
    179 |       {4, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:180:27: error: invalid use of incomplete type ‘class torch::Tensor’
    180 |       {5, AnyValue(Tensor())})
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:176:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    176 |   FORWARD_HAS_DEFAULT_ARGS(
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: note:   candidate expects 3 arguments, 4 provided
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:176:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    176 |   FORWARD_HAS_DEFAULT_ARGS(
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 4 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h: In member function ‘virtual std::vector<torch::nn::AnyValue> torch::nn::TransformerDecoderLayerImpl::_forward_populate_default_args(std::vector<torch::nn::AnyValue>&&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:177:27: error: invalid use of incomplete type ‘class torch::Tensor’
    177 |       {2, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:178:27: error: invalid use of incomplete type ‘class torch::Tensor’
    178 |       {3, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:179:27: error: invalid use of incomplete type ‘class torch::Tensor’
    179 |       {4, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:180:27: error: invalid use of incomplete type ‘class torch::Tensor’
    180 |       {5, AnyValue(Tensor())})
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:176:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    176 |   FORWARD_HAS_DEFAULT_ARGS(
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: note:   candidate expects 3 arguments, 4 provided
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformerlayer.h:176:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    176 |   FORWARD_HAS_DEFAULT_ARGS(
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 4 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:34,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:47:33: error: invalid use of incomplete type ‘const class torch::Tensor’
     47 |       const Tensor& src_mask = {},
        |                                 ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:34,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:48:45: error: invalid use of incomplete type ‘const class torch::Tensor’
     48 |       const Tensor& src_key_padding_mask = {});
        |                                             ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h: In member function ‘virtual unsigned int torch::nn::TransformerEncoderImpl::_forward_num_required_args()’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:55:48: error: invalid use of incomplete type ‘class torch::Tensor’
     55 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:55:73: error: invalid use of incomplete type ‘class torch::Tensor’
     55 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |                                                                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:55:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     55 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: note:   couldn’t deduce template parameter ‘_InputIterator’
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:55:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     55 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:43: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::initializer_list<std::pair<unsigned int, torch::nn::AnyValue> >’
    625 |       vector(initializer_list<value_type> __l,
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:23: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&&’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |              ~~~~~~~~~^~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:28: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |              ~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    522 |       vector(size_type __n, const value_type& __value,
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 2 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h: In member function ‘virtual std::vector<torch::nn::AnyValue> torch::nn::TransformerEncoderImpl::_forward_populate_default_args(std::vector<torch::nn::AnyValue>&&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:55:48: error: invalid use of incomplete type ‘class torch::Tensor’
     55 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:55:73: error: invalid use of incomplete type ‘class torch::Tensor’
     55 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |                                                                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:55:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     55 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: note:   couldn’t deduce template parameter ‘_InputIterator’
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:55:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     55 |   FORWARD_HAS_DEFAULT_ARGS({1, AnyValue(Tensor())}, {2, AnyValue(Tensor())})
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:43: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::initializer_list<std::pair<unsigned int, torch::nn::AnyValue> >’
    625 |       vector(initializer_list<value_type> __l,
        |              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:23: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&&’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |              ~~~~~~~~~^~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:28: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘const std::vector<std::pair<unsigned int, torch::nn::AnyValue> >&’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |              ~~~~~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    522 |       vector(size_type __n, const value_type& __value,
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:24: note:   no known conversion for argument 1 from ‘<brace-enclosed initializer list>’ to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::size_type’ {aka ‘long unsigned int’}
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |              ~~~~~~~~~~^~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 2 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:34,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:122:33: error: invalid use of incomplete type ‘const class torch::Tensor’
    122 |       const Tensor& tgt_mask = {},
        |                                 ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:34,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:123:36: error: invalid use of incomplete type ‘const class torch::Tensor’
    123 |       const Tensor& memory_mask = {},
        |                                    ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:34,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:124:45: error: invalid use of incomplete type ‘const class torch::Tensor’
    124 |       const Tensor& tgt_key_padding_mask = {},
        |                                             ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:34,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:125:48: error: invalid use of incomplete type ‘const class torch::Tensor’
    125 |       const Tensor& memory_key_padding_mask = {});
        |                                                ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h: In member function ‘virtual unsigned int torch::nn::TransformerDecoderImpl::_forward_num_required_args()’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:138:27: error: invalid use of incomplete type ‘class torch::Tensor’
    138 |       {2, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:139:27: error: invalid use of incomplete type ‘class torch::Tensor’
    139 |       {3, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:140:27: error: invalid use of incomplete type ‘class torch::Tensor’
    140 |       {4, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:141:27: error: invalid use of incomplete type ‘class torch::Tensor’
    141 |       {5, AnyValue(Tensor())})
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     81 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:137:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    137 |   FORWARD_HAS_DEFAULT_ARGS(
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:81:20: note:   candidate expects 3 arguments, 4 provided
     81 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:137:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    137 |   FORWARD_HAS_DEFAULT_ARGS(
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 4 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h: In member function ‘virtual std::vector<torch::nn::AnyValue> torch::nn::TransformerDecoderImpl::_forward_populate_default_args(std::vector<torch::nn::AnyValue>&&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:138:27: error: invalid use of incomplete type ‘class torch::Tensor’
    138 |       {2, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:139:27: error: invalid use of incomplete type ‘class torch::Tensor’
    139 |       {3, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:140:27: error: invalid use of incomplete type ‘class torch::Tensor’
    140 |       {4, AnyValue(Tensor())},
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:141:27: error: invalid use of incomplete type ‘class torch::Tensor’
    141 |       {5, AnyValue(Tensor())})
        |                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:9: note: in definition of macro ‘FORWARD_HAS_DEFAULT_ARGS’
     87 |         __VA_ARGS__};                                                    \
        |         ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: error: no matching function for call to ‘std::vector<std::pair<unsigned int, torch::nn::AnyValue> >::vector(<brace-enclosed initializer list>)’
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:137:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    137 |   FORWARD_HAS_DEFAULT_ARGS(
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:653:9: note: candidate: ‘template<class _InputIterator, class> std::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const allocator_type&) [with _InputIterator = _InputIterator; <template-parameter-2-2> = <template-parameter-1-2>; _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    653 |         vector(_InputIterator __first, _InputIterator __last,
        |         ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:653:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/common.h:87:20: note:   candidate expects 3 arguments, 4 provided
     87 |         __VA_ARGS__};                                                    \
        |                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/transformercoder.h:137:3: note: in expansion of macro ‘FORWARD_HAS_DEFAULT_ARGS’
    137 |   FORWARD_HAS_DEFAULT_ARGS(
        |   ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h:625:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    625 |       vector(initializer_list<value_type> __l,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:625:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:607:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    607 |       vector(vector&& __rv, const allocator_type& __m)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:607:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:589:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::false_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::false_type = std::integral_constant<bool, false>]’
    589 |       vector(vector&& __rv, const allocator_type& __m, false_type)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:589:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:585:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&, const allocator_type&, std::true_type) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::true_type = std::integral_constant<bool, true>]’
    585 |       vector(vector&& __rv, const allocator_type& __m, true_type) noexcept
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:585:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:575:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    575 |       vector(const vector& __x, const allocator_type& __a)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:575:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:572:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>&&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    572 |       vector(vector&&) noexcept = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:572:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:553:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    553 |       vector(const vector& __x)
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:553:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:522:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const value_type&, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::value_type = std::pair<unsigned int, torch::nn::AnyValue>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    522 |       vector(size_type __n, const value_type& __value,
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:522:7: note:   candidate expects 3 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:510:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(std::vector<_Tp, _Alloc>::size_type, const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    510 |       vector(size_type __n, const allocator_type& __a = allocator_type())
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:510:7: note:   candidate expects 2 arguments, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:497:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector(const allocator_type&) [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    497 |       vector(const allocator_type& __a) _GLIBCXX_NOEXCEPT
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:497:7: note:   candidate expects 1 argument, 4 provided
  /usr/include/c++/11/bits/stl_vector.h:487:7: note: candidate: ‘std::vector<_Tp, _Alloc>::vector() [with _Tp = std::pair<unsigned int, torch::nn::AnyValue>; _Alloc = std::allocator<std::pair<unsigned int, torch::nn::AnyValue> >]’
    487 |       vector() = default;
        |       ^~~~~~
  /usr/include/c++/11/bits/stl_vector.h:487:7: note:   candidate expects 0 arguments, 4 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h: In function ‘double torch::nn::utils::clip_grad_norm_(const std::vector<torch::Tensor>&, double, double, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:29:18: error: invalid use of incomplete type ‘const class torch::Tensor’
     29 |     auto& grad = param.grad();
        |                  ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:39:10: error: aggregate ‘torch::Tensor total_norm_tensor’ has incomplete type and cannot be defined
     39 |   Tensor total_norm_tensor;
        |          ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:45:26: error: invalid use of incomplete type ‘const class torch::Tensor’
     45 |       norms.emplace_back(param.grad().data().abs().max());
        |                          ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:48:66: error: could not convert ‘norms’ from ‘std::vector<torch::Tensor>’ to ‘at::TensorList’ {aka ‘c10::ArrayRef<at::Tensor>’}
     48 |         (norms.size() == 1) ? norms[0] : torch::max(torch::stack(norms));
        |                                                                  ^~~~~
        |                                                                  |
        |                                                                  std::vector<torch::Tensor>
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:57:26: error: invalid use of incomplete type ‘const class torch::Tensor’
     57 |       norms.emplace_back(param.grad().data().norm(norm_type));
        |                          ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:60:55: error: could not convert ‘norms’ from ‘std::vector<torch::Tensor>’ to ‘at::TensorList’ {aka ‘c10::ArrayRef<at::Tensor>’}
     60 |         (norms.size() == 1) ? norms[0] : torch::stack(norms).norm(norm_type);
        |                                                       ^~~~~
        |                                                       |
        |                                                       std::vector<torch::Tensor>
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:84:5: error: invalid use of incomplete type ‘class torch::Tensor’
     84 |     param.grad().data().mul_(clip_coef_clamped);
        |     ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/stl_algobase.h:67,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_iterator.h: In instantiation of ‘constexpr __gnu_cxx::__normal_iterator<_Iterator, _Container>& __gnu_cxx::__normal_iterator<_Iterator, _Container>::operator++() [with _Iterator = const torch::Tensor*; _Container = std::vector<torch::Tensor>]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:28:28:   required from here
  /usr/include/c++/11/bits/stl_iterator.h:1054:11: error: cannot increment a pointer to incomplete type ‘const torch::Tensor’
   1054 |         ++_M_current;
        |           ^~~~~~~~~~
  /usr/include/c++/11/bits/stl_iterator.h: In instantiation of ‘constexpr __gnu_cxx::__normal_iterator<_Iterator, _Container>& __gnu_cxx::__normal_iterator<_Iterator, _Container>::operator++() [with _Iterator = torch::Tensor*; _Container = std::vector<torch::Tensor>]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:44:30:   required from here
  /usr/include/c++/11/bits/stl_iterator.h:1054:11: error: cannot increment a pointer to incomplete type ‘torch::Tensor’
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:107:12: error: ‘parameter’ has incomplete type
    107 |     Tensor parameter,
        |     ~~~~~~~^~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h: In function ‘double torch::nn::utils::clip_grad_norm_(torch::Tensor, double, double, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:111:53: error: could not convert ‘{<expression error>}’ from ‘<brace-enclosed initializer list>’ to ‘std::vector<torch::Tensor>’
    111 |   std::vector<Tensor> params = {std::move(parameter)};
        |                                                     ^
        |                                                     |
        |                                                     <brace-enclosed initializer list>
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h: In function ‘void torch::nn::utils::clip_grad_value_(const std::vector<torch::Tensor>&, double)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:123:9: error: invalid use of incomplete type ‘const class torch::Tensor’
    123 |     if (param.grad().defined()) {
        |         ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:124:7: error: invalid use of incomplete type ‘const class torch::Tensor’
    124 |       param.grad().data().clamp_(-clip_value, clip_value);
        |       ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:139:37: error: ‘parameter’ has incomplete type
    139 | inline void clip_grad_value_(Tensor parameter, double clip_value) {
        |                              ~~~~~~~^~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h: In function ‘void torch::nn::utils::clip_grad_value_(torch::Tensor, double)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:140:53: error: could not convert ‘{<expression error>}’ from ‘<brace-enclosed initializer list>’ to ‘std::vector<torch::Tensor>’
    140 |   std::vector<Tensor> params = {std::move(parameter)};
        |                                                     ^
        |                                                     |
        |                                                     <brace-enclosed initializer list>
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/convert_parameters.h: In function ‘std::optional<long int> torch::nn::utils::_check_param_device(const torch::Tensor&, std::optional<long int>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/convert_parameters.h:17:24: error: invalid use of incomplete type ‘const class torch::Tensor’
     17 |     old_param_device = param.is_cuda() ? param.get_device() : -1;
        |                        ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/convert_parameters.h:17:42: error: invalid use of incomplete type ‘const class torch::Tensor’
     17 |     old_param_device = param.is_cuda() ? param.get_device() : -1;
        |                                          ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/convert_parameters.h:20:9: error: invalid use of incomplete type ‘const class torch::Tensor’
     20 |     if (param.is_cuda()) { // Check if in same GPU
        |         ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/convert_parameters.h:21:15: error: invalid use of incomplete type ‘const class torch::Tensor’
     21 |       warn = (param.get_device() != old_param_device);
        |               ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/convert_parameters.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/convert_parameters.h:38:49: error: return type ‘class torch::Tensor’ is incomplete
     38 |     const std::vector<torch::Tensor>& parameters) {
        |                                                 ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/convert_parameters.h: In function ‘void torch::nn::utils::parameters_to_vector(const std::vector<torch::Tensor>&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/convert_parameters.h:48:19: error: invalid use of incomplete type ‘const class torch::Tensor’
     48 |     vec.push_back(param.view(-1));
        |                   ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/convert_parameters.h:51:20: error: no matching function for call to ‘cat(std::vector<torch::Tensor>&)’
     51 |   return torch::cat(vec);
        |          ~~~~~~~~~~^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:559,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:19: note: candidate: ‘at::Tensor at::cat(const ITensorListRef&, int64_t)’
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:26:50: note:   no known conversion for argument 1 from ‘std::vector<torch::Tensor>’ to ‘const ITensorListRef&’ {aka ‘const c10::IListRef<at::Tensor>&’}
     26 | inline at::Tensor cat(const at::ITensorListRef & tensors, int64_t dim=0) {
        |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:19: note: candidate: ‘at::Tensor at::cat(at::TensorList, at::Dimname)’
     40 | inline at::Tensor cat(at::TensorList tensors, at::Dimname dim) {
        |                   ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/cat.h:40:19: note:   candidate expects 2 arguments, 1 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/convert_parameters.h: In function ‘void torch::nn::utils::vector_to_parameters(const torch::Tensor&, const std::vector<torch::Tensor>&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/convert_parameters.h:68:22: error: invalid use of incomplete type ‘const class torch::Tensor’
     68 |     auto num_param = param.numel();
        |                      ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/convert_parameters.h:70:5: error: invalid use of incomplete type ‘const class torch::Tensor’
     70 |     param.set_data(
        |     ^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:10,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/convert_parameters.h:71:9: error: invalid use of incomplete type ‘const class torch::Tensor’
     71 |         vec.slice(0, pointer, pointer + num_param).view_as(param).data());
        |         ^~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adagrad.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/optimizer.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/optimizer.h:24:11: error: ‘class at::Tensor’ conflicts with a previous declaration
     24 | using at::Tensor;
        |           ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: previous declaration ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adagrad.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/serialize.h: In function ‘void torch::optim::detail::serialize(torch::serialize::OutputArchive&, const std::vector<torch::optim::OptimizerParamGroup>&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/serialize.h:66:53: warning: invalid use of incomplete type ‘__gnu_cxx::__alloc_traits<std::allocator<torch::Tensor>, torch::Tensor>::value_type’ {aka ‘class torch::Tensor’}
     66 |               reinterpret_cast<size_t>(params[index].unsafeGetTensorImpl()))));
        |                                                     ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘__gnu_cxx::__alloc_traits<std::allocator<torch::Tensor>, torch::Tensor>::value_type’ {aka ‘class torch::Tensor’}
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adagrad.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/serialize.h: In function ‘void torch::optim::detail::serialize(torch::serialize::InputArchive&, std::vector<std::pair<std::vector<std::__cxx11::basic_string<char> >, std::unique_ptr<torch::optim::OptimizerOptions> > >&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/serialize.h:90:17: error: ‘param_groups_size_tensor’ has incomplete type
     90 |   torch::Tensor param_groups_size_tensor;
        |                 ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adagrad.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/serialize.h:92:74: error: expected primary-expression before ‘>’ token
     92 |   const int64_t param_groups_size = param_groups_size_tensor.item<int64_t>();
        |                                                                          ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/serialize.h:92:76: error: expected primary-expression before ‘)’ token
     92 |   const int64_t param_groups_size = param_groups_size_tensor.item<int64_t>();
        |                                                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/serialize.h:96:19: error: ‘size_tensor’ has incomplete type
     96 |     torch::Tensor size_tensor;
        |                   ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adagrad.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/serialize.h:98:50: error: expected primary-expression before ‘>’ token
     98 |     const int64_t size = size_tensor.item<int64_t>();
        |                                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/serialize.h:98:52: error: expected primary-expression before ‘)’ token
     98 |     const int64_t size = size_tensor.item<int64_t>();
        |                                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/serialize.h: In function ‘void torch::optim::serialize(torch::serialize::InputArchive&, torch::optim::Optimizer&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/serialize.h:199:38: warning: invalid use of incomplete type ‘__gnu_cxx::__alloc_traits<std::allocator<torch::Tensor>, torch::Tensor>::value_type’ {aka ‘class torch::Tensor’}
    199 |         optimizer.state()[params[idx].unsafeGetTensorImpl()] =
        |                                      ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘__gnu_cxx::__alloc_traits<std::allocator<torch::Tensor>, torch::Tensor>::value_type’ {aka ‘class torch::Tensor’}
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adagrad.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/serialize.h: In function ‘void torch::optim::serialize(torch::serialize::InputArchive&, const string&, BufferContainer&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/serialize.h:233:17: error: ‘size_tensor’ has incomplete type
    233 |   torch::Tensor size_tensor;
        |                 ^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adagrad.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/serialize.h:235:47: error: expected primary-expression before ‘>’ token
    235 |   const size_t size = size_tensor.item<int64_t>();
        |                                               ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/serialize.h:235:49: error: expected primary-expression before ‘)’ token
    235 |   const size_t size = size_tensor.item<int64_t>();
        |                                                 ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adagrad.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adagrad.h:40:28: error: field ‘sum_’ has incomplete type ‘torch::Tensor’
     40 |   TORCH_ARG(torch::Tensor, sum);
        |                            ^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adagrad.h: In constructor ‘torch::optim::Adagrad::Adagrad(const std::vector<torch::optim::OptimizerParamGroup>&, torch::optim::AdagradOptions)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adagrad.h:82:13: error: invalid use of incomplete type ‘const class torch::Tensor’
     82 |             p.data(),
        |             ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:16,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adagrad.h:85:16: error: invalid use of incomplete type ‘const class torch::Tensor’
     85 |         state_[p.unsafeGetTensorImpl()] = std::move(state);
        |                ^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adam.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adam.h:39:28: error: field ‘exp_avg_’ has incomplete type ‘torch::Tensor’
     39 |   TORCH_ARG(torch::Tensor, exp_avg);
        |                            ^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adam.h:40:28: error: field ‘exp_avg_sq_’ has incomplete type ‘torch::Tensor’
     40 |   TORCH_ARG(torch::Tensor, exp_avg_sq);
        |                            ^~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adam.h:41:28: error: field ‘max_exp_avg_sq_’ has incomplete type ‘torch::Tensor’
     41 |   TORCH_ARG(torch::Tensor, max_exp_avg_sq) = {};
        |                            ^~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adamw.h:39:28: error: field ‘exp_avg_’ has incomplete type ‘torch::Tensor’
     39 |   TORCH_ARG(torch::Tensor, exp_avg);
        |                            ^~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adamw.h:40:28: error: field ‘exp_avg_sq_’ has incomplete type ‘torch::Tensor’
     40 |   TORCH_ARG(torch::Tensor, exp_avg_sq);
        |                            ^~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/adamw.h:41:28: error: field ‘max_exp_avg_sq_’ has incomplete type ‘torch::Tensor’
     41 |   TORCH_ARG(torch::Tensor, max_exp_avg_sq) = {};
        |                            ^~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:42:21: error: field ‘d_’ has incomplete type ‘torch::Tensor’
     42 |   TORCH_ARG(Tensor, d) = {};
        |                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:43:21: error: field ‘H_diag_’ has incomplete type ‘torch::Tensor’
     43 |   TORCH_ARG(Tensor, H_diag) = {};
        |                     ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:44:21: error: field ‘prev_flat_grad_’ has incomplete type ‘torch::Tensor’
     44 |   TORCH_ARG(Tensor, prev_flat_grad) = {};
        |                     ^~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/rmsprop.h:45:28: error: field ‘square_avg_’ has incomplete type ‘torch::Tensor’
     45 |   TORCH_ARG(torch::Tensor, square_avg);
        |                            ^~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/rmsprop.h:46:28: error: field ‘momentum_buffer_’ has incomplete type ‘torch::Tensor’
     46 |   TORCH_ARG(torch::Tensor, momentum_buffer) = {};
        |                            ^~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/rmsprop.h:47:28: error: field ‘grad_avg_’ has incomplete type ‘torch::Tensor’
     47 |   TORCH_ARG(torch::Tensor, grad_avg) = {};
        |                            ^~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/sgd.h:40:28: error: field ‘momentum_buffer_’ has incomplete type ‘torch::Tensor’
     40 |   TORCH_ARG(torch::Tensor, momentum_buffer);
        |                            ^~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/arg.h:23:5: note: in definition of macro ‘TORCH_ARG’
     23 |   T name##_ /* NOLINT */
        |     ^~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:16:41: error: return type ‘class torch::Tensor’ is incomplete
     16 | inline Tensor gammaln(const Tensor& self) {
        |                                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::gammaln(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:17:33: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     17 |   return torch::special_gammaln(self);
        |                                 ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1238,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_gammaln.h:26:54: note: in passing argument 1 of ‘at::Tensor at::special_gammaln(const at::Tensor&)’
     26 | inline at::Tensor special_gammaln(const at::Tensor & self) {
        |                                   ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::gammaln_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:21:37: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
     21 |   return torch::special_gammaln_out(result, self);
        |                                     ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1238,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_gammaln.h:31:54: note: in passing argument 1 of ‘at::Tensor& at::special_gammaln_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_gammaln_out(at::Tensor & out, const at::Tensor & self) {
        |                                         ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:33:63: error: return type ‘class torch::Tensor’ is incomplete
     33 | inline Tensor gammainc(const Tensor& self, const Tensor& other) {
        |                                                               ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::gammainc(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:34:34: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     34 |   return torch::special_gammainc(self, other);
        |                                  ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1236,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_gammainc.h:35:55: note: in passing argument 1 of ‘at::Tensor at::special_gammainc(const at::Tensor&, const at::Tensor&)’
     35 | inline at::Tensor special_gammainc(const at::Tensor & self, const at::Tensor & other) {
        |                                    ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::gammainc_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:41:38: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
     41 |   return torch::special_gammainc_out(result, self, other);
        |                                      ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1236,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_gammainc.h:26:55: note: in passing argument 1 of ‘at::Tensor& at::special_gammainc_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor & special_gammainc_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                                          ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:53:64: error: return type ‘class torch::Tensor’ is incomplete
     53 | inline Tensor gammaincc(const Tensor& self, const Tensor& other) {
        |                                                                ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::gammaincc(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:54:35: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     54 |   return torch::special_gammaincc(self, other);
        |                                   ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1237,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_gammaincc.h:35:56: note: in passing argument 1 of ‘at::Tensor at::special_gammaincc(const at::Tensor&, const at::Tensor&)’
     35 | inline at::Tensor special_gammaincc(const at::Tensor & self, const at::Tensor & other) {
        |                                     ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::gammaincc_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:61:39: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
     61 |   return torch::special_gammaincc_out(result, self, other);
        |                                       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1237,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_gammaincc.h:26:56: note: in passing argument 1 of ‘at::Tensor& at::special_gammaincc_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor & special_gammaincc_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                                           ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:72:57: error: return type ‘class torch::Tensor’ is incomplete
     72 | inline Tensor multigammaln(const Tensor& self, int64_t p) {
        |                                                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::multigammaln(const torch::Tensor&, int64_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:73:38: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     73 |   return torch::special_multigammaln(self, p);
        |                                      ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1256,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_multigammaln.h:26:59: note: in passing argument 1 of ‘at::Tensor at::special_multigammaln(const at::Tensor&, int64_t)’
     26 | inline at::Tensor special_multigammaln(const at::Tensor & self, int64_t p) {
        |                                        ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::multigammaln_out(torch::Tensor&, const torch::Tensor&, int64_t)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:77:42: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
     77 |   return torch::special_multigammaln_out(result, self, p);
        |                                          ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1256,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_multigammaln.h:31:59: note: in passing argument 1 of ‘at::Tensor& at::special_multigammaln_out(at::Tensor&, const at::Tensor&, int64_t)’
     31 | inline at::Tensor & special_multigammaln_out(at::Tensor & out, const at::Tensor & self, int64_t p) {
        |                                              ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:88:54: error: return type ‘class torch::Tensor’ is incomplete
     88 | inline Tensor polygamma(int64_t n, const Tensor& self) {
        |                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::polygamma(int64_t, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:89:38: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
     89 |   return torch::special_polygamma(n, self);
        |                                      ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1259,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_polygamma.h:26:67: note: in passing argument 2 of ‘at::Tensor at::special_polygamma(int64_t, const at::Tensor&)’
     26 | inline at::Tensor special_polygamma(int64_t n, const at::Tensor & self) {
        |                                                ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::polygamma_out(torch::Tensor&, int64_t, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:93:39: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
     93 |   return torch::special_polygamma_out(result, n, self);
        |                                       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1259,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_polygamma.h:31:56: note: in passing argument 1 of ‘at::Tensor& at::special_polygamma_out(at::Tensor&, int64_t, const at::Tensor&)’
     31 | inline at::Tensor & special_polygamma_out(at::Tensor & out, int64_t n, const at::Tensor & self) {
        |                                           ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:104:37: error: return type ‘class torch::Tensor’ is incomplete
    104 | inline Tensor psi(const Tensor& self) {
        |                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::psi(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:105:29: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    105 |   return torch::special_psi(self);
        |                             ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1260,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_psi.h:26:50: note: in passing argument 1 of ‘at::Tensor at::special_psi(const at::Tensor&)’
     26 | inline at::Tensor special_psi(const at::Tensor & self) {
        |                               ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::psi_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:109:33: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    109 |   return torch::special_psi_out(result, self);
        |                                 ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1260,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_psi.h:31:50: note: in passing argument 1 of ‘at::Tensor& at::special_psi_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_psi_out(at::Tensor & out, const at::Tensor & self) {
        |                                     ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:120:41: error: return type ‘class torch::Tensor’ is incomplete
    120 | inline Tensor digamma(const Tensor& self) {
        |                                         ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::digamma(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:121:33: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    121 |   return torch::special_digamma(self);
        |                                 ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1227,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_digamma.h:26:54: note: in passing argument 1 of ‘at::Tensor at::special_digamma(const at::Tensor&)’
     26 | inline at::Tensor special_digamma(const at::Tensor & self) {
        |                                   ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::digamma_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:125:37: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    125 |   return torch::special_digamma_out(result, self);
        |                                     ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1227,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_digamma.h:31:54: note: in passing argument 1 of ‘at::Tensor& at::special_digamma_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_digamma_out(at::Tensor & out, const at::Tensor & self) {
        |                                         ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:136:38: error: return type ‘class torch::Tensor’ is incomplete
    136 | inline Tensor entr(const Tensor& self) {
        |                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::entr(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:137:30: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    137 |   return torch::special_entr(self);
        |                              ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1228,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_entr.h:26:51: note: in passing argument 1 of ‘at::Tensor at::special_entr(const at::Tensor&)’
     26 | inline at::Tensor special_entr(const at::Tensor & self) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::entr_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:141:34: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    141 |   return torch::special_entr_out(result, self);
        |                                  ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1228,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_entr.h:31:51: note: in passing argument 1 of ‘at::Tensor& at::special_entr_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_entr_out(at::Tensor & out, const at::Tensor & self) {
        |                                      ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:152:37: error: return type ‘class torch::Tensor’ is incomplete
    152 | inline Tensor erf(const Tensor& self) {
        |                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::erf(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:153:29: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    153 |   return torch::special_erf(self);
        |                             ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1229,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_erf.h:26:50: note: in passing argument 1 of ‘at::Tensor at::special_erf(const at::Tensor&)’
     26 | inline at::Tensor special_erf(const at::Tensor & self) {
        |                               ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::erf_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:157:33: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    157 |   return torch::special_erf_out(result, self);
        |                                 ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1229,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_erf.h:31:50: note: in passing argument 1 of ‘at::Tensor& at::special_erf_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_erf_out(at::Tensor & out, const at::Tensor & self) {
        |                                     ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:168:38: error: return type ‘class torch::Tensor’ is incomplete
    168 | inline Tensor erfc(const Tensor& self) {
        |                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::erfc(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:169:30: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    169 |   return torch::special_erfc(self);
        |                              ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1230,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_erfc.h:26:51: note: in passing argument 1 of ‘at::Tensor at::special_erfc(const at::Tensor&)’
     26 | inline at::Tensor special_erfc(const at::Tensor & self) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::erfc_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:173:34: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    173 |   return torch::special_erfc_out(result, self);
        |                                  ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1230,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_erfc.h:31:51: note: in passing argument 1 of ‘at::Tensor& at::special_erfc_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_erfc_out(at::Tensor & out, const at::Tensor & self) {
        |                                      ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:184:39: error: return type ‘class torch::Tensor’ is incomplete
    184 | inline Tensor erfcx(const Tensor& self) {
        |                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::erfcx(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:185:31: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    185 |   return torch::special_erfcx(self);
        |                               ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1231,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_erfcx.h:26:52: note: in passing argument 1 of ‘at::Tensor at::special_erfcx(const at::Tensor&)’
     26 | inline at::Tensor special_erfcx(const at::Tensor & self) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::erfcx_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:189:35: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    189 |   return torch::special_erfcx_out(result, self);
        |                                   ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1231,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_erfcx.h:31:52: note: in passing argument 1 of ‘at::Tensor& at::special_erfcx_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_erfcx_out(at::Tensor & out, const at::Tensor & self) {
        |                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:200:40: error: return type ‘class torch::Tensor’ is incomplete
    200 | inline Tensor erfinv(const Tensor& self) {
        |                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::erfinv(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:201:32: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    201 |   return torch::special_erfinv(self);
        |                                ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1232,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_erfinv.h:26:53: note: in passing argument 1 of ‘at::Tensor at::special_erfinv(const at::Tensor&)’
     26 | inline at::Tensor special_erfinv(const at::Tensor & self) {
        |                                  ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::erfinv_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:205:36: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    205 |   return torch::special_erfinv_out(result, self);
        |                                    ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1232,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_erfinv.h:31:53: note: in passing argument 1 of ‘at::Tensor& at::special_erfinv_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_erfinv_out(at::Tensor & out, const at::Tensor & self) {
        |                                        ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:217:75: error: return type ‘class torch::Tensor’ is incomplete
    217 | inline Tensor logsumexp(const Tensor& self, IntArrayRef dims, bool keepdim) {
        |                                                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::logsumexp(const torch::Tensor&, c10::IntArrayRef, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:218:35: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    218 |   return torch::special_logsumexp(self, dims, keepdim);
        |                                   ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1251,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_logsumexp.h:26:56: note: in passing argument 1 of ‘at::Tensor at::special_logsumexp(const at::Tensor&, at::IntArrayRef, bool)’
     26 | inline at::Tensor special_logsumexp(const at::Tensor & self, at::IntArrayRef dim, bool keepdim=false) {
        |                                     ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::logsumexp_out(torch::Tensor&, const torch::Tensor&, c10::IntArrayRef, bool)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:226:39: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    226 |   return torch::special_logsumexp_out(result, self, dims, keepdim);
        |                                       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1251,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_logsumexp.h:31:56: note: in passing argument 1 of ‘at::Tensor& at::special_logsumexp_out(at::Tensor&, const at::Tensor&, at::IntArrayRef, bool)’
     31 | inline at::Tensor & special_logsumexp_out(at::Tensor & out, const at::Tensor & self, at::IntArrayRef dim, bool keepdim=false) {
        |                                           ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:239:39: error: return type ‘class torch::Tensor’ is incomplete
    239 | inline Tensor ndtri(const Tensor& self) {
        |                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::ndtri(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:240:31: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    240 |   return torch::special_ndtri(self);
        |                               ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1258,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_ndtri.h:26:52: note: in passing argument 1 of ‘at::Tensor at::special_ndtri(const at::Tensor&)’
     26 | inline at::Tensor special_ndtri(const at::Tensor & self) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::ndtri_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:244:35: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    244 |   return torch::special_ndtri_out(result, self);
        |                                   ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1258,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_ndtri.h:31:52: note: in passing argument 1 of ‘at::Tensor& at::special_ndtri_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_ndtri_out(at::Tensor & out, const at::Tensor & self) {
        |                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:256:42: error: return type ‘class torch::Tensor’ is incomplete
    256 | inline Tensor log_ndtr(const Tensor& self) {
        |                                          ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::log_ndtr(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:257:34: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    257 |   return torch::special_log_ndtr(self);
        |                                  ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1248,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_log_ndtr.h:26:55: note: in passing argument 1 of ‘at::Tensor at::special_log_ndtr(const at::Tensor&)’
     26 | inline at::Tensor special_log_ndtr(const at::Tensor & self) {
        |                                    ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::log_ndtr_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:261:38: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    261 |   return torch::special_log_ndtr_out(result, self);
        |                                      ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1248,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_log_ndtr.h:31:55: note: in passing argument 1 of ‘at::Tensor& at::special_log_ndtr_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_log_ndtr_out(at::Tensor & out, const at::Tensor & self) {
        |                                          ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:272:39: error: return type ‘class torch::Tensor’ is incomplete
    272 | inline Tensor logit(const Tensor& self) {
        |                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::logit(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:273:31: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    273 |   return torch::special_logit(self);
        |                               ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1250,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_logit.h:26:52: note: in passing argument 1 of ‘at::Tensor at::special_logit(const at::Tensor&, std::optional<double>)’
     26 | inline at::Tensor special_logit(const at::Tensor & self, ::std::optional<double> eps=::std::nullopt) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::logit_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:277:35: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    277 |   return torch::special_logit_out(result, self);
        |                                   ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1250,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_logit.h:31:52: note: in passing argument 1 of ‘at::Tensor& at::special_logit_out(at::Tensor&, const at::Tensor&, std::optional<double>)’
     31 | inline at::Tensor & special_logit_out(at::Tensor & out, const at::Tensor & self, ::std::optional<double> eps=::std::nullopt) {
        |                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:289:39: error: return type ‘class torch::Tensor’ is incomplete
    289 | inline Tensor expit(const Tensor& self) {
        |                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::expit(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:290:31: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    290 |   return torch::special_expit(self);
        |                               ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1234,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_expit.h:26:52: note: in passing argument 1 of ‘at::Tensor at::special_expit(const at::Tensor&)’
     26 | inline at::Tensor special_expit(const at::Tensor & self) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::expit_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:294:35: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    294 |   return torch::special_expit_out(result, self);
        |                                   ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1234,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_expit.h:31:52: note: in passing argument 1 of ‘at::Tensor& at::special_expit_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_expit_out(at::Tensor & out, const at::Tensor & self) {
        |                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:305:38: error: return type ‘class torch::Tensor’ is incomplete
    305 | inline Tensor exp2(const Tensor& self) {
        |                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::exp2(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:306:30: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    306 |   return torch::special_exp2(self);
        |                              ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1233,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_exp2.h:26:51: note: in passing argument 1 of ‘at::Tensor at::special_exp2(const at::Tensor&)’
     26 | inline at::Tensor special_exp2(const at::Tensor & self) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::exp2_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:310:34: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    310 |   return torch::special_exp2_out(result, self);
        |                                  ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1233,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_exp2.h:31:51: note: in passing argument 1 of ‘at::Tensor& at::special_exp2_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_exp2_out(at::Tensor & out, const at::Tensor & self) {
        |                                      ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:321:39: error: return type ‘class torch::Tensor’ is incomplete
    321 | inline Tensor expm1(const Tensor& self) {
        |                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::expm1(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:322:31: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    322 |   return torch::special_expm1(self);
        |                               ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1235,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_expm1.h:26:52: note: in passing argument 1 of ‘at::Tensor at::special_expm1(const at::Tensor&)’
     26 | inline at::Tensor special_expm1(const at::Tensor & self) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::expm1_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:326:35: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    326 |   return torch::special_expm1_out(result, self);
        |                                   ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1235,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_expm1.h:31:52: note: in passing argument 1 of ‘at::Tensor& at::special_expm1_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_expm1_out(at::Tensor & out, const at::Tensor & self) {
        |                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:338:60: error: return type ‘class torch::Tensor’ is incomplete
    338 | inline Tensor xlogy(const Tensor& self, const Tensor& other) {
        |                                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::xlogy(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:339:30: error: no matching function for call to ‘special_xlogy(const torch::Tensor&, const torch::Tensor&)’
    339 |   return torch::special_xlogy(self, other);
        |          ~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1272,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:26:19: note: candidate: ‘at::Tensor at::special_xlogy(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_xlogy(const at::Tensor & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:26:52: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_xlogy(const at::Tensor & self, const at::Tensor & other) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:31:19: note: candidate: ‘at::Tensor at::special_xlogy(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_xlogy(const at::Scalar & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:31:52: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_xlogy(const at::Scalar & self, const at::Tensor & other) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:36:19: note: candidate: ‘at::Tensor at::special_xlogy(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_xlogy(const at::Tensor & self, const at::Scalar & other) {
        |                   ^~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:36:52: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_xlogy(const at::Tensor & self, const at::Scalar & other) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:342:60: error: return type ‘class torch::Tensor’ is incomplete
    342 | inline Tensor xlogy(const Scalar& self, const Tensor& other) {
        |                                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::xlogy(const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:343:30: error: no matching function for call to ‘special_xlogy(const c10::Scalar&, const torch::Tensor&)’
    343 |   return torch::special_xlogy(self, other);
        |          ~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1272,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:26:19: note: candidate: ‘at::Tensor at::special_xlogy(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_xlogy(const at::Tensor & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:26:52: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_xlogy(const at::Tensor & self, const at::Tensor & other) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:31:19: note: candidate: ‘at::Tensor at::special_xlogy(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_xlogy(const at::Scalar & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:31:77: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     31 | inline at::Tensor special_xlogy(const at::Scalar & self, const at::Tensor & other) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:36:19: note: candidate: ‘at::Tensor at::special_xlogy(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_xlogy(const at::Tensor & self, const at::Scalar & other) {
        |                   ^~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:36:52: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_xlogy(const at::Tensor & self, const at::Scalar & other) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:346:60: error: return type ‘class torch::Tensor’ is incomplete
    346 | inline Tensor xlogy(const Tensor& self, const Scalar& other) {
        |                                                            ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::xlogy(const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:347:30: error: no matching function for call to ‘special_xlogy(const torch::Tensor&, const c10::Scalar&)’
    347 |   return torch::special_xlogy(self, other);
        |          ~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1272,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:26:19: note: candidate: ‘at::Tensor at::special_xlogy(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_xlogy(const at::Tensor & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:26:52: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_xlogy(const at::Tensor & self, const at::Tensor & other) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:31:19: note: candidate: ‘at::Tensor at::special_xlogy(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_xlogy(const at::Scalar & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:31:52: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_xlogy(const at::Scalar & self, const at::Tensor & other) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:36:19: note: candidate: ‘at::Tensor at::special_xlogy(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_xlogy(const at::Tensor & self, const at::Scalar & other) {
        |                   ^~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:36:52: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_xlogy(const at::Tensor & self, const at::Scalar & other) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::xlogy_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:354:34: error: no matching function for call to ‘special_xlogy_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’
    354 |   return torch::special_xlogy_out(result, self, other);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1272,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:41:21: note: candidate: ‘at::Tensor& at::special_xlogy_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:41:52: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:50:21: note: candidate: ‘at::Tensor& at::special_xlogy_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:50:52: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:59:21: note: candidate: ‘at::Tensor& at::special_xlogy_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                     ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:59:52: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::xlogy_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:361:34: error: no matching function for call to ‘special_xlogy_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’
    361 |   return torch::special_xlogy_out(result, self, other);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1272,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:41:21: note: candidate: ‘at::Tensor& at::special_xlogy_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:41:52: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:50:21: note: candidate: ‘at::Tensor& at::special_xlogy_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:50:52: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:59:21: note: candidate: ‘at::Tensor& at::special_xlogy_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                     ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:59:52: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::xlogy_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:368:34: error: no matching function for call to ‘special_xlogy_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’
    368 |   return torch::special_xlogy_out(result, self, other);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1272,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:41:21: note: candidate: ‘at::Tensor& at::special_xlogy_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:41:52: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:50:21: note: candidate: ‘at::Tensor& at::special_xlogy_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:50:52: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:59:21: note: candidate: ‘at::Tensor& at::special_xlogy_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                     ^~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlogy.h:59:52: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_xlogy_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:380:62: error: return type ‘class torch::Tensor’ is incomplete
    380 | inline Tensor xlog1py(const Tensor& self, const Tensor& other) {
        |                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::xlog1py(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:381:32: error: no matching function for call to ‘special_xlog1py(const torch::Tensor&, const torch::Tensor&)’
    381 |   return torch::special_xlog1py(self, other);
        |          ~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1271,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:26:19: note: candidate: ‘at::Tensor at::special_xlog1py(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_xlog1py(const at::Tensor & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:26:54: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_xlog1py(const at::Tensor & self, const at::Tensor & other) {
        |                                   ~~~~~~~~~~~~~~~~~~~^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:31:19: note: candidate: ‘at::Tensor at::special_xlog1py(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_xlog1py(const at::Scalar & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:31:54: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_xlog1py(const at::Scalar & self, const at::Tensor & other) {
        |                                   ~~~~~~~~~~~~~~~~~~~^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:36:19: note: candidate: ‘at::Tensor at::special_xlog1py(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_xlog1py(const at::Tensor & self, const at::Scalar & other) {
        |                   ^~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:36:54: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_xlog1py(const at::Tensor & self, const at::Scalar & other) {
        |                                   ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:384:62: error: return type ‘class torch::Tensor’ is incomplete
    384 | inline Tensor xlog1py(const Scalar& self, const Tensor& other) {
        |                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::xlog1py(const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:385:32: error: no matching function for call to ‘special_xlog1py(const c10::Scalar&, const torch::Tensor&)’
    385 |   return torch::special_xlog1py(self, other);
        |          ~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1271,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:26:19: note: candidate: ‘at::Tensor at::special_xlog1py(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_xlog1py(const at::Tensor & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:26:54: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_xlog1py(const at::Tensor & self, const at::Tensor & other) {
        |                                   ~~~~~~~~~~~~~~~~~~~^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:31:19: note: candidate: ‘at::Tensor at::special_xlog1py(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_xlog1py(const at::Scalar & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:31:79: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     31 | inline at::Tensor special_xlog1py(const at::Scalar & self, const at::Tensor & other) {
        |                                                            ~~~~~~~~~~~~~~~~~~~^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:36:19: note: candidate: ‘at::Tensor at::special_xlog1py(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_xlog1py(const at::Tensor & self, const at::Scalar & other) {
        |                   ^~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:36:54: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_xlog1py(const at::Tensor & self, const at::Scalar & other) {
        |                                   ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:388:62: error: return type ‘class torch::Tensor’ is incomplete
    388 | inline Tensor xlog1py(const Tensor& self, const Scalar& other) {
        |                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::xlog1py(const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:389:32: error: no matching function for call to ‘special_xlog1py(const torch::Tensor&, const c10::Scalar&)’
    389 |   return torch::special_xlog1py(self, other);
        |          ~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1271,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:26:19: note: candidate: ‘at::Tensor at::special_xlog1py(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_xlog1py(const at::Tensor & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:26:54: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_xlog1py(const at::Tensor & self, const at::Tensor & other) {
        |                                   ~~~~~~~~~~~~~~~~~~~^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:31:19: note: candidate: ‘at::Tensor at::special_xlog1py(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_xlog1py(const at::Scalar & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:31:54: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_xlog1py(const at::Scalar & self, const at::Tensor & other) {
        |                                   ~~~~~~~~~~~~~~~~~~~^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:36:19: note: candidate: ‘at::Tensor at::special_xlog1py(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_xlog1py(const at::Tensor & self, const at::Scalar & other) {
        |                   ^~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:36:54: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_xlog1py(const at::Tensor & self, const at::Scalar & other) {
        |                                   ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::xlog1py_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:396:36: error: no matching function for call to ‘special_xlog1py_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’
    396 |   return torch::special_xlog1py_out(result, self, other);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1271,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:41:21: note: candidate: ‘at::Tensor& at::special_xlog1py_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:41:54: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                                         ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:50:21: note: candidate: ‘at::Tensor& at::special_xlog1py_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:50:54: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                                         ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:59:21: note: candidate: ‘at::Tensor& at::special_xlog1py_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                     ^~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:59:54: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                                         ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::xlog1py_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:403:36: error: no matching function for call to ‘special_xlog1py_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’
    403 |   return torch::special_xlog1py_out(result, self, other);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1271,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:41:21: note: candidate: ‘at::Tensor& at::special_xlog1py_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:41:54: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                                         ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:50:21: note: candidate: ‘at::Tensor& at::special_xlog1py_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:50:54: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                                         ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:59:21: note: candidate: ‘at::Tensor& at::special_xlog1py_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                     ^~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:59:54: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                                         ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::xlog1py_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:410:36: error: no matching function for call to ‘special_xlog1py_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’
    410 |   return torch::special_xlog1py_out(result, self, other);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1271,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:41:21: note: candidate: ‘at::Tensor& at::special_xlog1py_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:41:54: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                                         ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:50:21: note: candidate: ‘at::Tensor& at::special_xlog1py_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:50:54: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                                         ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:59:21: note: candidate: ‘at::Tensor& at::special_xlog1py_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                     ^~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_xlog1py.h:59:54: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_xlog1py_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                                         ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:422:59: error: return type ‘class torch::Tensor’ is incomplete
    422 | inline Tensor zeta(const Tensor& self, const Tensor& other) {
        |                                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::zeta(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:423:29: error: no matching function for call to ‘special_zeta(const torch::Tensor&, const torch::Tensor&)’
    423 |   return torch::special_zeta(self, other);
        |          ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1273,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:26:19: note: candidate: ‘at::Tensor at::special_zeta(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_zeta(const at::Tensor & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:26:51: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_zeta(const at::Tensor & self, const at::Tensor & other) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:31:19: note: candidate: ‘at::Tensor at::special_zeta(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_zeta(const at::Scalar & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:31:51: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_zeta(const at::Scalar & self, const at::Tensor & other) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:36:19: note: candidate: ‘at::Tensor at::special_zeta(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_zeta(const at::Tensor & self, const at::Scalar & other) {
        |                   ^~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:36:51: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_zeta(const at::Tensor & self, const at::Scalar & other) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:426:59: error: return type ‘class torch::Tensor’ is incomplete
    426 | inline Tensor zeta(const Scalar& self, const Tensor& other) {
        |                                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::zeta(const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:427:29: error: no matching function for call to ‘special_zeta(const c10::Scalar&, const torch::Tensor&)’
    427 |   return torch::special_zeta(self, other);
        |          ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1273,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:26:19: note: candidate: ‘at::Tensor at::special_zeta(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_zeta(const at::Tensor & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:26:51: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_zeta(const at::Tensor & self, const at::Tensor & other) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:31:19: note: candidate: ‘at::Tensor at::special_zeta(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_zeta(const at::Scalar & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:31:76: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     31 | inline at::Tensor special_zeta(const at::Scalar & self, const at::Tensor & other) {
        |                                                         ~~~~~~~~~~~~~~~~~~~^~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:36:19: note: candidate: ‘at::Tensor at::special_zeta(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_zeta(const at::Tensor & self, const at::Scalar & other) {
        |                   ^~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:36:51: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_zeta(const at::Tensor & self, const at::Scalar & other) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:430:59: error: return type ‘class torch::Tensor’ is incomplete
    430 | inline Tensor zeta(const Tensor& self, const Scalar& other) {
        |                                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::zeta(const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:431:29: error: no matching function for call to ‘special_zeta(const torch::Tensor&, const c10::Scalar&)’
    431 |   return torch::special_zeta(self, other);
        |          ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1273,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:26:19: note: candidate: ‘at::Tensor at::special_zeta(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_zeta(const at::Tensor & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:26:51: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_zeta(const at::Tensor & self, const at::Tensor & other) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:31:19: note: candidate: ‘at::Tensor at::special_zeta(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_zeta(const at::Scalar & self, const at::Tensor & other) {
        |                   ^~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:31:51: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_zeta(const at::Scalar & self, const at::Tensor & other) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:36:19: note: candidate: ‘at::Tensor at::special_zeta(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_zeta(const at::Tensor & self, const at::Scalar & other) {
        |                   ^~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:36:51: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_zeta(const at::Tensor & self, const at::Scalar & other) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::zeta_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:438:33: error: no matching function for call to ‘special_zeta_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’
    438 |   return torch::special_zeta_out(result, self, other);
        |          ~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1273,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:41:21: note: candidate: ‘at::Tensor& at::special_zeta_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:41:51: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                                      ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:50:21: note: candidate: ‘at::Tensor& at::special_zeta_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:50:51: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                                      ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:59:21: note: candidate: ‘at::Tensor& at::special_zeta_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                     ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:59:51: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                                      ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::zeta_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:445:33: error: no matching function for call to ‘special_zeta_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’
    445 |   return torch::special_zeta_out(result, self, other);
        |          ~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1273,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:41:21: note: candidate: ‘at::Tensor& at::special_zeta_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:41:51: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                                      ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:50:21: note: candidate: ‘at::Tensor& at::special_zeta_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:50:51: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                                      ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:59:21: note: candidate: ‘at::Tensor& at::special_zeta_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                     ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:59:51: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                                      ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::zeta_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:452:33: error: no matching function for call to ‘special_zeta_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’
    452 |   return torch::special_zeta_out(result, self, other);
        |          ~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1273,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:41:21: note: candidate: ‘at::Tensor& at::special_zeta_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:41:51: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Tensor & self, const at::Tensor & other) {
        |                                      ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:50:21: note: candidate: ‘at::Tensor& at::special_zeta_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                     ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:50:51: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Scalar & self, const at::Tensor & other) {
        |                                      ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:59:21: note: candidate: ‘at::Tensor& at::special_zeta_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                     ^~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_zeta.h:59:51: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_zeta_out(at::Tensor & out, const at::Tensor & self, const at::Scalar & other) {
        |                                      ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:464:36: error: return type ‘class torch::Tensor’ is incomplete
    464 | inline Tensor i0(const Tensor& self) {
        |                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::i0(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:465:28: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    465 |   return torch::special_i0(self);
        |                            ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1241,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_i0.h:26:49: note: in passing argument 1 of ‘at::Tensor at::special_i0(const at::Tensor&)’
     26 | inline at::Tensor special_i0(const at::Tensor & self) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::i0_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:469:32: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    469 |   return torch::special_i0_out(result, self);
        |                                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1241,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_i0.h:31:49: note: in passing argument 1 of ‘at::Tensor& at::special_i0_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_i0_out(at::Tensor & out, const at::Tensor & self) {
        |                                    ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:481:38: error: return type ‘class torch::Tensor’ is incomplete
    481 | inline Tensor ndtr(const Tensor& self) {
        |                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::ndtr(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:482:30: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    482 |   return torch::special_ndtr(self);
        |                              ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1257,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_ndtr.h:26:51: note: in passing argument 1 of ‘at::Tensor at::special_ndtr(const at::Tensor&)’
     26 | inline at::Tensor special_ndtr(const at::Tensor & self) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::ndtr_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:486:34: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    486 |   return torch::special_ndtr_out(result, self);
        |                                  ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1257,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_ndtr.h:31:51: note: in passing argument 1 of ‘at::Tensor& at::special_ndtr_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_ndtr_out(at::Tensor & out, const at::Tensor & self) {
        |                                      ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:498:37: error: return type ‘class torch::Tensor’ is incomplete
    498 | inline Tensor i0e(const Tensor& self) {
        |                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::i0e(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:499:29: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    499 |   return torch::special_i0e(self);
        |                             ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1242,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_i0e.h:26:50: note: in passing argument 1 of ‘at::Tensor at::special_i0e(const at::Tensor&)’
     26 | inline at::Tensor special_i0e(const at::Tensor & self) {
        |                               ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::i0e_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:503:33: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    503 |   return torch::special_i0e_out(result, self);
        |                                 ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1242,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_i0e.h:31:50: note: in passing argument 1 of ‘at::Tensor& at::special_i0e_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_i0e_out(at::Tensor & out, const at::Tensor & self) {
        |                                     ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:514:36: error: return type ‘class torch::Tensor’ is incomplete
    514 | inline Tensor i1(const Tensor& self) {
        |                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::i1(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:515:28: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    515 |   return torch::special_i1(self);
        |                            ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1243,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_i1.h:26:49: note: in passing argument 1 of ‘at::Tensor at::special_i1(const at::Tensor&)’
     26 | inline at::Tensor special_i1(const at::Tensor & self) {
        |                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::i1_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:519:32: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    519 |   return torch::special_i1_out(result, self);
        |                                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1243,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_i1.h:31:49: note: in passing argument 1 of ‘at::Tensor& at::special_i1_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_i1_out(at::Tensor & out, const at::Tensor & self) {
        |                                    ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:531:37: error: return type ‘class torch::Tensor’ is incomplete
    531 | inline Tensor i1e(const Tensor& self) {
        |                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::i1e(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:532:29: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    532 |   return torch::special_i1e(self);
        |                             ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1244,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_i1e.h:26:50: note: in passing argument 1 of ‘at::Tensor at::special_i1e(const at::Tensor&)’
     26 | inline at::Tensor special_i1e(const at::Tensor & self) {
        |                               ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::i1e_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:536:33: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    536 |   return torch::special_i1e_out(result, self);
        |                                 ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1244,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_i1e.h:31:50: note: in passing argument 1 of ‘at::Tensor& at::special_i1e_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_i1e_out(at::Tensor & out, const at::Tensor & self) {
        |                                     ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:547:38: error: return type ‘class torch::Tensor’ is incomplete
    547 | inline Tensor sinc(const Tensor& self) {
        |                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::sinc(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:548:30: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    548 |   return torch::special_sinc(self);
        |                              ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1268,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_sinc.h:26:51: note: in passing argument 1 of ‘at::Tensor at::special_sinc(const at::Tensor&)’
     26 | inline at::Tensor special_sinc(const at::Tensor & self) {
        |                                ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::sinc_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:552:34: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    552 |   return torch::special_sinc_out(result, self);
        |                                  ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1268,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_sinc.h:31:51: note: in passing argument 1 of ‘at::Tensor& at::special_sinc_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_sinc_out(at::Tensor & out, const at::Tensor & self) {
        |                                      ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:563:39: error: return type ‘class torch::Tensor’ is incomplete
    563 | inline Tensor round(const Tensor& self) {
        |                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::round(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:564:31: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    564 |   return torch::special_round(self);
        |                               ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1261,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_round.h:26:52: note: in passing argument 1 of ‘at::Tensor at::special_round(const at::Tensor&, int64_t)’
     26 | inline at::Tensor special_round(const at::Tensor & self, int64_t decimals=0) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::round_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:568:35: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    568 |   return torch::special_round_out(result, self);
        |                                   ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1261,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_round.h:31:52: note: in passing argument 1 of ‘at::Tensor& at::special_round_out(at::Tensor&, const at::Tensor&, int64_t)’
     31 | inline at::Tensor & special_round_out(at::Tensor & out, const at::Tensor & self, int64_t decimals=0) {
        |                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:579:39: error: return type ‘class torch::Tensor’ is incomplete
    579 | inline Tensor log1p(const Tensor& self) {
        |                                       ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::log1p(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:580:31: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    580 |   return torch::special_log1p(self);
        |                               ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1247,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_log1p.h:26:52: note: in passing argument 1 of ‘at::Tensor at::special_log1p(const at::Tensor&)’
     26 | inline at::Tensor special_log1p(const at::Tensor & self) {
        |                                 ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::log1p_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:584:35: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    584 |   return torch::special_log1p_out(result, self);
        |                                   ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1247,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_log1p.h:31:52: note: in passing argument 1 of ‘at::Tensor& at::special_log1p_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_log1p_out(at::Tensor & out, const at::Tensor & self) {
        |                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:598:36: error: return type ‘class torch::Tensor’ is incomplete
    598 |     std::optional<ScalarType> dtype) {
        |                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::log_softmax(const torch::Tensor&, int64_t, std::optional<c10::ScalarType>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:599:37: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    599 |   return torch::special_log_softmax(self, dim, dtype);
        |                                     ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1249,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_log_softmax.h:26:58: note: in passing argument 1 of ‘at::Tensor at::special_log_softmax(const at::Tensor&, int64_t, std::optional<c10::ScalarType>)’
     26 | inline at::Tensor special_log_softmax(const at::Tensor & self, int64_t dim, ::std::optional<at::ScalarType> dtype=::std::nullopt) {
        |                                       ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:613:36: error: return type ‘class torch::Tensor’ is incomplete
    613 |     std::optional<ScalarType> dtype) {
        |                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::softmax(const torch::Tensor&, int64_t, std::optional<c10::ScalarType>)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:614:33: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    614 |   return torch::special_softmax(self, dim, dtype);
        |                                 ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1269,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_softmax.h:26:54: note: in passing argument 1 of ‘at::Tensor at::special_softmax(const at::Tensor&, int64_t, std::optional<c10::ScalarType>)’
     26 | inline at::Tensor special_softmax(const at::Tensor & self, int64_t dim, ::std::optional<at::ScalarType> dtype=::std::nullopt) {
        |                                   ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:628:38: error: return type ‘class torch::Tensor’ is incomplete
    628 | inline Tensor airy_ai(const Tensor& x) {
        |                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::airy_ai(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:629:33: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    629 |   return torch::special_airy_ai(x);
        |                                 ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1218,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_airy_ai.h:26:54: note: in passing argument 1 of ‘at::Tensor at::special_airy_ai(const at::Tensor&)’
     26 | inline at::Tensor special_airy_ai(const at::Tensor & x) {
        |                                   ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::airy_ai_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:633:37: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    633 |   return torch::special_airy_ai_out(y, x);
        |                                     ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1218,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_airy_ai.h:31:54: note: in passing argument 1 of ‘at::Tensor& at::special_airy_ai_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_airy_ai_out(at::Tensor & out, const at::Tensor & x) {
        |                                         ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:647:43: error: return type ‘class torch::Tensor’ is incomplete
    647 | inline Tensor bessel_j0(const Tensor& self) {
        |                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::bessel_j0(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:648:35: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    648 |   return torch::special_bessel_j0(self);
        |                                   ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1219,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_bessel_j0.h:26:56: note: in passing argument 1 of ‘at::Tensor at::special_bessel_j0(const at::Tensor&)’
     26 | inline at::Tensor special_bessel_j0(const at::Tensor & self) {
        |                                     ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::bessel_j0_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:652:39: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    652 |   return torch::special_bessel_j0_out(result, self);
        |                                       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1219,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_bessel_j0.h:31:56: note: in passing argument 1 of ‘at::Tensor& at::special_bessel_j0_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_bessel_j0_out(at::Tensor & out, const at::Tensor & self) {
        |                                           ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:666:43: error: return type ‘class torch::Tensor’ is incomplete
    666 | inline Tensor bessel_j1(const Tensor& self) {
        |                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::bessel_j1(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:667:35: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    667 |   return torch::special_bessel_j1(self);
        |                                   ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1220,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_bessel_j1.h:26:56: note: in passing argument 1 of ‘at::Tensor at::special_bessel_j1(const at::Tensor&)’
     26 | inline at::Tensor special_bessel_j1(const at::Tensor & self) {
        |                                     ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::bessel_j1_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:671:39: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    671 |   return torch::special_bessel_j1_out(result, self);
        |                                       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1220,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_bessel_j1.h:31:56: note: in passing argument 1 of ‘at::Tensor& at::special_bessel_j1_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_bessel_j1_out(at::Tensor & out, const at::Tensor & self) {
        |                                           ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:685:43: error: return type ‘class torch::Tensor’ is incomplete
    685 | inline Tensor bessel_y0(const Tensor& self) {
        |                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::bessel_y0(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:686:35: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    686 |   return torch::special_bessel_y0(self);
        |                                   ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1221,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_bessel_y0.h:26:56: note: in passing argument 1 of ‘at::Tensor at::special_bessel_y0(const at::Tensor&)’
     26 | inline at::Tensor special_bessel_y0(const at::Tensor & self) {
        |                                     ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::bessel_y0_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:690:39: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    690 |   return torch::special_bessel_y0_out(result, self);
        |                                       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1221,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_bessel_y0.h:31:56: note: in passing argument 1 of ‘at::Tensor& at::special_bessel_y0_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_bessel_y0_out(at::Tensor & out, const at::Tensor & self) {
        |                                           ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:704:43: error: return type ‘class torch::Tensor’ is incomplete
    704 | inline Tensor bessel_y1(const Tensor& self) {
        |                                           ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::bessel_y1(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:705:35: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
    705 |   return torch::special_bessel_y1(self);
        |                                   ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1222,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_bessel_y1.h:26:56: note: in passing argument 1 of ‘at::Tensor at::special_bessel_y1(const at::Tensor&)’
     26 | inline at::Tensor special_bessel_y1(const at::Tensor & self) {
        |                                     ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::bessel_y1_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:709:39: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
    709 |   return torch::special_bessel_y1_out(result, self);
        |                                       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1222,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_bessel_y1.h:31:56: note: in passing argument 1 of ‘at::Tensor& at::special_bessel_y1_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_bessel_y1_out(at::Tensor & out, const at::Tensor & self) {
        |                                           ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:725:70: error: return type ‘class torch::Tensor’ is incomplete
    725 | inline Tensor chebyshev_polynomial_t(const Tensor& x, const Tensor& n) {
        |                                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::chebyshev_polynomial_t(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:726:47: error: no matching function for call to ‘special_chebyshev_polynomial_t(const torch::Tensor&, const torch::Tensor&)’
    726 |   return torch::special_chebyshev_polynomial_t(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1223,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:26:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_t(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_chebyshev_polynomial_t(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:26:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_chebyshev_polynomial_t(const at::Tensor & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:31:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_t(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_chebyshev_polynomial_t(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:31:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_chebyshev_polynomial_t(const at::Scalar & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:36:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_t(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_chebyshev_polynomial_t(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:36:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_chebyshev_polynomial_t(const at::Tensor & x, const at::Scalar & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:729:70: error: return type ‘class torch::Tensor’ is incomplete
    729 | inline Tensor chebyshev_polynomial_t(const Scalar& x, const Tensor& n) {
        |                                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::chebyshev_polynomial_t(const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:730:47: error: no matching function for call to ‘special_chebyshev_polynomial_t(const c10::Scalar&, const torch::Tensor&)’
    730 |   return torch::special_chebyshev_polynomial_t(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1223,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:26:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_t(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_chebyshev_polynomial_t(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:26:69: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_chebyshev_polynomial_t(const at::Tensor & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:31:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_t(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_chebyshev_polynomial_t(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:31:91: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     31 | inline at::Tensor special_chebyshev_polynomial_t(const at::Scalar & x, const at::Tensor & n) {
        |                                                                        ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:36:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_t(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_chebyshev_polynomial_t(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:36:69: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_chebyshev_polynomial_t(const at::Tensor & x, const at::Scalar & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:733:70: error: return type ‘class torch::Tensor’ is incomplete
    733 | inline Tensor chebyshev_polynomial_t(const Tensor& x, const Scalar& n) {
        |                                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::chebyshev_polynomial_t(const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:734:47: error: no matching function for call to ‘special_chebyshev_polynomial_t(const torch::Tensor&, const c10::Scalar&)’
    734 |   return torch::special_chebyshev_polynomial_t(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1223,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:26:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_t(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_chebyshev_polynomial_t(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:26:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_chebyshev_polynomial_t(const at::Tensor & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:31:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_t(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_chebyshev_polynomial_t(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:31:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_chebyshev_polynomial_t(const at::Scalar & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:36:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_t(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_chebyshev_polynomial_t(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:36:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_chebyshev_polynomial_t(const at::Tensor & x, const at::Scalar & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::chebyshev_polynomial_t_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:741:51: error: no matching function for call to ‘special_chebyshev_polynomial_t_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’
    741 |   return torch::special_chebyshev_polynomial_t_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1223,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:41:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_t_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:41:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:50:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_t_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:50:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:59:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_t_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:59:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::chebyshev_polynomial_t_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:748:51: error: no matching function for call to ‘special_chebyshev_polynomial_t_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’
    748 |   return torch::special_chebyshev_polynomial_t_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1223,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:41:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_t_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:41:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:50:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_t_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:50:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:59:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_t_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:59:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::chebyshev_polynomial_t_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:755:51: error: no matching function for call to ‘special_chebyshev_polynomial_t_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’
    755 |   return torch::special_chebyshev_polynomial_t_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1223,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:41:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_t_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:41:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:50:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_t_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:50:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:59:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_t_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_t.h:59:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:771:70: error: return type ‘class torch::Tensor’ is incomplete
    771 | inline Tensor chebyshev_polynomial_u(const Tensor& x, const Tensor& n) {
        |                                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::chebyshev_polynomial_u(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:772:47: error: no matching function for call to ‘special_chebyshev_polynomial_u(const torch::Tensor&, const torch::Tensor&)’
    772 |   return torch::special_chebyshev_polynomial_u(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1224,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:26:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_u(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_chebyshev_polynomial_u(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:26:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_chebyshev_polynomial_u(const at::Tensor & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:31:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_u(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_chebyshev_polynomial_u(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:31:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_chebyshev_polynomial_u(const at::Scalar & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:36:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_u(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_chebyshev_polynomial_u(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:36:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_chebyshev_polynomial_u(const at::Tensor & x, const at::Scalar & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:775:70: error: return type ‘class torch::Tensor’ is incomplete
    775 | inline Tensor chebyshev_polynomial_u(const Scalar& x, const Tensor& n) {
        |                                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::chebyshev_polynomial_u(const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:776:47: error: no matching function for call to ‘special_chebyshev_polynomial_u(const c10::Scalar&, const torch::Tensor&)’
    776 |   return torch::special_chebyshev_polynomial_u(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1224,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:26:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_u(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_chebyshev_polynomial_u(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:26:69: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_chebyshev_polynomial_u(const at::Tensor & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:31:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_u(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_chebyshev_polynomial_u(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:31:91: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     31 | inline at::Tensor special_chebyshev_polynomial_u(const at::Scalar & x, const at::Tensor & n) {
        |                                                                        ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:36:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_u(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_chebyshev_polynomial_u(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:36:69: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_chebyshev_polynomial_u(const at::Tensor & x, const at::Scalar & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:779:70: error: return type ‘class torch::Tensor’ is incomplete
    779 | inline Tensor chebyshev_polynomial_u(const Tensor& x, const Scalar& n) {
        |                                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::chebyshev_polynomial_u(const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:780:47: error: no matching function for call to ‘special_chebyshev_polynomial_u(const torch::Tensor&, const c10::Scalar&)’
    780 |   return torch::special_chebyshev_polynomial_u(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1224,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:26:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_u(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_chebyshev_polynomial_u(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:26:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_chebyshev_polynomial_u(const at::Tensor & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:31:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_u(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_chebyshev_polynomial_u(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:31:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_chebyshev_polynomial_u(const at::Scalar & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:36:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_u(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_chebyshev_polynomial_u(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:36:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_chebyshev_polynomial_u(const at::Tensor & x, const at::Scalar & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::chebyshev_polynomial_u_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:787:51: error: no matching function for call to ‘special_chebyshev_polynomial_u_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’
    787 |   return torch::special_chebyshev_polynomial_u_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1224,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:41:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_u_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:41:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:50:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_u_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:50:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:59:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_u_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:59:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::chebyshev_polynomial_u_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:794:51: error: no matching function for call to ‘special_chebyshev_polynomial_u_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’
    794 |   return torch::special_chebyshev_polynomial_u_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1224,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:41:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_u_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:41:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:50:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_u_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:50:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:59:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_u_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:59:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::chebyshev_polynomial_u_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:801:51: error: no matching function for call to ‘special_chebyshev_polynomial_u_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’
    801 |   return torch::special_chebyshev_polynomial_u_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1224,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:41:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_u_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:41:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:50:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_u_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:50:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:59:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_u_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_u.h:59:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:817:70: error: return type ‘class torch::Tensor’ is incomplete
    817 | inline Tensor chebyshev_polynomial_v(const Tensor& x, const Tensor& n) {
        |                                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::chebyshev_polynomial_v(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:818:47: error: no matching function for call to ‘special_chebyshev_polynomial_v(const torch::Tensor&, const torch::Tensor&)’
    818 |   return torch::special_chebyshev_polynomial_v(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1225,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:26:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_v(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_chebyshev_polynomial_v(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:26:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_chebyshev_polynomial_v(const at::Tensor & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:31:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_v(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_chebyshev_polynomial_v(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:31:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_chebyshev_polynomial_v(const at::Scalar & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:36:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_v(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_chebyshev_polynomial_v(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:36:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_chebyshev_polynomial_v(const at::Tensor & x, const at::Scalar & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:821:70: error: return type ‘class torch::Tensor’ is incomplete
    821 | inline Tensor chebyshev_polynomial_v(const Scalar& x, const Tensor& n) {
        |                                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::chebyshev_polynomial_v(const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:822:47: error: no matching function for call to ‘special_chebyshev_polynomial_v(const c10::Scalar&, const torch::Tensor&)’
    822 |   return torch::special_chebyshev_polynomial_v(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1225,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:26:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_v(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_chebyshev_polynomial_v(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:26:69: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_chebyshev_polynomial_v(const at::Tensor & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:31:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_v(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_chebyshev_polynomial_v(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:31:91: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     31 | inline at::Tensor special_chebyshev_polynomial_v(const at::Scalar & x, const at::Tensor & n) {
        |                                                                        ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:36:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_v(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_chebyshev_polynomial_v(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:36:69: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_chebyshev_polynomial_v(const at::Tensor & x, const at::Scalar & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:825:70: error: return type ‘class torch::Tensor’ is incomplete
    825 | inline Tensor chebyshev_polynomial_v(const Tensor& x, const Scalar& n) {
        |                                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::chebyshev_polynomial_v(const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:826:47: error: no matching function for call to ‘special_chebyshev_polynomial_v(const torch::Tensor&, const c10::Scalar&)’
    826 |   return torch::special_chebyshev_polynomial_v(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1225,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:26:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_v(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_chebyshev_polynomial_v(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:26:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_chebyshev_polynomial_v(const at::Tensor & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:31:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_v(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_chebyshev_polynomial_v(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:31:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_chebyshev_polynomial_v(const at::Scalar & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:36:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_v(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_chebyshev_polynomial_v(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:36:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_chebyshev_polynomial_v(const at::Tensor & x, const at::Scalar & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::chebyshev_polynomial_v_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:833:51: error: no matching function for call to ‘special_chebyshev_polynomial_v_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’
    833 |   return torch::special_chebyshev_polynomial_v_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1225,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:41:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_v_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:41:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:50:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_v_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:50:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:59:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_v_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:59:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::chebyshev_polynomial_v_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:840:51: error: no matching function for call to ‘special_chebyshev_polynomial_v_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’
    840 |   return torch::special_chebyshev_polynomial_v_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1225,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:41:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_v_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:41:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:50:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_v_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:50:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:59:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_v_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:59:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::chebyshev_polynomial_v_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:847:51: error: no matching function for call to ‘special_chebyshev_polynomial_v_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’
    847 |   return torch::special_chebyshev_polynomial_v_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1225,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:41:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_v_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:41:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:50:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_v_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:50:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:59:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_v_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_v.h:59:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:863:70: error: return type ‘class torch::Tensor’ is incomplete
    863 | inline Tensor chebyshev_polynomial_w(const Tensor& x, const Tensor& n) {
        |                                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::chebyshev_polynomial_w(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:864:47: error: no matching function for call to ‘special_chebyshev_polynomial_w(const torch::Tensor&, const torch::Tensor&)’
    864 |   return torch::special_chebyshev_polynomial_w(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1226,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:26:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_w(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_chebyshev_polynomial_w(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:26:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_chebyshev_polynomial_w(const at::Tensor & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:31:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_w(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_chebyshev_polynomial_w(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:31:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_chebyshev_polynomial_w(const at::Scalar & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:36:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_w(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_chebyshev_polynomial_w(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:36:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_chebyshev_polynomial_w(const at::Tensor & x, const at::Scalar & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:867:70: error: return type ‘class torch::Tensor’ is incomplete
    867 | inline Tensor chebyshev_polynomial_w(const Scalar& x, const Tensor& n) {
        |                                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::chebyshev_polynomial_w(const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:868:47: error: no matching function for call to ‘special_chebyshev_polynomial_w(const c10::Scalar&, const torch::Tensor&)’
    868 |   return torch::special_chebyshev_polynomial_w(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1226,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:26:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_w(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_chebyshev_polynomial_w(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:26:69: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_chebyshev_polynomial_w(const at::Tensor & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:31:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_w(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_chebyshev_polynomial_w(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:31:91: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     31 | inline at::Tensor special_chebyshev_polynomial_w(const at::Scalar & x, const at::Tensor & n) {
        |                                                                        ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:36:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_w(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_chebyshev_polynomial_w(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:36:69: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_chebyshev_polynomial_w(const at::Tensor & x, const at::Scalar & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:871:70: error: return type ‘class torch::Tensor’ is incomplete
    871 | inline Tensor chebyshev_polynomial_w(const Tensor& x, const Scalar& n) {
        |                                                                      ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::chebyshev_polynomial_w(const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:872:47: error: no matching function for call to ‘special_chebyshev_polynomial_w(const torch::Tensor&, const c10::Scalar&)’
    872 |   return torch::special_chebyshev_polynomial_w(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1226,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:26:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_w(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_chebyshev_polynomial_w(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:26:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_chebyshev_polynomial_w(const at::Tensor & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:31:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_w(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_chebyshev_polynomial_w(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:31:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_chebyshev_polynomial_w(const at::Scalar & x, const at::Tensor & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:36:19: note: candidate: ‘at::Tensor at::special_chebyshev_polynomial_w(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_chebyshev_polynomial_w(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:36:69: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_chebyshev_polynomial_w(const at::Tensor & x, const at::Scalar & n) {
        |                                                  ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::chebyshev_polynomial_w_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:879:51: error: no matching function for call to ‘special_chebyshev_polynomial_w_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’
    879 |   return torch::special_chebyshev_polynomial_w_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1226,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:41:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_w_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:41:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:50:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_w_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:50:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:59:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_w_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:59:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::chebyshev_polynomial_w_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:886:51: error: no matching function for call to ‘special_chebyshev_polynomial_w_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’
    886 |   return torch::special_chebyshev_polynomial_w_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1226,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:41:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_w_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:41:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:50:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_w_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:50:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:59:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_w_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:59:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::chebyshev_polynomial_w_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:893:51: error: no matching function for call to ‘special_chebyshev_polynomial_w_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’
    893 |   return torch::special_chebyshev_polynomial_w_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1226,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:41:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_w_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:41:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:50:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_w_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:50:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:59:21: note: candidate: ‘at::Tensor& at::special_chebyshev_polynomial_w_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_chebyshev_polynomial_w.h:59:69: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                        ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:909:68: error: return type ‘class torch::Tensor’ is incomplete
    909 | inline Tensor hermite_polynomial_h(const Tensor& x, const Tensor& n) {
        |                                                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::hermite_polynomial_h(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:910:45: error: no matching function for call to ‘special_hermite_polynomial_h(const torch::Tensor&, const torch::Tensor&)’
    910 |   return torch::special_hermite_polynomial_h(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1239,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:26:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_h(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_hermite_polynomial_h(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:26:67: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_hermite_polynomial_h(const at::Tensor & x, const at::Tensor & n) {
        |                                                ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:31:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_h(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_hermite_polynomial_h(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:31:67: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_hermite_polynomial_h(const at::Scalar & x, const at::Tensor & n) {
        |                                                ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:36:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_h(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_hermite_polynomial_h(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:36:67: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_hermite_polynomial_h(const at::Tensor & x, const at::Scalar & n) {
        |                                                ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:913:68: error: return type ‘class torch::Tensor’ is incomplete
    913 | inline Tensor hermite_polynomial_h(const Scalar& x, const Tensor& n) {
        |                                                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::hermite_polynomial_h(const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:914:45: error: no matching function for call to ‘special_hermite_polynomial_h(const c10::Scalar&, const torch::Tensor&)’
    914 |   return torch::special_hermite_polynomial_h(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1239,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:26:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_h(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_hermite_polynomial_h(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:26:67: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_hermite_polynomial_h(const at::Tensor & x, const at::Tensor & n) {
        |                                                ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:31:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_h(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_hermite_polynomial_h(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:31:89: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     31 | inline at::Tensor special_hermite_polynomial_h(const at::Scalar & x, const at::Tensor & n) {
        |                                                                      ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:36:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_h(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_hermite_polynomial_h(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:36:67: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_hermite_polynomial_h(const at::Tensor & x, const at::Scalar & n) {
        |                                                ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:917:68: error: return type ‘class torch::Tensor’ is incomplete
    917 | inline Tensor hermite_polynomial_h(const Tensor& x, const Scalar& n) {
        |                                                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::hermite_polynomial_h(const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:918:45: error: no matching function for call to ‘special_hermite_polynomial_h(const torch::Tensor&, const c10::Scalar&)’
    918 |   return torch::special_hermite_polynomial_h(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1239,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:26:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_h(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_hermite_polynomial_h(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:26:67: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_hermite_polynomial_h(const at::Tensor & x, const at::Tensor & n) {
        |                                                ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:31:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_h(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_hermite_polynomial_h(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:31:67: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_hermite_polynomial_h(const at::Scalar & x, const at::Tensor & n) {
        |                                                ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:36:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_h(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_hermite_polynomial_h(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:36:67: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_hermite_polynomial_h(const at::Tensor & x, const at::Scalar & n) {
        |                                                ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::hermite_polynomial_h_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:925:49: error: no matching function for call to ‘special_hermite_polynomial_h_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’
    925 |   return torch::special_hermite_polynomial_h_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1239,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:41:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_h_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:41:67: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                      ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:50:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_h_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:50:67: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                      ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:59:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_h_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:59:67: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                      ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::hermite_polynomial_h_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:932:49: error: no matching function for call to ‘special_hermite_polynomial_h_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’
    932 |   return torch::special_hermite_polynomial_h_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1239,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:41:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_h_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:41:67: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                      ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:50:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_h_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:50:67: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                      ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:59:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_h_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:59:67: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                      ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::hermite_polynomial_h_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:939:49: error: no matching function for call to ‘special_hermite_polynomial_h_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’
    939 |   return torch::special_hermite_polynomial_h_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1239,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:41:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_h_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:41:67: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                      ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:50:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_h_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:50:67: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                      ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:59:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_h_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_h.h:59:67: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_hermite_polynomial_h_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                      ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:955:69: error: return type ‘class torch::Tensor’ is incomplete
    955 | inline Tensor hermite_polynomial_he(const Tensor& x, const Tensor& n) {
        |                                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::hermite_polynomial_he(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:956:46: error: no matching function for call to ‘special_hermite_polynomial_he(const torch::Tensor&, const torch::Tensor&)’
    956 |   return torch::special_hermite_polynomial_he(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1240,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:26:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_he(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_hermite_polynomial_he(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:26:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_hermite_polynomial_he(const at::Tensor & x, const at::Tensor & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:31:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_he(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_hermite_polynomial_he(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:31:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_hermite_polynomial_he(const at::Scalar & x, const at::Tensor & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:36:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_he(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_hermite_polynomial_he(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:36:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_hermite_polynomial_he(const at::Tensor & x, const at::Scalar & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:959:69: error: return type ‘class torch::Tensor’ is incomplete
    959 | inline Tensor hermite_polynomial_he(const Scalar& x, const Tensor& n) {
        |                                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::hermite_polynomial_he(const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:960:46: error: no matching function for call to ‘special_hermite_polynomial_he(const c10::Scalar&, const torch::Tensor&)’
    960 |   return torch::special_hermite_polynomial_he(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1240,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:26:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_he(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_hermite_polynomial_he(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:26:68: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_hermite_polynomial_he(const at::Tensor & x, const at::Tensor & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:31:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_he(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_hermite_polynomial_he(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:31:90: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     31 | inline at::Tensor special_hermite_polynomial_he(const at::Scalar & x, const at::Tensor & n) {
        |                                                                       ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:36:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_he(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_hermite_polynomial_he(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:36:68: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_hermite_polynomial_he(const at::Tensor & x, const at::Scalar & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:963:69: error: return type ‘class torch::Tensor’ is incomplete
    963 | inline Tensor hermite_polynomial_he(const Tensor& x, const Scalar& n) {
        |                                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::hermite_polynomial_he(const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:964:46: error: no matching function for call to ‘special_hermite_polynomial_he(const torch::Tensor&, const c10::Scalar&)’
    964 |   return torch::special_hermite_polynomial_he(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1240,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:26:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_he(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_hermite_polynomial_he(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:26:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_hermite_polynomial_he(const at::Tensor & x, const at::Tensor & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:31:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_he(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_hermite_polynomial_he(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:31:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_hermite_polynomial_he(const at::Scalar & x, const at::Tensor & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:36:19: note: candidate: ‘at::Tensor at::special_hermite_polynomial_he(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_hermite_polynomial_he(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:36:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_hermite_polynomial_he(const at::Tensor & x, const at::Scalar & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::hermite_polynomial_he_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:971:50: error: no matching function for call to ‘special_hermite_polynomial_he_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’
    971 |   return torch::special_hermite_polynomial_he_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1240,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:41:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_he_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:41:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:50:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_he_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:50:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:59:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_he_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:59:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::hermite_polynomial_he_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:978:50: error: no matching function for call to ‘special_hermite_polynomial_he_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’
    978 |   return torch::special_hermite_polynomial_he_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1240,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:41:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_he_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:41:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:50:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_he_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:50:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:59:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_he_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:59:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::hermite_polynomial_he_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:985:50: error: no matching function for call to ‘special_hermite_polynomial_he_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’
    985 |   return torch::special_hermite_polynomial_he_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1240,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:41:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_he_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:41:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:50:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_he_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:50:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:59:21: note: candidate: ‘at::Tensor& at::special_hermite_polynomial_he_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_hermite_polynomial_he.h:59:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_hermite_polynomial_he_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1001:69: error: return type ‘class torch::Tensor’ is incomplete
   1001 | inline Tensor laguerre_polynomial_l(const Tensor& x, const Tensor& n) {
        |                                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::laguerre_polynomial_l(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1002:46: error: no matching function for call to ‘special_laguerre_polynomial_l(const torch::Tensor&, const torch::Tensor&)’
   1002 |   return torch::special_laguerre_polynomial_l(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1245,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:26:19: note: candidate: ‘at::Tensor at::special_laguerre_polynomial_l(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_laguerre_polynomial_l(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:26:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_laguerre_polynomial_l(const at::Tensor & x, const at::Tensor & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:31:19: note: candidate: ‘at::Tensor at::special_laguerre_polynomial_l(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_laguerre_polynomial_l(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:31:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_laguerre_polynomial_l(const at::Scalar & x, const at::Tensor & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:36:19: note: candidate: ‘at::Tensor at::special_laguerre_polynomial_l(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_laguerre_polynomial_l(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:36:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_laguerre_polynomial_l(const at::Tensor & x, const at::Scalar & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1005:69: error: return type ‘class torch::Tensor’ is incomplete
   1005 | inline Tensor laguerre_polynomial_l(const Scalar& x, const Tensor& n) {
        |                                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::laguerre_polynomial_l(const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1006:46: error: no matching function for call to ‘special_laguerre_polynomial_l(const c10::Scalar&, const torch::Tensor&)’
   1006 |   return torch::special_laguerre_polynomial_l(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1245,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:26:19: note: candidate: ‘at::Tensor at::special_laguerre_polynomial_l(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_laguerre_polynomial_l(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:26:68: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_laguerre_polynomial_l(const at::Tensor & x, const at::Tensor & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:31:19: note: candidate: ‘at::Tensor at::special_laguerre_polynomial_l(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_laguerre_polynomial_l(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:31:90: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     31 | inline at::Tensor special_laguerre_polynomial_l(const at::Scalar & x, const at::Tensor & n) {
        |                                                                       ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:36:19: note: candidate: ‘at::Tensor at::special_laguerre_polynomial_l(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_laguerre_polynomial_l(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:36:68: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_laguerre_polynomial_l(const at::Tensor & x, const at::Scalar & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1009:69: error: return type ‘class torch::Tensor’ is incomplete
   1009 | inline Tensor laguerre_polynomial_l(const Tensor& x, const Scalar& n) {
        |                                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::laguerre_polynomial_l(const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1010:46: error: no matching function for call to ‘special_laguerre_polynomial_l(const torch::Tensor&, const c10::Scalar&)’
   1010 |   return torch::special_laguerre_polynomial_l(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1245,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:26:19: note: candidate: ‘at::Tensor at::special_laguerre_polynomial_l(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_laguerre_polynomial_l(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:26:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_laguerre_polynomial_l(const at::Tensor & x, const at::Tensor & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:31:19: note: candidate: ‘at::Tensor at::special_laguerre_polynomial_l(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_laguerre_polynomial_l(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:31:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_laguerre_polynomial_l(const at::Scalar & x, const at::Tensor & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:36:19: note: candidate: ‘at::Tensor at::special_laguerre_polynomial_l(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_laguerre_polynomial_l(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:36:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_laguerre_polynomial_l(const at::Tensor & x, const at::Scalar & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::laguerre_polynomial_l_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1017:50: error: no matching function for call to ‘special_laguerre_polynomial_l_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’
   1017 |   return torch::special_laguerre_polynomial_l_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1245,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:41:21: note: candidate: ‘at::Tensor& at::special_laguerre_polynomial_l_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:41:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:50:21: note: candidate: ‘at::Tensor& at::special_laguerre_polynomial_l_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:50:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:59:21: note: candidate: ‘at::Tensor& at::special_laguerre_polynomial_l_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:59:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::laguerre_polynomial_l_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1024:50: error: no matching function for call to ‘special_laguerre_polynomial_l_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’
   1024 |   return torch::special_laguerre_polynomial_l_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1245,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:41:21: note: candidate: ‘at::Tensor& at::special_laguerre_polynomial_l_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:41:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:50:21: note: candidate: ‘at::Tensor& at::special_laguerre_polynomial_l_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:50:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:59:21: note: candidate: ‘at::Tensor& at::special_laguerre_polynomial_l_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:59:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::laguerre_polynomial_l_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1031:50: error: no matching function for call to ‘special_laguerre_polynomial_l_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’
   1031 |   return torch::special_laguerre_polynomial_l_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1245,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:41:21: note: candidate: ‘at::Tensor& at::special_laguerre_polynomial_l_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:41:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:50:21: note: candidate: ‘at::Tensor& at::special_laguerre_polynomial_l_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:50:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:59:21: note: candidate: ‘at::Tensor& at::special_laguerre_polynomial_l_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_laguerre_polynomial_l.h:59:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_laguerre_polynomial_l_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1047:69: error: return type ‘class torch::Tensor’ is incomplete
   1047 | inline Tensor legendre_polynomial_p(const Tensor& x, const Tensor& n) {
        |                                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::legendre_polynomial_p(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1048:46: error: no matching function for call to ‘special_legendre_polynomial_p(const torch::Tensor&, const torch::Tensor&)’
   1048 |   return torch::special_legendre_polynomial_p(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1246,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:26:19: note: candidate: ‘at::Tensor at::special_legendre_polynomial_p(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_legendre_polynomial_p(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:26:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_legendre_polynomial_p(const at::Tensor & x, const at::Tensor & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:31:19: note: candidate: ‘at::Tensor at::special_legendre_polynomial_p(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_legendre_polynomial_p(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:31:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_legendre_polynomial_p(const at::Scalar & x, const at::Tensor & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:36:19: note: candidate: ‘at::Tensor at::special_legendre_polynomial_p(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_legendre_polynomial_p(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:36:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_legendre_polynomial_p(const at::Tensor & x, const at::Scalar & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1051:69: error: return type ‘class torch::Tensor’ is incomplete
   1051 | inline Tensor legendre_polynomial_p(const Scalar& x, const Tensor& n) {
        |                                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::legendre_polynomial_p(const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1052:46: error: no matching function for call to ‘special_legendre_polynomial_p(const c10::Scalar&, const torch::Tensor&)’
   1052 |   return torch::special_legendre_polynomial_p(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1246,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:26:19: note: candidate: ‘at::Tensor at::special_legendre_polynomial_p(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_legendre_polynomial_p(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:26:68: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_legendre_polynomial_p(const at::Tensor & x, const at::Tensor & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:31:19: note: candidate: ‘at::Tensor at::special_legendre_polynomial_p(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_legendre_polynomial_p(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:31:90: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     31 | inline at::Tensor special_legendre_polynomial_p(const at::Scalar & x, const at::Tensor & n) {
        |                                                                       ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:36:19: note: candidate: ‘at::Tensor at::special_legendre_polynomial_p(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_legendre_polynomial_p(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:36:68: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_legendre_polynomial_p(const at::Tensor & x, const at::Scalar & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1055:69: error: return type ‘class torch::Tensor’ is incomplete
   1055 | inline Tensor legendre_polynomial_p(const Tensor& x, const Scalar& n) {
        |                                                                     ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::legendre_polynomial_p(const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1056:46: error: no matching function for call to ‘special_legendre_polynomial_p(const torch::Tensor&, const c10::Scalar&)’
   1056 |   return torch::special_legendre_polynomial_p(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1246,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:26:19: note: candidate: ‘at::Tensor at::special_legendre_polynomial_p(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_legendre_polynomial_p(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:26:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_legendre_polynomial_p(const at::Tensor & x, const at::Tensor & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:31:19: note: candidate: ‘at::Tensor at::special_legendre_polynomial_p(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_legendre_polynomial_p(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:31:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_legendre_polynomial_p(const at::Scalar & x, const at::Tensor & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:36:19: note: candidate: ‘at::Tensor at::special_legendre_polynomial_p(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_legendre_polynomial_p(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:36:68: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_legendre_polynomial_p(const at::Tensor & x, const at::Scalar & n) {
        |                                                 ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::legendre_polynomial_p_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1063:50: error: no matching function for call to ‘special_legendre_polynomial_p_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’
   1063 |   return torch::special_legendre_polynomial_p_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1246,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:41:21: note: candidate: ‘at::Tensor& at::special_legendre_polynomial_p_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:41:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:50:21: note: candidate: ‘at::Tensor& at::special_legendre_polynomial_p_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:50:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:59:21: note: candidate: ‘at::Tensor& at::special_legendre_polynomial_p_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:59:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::legendre_polynomial_p_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1070:50: error: no matching function for call to ‘special_legendre_polynomial_p_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’
   1070 |   return torch::special_legendre_polynomial_p_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1246,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:41:21: note: candidate: ‘at::Tensor& at::special_legendre_polynomial_p_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:41:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:50:21: note: candidate: ‘at::Tensor& at::special_legendre_polynomial_p_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:50:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:59:21: note: candidate: ‘at::Tensor& at::special_legendre_polynomial_p_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:59:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::legendre_polynomial_p_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1077:50: error: no matching function for call to ‘special_legendre_polynomial_p_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’
   1077 |   return torch::special_legendre_polynomial_p_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1246,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:41:21: note: candidate: ‘at::Tensor& at::special_legendre_polynomial_p_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:41:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:50:21: note: candidate: ‘at::Tensor& at::special_legendre_polynomial_p_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:50:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:59:21: note: candidate: ‘at::Tensor& at::special_legendre_polynomial_p_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_legendre_polynomial_p.h:59:68: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_legendre_polynomial_p_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                       ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1092:52: error: return type ‘class torch::Tensor’ is incomplete
   1092 | inline Tensor modified_bessel_i0(const Tensor& self) {
        |                                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::modified_bessel_i0(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1093:44: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
   1093 |   return torch::special_modified_bessel_i0(self);
        |                                            ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1252,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_modified_bessel_i0.h:26:65: note: in passing argument 1 of ‘at::Tensor at::special_modified_bessel_i0(const at::Tensor&)’
     26 | inline at::Tensor special_modified_bessel_i0(const at::Tensor & self) {
        |                                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::modified_bessel_i0_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1097:48: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
   1097 |   return torch::special_modified_bessel_i0_out(result, self);
        |                                                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1252,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_modified_bessel_i0.h:31:65: note: in passing argument 1 of ‘at::Tensor& at::special_modified_bessel_i0_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_modified_bessel_i0_out(at::Tensor & out, const at::Tensor & self) {
        |                                                    ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1112:52: error: return type ‘class torch::Tensor’ is incomplete
   1112 | inline Tensor modified_bessel_i1(const Tensor& self) {
        |                                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::modified_bessel_i1(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1113:44: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
   1113 |   return torch::special_modified_bessel_i1(self);
        |                                            ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1253,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_modified_bessel_i1.h:26:65: note: in passing argument 1 of ‘at::Tensor at::special_modified_bessel_i1(const at::Tensor&)’
     26 | inline at::Tensor special_modified_bessel_i1(const at::Tensor & self) {
        |                                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::modified_bessel_i1_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1117:48: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
   1117 |   return torch::special_modified_bessel_i1_out(result, self);
        |                                                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1253,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_modified_bessel_i1.h:31:65: note: in passing argument 1 of ‘at::Tensor& at::special_modified_bessel_i1_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_modified_bessel_i1_out(at::Tensor & out, const at::Tensor & self) {
        |                                                    ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1132:52: error: return type ‘class torch::Tensor’ is incomplete
   1132 | inline Tensor modified_bessel_k0(const Tensor& self) {
        |                                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::modified_bessel_k0(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1133:44: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
   1133 |   return torch::special_modified_bessel_k0(self);
        |                                            ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1254,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_modified_bessel_k0.h:26:65: note: in passing argument 1 of ‘at::Tensor at::special_modified_bessel_k0(const at::Tensor&)’
     26 | inline at::Tensor special_modified_bessel_k0(const at::Tensor & self) {
        |                                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::modified_bessel_k0_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1137:48: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
   1137 |   return torch::special_modified_bessel_k0_out(result, self);
        |                                                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1254,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_modified_bessel_k0.h:31:65: note: in passing argument 1 of ‘at::Tensor& at::special_modified_bessel_k0_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_modified_bessel_k0_out(at::Tensor & out, const at::Tensor & self) {
        |                                                    ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1152:52: error: return type ‘class torch::Tensor’ is incomplete
   1152 | inline Tensor modified_bessel_k1(const Tensor& self) {
        |                                                    ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::modified_bessel_k1(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1153:44: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
   1153 |   return torch::special_modified_bessel_k1(self);
        |                                            ^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1255,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_modified_bessel_k1.h:26:65: note: in passing argument 1 of ‘at::Tensor at::special_modified_bessel_k1(const at::Tensor&)’
     26 | inline at::Tensor special_modified_bessel_k1(const at::Tensor & self) {
        |                                              ~~~~~~~~~~~~~~~~~~~^~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::modified_bessel_k1_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1157:48: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
   1157 |   return torch::special_modified_bessel_k1_out(result, self);
        |                                                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1255,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_modified_bessel_k1.h:31:65: note: in passing argument 1 of ‘at::Tensor& at::special_modified_bessel_k1_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_modified_bessel_k1_out(at::Tensor & out, const at::Tensor & self) {
        |                                                    ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1172:56: error: return type ‘class torch::Tensor’ is incomplete
   1172 | inline Tensor scaled_modified_bessel_k0(const Tensor& x) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::scaled_modified_bessel_k0(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1173:51: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
   1173 |   return torch::special_scaled_modified_bessel_k0(x);
        |                                                   ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1262,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_scaled_modified_bessel_k0.h:26:72: note: in passing argument 1 of ‘at::Tensor at::special_scaled_modified_bessel_k0(const at::Tensor&)’
     26 | inline at::Tensor special_scaled_modified_bessel_k0(const at::Tensor & x) {
        |                                                     ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::scaled_modified_bessel_k0_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1177:55: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
   1177 |   return torch::special_scaled_modified_bessel_k0_out(y, x);
        |                                                       ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1262,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_scaled_modified_bessel_k0.h:31:72: note: in passing argument 1 of ‘at::Tensor& at::special_scaled_modified_bessel_k0_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_scaled_modified_bessel_k0_out(at::Tensor & out, const at::Tensor & x) {
        |                                                           ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1192:56: error: return type ‘class torch::Tensor’ is incomplete
   1192 | inline Tensor scaled_modified_bessel_k1(const Tensor& x) {
        |                                                        ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::scaled_modified_bessel_k1(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1193:51: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
   1193 |   return torch::special_scaled_modified_bessel_k1(x);
        |                                                   ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1263,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_scaled_modified_bessel_k1.h:26:72: note: in passing argument 1 of ‘at::Tensor at::special_scaled_modified_bessel_k1(const at::Tensor&)’
     26 | inline at::Tensor special_scaled_modified_bessel_k1(const at::Tensor & x) {
        |                                                     ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::scaled_modified_bessel_k1_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1197:55: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
   1197 |   return torch::special_scaled_modified_bessel_k1_out(y, x);
        |                                                       ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1263,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_scaled_modified_bessel_k1.h:31:72: note: in passing argument 1 of ‘at::Tensor& at::special_scaled_modified_bessel_k1_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_scaled_modified_bessel_k1_out(at::Tensor & out, const at::Tensor & x) {
        |                                                           ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1213:78: error: return type ‘class torch::Tensor’ is incomplete
   1213 | inline Tensor shifted_chebyshev_polynomial_t(const Tensor& x, const Tensor& n) {
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::shifted_chebyshev_polynomial_t(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1214:55: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_t(const torch::Tensor&, const torch::Tensor&)’
   1214 |   return torch::special_shifted_chebyshev_polynomial_t(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1264,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:26:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_t(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:26:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Tensor & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:31:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_t(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:31:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Scalar & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:36:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_t(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:36:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Tensor & x, const at::Scalar & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1217:78: error: return type ‘class torch::Tensor’ is incomplete
   1217 | inline Tensor shifted_chebyshev_polynomial_t(const Scalar& x, const Tensor& n) {
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::shifted_chebyshev_polynomial_t(const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1218:55: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_t(const c10::Scalar&, const torch::Tensor&)’
   1218 |   return torch::special_shifted_chebyshev_polynomial_t(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1264,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:26:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_t(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:26:77: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Tensor & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:31:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_t(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:31:99: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Scalar & x, const at::Tensor & n) {
        |                                                                                ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:36:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_t(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:36:77: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Tensor & x, const at::Scalar & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1221:78: error: return type ‘class torch::Tensor’ is incomplete
   1221 | inline Tensor shifted_chebyshev_polynomial_t(const Tensor& x, const Scalar& n) {
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::shifted_chebyshev_polynomial_t(const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1222:55: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_t(const torch::Tensor&, const c10::Scalar&)’
   1222 |   return torch::special_shifted_chebyshev_polynomial_t(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1264,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:26:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_t(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:26:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Tensor & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:31:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_t(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:31:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Scalar & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:36:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_t(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:36:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_t(const at::Tensor & x, const at::Scalar & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::shifted_chebyshev_polynomial_t_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1229:59: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_t_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’
   1229 |   return torch::special_shifted_chebyshev_polynomial_t_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1264,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:41:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_t_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:41:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1264,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:50:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_t_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:50:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:59:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_t_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:59:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::shifted_chebyshev_polynomial_t_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1236:59: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_t_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’
   1236 |   return torch::special_shifted_chebyshev_polynomial_t_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1264,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:41:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_t_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:41:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1264,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:50:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_t_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:50:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:59:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_t_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:59:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::shifted_chebyshev_polynomial_t_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1243:59: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_t_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’
   1243 |   return torch::special_shifted_chebyshev_polynomial_t_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1264,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:41:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_t_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:41:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1264,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:50:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_t_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:50:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:59:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_t_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_t.h:59:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_t_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1259:78: error: return type ‘class torch::Tensor’ is incomplete
   1259 | inline Tensor shifted_chebyshev_polynomial_u(const Tensor& x, const Tensor& n) {
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::shifted_chebyshev_polynomial_u(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1260:55: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_u(const torch::Tensor&, const torch::Tensor&)’
   1260 |   return torch::special_shifted_chebyshev_polynomial_u(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1265,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:26:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_u(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:26:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Tensor & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:31:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_u(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:31:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Scalar & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:36:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_u(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:36:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Tensor & x, const at::Scalar & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1263:78: error: return type ‘class torch::Tensor’ is incomplete
   1263 | inline Tensor shifted_chebyshev_polynomial_u(const Scalar& x, const Tensor& n) {
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::shifted_chebyshev_polynomial_u(const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1264:55: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_u(const c10::Scalar&, const torch::Tensor&)’
   1264 |   return torch::special_shifted_chebyshev_polynomial_u(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1265,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:26:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_u(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:26:77: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Tensor & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:31:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_u(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:31:99: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Scalar & x, const at::Tensor & n) {
        |                                                                                ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:36:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_u(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:36:77: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Tensor & x, const at::Scalar & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1267:78: error: return type ‘class torch::Tensor’ is incomplete
   1267 | inline Tensor shifted_chebyshev_polynomial_u(const Tensor& x, const Scalar& n) {
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::shifted_chebyshev_polynomial_u(const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1268:55: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_u(const torch::Tensor&, const c10::Scalar&)’
   1268 |   return torch::special_shifted_chebyshev_polynomial_u(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1265,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:26:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_u(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:26:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Tensor & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:31:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_u(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:31:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Scalar & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:36:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_u(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:36:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_u(const at::Tensor & x, const at::Scalar & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::shifted_chebyshev_polynomial_u_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1275:59: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_u_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’
   1275 |   return torch::special_shifted_chebyshev_polynomial_u_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1265,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:41:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_u_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:41:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1265,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:50:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_u_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:50:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:59:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_u_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:59:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::shifted_chebyshev_polynomial_u_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1282:59: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_u_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’
   1282 |   return torch::special_shifted_chebyshev_polynomial_u_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1265,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:41:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_u_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:41:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1265,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:50:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_u_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:50:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:59:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_u_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:59:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::shifted_chebyshev_polynomial_u_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1289:59: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_u_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’
   1289 |   return torch::special_shifted_chebyshev_polynomial_u_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1265,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:41:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_u_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:41:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1265,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:50:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_u_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:50:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:59:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_u_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_u.h:59:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_u_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1305:78: error: return type ‘class torch::Tensor’ is incomplete
   1305 | inline Tensor shifted_chebyshev_polynomial_v(const Tensor& x, const Tensor& n) {
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::shifted_chebyshev_polynomial_v(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1306:55: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_v(const torch::Tensor&, const torch::Tensor&)’
   1306 |   return torch::special_shifted_chebyshev_polynomial_v(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1266,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:26:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_v(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:26:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Tensor & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:31:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_v(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:31:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Scalar & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:36:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_v(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:36:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Tensor & x, const at::Scalar & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1309:78: error: return type ‘class torch::Tensor’ is incomplete
   1309 | inline Tensor shifted_chebyshev_polynomial_v(const Scalar& x, const Tensor& n) {
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::shifted_chebyshev_polynomial_v(const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1310:55: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_v(const c10::Scalar&, const torch::Tensor&)’
   1310 |   return torch::special_shifted_chebyshev_polynomial_v(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1266,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:26:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_v(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:26:77: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Tensor & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:31:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_v(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:31:99: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Scalar & x, const at::Tensor & n) {
        |                                                                                ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:36:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_v(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:36:77: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Tensor & x, const at::Scalar & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1313:78: error: return type ‘class torch::Tensor’ is incomplete
   1313 | inline Tensor shifted_chebyshev_polynomial_v(const Tensor& x, const Scalar& n) {
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::shifted_chebyshev_polynomial_v(const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1314:55: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_v(const torch::Tensor&, const c10::Scalar&)’
   1314 |   return torch::special_shifted_chebyshev_polynomial_v(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1266,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:26:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_v(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:26:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Tensor & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:31:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_v(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:31:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Scalar & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:36:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_v(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:36:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_v(const at::Tensor & x, const at::Scalar & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::shifted_chebyshev_polynomial_v_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1321:59: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_v_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’
   1321 |   return torch::special_shifted_chebyshev_polynomial_v_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1266,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:41:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_v_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:41:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1266,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:50:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_v_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:50:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:59:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_v_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:59:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::shifted_chebyshev_polynomial_v_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1328:59: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_v_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’
   1328 |   return torch::special_shifted_chebyshev_polynomial_v_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1266,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:41:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_v_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:41:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1266,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:50:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_v_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:50:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:59:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_v_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:59:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::shifted_chebyshev_polynomial_v_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1335:59: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_v_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’
   1335 |   return torch::special_shifted_chebyshev_polynomial_v_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1266,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:41:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_v_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:41:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1266,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:50:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_v_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:50:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:59:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_v_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_v.h:59:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_v_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1351:78: error: return type ‘class torch::Tensor’ is incomplete
   1351 | inline Tensor shifted_chebyshev_polynomial_w(const Tensor& x, const Tensor& n) {
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::shifted_chebyshev_polynomial_w(const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1352:55: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_w(const torch::Tensor&, const torch::Tensor&)’
   1352 |   return torch::special_shifted_chebyshev_polynomial_w(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1267,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:26:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_w(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:26:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Tensor & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:31:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_w(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:31:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Scalar & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:36:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_w(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:36:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Tensor & x, const at::Scalar & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1355:78: error: return type ‘class torch::Tensor’ is incomplete
   1355 | inline Tensor shifted_chebyshev_polynomial_w(const Scalar& x, const Tensor& n) {
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::shifted_chebyshev_polynomial_w(const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1356:55: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_w(const c10::Scalar&, const torch::Tensor&)’
   1356 |   return torch::special_shifted_chebyshev_polynomial_w(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1267,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:26:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_w(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:26:77: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Tensor & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:31:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_w(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:31:99: note:   no known conversion for argument 2 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Scalar & x, const at::Tensor & n) {
        |                                                                                ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:36:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_w(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:36:77: note:   no known conversion for argument 1 from ‘const c10::Scalar’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Tensor & x, const at::Scalar & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1359:78: error: return type ‘class torch::Tensor’ is incomplete
   1359 | inline Tensor shifted_chebyshev_polynomial_w(const Tensor& x, const Scalar& n) {
        |                                                                              ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::shifted_chebyshev_polynomial_w(const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1360:55: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_w(const torch::Tensor&, const c10::Scalar&)’
   1360 |   return torch::special_shifted_chebyshev_polynomial_w(x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1267,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:26:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_w(const at::Tensor&, const at::Tensor&)’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Tensor & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:26:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     26 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Tensor & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:31:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_w(const c10::Scalar&, const at::Tensor&)’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Scalar & x, const at::Tensor & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:31:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const c10::Scalar&’
     31 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Scalar & x, const at::Tensor & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:36:19: note: candidate: ‘at::Tensor at::special_shifted_chebyshev_polynomial_w(const at::Tensor&, const c10::Scalar&)’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Tensor & x, const at::Scalar & n) {
        |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:36:77: note:   no known conversion for argument 1 from ‘const torch::Tensor’ to ‘const at::Tensor&’
     36 | inline at::Tensor special_shifted_chebyshev_polynomial_w(const at::Tensor & x, const at::Scalar & n) {
        |                                                          ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::shifted_chebyshev_polynomial_w_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1367:59: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_w_out(torch::Tensor&, const torch::Tensor&, const torch::Tensor&)’
   1367 |   return torch::special_shifted_chebyshev_polynomial_w_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1267,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:41:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_w_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:41:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1267,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:50:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_w_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:50:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:59:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_w_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:59:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::shifted_chebyshev_polynomial_w_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1374:59: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_w_out(torch::Tensor&, const c10::Scalar&, const torch::Tensor&)’
   1374 |   return torch::special_shifted_chebyshev_polynomial_w_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1267,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:41:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_w_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:41:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1267,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:50:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_w_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:50:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:59:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_w_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:59:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::shifted_chebyshev_polynomial_w_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1381:59: error: no matching function for call to ‘special_shifted_chebyshev_polynomial_w_out(torch::Tensor&, const torch::Tensor&, const c10::Scalar&)’
   1381 |   return torch::special_shifted_chebyshev_polynomial_w_out(output, x, n);
        |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1267,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:41:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_w_out(at::Tensor&, const at::Tensor&, const at::Tensor&)’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:41:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     41 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1267,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:50:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_w_out(at::Tensor&, const c10::Scalar&, const at::Tensor&)’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:50:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     50 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Scalar & x, const at::Tensor & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:59:21: note: candidate: ‘at::Tensor& at::special_shifted_chebyshev_polynomial_w_out(at::Tensor&, const at::Tensor&, const c10::Scalar&)’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_shifted_chebyshev_polynomial_w.h:59:77: note:   no known conversion for argument 1 from ‘torch::Tensor’ to ‘at::Tensor&’
     59 | inline at::Tensor & special_shifted_chebyshev_polynomial_w_out(at::Tensor & out, const at::Tensor & x, const at::Scalar & n) {
        |                                                                ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1396:50: error: return type ‘class torch::Tensor’ is incomplete
   1396 | inline Tensor spherical_bessel_j0(const Tensor& x) {
        |                                                  ^
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘void torch::special::spherical_bessel_j0(const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1397:45: error: invalid initialization of reference of type ‘const at::Tensor&’ from expression of type ‘const torch::Tensor’
   1397 |   return torch::special_spherical_bessel_j0(x);
        |                                             ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1270,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_spherical_bessel_j0.h:26:66: note: in passing argument 1 of ‘at::Tensor at::special_spherical_bessel_j0(const at::Tensor&)’
     26 | inline at::Tensor special_spherical_bessel_j0(const at::Tensor & x) {
        |                                               ~~~~~~~~~~~~~~~~~~~^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:19,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h: In function ‘torch::Tensor& torch::special::spherical_bessel_j0_out(torch::Tensor&, const torch::Tensor&)’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/special.h:1401:49: error: invalid initialization of reference of type ‘at::Tensor&’ from expression of type ‘torch::Tensor’
   1401 |   return torch::special_spherical_bessel_j0_out(y, x);
        |                                                 ^
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Functions.h:1270,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ExpandUtils.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/input_metadata.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/custom_function.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/ops/special_spherical_bessel_j0.h:31:66: note: in passing argument 1 of ‘at::Tensor& at::special_spherical_bessel_j0_out(at::Tensor&, const at::Tensor&)’
     31 | inline at::Tensor & special_spherical_bessel_j0_out(at::Tensor & out, const at::Tensor & x) {
        |                                                     ~~~~~~~~~~~~~^~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:9,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h: At global scope:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h:24:8: error: reference to ‘Device’ is ambiguous
     24 | inline Device py_object_to_device(py::object object) {
        |        ^~~~~~
  In file included from /workspace/nunchaku/src/Linear.h:4,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Tensor.h:5:8: note: candidates are: ‘struct Device’
      5 | struct Device {
        |        ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/Device.h:31:16: note:                 ‘struct c10::Device’
     31 | struct C10_API Device final {
        |                ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:9,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h: In lambda function:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h:171:35: error: ‘py_object_to_device’ is not a member of ‘torch::python::detail’; did you mean ‘py_object_to_dtype’?
    171 |                 module.to(detail::py_object_to_device(device), non_blocking);
        |                                   ^~~~~~~~~~~~~~~~~~~
        |                                   py_object_to_dtype
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h:174:29: error: ‘py_object_to_device’ is not a member of ‘torch::python::detail’; did you mean ‘py_object_to_dtype’?
    174 |                     detail::py_object_to_device(device),
        |                             ^~~~~~~~~~~~~~~~~~~
        |                             py_object_to_dtype
  In file included from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_pair.h: In instantiation of ‘struct std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>’:
  /workspace/nunchaku/nunchaku/csrc/pybind.cpp:15:29:   required from here
  /usr/include/c++/11/bits/stl_pair.h:218:11: error: ‘std::pair<_T1, _T2>::second’ has incomplete type
    218 |       _T2 second;                ///< The second member
        |           ^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  /workspace/nunchaku/nunchaku/csrc/pybind.cpp: In function ‘void pybind11_init__C(pybind11::module_&)’:
  /workspace/nunchaku/nunchaku/csrc/pybind.cpp:50:59: error: ‘x’ has incomplete type
     50 |         .def("forward", [](GEMM_W4A4 &self, torch::Tensor x) {
        |                                             ~~~~~~~~~~~~~~^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  /workspace/nunchaku/nunchaku/csrc/pybind.cpp:64:58: error: ‘input’ has incomplete type
     64 |     ops_module.def("quantize_w4a4_wgt", [](torch::Tensor input) {
        |                                            ~~~~~~~~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  /workspace/nunchaku/nunchaku/csrc/pybind.cpp:72:58: error: ‘input’ has incomplete type
     72 |     ops_module.def("quantize_w4a4_act", [](torch::Tensor input) {
        |                                            ~~~~~~~~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/CheckMemoryFormat.h:1,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:31,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/TensorOptions.h: In instantiation of ‘c10::TensorOptions c10::TensorOptions::device(Args&& ...) const [with Args = {c10::TensorOptions (&)(c10::Device)}]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/ATen/TensorIterator.h:165:46:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/TensorOptions.h:208:14: error: no matching function for call to ‘std::optional<c10::Device>::optional(const std::in_place_t&, c10::TensorOptions (&)(c10::Device))’
    208 |         std::optional<Device>(std::in_place, std::forward<Args>(args)...));
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:781:9: note: candidate: ‘template<class _Up, class ... _Args, typename std::enable_if<__and_v<std::is_constructible<c10::Device, std::initializer_list<_Tp>&, _Args ...> >, bool>::type <anonymous> > constexpr std::optional<_Tp>::optional(std::in_place_t, std::initializer_list<_Up>, _Args&& ...) [with _Up = _Up; _Args = {_Args ...}; typename std::enable_if<__and_v<std::is_constructible<_Tp, std::initializer_list<_Up>&, _Args ...> >, bool>::type <anonymous> = <anonymous>; _Tp = c10::Device]’
    781 |         optional(in_place_t, initializer_list<_Up> __il, _Args&&... __args)
        |         ^~~~~~~~
  /usr/include/c++/11/optional:781:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/CheckMemoryFormat.h:1,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:31,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/TensorOptions.h:208:14: note:   mismatched types ‘std::initializer_list<_Tp>’ and ‘c10::TensorOptions (*)(c10::Device)’
    208 |         std::optional<Device>(std::in_place, std::forward<Args>(args)...));
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:772:9: note: candidate: ‘template<class ... _Args, typename std::enable_if<__and_v<std::is_constructible<c10::Device, _Args ...> >, bool>::type <anonymous> > constexpr std::optional<_Tp>::optional(std::in_place_t, _Args&& ...) [with _Args = {_Args ...}; typename std::enable_if<__and_v<std::is_constructible<_Tp, _Args ...> >, bool>::type <anonymous> = <anonymous>; _Tp = c10::Device]’
    772 |         optional(in_place_t, _Args&&... __args)
        |         ^~~~~~~~
  /usr/include/c++/11/optional:772:9: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/optional:770:61: error: no type named ‘type’ in ‘struct std::enable_if<false, bool>’
    770 |                _Requires<is_constructible<_Tp, _Args...>> = false>
        |                                                             ^~~~~
  /usr/include/c++/11/optional:762:9: note: candidate: ‘template<class _Up, typename std::enable_if<__and_v<std::__not_<std::is_same<c10::Device, _U1> >, std::is_constructible<c10::Device, _Up>, std::__not_<std::is_convertible<_Up, c10::Device> >, std::__not_<std::__or_<std::is_constructible<c10::Device, const std::optional<_Tp>&>, std::is_constructible<c10::Device, std::optional<_Tp>&>, std::is_constructible<c10::Device, const std::optional<_Tp>&&>, std::is_constructible<c10::Device, std::optional<_Tp>&&>, std::is_convertible<const std::optional<_Tp>&, c10::Device>, std::is_convertible<std::optional<_Tp>&, c10::Device>, std::is_convertible<const std::optional<_Tp>&&, c10::Device>, std::is_convertible<std::optional<_Tp>&&, c10::Device> > > >, bool>::type <anonymous> > constexpr std::optional<_Tp>::optional(std::optional<_Up>&&) [with _Up = _Up; typename std::enable_if<__and_v<std::__not_<std::is_same<_T1, _U1> >, std::is_constructible<_Tp, _Up>, std::__not_<std::is_convertible<_Up, _Tp> >, std::__not_<std::__or_<std::is_constructible<_Tp, const std::optional<_Up>&>, std::is_constructible<_Tp, std::optional<_Up>&>, std::is_constructible<_Tp, const std::optional<_Up>&&>, std::is_constructible<_Tp, std::optional<_Up>&&>, std::is_convertible<const std::optional<_Up>&, _Tp>, std::is_convertible<std::optional<_Up>&, _Tp>, std::is_convertible<const std::optional<_Up>&&, _Tp>, std::is_convertible<std::optional<_Up>&&, _Tp> > > >, bool>::type <anonymous> = <anonymous>; _Tp = c10::Device]’
    762 |         optional(optional<_Up>&& __t)
        |         ^~~~~~~~
  /usr/include/c++/11/optional:762:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/CheckMemoryFormat.h:1,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:31,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/TensorOptions.h:208:14: note:   types ‘std::optional<_Tp>’ and ‘const std::in_place_t’ have incompatible cv-qualifiers
    208 |         std::optional<Device>(std::in_place, std::forward<Args>(args)...));
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:749:9: note: candidate: ‘template<class _Up, typename std::enable_if<__and_v<std::__not_<std::is_same<c10::Device, _U1> >, std::is_constructible<c10::Device, _Up>, std::is_convertible<_Up, c10::Device>, std::__not_<std::__or_<std::is_constructible<c10::Device, const std::optional<_Tp>&>, std::is_constructible<c10::Device, std::optional<_Tp>&>, std::is_constructible<c10::Device, const std::optional<_Tp>&&>, std::is_constructible<c10::Device, std::optional<_Tp>&&>, std::is_convertible<const std::optional<_Tp>&, c10::Device>, std::is_convertible<std::optional<_Tp>&, c10::Device>, std::is_convertible<const std::optional<_Tp>&&, c10::Device>, std::is_convertible<std::optional<_Tp>&&, c10::Device> > > >, bool>::type <anonymous> > constexpr std::optional<_Tp>::optional(std::optional<_Up>&&) [with _Up = _Up; typename std::enable_if<__and_v<std::__not_<std::is_same<_T1, _U1> >, std::is_constructible<_Tp, _Up>, std::is_convertible<_Up, _Tp>, std::__not_<std::__or_<std::is_constructible<_Tp, const std::optional<_Up>&>, std::is_constructible<_Tp, std::optional<_Up>&>, std::is_constructible<_Tp, const std::optional<_Up>&&>, std::is_constructible<_Tp, std::optional<_Up>&&>, std::is_convertible<const std::optional<_Up>&, _Tp>, std::is_convertible<std::optional<_Up>&, _Tp>, std::is_convertible<const std::optional<_Up>&&, _Tp>, std::is_convertible<std::optional<_Up>&&, _Tp> > > >, bool>::type <anonymous> = <anonymous>; _Tp = c10::Device]’
    749 |         optional(optional<_Up>&& __t)
        |         ^~~~~~~~
  /usr/include/c++/11/optional:749:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/CheckMemoryFormat.h:1,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:31,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/TensorOptions.h:208:14: note:   types ‘std::optional<_Tp>’ and ‘const std::in_place_t’ have incompatible cv-qualifiers
    208 |         std::optional<Device>(std::in_place, std::forward<Args>(args)...));
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:736:9: note: candidate: ‘template<class _Up, typename std::enable_if<__and_v<std::__not_<std::is_same<c10::Device, _U1> >, std::is_constructible<c10::Device, const _Up&>, std::__not_<std::is_convertible<const _Up&, c10::Device> >, std::__not_<std::__or_<std::is_constructible<c10::Device, const std::optional<_Tp>&>, std::is_constructible<c10::Device, std::optional<_Tp>&>, std::is_constructible<c10::Device, const std::optional<_Tp>&&>, std::is_constructible<c10::Device, std::optional<_Tp>&&>, std::is_convertible<const std::optional<_Tp>&, c10::Device>, std::is_convertible<std::optional<_Tp>&, c10::Device>, std::is_convertible<const std::optional<_Tp>&&, c10::Device>, std::is_convertible<std::optional<_Tp>&&, c10::Device> > > >, bool>::type <anonymous> > constexpr std::optional<_Tp>::optional(const std::optional<_Up>&) [with _Up = _Up; typename std::enable_if<__and_v<std::__not_<std::is_same<_T1, _U1> >, std::is_constructible<_Tp, const _Up&>, std::__not_<std::is_convertible<const _Up&, _Tp> >, std::__not_<std::__or_<std::is_constructible<_Tp, const std::optional<_Up>&>, std::is_constructible<_Tp, std::optional<_Up>&>, std::is_constructible<_Tp, const std::optional<_Up>&&>, std::is_constructible<_Tp, std::optional<_Up>&&>, std::is_convertible<const std::optional<_Up>&, _Tp>, std::is_convertible<std::optional<_Up>&, _Tp>, std::is_convertible<const std::optional<_Up>&&, _Tp>, std::is_convertible<std::optional<_Up>&&, _Tp> > > >, bool>::type <anonymous> = <anonymous>; _Tp = c10::Device]’
    736 |         optional(const optional<_Up>& __t)
        |         ^~~~~~~~
  /usr/include/c++/11/optional:736:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/CheckMemoryFormat.h:1,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:31,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/TensorOptions.h:208:14: note:   ‘const std::in_place_t’ is not derived from ‘const std::optional<_Tp>’
    208 |         std::optional<Device>(std::in_place, std::forward<Args>(args)...));
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:723:9: note: candidate: ‘template<class _Up, typename std::enable_if<__and_v<std::__not_<std::is_same<c10::Device, _U1> >, std::is_constructible<c10::Device, const _Up&>, std::is_convertible<const _Up&, c10::Device>, std::__not_<std::__or_<std::is_constructible<c10::Device, const std::optional<_Tp>&>, std::is_constructible<c10::Device, std::optional<_Tp>&>, std::is_constructible<c10::Device, const std::optional<_Tp>&&>, std::is_constructible<c10::Device, std::optional<_Tp>&&>, std::is_convertible<const std::optional<_Tp>&, c10::Device>, std::is_convertible<std::optional<_Tp>&, c10::Device>, std::is_convertible<const std::optional<_Tp>&&, c10::Device>, std::is_convertible<std::optional<_Tp>&&, c10::Device> > > >, bool>::type <anonymous> > constexpr std::optional<_Tp>::optional(const std::optional<_Up>&) [with _Up = _Up; typename std::enable_if<__and_v<std::__not_<std::is_same<_T1, _U1> >, std::is_constructible<_Tp, const _Up&>, std::is_convertible<const _Up&, _Tp>, std::__not_<std::__or_<std::is_constructible<_Tp, const std::optional<_Up>&>, std::is_constructible<_Tp, std::optional<_Up>&>, std::is_constructible<_Tp, const std::optional<_Up>&&>, std::is_constructible<_Tp, std::optional<_Up>&&>, std::is_convertible<const std::optional<_Up>&, _Tp>, std::is_convertible<std::optional<_Up>&, _Tp>, std::is_convertible<const std::optional<_Up>&&, _Tp>, std::is_convertible<std::optional<_Up>&&, _Tp> > > >, bool>::type <anonymous> = <anonymous>; _Tp = c10::Device]’
    723 |         optional(const optional<_Up>& __t)
        |         ^~~~~~~~
  /usr/include/c++/11/optional:723:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/CheckMemoryFormat.h:1,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:31,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/TensorOptions.h:208:14: note:   ‘const std::in_place_t’ is not derived from ‘const std::optional<_Tp>’
    208 |         std::optional<Device>(std::in_place, std::forward<Args>(args)...));
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:713:9: note: candidate: ‘template<class _Up, typename std::enable_if<__and_v<std::__not_<std::is_same<std::optional<c10::Device>, typename std::remove_cv<typename std::remove_reference<_Tp>::type>::type> >, std::__not_<std::is_same<std::in_place_t, typename std::remove_cv<typename std::remove_reference<_Tp>::type>::type> >, std::is_constructible<c10::Device, _Up>, std::__not_<std::is_convertible<_Up, c10::Device> > >, bool>::type <anonymous> > constexpr std::optional<_Tp>::optional(_Up&&) [with _Up = _Up; typename std::enable_if<__and_v<std::__not_<std::is_same<std::optional<_Tp>, typename std::remove_cv<typename std::remove_reference<_Iter>::type>::type> >, std::__not_<std::is_same<std::in_place_t, typename std::remove_cv<typename std::remove_reference<_Iter>::type>::type> >, std::is_constructible<_Tp, _Up>, std::__not_<std::is_convertible<_Up, _Tp> > >, bool>::type <anonymous> = <anonymous>; _Tp = c10::Device]’
    713 |         optional(_Up&& __t)
        |         ^~~~~~~~
  /usr/include/c++/11/optional:713:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/CheckMemoryFormat.h:1,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:31,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/TensorOptions.h:208:14: note:   candidate expects 1 argument, 2 provided
    208 |         std::optional<Device>(std::in_place, std::forward<Args>(args)...));
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:704:9: note: candidate: ‘template<class _Up, typename std::enable_if<__and_v<std::__not_<std::is_same<std::optional<c10::Device>, typename std::remove_cv<typename std::remove_reference<_Tp>::type>::type> >, std::__not_<std::is_same<std::in_place_t, typename std::remove_cv<typename std::remove_reference<_Tp>::type>::type> >, std::is_constructible<c10::Device, _Up>, std::is_convertible<_Up, c10::Device> >, bool>::type <anonymous> > constexpr std::optional<_Tp>::optional(_Up&&) [with _Up = _Up; typename std::enable_if<__and_v<std::__not_<std::is_same<std::optional<_Tp>, typename std::remove_cv<typename std::remove_reference<_Iter>::type>::type> >, std::__not_<std::is_same<std::in_place_t, typename std::remove_cv<typename std::remove_reference<_Iter>::type>::type> >, std::is_constructible<_Tp, _Up>, std::is_convertible<_Up, _Tp> >, bool>::type <anonymous> = <anonymous>; _Tp = c10::Device]’
    704 |         optional(_Up&& __t)
        |         ^~~~~~~~
  /usr/include/c++/11/optional:704:9: note:   template argument deduction/substitution failed:
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/CheckMemoryFormat.h:1,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:31,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/TensorOptions.h:208:14: note:   candidate expects 1 argument, 2 provided
    208 |         std::optional<Device>(std::in_place, std::forward<Args>(args)...));
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional:696:17: note: candidate: ‘constexpr std::optional<_Tp>::optional(std::nullopt_t) [with _Tp = c10::Device]’
    696 |       constexpr optional(nullopt_t) noexcept { }
        |                 ^~~~~~~~
  /usr/include/c++/11/optional:696:17: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/optional:694:17: note: candidate: ‘constexpr std::optional<_Tp>::optional() [with _Tp = c10::Device]’
    694 |       constexpr optional() noexcept { }
        |                 ^~~~~~~~
  /usr/include/c++/11/optional:694:17: note:   candidate expects 0 arguments, 2 provided
  /usr/include/c++/11/optional:662:11: note: candidate: ‘constexpr std::optional<c10::Device>::optional(const std::optional<c10::Device>&)’
    662 |     class optional
        |           ^~~~~~~~
  /usr/include/c++/11/optional:662:11: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/optional:662:11: note: candidate: ‘constexpr std::optional<c10::Device>::optional(std::optional<c10::Device>&&)’
  /usr/include/c++/11/optional:662:11: note:   candidate expects 1 argument, 2 provided
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h: In instantiation of ‘std::_Vector_base<_Tp, _Alloc>::~_Vector_base() [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’:
  /usr/include/c++/11/bits/stl_vector.h:487:7:   required from here
  /usr/include/c++/11/bits/stl_vector.h:336:49: error: invalid use of incomplete type ‘class torch::Tensor’
    336 |                       _M_impl._M_end_of_storage - _M_impl._M_start);
        |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/move.h:57,
                   from /usr/include/c++/11/bits/stl_pair.h:59,
                   from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::__not_<std::is_nothrow_move_constructible<torch::Tensor> >’:
  /usr/include/c++/11/type_traits:152:12:   required from ‘struct std::__and_<std::__not_<std::is_nothrow_move_constructible<torch::Tensor> >, std::is_copy_constructible<torch::Tensor> >’
  /usr/include/c++/11/bits/move.h:109:12:   required from ‘struct std::__move_if_noexcept_cond<torch::Tensor>’
  /usr/include/c++/11/bits/stl_iterator.h:1719:26:   required by substitution of ‘template<class _Tp, class _ReturnType> constexpr _ReturnType std::__make_move_if_noexcept_iterator(_Tp*) [with _Tp = torch::Tensor; _ReturnType = <missing>]’
  /usr/include/c++/11/bits/vector.tcc:86:3:   required from ‘void std::vector<_Tp, _Alloc>::reserve(std::vector<_Tp, _Alloc>::size_type) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::size_type = long unsigned int]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:21:17:   required from here
  /usr/include/c++/11/type_traits:163:41: error: ‘value’ is not a member of ‘std::is_nothrow_move_constructible<torch::Tensor>’
    163 |     : public __bool_constant<!bool(_Pp::value)>
        |                                         ^~~~~
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::__and_<std::__not_<std::is_nothrow_move_constructible<torch::Tensor> >, std::is_copy_constructible<torch::Tensor> >’:
  /usr/include/c++/11/bits/move.h:109:12:   required from ‘struct std::__move_if_noexcept_cond<torch::Tensor>’
  /usr/include/c++/11/bits/stl_iterator.h:1719:26:   required by substitution of ‘template<class _Tp, class _ReturnType> constexpr _ReturnType std::__make_move_if_noexcept_iterator(_Tp*) [with _Tp = torch::Tensor; _ReturnType = <missing>]’
  /usr/include/c++/11/bits/vector.tcc:86:3:   required from ‘void std::vector<_Tp, _Alloc>::reserve(std::vector<_Tp, _Alloc>::size_type) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::size_type = long unsigned int]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:21:17:   required from here
  /usr/include/c++/11/type_traits:152:12: error: ‘value’ is not a member of ‘std::__not_<std::is_nothrow_move_constructible<torch::Tensor> >’
    152 |     struct __and_<_B1, _B2>
        |            ^~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/bits/stl_pair.h:59,
                   from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/move.h: In instantiation of ‘struct std::__move_if_noexcept_cond<torch::Tensor>’:
  /usr/include/c++/11/bits/stl_iterator.h:1719:26:   required by substitution of ‘template<class _Tp, class _ReturnType> constexpr _ReturnType std::__make_move_if_noexcept_iterator(_Tp*) [with _Tp = torch::Tensor; _ReturnType = <missing>]’
  /usr/include/c++/11/bits/vector.tcc:86:3:   required from ‘void std::vector<_Tp, _Alloc>::reserve(std::vector<_Tp, _Alloc>::size_type) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::size_type = long unsigned int]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:21:17:   required from here
  /usr/include/c++/11/bits/move.h:109:12: error: no type named ‘type’ in ‘struct std::__and_<std::__not_<std::is_nothrow_move_constructible<torch::Tensor> >, std::is_copy_constructible<torch::Tensor> >’
    109 |     struct __move_if_noexcept_cond
        |            ^~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/bits/stl_algobase.h:67,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/vector.tcc: In instantiation of ‘void std::vector<_Tp, _Alloc>::reserve(std::vector<_Tp, _Alloc>::size_type) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::size_type = long unsigned int]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:21:17:   required from here
  /usr/include/c++/11/bits/vector.tcc:86:17: error: no matching function for call to ‘__make_move_if_noexcept_iterator(torch::Tensor*&)’
     86 |                 _GLIBCXX_MAKE_MOVE_IF_NOEXCEPT_ITERATOR(this->_M_impl._M_start),
        |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/bits/stl_iterator.h:1714:5: note: candidate: ‘template<class _Iterator, class _ReturnType> constexpr _ReturnType std::__make_move_if_noexcept_iterator(_Iterator)’
   1714 |     __make_move_if_noexcept_iterator(_Iterator __i)
        |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/bits/stl_iterator.h:1714:5: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/bits/stl_iterator.h:1709:32: error: ‘value’ is not a member of ‘std::__move_if_noexcept_cond<torch::Tensor>’
   1709 |   template<typename _Iterator, typename _ReturnType
        |                                ^~~~~~~~
  /usr/include/c++/11/bits/stl_iterator.h:1723:5: note: candidate: ‘template<class _Tp, class _ReturnType> constexpr _ReturnType std::__make_move_if_noexcept_iterator(_Tp*)’
   1723 |     __make_move_if_noexcept_iterator(_Tp* __i)
        |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/bits/stl_iterator.h:1723:5: note:   substitution of deduced template arguments resulted in errors seen above
  /usr/include/c++/11/bits/vector.tcc:87:17: error: no matching function for call to ‘__make_move_if_noexcept_iterator(torch::Tensor*&)’
     87 |                 _GLIBCXX_MAKE_MOVE_IF_NOEXCEPT_ITERATOR(this->_M_impl._M_finish));
        |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/bits/stl_iterator.h:1714:5: note: candidate: ‘template<class _Iterator, class _ReturnType> constexpr _ReturnType std::__make_move_if_noexcept_iterator(_Iterator)’
   1714 |     __make_move_if_noexcept_iterator(_Iterator __i)
        |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/bits/stl_iterator.h:1714:5: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/bits/stl_iterator.h:1709:32: error: ‘value’ is not a member of ‘std::__move_if_noexcept_cond<torch::Tensor>’
   1709 |   template<typename _Iterator, typename _ReturnType
        |                                ^~~~~~~~
  /usr/include/c++/11/bits/stl_iterator.h:1723:5: note: candidate: ‘template<class _Tp, class _ReturnType> constexpr _ReturnType std::__make_move_if_noexcept_iterator(_Tp*)’
   1723 |     __make_move_if_noexcept_iterator(_Tp* __i)
        |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/bits/stl_iterator.h:1723:5: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/bits/stl_iterator.h:1719:26: error: ‘value’ is not a member of ‘std::__move_if_noexcept_cond<torch::Tensor>’
   1719 |   template<typename _Tp, typename _ReturnType
        |                          ^~~~~~~~
  In file included from /usr/include/c++/11/vector:72,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/vector.tcc:94:25: error: invalid use of incomplete type ‘class torch::Tensor’
     93 |                         this->_M_impl._M_end_of_storage
        |                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     94 |                         - this->_M_impl._M_start);
        |                         ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/vector:72,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/vector.tcc:96:43: error: invalid use of incomplete type ‘class torch::Tensor’
     96 |           this->_M_impl._M_finish = __tmp + __old_size;
        |                                     ~~~~~~^~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/vector:72,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/vector.tcc:97:68: error: invalid use of incomplete type ‘class torch::Tensor’
     97 |           this->_M_impl._M_end_of_storage = this->_M_impl._M_start + __n;
        |                                             ~~~~~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h: In instantiation of ‘std::vector<_Tp, _Alloc>::reference std::vector<_Tp, _Alloc>::operator[](std::vector<_Tp, _Alloc>::size_type) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::reference = torch::Tensor&; std::vector<_Tp, _Alloc>::size_type = long unsigned int]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:117:44:   required from here
  /usr/include/c++/11/bits/stl_vector.h:1046:41: error: invalid use of incomplete type ‘class torch::Tensor’
   1046 |         return *(this->_M_impl._M_start + __n);
        |                 ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/functional:59,
                   from /workspace/nunchaku/src/common.h:21,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/std_function.h: In instantiation of ‘_Res std::function<_Res(_ArgTypes ...)>::operator()(_ArgTypes ...) const [with _Res = torch::Tensor; _ArgTypes = {const torch::Tensor&, const torch::Tensor&}]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:664:38:   required from here
  /usr/include/c++/11/bits/std_function.h:586:7: error: return type ‘class torch::Tensor’ is incomplete
    586 |       operator()(_ArgTypes... __args) const
        |       ^~~~~~~~
  /usr/include/c++/11/bits/std_function.h:590:16: error: invalid use of incomplete type ‘class torch::Tensor’
    590 |         return _M_invoker(_M_functor, std::forward<_ArgTypes>(__args)...);
        |                ^~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /workspace/nunchaku/src/common.h:19,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/optional: In instantiation of ‘constexpr _Tp& std::optional<_Tp>::operator*() & [with _Tp = torch::Tensor]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:23:28:   required from here
  /usr/include/c++/11/optional:931:22: error: ‘class std::optional<torch::Tensor>’ has no member named ‘_M_get’
    931 |       { return this->_M_get(); }
        |                ~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/c10/core/MemoryFormat.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/TensorBody.h:13,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/core/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/ATen/Tensor.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/variable.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h: In instantiation of ‘constexpr const T& c10::ArrayRef<T>::operator[](size_t) const [with T = torch::Tensor; size_t = long unsigned int]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/rnn.h:339:51:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/c10/util/ArrayRef.h:226:16: error: invalid use of incomplete type ‘class torch::Tensor’
    226 |     return Data[Index];
        |            ~~~~^
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/move.h:57,
                   from /usr/include/c++/11/bits/stl_pair.h:59,
                   from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/type_traits: In substitution of ‘template<class _Tp, class ... _Args> using __is_nothrow_constructible_impl = std::__bool_constant<__is_nothrow_constructible(_Tp)> [with _Tp = torch::Tensor; _Args = {const torch::Tensor&}]’:
  /usr/include/c++/11/type_traits:1022:12:   required from ‘struct std::is_nothrow_constructible<torch::Tensor, const torch::Tensor&>’
  /usr/include/c++/11/bits/alloc_traits.h:513:57:   required from ‘static constexpr void std::allocator_traits<std::allocator<_CharT> >::construct(std::allocator_traits<std::allocator<_CharT> >::allocator_type&, _Up*, _Args&& ...) [with _Up = torch::Tensor; _Args = {const torch::Tensor&}; _Tp = torch::Tensor; std::allocator_traits<std::allocator<_CharT> >::allocator_type = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/bits/stl_vector.h:1192:30:   required from ‘void std::vector<_Tp, _Alloc>::push_back(const value_type&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::value_type = torch::Tensor]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:31:33:   required from here
  /usr/include/c++/11/type_traits:1017:25: error: invalid use of incomplete type ‘class torch::Tensor’
   1017 |       = __bool_constant<__is_nothrow_constructible(_Tp, _Args...)>;
        |                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/move.h:57,
                   from /usr/include/c++/11/bits/stl_pair.h:59,
                   from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::is_nothrow_constructible<torch::Tensor, const torch::Tensor&>’:
  /usr/include/c++/11/bits/alloc_traits.h:513:57:   required from ‘static constexpr void std::allocator_traits<std::allocator<_CharT> >::construct(std::allocator_traits<std::allocator<_CharT> >::allocator_type&, _Up*, _Args&& ...) [with _Up = torch::Tensor; _Args = {const torch::Tensor&}; _Tp = torch::Tensor; std::allocator_traits<std::allocator<_CharT> >::allocator_type = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/bits/stl_vector.h:1192:30:   required from ‘void std::vector<_Tp, _Alloc>::push_back(const value_type&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::value_type = torch::Tensor]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:31:33:   required from here
  /usr/include/c++/11/type_traits:1025:52: error: static assertion failed: template argument must be a complete class or an unbounded array
   1025 |       static_assert(std::__is_complete_or_unbounded(__type_identity<_Tp>{}),
        |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/type_traits:1025:52: note: ‘std::__is_complete_or_unbounded<std::__type_identity<torch::Tensor> >((std::__type_identity<torch::Tensor>{}, std::__type_identity<torch::Tensor>()))’ evaluates to false
  In file included from /usr/include/c++/11/ext/alloc_traits.h:34,
                   from /usr/include/c++/11/bits/basic_string.h:40,
                   from /usr/include/c++/11/string:55,
                   from /usr/include/c++/11/bits/locale_classes.h:40,
                   from /usr/include/c++/11/bits/ios_base.h:41,
                   from /usr/include/c++/11/ios:42,
                   from /usr/include/c++/11/ostream:38,
                   from /usr/include/c++/11/iostream:39,
                   from /workspace/nunchaku/src/common.h:6,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/alloc_traits.h: In instantiation of ‘static constexpr void std::allocator_traits<std::allocator<_CharT> >::construct(std::allocator_traits<std::allocator<_CharT> >::allocator_type&, _Up*, _Args&& ...) [with _Up = torch::Tensor; _Args = {const torch::Tensor&}; _Tp = torch::Tensor; std::allocator_traits<std::allocator<_CharT> >::allocator_type = std::allocator<torch::Tensor>]’:
  /usr/include/c++/11/bits/stl_vector.h:1192:30:   required from ‘void std::vector<_Tp, _Alloc>::push_back(const value_type&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::value_type = torch::Tensor]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:31:33:   required from here
  /usr/include/c++/11/bits/alloc_traits.h:513:64: error: ‘value’ is not a member of ‘std::is_nothrow_constructible<torch::Tensor, const torch::Tensor&>’
    513 |         noexcept(std::is_nothrow_constructible<_Up, _Args...>::value)
        |                                                                ^~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h: In instantiation of ‘void std::vector<_Tp, _Alloc>::push_back(const value_type&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::value_type = torch::Tensor]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:31:33:   required from here
  /usr/include/c++/11/bits/stl_vector.h:1194:29: error: cannot increment a pointer to incomplete type ‘torch::Tensor’
   1194 |             ++this->_M_impl._M_finish;
        |               ~~~~~~~~~~~~~~^~~~~~~~~
  /usr/include/c++/11/bits/stl_vector.h: In instantiation of ‘std::vector<_Tp, _Alloc>::size_type std::vector<_Tp, _Alloc>::size() const [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::size_type = long unsigned int]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:42:40:   required from here
  /usr/include/c++/11/bits/stl_vector.h:919:50: error: invalid use of incomplete type ‘class torch::Tensor’
    919 |       { return size_type(this->_M_impl._M_finish - this->_M_impl._M_start); }
        |                          ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/algorithmfwd.h:39,
                   from /usr/include/c++/11/bits/stl_algo.h:60,
                   from /usr/include/c++/11/string:52,
                   from /usr/include/c++/11/bits/locale_classes.h:40,
                   from /usr/include/c++/11/bits/ios_base.h:41,
                   from /usr/include/c++/11/ios:42,
                   from /usr/include/c++/11/ostream:38,
                   from /usr/include/c++/11/iostream:39,
                   from /workspace/nunchaku/src/common.h:6,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/initializer_list: In instantiation of ‘constexpr const _E* std::initializer_list<_E>::end() const [with _E = torch::Tensor; std::initializer_list<_E>::const_iterator = const torch::Tensor*]’:
  /usr/include/c++/11/bits/stl_vector.h:629:42:   required from ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:101:37:   required from here
  /usr/include/c++/11/initializer_list:79:45: error: invalid use of incomplete type ‘class torch::Tensor’
     79 |       end() const noexcept { return begin() + size(); }
        |                                     ~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h: In instantiation of ‘std::vector<_Tp, _Alloc>::size_type std::vector<_Tp, _Alloc>::capacity() const [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::size_type = long unsigned int]’:
  /usr/include/c++/11/bits/vector.tcc:71:17:   required from ‘void std::vector<_Tp, _Alloc>::reserve(std::vector<_Tp, _Alloc>::size_type) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::size_type = long unsigned int]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:21:17:   required from here
  /usr/include/c++/11/bits/stl_vector.h:1000:26: error: invalid use of incomplete type ‘class torch::Tensor’
    999 |       { return size_type(this->_M_impl._M_end_of_storage
        |                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   1000 |                          - this->_M_impl._M_start); }
        |                          ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/ext/alloc_traits.h:34,
                   from /usr/include/c++/11/bits/basic_string.h:40,
                   from /usr/include/c++/11/string:55,
                   from /usr/include/c++/11/bits/locale_classes.h:40,
                   from /usr/include/c++/11/bits/ios_base.h:41,
                   from /usr/include/c++/11/ios:42,
                   from /usr/include/c++/11/ostream:38,
                   from /usr/include/c++/11/iostream:39,
                   from /workspace/nunchaku/src/common.h:6,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/alloc_traits.h: In instantiation of ‘static constexpr void std::allocator_traits<std::allocator<_CharT> >::construct(std::allocator_traits<std::allocator<_CharT> >::allocator_type&, _Up*, _Args&& ...) [with _Up = torch::Tensor; _Args = {const torch::Tensor&}; _Tp = torch::Tensor; std::allocator_traits<std::allocator<_CharT> >::allocator_type = std::allocator<torch::Tensor>]’:
  /usr/include/c++/11/bits/stl_vector.h:1192:30:   required from ‘void std::vector<_Tp, _Alloc>::push_back(const value_type&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::value_type = torch::Tensor]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:31:33:   required from here
  /usr/include/c++/11/bits/alloc_traits.h:518:28: error: no matching function for call to ‘construct_at(torch::Tensor*&, const torch::Tensor&)’
    518 |           std::construct_at(__p, std::forward<_Args>(__args)...);
        |           ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/bits/stl_iterator.h:85,
                   from /usr/include/c++/11/bits/stl_algobase.h:67,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_construct.h:94:5: note: candidate: ‘template<class _Tp, class ... _Args> constexpr decltype (::new(void*(0)) _Tp) std::construct_at(_Tp*, _Args&& ...)’
     94 |     construct_at(_Tp* __location, _Args&&... __args)
        |     ^~~~~~~~~~~~
  /usr/include/c++/11/bits/stl_construct.h:94:5: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/bits/stl_construct.h: In substitution of ‘template<class _Tp, class ... _Args> constexpr decltype (::new(void*(0)) _Tp) std::construct_at(_Tp*, _Args&& ...) [with _Tp = torch::Tensor; _Args = {const torch::Tensor&}]’:
  /usr/include/c++/11/bits/alloc_traits.h:518:21:   required from ‘static constexpr void std::allocator_traits<std::allocator<_CharT> >::construct(std::allocator_traits<std::allocator<_CharT> >::allocator_type&, _Up*, _Args&& ...) [with _Up = torch::Tensor; _Args = {const torch::Tensor&}; _Tp = torch::Tensor; std::allocator_traits<std::allocator<_CharT> >::allocator_type = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/bits/stl_vector.h:1192:30:   required from ‘void std::vector<_Tp, _Alloc>::push_back(const value_type&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::value_type = torch::Tensor]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:31:33:   required from here
  /usr/include/c++/11/bits/stl_construct.h:96:17: error: invalid use of incomplete type ‘class torch::Tensor’
     96 |     -> decltype(::new((void*)0) _Tp(std::declval<_Args>()...))
        |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/stl_algobase.h:66,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_iterator_base_funcs.h: In instantiation of ‘constexpr typename std::iterator_traits< <template-parameter-1-1> >::difference_type std::__distance(_RandomAccessIterator, _RandomAccessIterator, std::random_access_iterator_tag) [with _RandomAccessIterator = const torch::Tensor*; typename std::iterator_traits< <template-parameter-1-1> >::difference_type = long int]’:
  /usr/include/c++/11/bits/stl_iterator_base_funcs.h:141:29:   required from ‘constexpr typename std::iterator_traits< <template-parameter-1-1> >::difference_type std::distance(_InputIterator, _InputIterator) [with _InputIterator = const torch::Tensor*; typename std::iterator_traits< <template-parameter-1-1> >::difference_type = long int]’
  /usr/include/c++/11/bits/stl_vector.h:1580:39:   required from ‘void std::vector<_Tp, _Alloc>::_M_range_initialize(_ForwardIterator, _ForwardIterator, std::forward_iterator_tag) [with _ForwardIterator = const torch::Tensor*; _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/bits/stl_vector.h:629:21:   required from ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:101:37:   required from here
  /usr/include/c++/11/bits/stl_iterator_base_funcs.h:104:21: error: invalid use of incomplete type ‘const class torch::Tensor’
    104 |       return __last - __first;
        |              ~~~~~~~^~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h: In instantiation of ‘void std::vector<_Tp, _Alloc>::_M_range_initialize(_ForwardIterator, _ForwardIterator, std::forward_iterator_tag) [with _ForwardIterator = const torch::Tensor*; _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’:
  /usr/include/c++/11/bits/stl_vector.h:629:21:   required from ‘std::vector<_Tp, _Alloc>::vector(std::initializer_list<_Tp>, const allocator_type&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::allocator_type = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:101:37:   required from here
  /usr/include/c++/11/bits/stl_vector.h:1583:68: error: invalid use of incomplete type ‘class torch::Tensor’
   1583 |           this->_M_impl._M_end_of_storage = this->_M_impl._M_start + __n;
        |                                             ~~~~~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/vector:72,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/vector.tcc: In instantiation of ‘std::vector<_Tp, _Alloc>& std::vector<_Tp, _Alloc>::operator=(const std::vector<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’:
  /usr/include/c++/11/optional:168:19:   required from ‘constexpr void std::_Optional_payload_base<_Tp>::_M_copy_assign(const std::_Optional_payload_base<_Tp>&) [with _Tp = std::vector<torch::Tensor>]’
  /usr/include/c++/11/optional:371:22:   required from ‘constexpr std::_Optional_payload<_Tp, true, false, false>& std::_Optional_payload<_Tp, true, false, false>::operator=(const std::_Optional_payload<_Tp, true, false, false>&) [with _Tp = std::vector<torch::Tensor>]’
  /usr/include/c++/11/optional:397:26:   required from here
  /usr/include/c++/11/bits/vector.tcc:214:33: error: invalid use of incomplete type ‘class torch::Tensor’
    213 |                                 this->_M_impl._M_end_of_storage
        |                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    214 |                                 - this->_M_impl._M_start);
        |                                 ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/vector:72,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/vector.tcc:232:29: error: invalid use of incomplete type ‘class torch::Tensor’
    231 |                             this->_M_impl._M_end_of_storage
        |                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    232 |                             - this->_M_impl._M_start);
        |                             ^~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/vector:72,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/vector.tcc:234:72: error: invalid use of incomplete type ‘class torch::Tensor’
    234 |               this->_M_impl._M_end_of_storage = this->_M_impl._M_start + __xlen;
        |                                                 ~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/vector:72,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/vector.tcc:243:68: error: invalid use of incomplete type ‘class torch::Tensor’
    243 |               std::copy(__x._M_impl._M_start, __x._M_impl._M_start + size(),
        |                                               ~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/vector:72,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/vector.tcc:245:64: error: invalid use of incomplete type ‘class torch::Tensor’
    245 |               std::__uninitialized_copy_a(__x._M_impl._M_start + size(),
        |                                           ~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/vector:72,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/vector.tcc:250:60: error: invalid use of incomplete type ‘class torch::Tensor’
    250 |           this->_M_impl._M_finish = this->_M_impl._M_start + __xlen;
        |                                     ~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/move.h:57,
                   from /usr/include/c++/11/bits/stl_pair.h:59,
                   from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::is_destructible<torch::Tensor>’:
  /usr/include/c++/11/bits/stl_construct.h:188:51:   required from ‘constexpr void std::_Destroy(_ForwardIterator, _ForwardIterator) [with _ForwardIterator = torch::Tensor*]’
  /usr/include/c++/11/bits/alloc_traits.h:848:15:   required from ‘void std::_Destroy(_ForwardIterator, _ForwardIterator, std::allocator<_T2>&) [with _ForwardIterator = torch::Tensor*; _Tp = torch::Tensor]’
  /usr/include/c++/11/bits/stl_vector.h:680:15:   required from ‘std::vector<_Tp, _Alloc>::~vector() [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:20:32:   required from here
  /usr/include/c++/11/type_traits:885:52: error: static assertion failed: template argument must be a complete class or an unbounded array
    885 |       static_assert(std::__is_complete_or_unbounded(__type_identity<_Tp>{}),
        |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/type_traits:885:52: note: ‘std::__is_complete_or_unbounded<std::__type_identity<torch::Tensor> >((std::__type_identity<torch::Tensor>{}, std::__type_identity<torch::Tensor>()))’ evaluates to false
  In file included from /usr/include/c++/11/bits/stl_iterator.h:85,
                   from /usr/include/c++/11/bits/stl_algobase.h:67,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_construct.h: In instantiation of ‘constexpr void std::_Destroy(_ForwardIterator, _ForwardIterator) [with _ForwardIterator = torch::Tensor*]’:
  /usr/include/c++/11/bits/alloc_traits.h:848:15:   required from ‘void std::_Destroy(_ForwardIterator, _ForwardIterator, std::allocator<_T2>&) [with _ForwardIterator = torch::Tensor*; _Tp = torch::Tensor]’
  /usr/include/c++/11/bits/stl_vector.h:680:15:   required from ‘std::vector<_Tp, _Alloc>::~vector() [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:20:32:   required from here
  /usr/include/c++/11/bits/stl_construct.h:188:51: error: static assertion failed: value type is destructible
    188 |       static_assert(is_destructible<_Value_type>::value,
        |                                                   ^~~~~
  /usr/include/c++/11/bits/stl_construct.h:188:51: note: ‘std::integral_constant<bool, false>::value’ evaluates to false
  /usr/include/c++/11/bits/stl_construct.h:195:25: error: invalid use of incomplete type ‘using value_type = std::remove_cv_t<torch::Tensor>’ {aka ‘class torch::Tensor’}
    195 |       std::_Destroy_aux<__has_trivial_destructor(_Value_type)>::
        |                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘using value_type = std::remove_cv_t<torch::Tensor>’ {aka ‘class torch::Tensor’}
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h: In instantiation of ‘static std::vector<_Tp, _Alloc>::size_type std::vector<_Tp, _Alloc>::_S_max_size(const _Tp_alloc_type&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::_Tp_alloc_type = std::vector<torch::Tensor>::_Tp_alloc_type]’:
  /usr/include/c++/11/bits/stl_vector.h:924:27:   required from ‘std::vector<_Tp, _Alloc>::size_type std::vector<_Tp, _Alloc>::max_size() const [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::size_type = long unsigned int]’
  /usr/include/c++/11/bits/vector.tcc:69:23:   required from ‘void std::vector<_Tp, _Alloc>::reserve(std::vector<_Tp, _Alloc>::size_type) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::size_type = long unsigned int]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:21:17:   required from here
  /usr/include/c++/11/bits/stl_vector.h:1782:61: error: invalid application of ‘sizeof’ to incomplete type ‘torch::Tensor’
   1782 |           = __gnu_cxx::__numeric_traits<ptrdiff_t>::__max / sizeof(_Tp);
        |                                                             ^~~~~~~~~~~
  In file included from /usr/include/c++/11/ext/alloc_traits.h:34,
                   from /usr/include/c++/11/bits/basic_string.h:40,
                   from /usr/include/c++/11/string:55,
                   from /usr/include/c++/11/bits/locale_classes.h:40,
                   from /usr/include/c++/11/bits/ios_base.h:41,
                   from /usr/include/c++/11/ios:42,
                   from /usr/include/c++/11/ostream:38,
                   from /usr/include/c++/11/iostream:39,
                   from /workspace/nunchaku/src/common.h:6,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/alloc_traits.h: In instantiation of ‘static constexpr std::allocator_traits<std::allocator<_CharT> >::size_type std::allocator_traits<std::allocator<_CharT> >::max_size(const allocator_type&) [with _Tp = torch::Tensor; std::allocator_traits<std::allocator<_CharT> >::size_type = long unsigned int; std::allocator_traits<std::allocator<_CharT> >::allocator_type = std::allocator<torch::Tensor>]’:
  /usr/include/c++/11/bits/stl_vector.h:1783:51:   required from ‘static std::vector<_Tp, _Alloc>::size_type std::vector<_Tp, _Alloc>::_S_max_size(const _Tp_alloc_type&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::size_type = long unsigned int; std::vector<_Tp, _Alloc>::_Tp_alloc_type = std::vector<torch::Tensor>::_Tp_alloc_type]’
  /usr/include/c++/11/bits/stl_vector.h:924:27:   required from ‘std::vector<_Tp, _Alloc>::size_type std::vector<_Tp, _Alloc>::max_size() const [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::size_type = long unsigned int]’
  /usr/include/c++/11/bits/vector.tcc:69:23:   required from ‘void std::vector<_Tp, _Alloc>::reserve(std::vector<_Tp, _Alloc>::size_type) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::size_type = long unsigned int]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:21:17:   required from here
  /usr/include/c++/11/bits/alloc_traits.h:552:29: error: invalid application of ‘sizeof’ to incomplete type ‘std::allocator_traits<std::allocator<torch::Tensor> >::value_type’ {aka ‘torch::Tensor’}
    552 |         return size_t(-1) / sizeof(value_type);
        |                             ^~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h: In instantiation of ‘void std::_Vector_base<_Tp, _Alloc>::_M_create_storage(std::size_t) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::size_t = long unsigned int]’:
  /usr/include/c++/11/bits/stl_vector.h:305:9:   required from ‘std::_Vector_base<_Tp, _Alloc>::_Vector_base(std::size_t, const allocator_type&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::size_t = long unsigned int; std::_Vector_base<_Tp, _Alloc>::allocator_type = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/bits/stl_vector.h:555:61:   required from ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/optimizer.h:84:9:   required from here
  /usr/include/c++/11/bits/stl_vector.h:363:66: error: invalid use of incomplete type ‘class torch::Tensor’
    363 |         this->_M_impl._M_end_of_storage = this->_M_impl._M_start + __n;
        |                                           ~~~~~~~~~~~~~~~~~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/memory:66,
                   from /workspace/nunchaku/src/common.h:9,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_uninitialized.h: In instantiation of ‘_ForwardIterator std::uninitialized_copy(_InputIterator, _InputIterator, _ForwardIterator) [with _InputIterator = __gnu_cxx::__normal_iterator<const torch::Tensor*, std::vector<torch::Tensor> >; _ForwardIterator = torch::Tensor*]’:
  /usr/include/c++/11/bits/stl_uninitialized.h:333:37:   required from ‘_ForwardIterator std::__uninitialized_copy_a(_InputIterator, _InputIterator, _ForwardIterator, std::allocator<_Tp>&) [with _InputIterator = __gnu_cxx::__normal_iterator<const torch::Tensor*, std::vector<torch::Tensor> >; _ForwardIterator = torch::Tensor*; _Tp = torch::Tensor]’
  /usr/include/c++/11/bits/stl_vector.h:558:31:   required from ‘std::vector<_Tp, _Alloc>::vector(const std::vector<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/optimizer.h:84:9:   required from here
  /usr/include/c++/11/bits/stl_uninitialized.h:138:72: error: static assertion failed: result type must be constructible from value type of input range
    138 |       static_assert(is_constructible<_ValueType2, decltype(*__first)>::value,
        |                                                                        ^~~~~
  /usr/include/c++/11/bits/stl_uninitialized.h:138:72: note: ‘std::integral_constant<bool, false>::value’ evaluates to false
  /usr/include/c++/11/bits/stl_uninitialized.h:148:40: error: invalid use of incomplete type ‘using value_type = __gnu_cxx::__normal_iterator<const torch::Tensor*, std::vector<torch::Tensor> >::value_type’ {aka ‘class torch::Tensor’}
    148 |       return std::__uninitialized_copy<__is_trivial(_ValueType1)
        |                                        ^~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘using value_type = __gnu_cxx::__normal_iterator<const torch::Tensor*, std::vector<torch::Tensor> >::value_type’ {aka ‘class torch::Tensor’}
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/memory:66,
                   from /workspace/nunchaku/src/common.h:9,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_uninitialized.h:149:43: error: invalid use of incomplete type ‘using value_type = std::remove_cv_t<torch::Tensor>’ {aka ‘class torch::Tensor’}
    149 |                                        && __is_trivial(_ValueType2)
        |                                           ^~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘using value_type = std::remove_cv_t<torch::Tensor>’ {aka ‘class torch::Tensor’}
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/deque:67,
                   from /usr/include/c++/11/stack:60,
                   from /workspace/nunchaku/src/common.h:13,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_deque.h: In instantiation of ‘void std::_Deque_base<_Tp, _Alloc>::_M_deallocate_node(std::_Deque_base<_Tp, _Alloc>::_Ptr) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::_Deque_base<_Tp, _Alloc>::_Ptr = torch::Tensor*]’:
  /usr/include/c++/11/bits/stl_deque.h:2180:20:   required from ‘void std::deque<_Tp, _Alloc>::_M_replace_map(_Args&& ...) [with _Args = {const std::deque<torch::Tensor, std::allocator<torch::Tensor> >&, std::allocator<torch::Tensor>}; _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/bits/deque.tcc:108:19:   required from ‘std::deque<_Tp, _Alloc>& std::deque<_Tp, _Alloc>::operator=(const std::deque<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:45:3:   required from here
  /usr/include/c++/11/bits/stl_deque.h:569:60: error: invalid application of ‘sizeof’ to incomplete type ‘torch::Tensor’
    569 |         _Traits::deallocate(_M_impl, __p, __deque_buf_size(sizeof(_Tp)));
        |                                                            ^~~~~~~~~~~
  /usr/include/c++/11/bits/stl_deque.h: In instantiation of ‘std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>::difference_type std::operator-(const _Self&, const _Self&)’:
  /usr/include/c++/11/bits/stl_deque.h:1234:40:   required from ‘std::deque<_Tp, _Alloc>::size_type std::deque<_Tp, _Alloc>::size() const [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::deque<_Tp, _Alloc>::size_type = long unsigned int]’
  /usr/include/c++/11/bits/deque.tcc:117:28:   required from ‘std::deque<_Tp, _Alloc>& std::deque<_Tp, _Alloc>::operator=(const std::deque<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:45:3:   required from here
  /usr/include/c++/11/bits/stl_deque.h:357:25: error: invalid use of incomplete type ‘class torch::Tensor’
    357 |           + (__x._M_cur - __x._M_first)
        |             ~~~~~~~~~~~~^~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/deque:67,
                   from /usr/include/c++/11/stack:60,
                   from /workspace/nunchaku/src/common.h:13,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_deque.h:358:26: error: invalid use of incomplete type ‘class torch::Tensor’
    358 |           + (__y._M_last - __y._M_cur);
        |             ~~~~~~~~~~~~~^~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/deque:67,
                   from /usr/include/c++/11/stack:60,
                   from /workspace/nunchaku/src/common.h:13,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_deque.h: In instantiation of ‘void std::deque<_Tp, _Alloc>::_M_destroy_data(std::deque<_Tp, _Alloc>::iterator, std::deque<_Tp, _Alloc>::iterator, const std::allocator<_CharT>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::deque<_Tp, _Alloc>::iterator = std::_Deque_base<torch::Tensor, std::allocator<torch::Tensor> >::iterator]’:
  /usr/include/c++/11/bits/stl_deque.h:2066:17:   required from ‘void std::deque<_Tp, _Alloc>::_M_erase_at_end(std::deque<_Tp, _Alloc>::iterator) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::deque<_Tp, _Alloc>::iterator = std::_Deque_base<torch::Tensor, std::allocator<torch::Tensor> >::iterator]’
  /usr/include/c++/11/bits/deque.tcc:119:6:   required from ‘std::deque<_Tp, _Alloc>& std::deque<_Tp, _Alloc>::operator=(const std::deque<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:45:3:   required from here
  /usr/include/c++/11/bits/stl_deque.h:2048:14: error: invalid use of incomplete type ‘std::deque<torch::Tensor>::value_type’ {aka ‘class torch::Tensor’}
   2048 |         if (!__has_trivial_destructor(value_type))
        |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘std::deque<torch::Tensor>::value_type’ {aka ‘class torch::Tensor’}
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/deque:67,
                   from /usr/include/c++/11/stack:60,
                   from /workspace/nunchaku/src/common.h:13,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_deque.h: In instantiation of ‘std::_Deque_iterator<_Tp, _Ref, _Ptr>::_Self& std::_Deque_iterator<_Tp, _Ref, _Ptr>::operator+=(std::_Deque_iterator<_Tp, _Ref, _Ptr>::difference_type) [with _Tp = torch::Tensor; _Ref = const torch::Tensor&; _Ptr = const torch::Tensor*; std::_Deque_iterator<_Tp, _Ref, _Ptr>::_Self = std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>::_Self; std::_Deque_iterator<_Tp, _Ref, _Ptr>::difference_type = long int]’:
  /usr/include/c++/11/bits/stl_deque.h:381:8:   required from ‘std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>::_Self std::operator+(const _Self&, std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>::difference_type)’
  /usr/include/c++/11/bits/deque.tcc:123:43:   required from ‘std::deque<_Tp, _Alloc>& std::deque<_Tp, _Alloc>::operator=(const std::deque<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:45:3:   required from here
  /usr/include/c++/11/bits/stl_deque.h:230:56: error: invalid use of incomplete type ‘class torch::Tensor’
    230 |         const difference_type __offset = __n + (_M_cur - _M_first);
        |                                                ~~~~~~~~^~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/deque:67,
                   from /usr/include/c++/11/stack:60,
                   from /workspace/nunchaku/src/common.h:13,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_deque.h:232:18: error: invalid use of incomplete type ‘class torch::Tensor’
    232 |           _M_cur += __n;
        |           ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/deque:67,
                   from /usr/include/c++/11/stack:60,
                   from /workspace/nunchaku/src/common.h:13,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_deque.h:240:31: error: invalid use of incomplete type ‘class torch::Tensor’
    240 |             _M_cur = _M_first + (__offset - __node_offset
        |                      ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~
    241 |                                  * difference_type(_S_buffer_size()));
        |                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/deque:67,
                   from /usr/include/c++/11/stack:60,
                   from /workspace/nunchaku/src/common.h:13,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_deque.h: In instantiation of ‘std::deque<_Tp, _Alloc>::iterator std::deque<_Tp, _Alloc>::_M_reserve_elements_at_front(std::deque<_Tp, _Alloc>::size_type) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::deque<_Tp, _Alloc>::iterator = std::_Deque_base<torch::Tensor, std::allocator<torch::Tensor> >::iterator; std::deque<_Tp, _Alloc>::size_type = long unsigned int]’:
  /usr/include/c++/11/bits/deque.tcc:606:29:   required from ‘void std::deque<_Tp, _Alloc>::_M_range_insert_aux(std::deque<_Tp, _Alloc>::iterator, _ForwardIterator, _ForwardIterator, std::forward_iterator_tag) [with _ForwardIterator = std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>; _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::deque<_Tp, _Alloc>::iterator = std::_Deque_base<torch::Tensor, std::allocator<torch::Tensor> >::iterator]’
  /usr/include/c++/11/bits/deque.tcc:125:27:   required from ‘std::deque<_Tp, _Alloc>& std::deque<_Tp, _Alloc>::operator=(const std::deque<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:45:3:   required from here
  /usr/include/c++/11/bits/stl_deque.h:2093:39: error: invalid use of incomplete type ‘class torch::Tensor’
   2092 |         const size_type __vacancies = this->_M_impl._M_start._M_cur
        |                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   2093 |                                       - this->_M_impl._M_start._M_first;
        |                                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/deque:67,
                   from /usr/include/c++/11/stack:60,
                   from /workspace/nunchaku/src/common.h:13,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_deque.h: In instantiation of ‘std::deque<_Tp, _Alloc>::iterator std::deque<_Tp, _Alloc>::_M_reserve_elements_at_back(std::deque<_Tp, _Alloc>::size_type) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::deque<_Tp, _Alloc>::iterator = std::_Deque_base<torch::Tensor, std::allocator<torch::Tensor> >::iterator; std::deque<_Tp, _Alloc>::size_type = long unsigned int]’:
  /usr/include/c++/11/bits/deque.tcc:622:30:   required from ‘void std::deque<_Tp, _Alloc>::_M_range_insert_aux(std::deque<_Tp, _Alloc>::iterator, _ForwardIterator, _ForwardIterator, std::forward_iterator_tag) [with _ForwardIterator = std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>; _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::deque<_Tp, _Alloc>::iterator = std::_Deque_base<torch::Tensor, std::allocator<torch::Tensor> >::iterator]’
  /usr/include/c++/11/bits/deque.tcc:125:27:   required from ‘std::deque<_Tp, _Alloc>& std::deque<_Tp, _Alloc>::operator=(const std::deque<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:45:3:   required from here
  /usr/include/c++/11/bits/stl_deque.h:2103:40: error: invalid use of incomplete type ‘class torch::Tensor’
   2102 |         const size_type __vacancies = (this->_M_impl._M_finish._M_last
        |                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   2103 |                                        - this->_M_impl._M_finish._M_cur) - 1;
        |                                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/cmath:42,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/cpp_type_traits.h: In instantiation of ‘struct std::__is_nonvolatile_trivially_copyable<torch::Tensor>’:
  /usr/include/c++/11/bits/cpp_type_traits.h:454:12:   required from ‘struct std::__memcpyable<torch::Tensor*, const torch::Tensor*>’
  /usr/include/c++/11/bits/stl_algobase.h:495:30:   required from ‘constexpr _OI std::__copy_move_a2(_II, _II, _OI) [with bool _IsMove = false; _II = const torch::Tensor*; _OI = torch::Tensor*]’
  /usr/include/c++/11/bits/stl_algobase.h:522:42:   required from ‘constexpr _OI std::__copy_move_a1(_II, _II, _OI) [with bool _IsMove = false; _II = const torch::Tensor*; _OI = torch::Tensor*]’
  /usr/include/c++/11/bits/stl_algobase.h:530:31:   required from ‘constexpr _OI std::__copy_move_a(_II, _II, _OI) [with bool _IsMove = false; _II = __gnu_cxx::__normal_iterator<const torch::Tensor*, std::vector<torch::Tensor> >; _OI = __gnu_cxx::__normal_iterator<torch::Tensor*, std::vector<torch::Tensor> >]’
  /usr/include/c++/11/bits/stl_algobase.h:620:7:   required from ‘constexpr _OI std::copy(_II, _II, _OI) [with _II = __gnu_cxx::__normal_iterator<const torch::Tensor*, std::vector<torch::Tensor> >; _OI = __gnu_cxx::__normal_iterator<torch::Tensor*, std::vector<torch::Tensor> >]’
  /usr/include/c++/11/bits/vector.tcc:238:31:   required from ‘std::vector<_Tp, _Alloc>& std::vector<_Tp, _Alloc>::operator=(const std::vector<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/optional:168:19:   required from ‘constexpr void std::_Optional_payload_base<_Tp>::_M_copy_assign(const std::_Optional_payload_base<_Tp>&) [with _Tp = std::vector<torch::Tensor>]’
  /usr/include/c++/11/optional:371:22:   required from ‘constexpr std::_Optional_payload<_Tp, true, false, false>& std::_Optional_payload<_Tp, true, false, false>::operator=(const std::_Optional_payload<_Tp, true, false, false>&) [with _Tp = std::vector<torch::Tensor>]’
  /usr/include/c++/11/optional:397:26:   required from here
  /usr/include/c++/11/bits/cpp_type_traits.h:429:24: error: invalid use of incomplete type ‘class torch::Tensor’
    429 |       enum { __value = __is_trivially_copyable(_Tp) };
        |                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_algobase.h: In instantiation of ‘static constexpr _OI std::__copy_move<false, false, std::random_access_iterator_tag>::__copy_m(_II, _II, _OI) [with _II = const torch::Tensor*; _OI = torch::Tensor*]’:
  /usr/include/c++/11/bits/stl_algobase.h:492:12:   required from ‘constexpr _OI std::__copy_move_a2(_II, _II, _OI) [with bool _IsMove = false; _II = const torch::Tensor*; _OI = torch::Tensor*]’
  /usr/include/c++/11/bits/stl_algobase.h:522:42:   required from ‘constexpr _OI std::__copy_move_a1(_II, _II, _OI) [with bool _IsMove = false; _II = const torch::Tensor*; _OI = torch::Tensor*]’
  /usr/include/c++/11/bits/stl_algobase.h:530:31:   required from ‘constexpr _OI std::__copy_move_a(_II, _II, _OI) [with bool _IsMove = false; _II = __gnu_cxx::__normal_iterator<const torch::Tensor*, std::vector<torch::Tensor> >; _OI = __gnu_cxx::__normal_iterator<torch::Tensor*, std::vector<torch::Tensor> >]’
  /usr/include/c++/11/bits/stl_algobase.h:620:7:   required from ‘constexpr _OI std::copy(_II, _II, _OI) [with _II = __gnu_cxx::__normal_iterator<const torch::Tensor*, std::vector<torch::Tensor> >; _OI = __gnu_cxx::__normal_iterator<torch::Tensor*, std::vector<torch::Tensor> >]’
  /usr/include/c++/11/bits/vector.tcc:238:31:   required from ‘std::vector<_Tp, _Alloc>& std::vector<_Tp, _Alloc>::operator=(const std::vector<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/optional:168:19:   required from ‘constexpr void std::_Optional_payload_base<_Tp>::_M_copy_assign(const std::_Optional_payload_base<_Tp>&) [with _Tp = std::vector<torch::Tensor>]’
  /usr/include/c++/11/optional:371:22:   required from ‘constexpr std::_Optional_payload<_Tp, true, false, false>& std::_Optional_payload<_Tp, true, false, false>::operator=(const std::_Optional_payload<_Tp, true, false, false>&) [with _Tp = std::vector<torch::Tensor>]’
  /usr/include/c++/11/optional:397:26:   required from here
  /usr/include/c++/11/bits/stl_algobase.h:383:38: error: invalid use of incomplete type ‘const class torch::Tensor’
    383 |           for(_Distance __n = __last - __first; __n > 0; --__n)
        |                               ~~~~~~~^~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_algobase.h:385:25: error: invalid use of incomplete type ‘class torch::Tensor’
    385 |               *__result = *__first;
        |               ~~~~~~~~~~^~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_algobase.h:386:17: error: cannot increment a pointer to incomplete type ‘const torch::Tensor’
    386 |               ++__first;
        |                 ^~~~~~~
  /usr/include/c++/11/bits/stl_algobase.h:387:17: error: cannot increment a pointer to incomplete type ‘torch::Tensor’
    387 |               ++__result;
        |                 ^~~~~~~~
  /usr/include/c++/11/bits/stl_algobase.h: In instantiation of ‘constexpr _From std::__niter_wrap(_From, _To) [with _From = __gnu_cxx::__normal_iterator<torch::Tensor*, std::vector<torch::Tensor> >; _To = torch::Tensor*]’:
  /usr/include/c++/11/bits/stl_algobase.h:529:31:   required from ‘constexpr _OI std::__copy_move_a(_II, _II, _OI) [with bool _IsMove = false; _II = __gnu_cxx::__normal_iterator<const torch::Tensor*, std::vector<torch::Tensor> >; _OI = __gnu_cxx::__normal_iterator<torch::Tensor*, std::vector<torch::Tensor> >]’
  /usr/include/c++/11/bits/stl_algobase.h:620:7:   required from ‘constexpr _OI std::copy(_II, _II, _OI) [with _II = __gnu_cxx::__normal_iterator<const torch::Tensor*, std::vector<torch::Tensor> >; _OI = __gnu_cxx::__normal_iterator<torch::Tensor*, std::vector<torch::Tensor> >]’
  /usr/include/c++/11/bits/vector.tcc:238:31:   required from ‘std::vector<_Tp, _Alloc>& std::vector<_Tp, _Alloc>::operator=(const std::vector<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/optional:168:19:   required from ‘constexpr void std::_Optional_payload_base<_Tp>::_M_copy_assign(const std::_Optional_payload_base<_Tp>&) [with _Tp = std::vector<torch::Tensor>]’
  /usr/include/c++/11/optional:371:22:   required from ‘constexpr std::_Optional_payload<_Tp, true, false, false>& std::_Optional_payload<_Tp, true, false, false>::operator=(const std::_Optional_payload<_Tp, true, false, false>&) [with _Tp = std::vector<torch::Tensor>]’
  /usr/include/c++/11/optional:397:26:   required from here
  /usr/include/c++/11/bits/stl_algobase.h:329:30: error: invalid use of incomplete type ‘class torch::Tensor’
    329 |     { return __from + (__res - std::__niter_base(__from)); }
        |                       ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_algobase.h: In instantiation of ‘static constexpr _OI std::__copy_move<false, false, std::random_access_iterator_tag>::__copy_m(_II, _II, _OI) [with _II = torch::Tensor*; _OI = torch::Tensor*]’:
  /usr/include/c++/11/bits/stl_algobase.h:492:12:   required from ‘constexpr _OI std::__copy_move_a2(_II, _II, _OI) [with bool _IsMove = false; _II = torch::Tensor*; _OI = torch::Tensor*]’
  /usr/include/c++/11/bits/stl_algobase.h:522:42:   required from ‘constexpr _OI std::__copy_move_a1(_II, _II, _OI) [with bool _IsMove = false; _II = torch::Tensor*; _OI = torch::Tensor*]’
  /usr/include/c++/11/bits/stl_algobase.h:530:31:   required from ‘constexpr _OI std::__copy_move_a(_II, _II, _OI) [with bool _IsMove = false; _II = torch::Tensor*; _OI = torch::Tensor*]’
  /usr/include/c++/11/bits/stl_algobase.h:620:7:   required from ‘constexpr _OI std::copy(_II, _II, _OI) [with _II = torch::Tensor*; _OI = torch::Tensor*]’
  /usr/include/c++/11/bits/vector.tcc:243:17:   required from ‘std::vector<_Tp, _Alloc>& std::vector<_Tp, _Alloc>::operator=(const std::vector<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/optional:168:19:   required from ‘constexpr void std::_Optional_payload_base<_Tp>::_M_copy_assign(const std::_Optional_payload_base<_Tp>&) [with _Tp = std::vector<torch::Tensor>]’
  /usr/include/c++/11/optional:371:22:   required from ‘constexpr std::_Optional_payload<_Tp, true, false, false>& std::_Optional_payload<_Tp, true, false, false>::operator=(const std::_Optional_payload<_Tp, true, false, false>&) [with _Tp = std::vector<torch::Tensor>]’
  /usr/include/c++/11/optional:397:26:   required from here
  /usr/include/c++/11/bits/stl_algobase.h:383:38: error: invalid use of incomplete type ‘class torch::Tensor’
    383 |           for(_Distance __n = __last - __first; __n > 0; --__n)
        |                               ~~~~~~~^~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_algobase.h:385:25: error: invalid use of incomplete type ‘class torch::Tensor’
    385 |               *__result = *__first;
        |               ~~~~~~~~~~^~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_algobase.h:386:17: error: cannot increment a pointer to incomplete type ‘torch::Tensor’
    386 |               ++__first;
        |                 ^~~~~~~
  /usr/include/c++/11/bits/stl_algobase.h:387:17: error: cannot increment a pointer to incomplete type ‘torch::Tensor’
    387 |               ++__result;
        |                 ^~~~~~~~
  In file included from /usr/include/c++/11/bits/move.h:57,
                   from /usr/include/c++/11/bits/stl_pair.h:59,
                   from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::is_base_of<pybind11::detail::pyobject_tag, torch::Tensor>’:
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/cast.h:1592:68:   recursively required by substitution of ‘template<class T> class pybind11::detail::type_caster<T, typename std::enable_if<std::is_base_of<pybind11::detail::pyobject_tag, typename std::remove_reference<_Tp>::type>::value, void>::type> [with T = torch::Tensor]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/cast.h:1592:68:   required from ‘constexpr const auto pybind11::detail::argument_loader<GEMM_W4A4&, torch::Tensor>::arg_names’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/cast.h:1591:27:   required from ‘class pybind11::detail::argument_loader<GEMM_W4A4&, torch::Tensor>’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:245:43:   required from ‘void pybind11::cpp_function::initialize(Func&&, Return (*)(Args ...), const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, torch::Tensor)>; Return = at::Tensor; Args = {GEMM_W4A4&, torch::Tensor}; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg}]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:127:19:   required from ‘pybind11::cpp_function::cpp_function(Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, torch::Tensor)>; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg}; <template-parameter-1-3> = void]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:1621:22:   required from ‘pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >& pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >::def(const char*, Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, torch::Tensor)>; Extra = {pybind11::arg}; type_ = GEMM_W4A4; options = {}]’
  /workspace/nunchaku/nunchaku/csrc/pybind.cpp:50:13:   required from here
  /usr/include/c++/11/type_traits:1422:38: error: invalid use of incomplete type ‘class torch::Tensor’
   1422 |     : public integral_constant<bool, __is_base_of(_Base, _Derived)>
        |                                      ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/cast.h:14,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/attr.h:14,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/detail/class.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/Exceptions.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:9,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/detail/descr.h: In instantiation of ‘static constexpr std::array<const std::type_info*, (sizeof... (Ts) + 1)> pybind11::detail::descr<N, Ts>::types() [with long unsigned int N = 26; Ts = {GEMM_W4A4, torch::Tensor}]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:324:73:   required from ‘void pybind11::cpp_function::initialize(Func&&, Return (*)(Args ...), const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, torch::Tensor)>; Return = at::Tensor; Args = {GEMM_W4A4&, torch::Tensor}; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg}]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:127:19:   required from ‘pybind11::cpp_function::cpp_function(Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, torch::Tensor)>; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg}; <template-parameter-1-3> = void]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:1621:22:   required from ‘pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >& pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >::def(const char*, Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, torch::Tensor)>; Extra = {pybind11::arg}; type_ = GEMM_W4A4; options = {}]’
  /workspace/nunchaku/nunchaku/csrc/pybind.cpp:50:13:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/detail/descr.h:40:19: error: invalid use of incomplete type ‘class torch::Tensor’
     40 |         return {{&typeid(Ts)..., nullptr}};
        |                   ^~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/cast.h:14,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/attr.h:14,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/detail/class.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/Exceptions.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:9,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/detail/descr.h:40:42: error: could not convert ‘{{<expression error>, nullptr}}’ from ‘<brace-enclosed initializer list>’ to ‘std::array<const std::type_info*, 3>’
     40 |         return {{&typeid(Ts)..., nullptr}};
        |                                          ^
        |                                          |
        |                                          <brace-enclosed initializer list>
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/Exceptions.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:9,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h: In instantiation of ‘void pybind11::cpp_function::initialize(Func&&, Return (*)(Args ...), const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, torch::Tensor)>; Return = at::Tensor; Args = {GEMM_W4A4&, torch::Tensor}; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg}]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:127:19:   required from ‘pybind11::cpp_function::cpp_function(Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, torch::Tensor)>; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg}; <template-parameter-1-3> = void]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:1621:22:   required from ‘pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >& pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >::def(const char*, Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, torch::Tensor)>; Extra = {pybind11::arg}; type_ = GEMM_W4A4; options = {}]’
  /workspace/nunchaku/nunchaku/csrc/pybind.cpp:50:13:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:324:73:   in ‘constexpr’ expansion of ‘pybind11::detail::descr<26, GEMM_W4A4, torch::Tensor>::types()’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:324:39: error: ‘constexpr’ call flows off the end of the function
    324 |         PYBIND11_DESCR_CONSTEXPR auto types = decltype(signature)::types();
        |                                       ^~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/cast.h:14,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/attr.h:14,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/detail/class.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/Exceptions.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:9,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/detail/descr.h: In instantiation of ‘static constexpr std::array<const std::type_info*, (sizeof... (Ts) + 1)> pybind11::detail::descr<N, Ts>::types() [with long unsigned int N = 37; Ts = {GEMM_W4A4, torch::Tensor}]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:324:73:   required from ‘void pybind11::cpp_function::initialize(Func&&, Return (*)(Args ...), const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Return = void; Args = {GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor> > >&, bool}; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg_v}]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:127:19:   required from ‘pybind11::cpp_function::cpp_function(Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg_v}; <template-parameter-1-3> = void]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:1621:22:   required from ‘pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >& pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >::def(const char*, Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Extra = {pybind11::arg, pybind11::arg_v}; type_ = GEMM_W4A4; options = {}]’
  /workspace/nunchaku/nunchaku/csrc/pybind.cpp:55:13:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/detail/descr.h:40:19: error: invalid use of incomplete type ‘class torch::Tensor’
     40 |         return {{&typeid(Ts)..., nullptr}};
        |                   ^~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/cast.h:14,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/attr.h:14,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/detail/class.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/Exceptions.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:9,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/detail/descr.h:40:42: error: could not convert ‘{{<expression error>, nullptr}}’ from ‘<brace-enclosed initializer list>’ to ‘std::array<const std::type_info*, 3>’
     40 |         return {{&typeid(Ts)..., nullptr}};
        |                                          ^
        |                                          |
        |                                          <brace-enclosed initializer list>
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/Exceptions.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h:11,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:9,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h: In instantiation of ‘void pybind11::cpp_function::initialize(Func&&, Return (*)(Args ...), const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Return = void; Args = {GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor> > >&, bool}; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg_v}]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:127:19:   required from ‘pybind11::cpp_function::cpp_function(Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg_v}; <template-parameter-1-3> = void]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:1621:22:   required from ‘pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >& pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >::def(const char*, Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Extra = {pybind11::arg, pybind11::arg_v}; type_ = GEMM_W4A4; options = {}]’
  /workspace/nunchaku/nunchaku/csrc/pybind.cpp:55:13:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:324:73:   in ‘constexpr’ expansion of ‘pybind11::detail::descr<37, GEMM_W4A4, torch::Tensor>::types()’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:324:39: error: ‘constexpr’ call flows off the end of the function
    324 |         PYBIND11_DESCR_CONSTEXPR auto types = decltype(signature)::types();
        |                                       ^~~~~
  In file included from /usr/include/c++/11/bits/stl_iterator.h:85,
                   from /usr/include/c++/11/bits/stl_algobase.h:67,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_construct.h: In instantiation of ‘static constexpr void std::_Destroy_aux<<anonymous> >::__destroy(_ForwardIterator, _ForwardIterator) [with _ForwardIterator = torch::Tensor*; bool <anonymous> = false]’:
  /usr/include/c++/11/bits/stl_construct.h:193:39:   required from ‘constexpr void std::_Destroy(_ForwardIterator, _ForwardIterator) [with _ForwardIterator = torch::Tensor*]’
  /usr/include/c++/11/bits/alloc_traits.h:848:15:   required from ‘void std::_Destroy(_ForwardIterator, _ForwardIterator, std::allocator<_T2>&) [with _ForwardIterator = torch::Tensor*; _Tp = torch::Tensor]’
  /usr/include/c++/11/bits/stl_vector.h:680:15:   required from ‘std::vector<_Tp, _Alloc>::~vector() [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:20:32:   required from here
  /usr/include/c++/11/bits/stl_construct.h:162:39: error: cannot increment a pointer to incomplete type ‘torch::Tensor’
    162 |           for (; __first != __last; ++__first)
        |                                       ^~~~~~~
  In file included from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_algobase.h: In instantiation of ‘static constexpr _OI std::__copy_move<true, false, std::random_access_iterator_tag>::__copy_m(_II, _II, _OI) [with _II = torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item*; _OI = torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item*]’:
  /usr/include/c++/11/bits/stl_algobase.h:492:12:   required from ‘constexpr _OI std::__copy_move_a2(_II, _II, _OI) [with bool _IsMove = true; _II = torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item*; _OI = torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item*]’
  /usr/include/c++/11/bits/stl_algobase.h:522:42:   required from ‘constexpr _OI std::__copy_move_a1(_II, _II, _OI) [with bool _IsMove = true; _II = torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item*; _OI = torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item*]’
  /usr/include/c++/11/bits/stl_algobase.h:530:31:   required from ‘constexpr _OI std::__copy_move_a(_II, _II, _OI) [with bool _IsMove = true; _II = __gnu_cxx::__normal_iterator<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item*, std::vector<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item, std::allocator<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item> > >; _OI = __gnu_cxx::__normal_iterator<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item*, std::vector<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item, std::allocator<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item> > >]’
  /usr/include/c++/11/bits/stl_algobase.h:652:38:   required from ‘constexpr _OI std::move(_II, _II, _OI) [with _II = __gnu_cxx::__normal_iterator<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item*, std::vector<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item, std::allocator<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item> > >; _OI = __gnu_cxx::__normal_iterator<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item*, std::vector<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item, std::allocator<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item> > >]’
  /usr/include/c++/11/bits/vector.tcc:175:2:   required from ‘std::vector<_Tp, _Alloc>::iterator std::vector<_Tp, _Alloc>::_M_erase(std::vector<_Tp, _Alloc>::iterator) [with _Tp = torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item; _Alloc = std::allocator<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item>; std::vector<_Tp, _Alloc>::iterator = std::vector<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item, std::allocator<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item> >::iterator]’
  /usr/include/c++/11/bits/stl_vector.h:1431:24:   required from ‘std::vector<_Tp, _Alloc>::iterator std::vector<_Tp, _Alloc>::erase(std::vector<_Tp, _Alloc>::const_iterator) [with _Tp = torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item; _Alloc = std::allocator<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item>; std::vector<_Tp, _Alloc>::iterator = std::vector<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item, std::allocator<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item> >::iterator; std::vector<_Tp, _Alloc>::const_iterator = std::vector<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item, std::allocator<torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item> >::const_iterator]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/ordered_dict.h:422:15:   required from ‘void torch::OrderedDict<Key, Value>::erase(const Key&) [with Key = std::__cxx11::basic_string<char>; Value = torch::Tensor]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/parameterdict.h:52:22:   required from here
  /usr/include/c++/11/bits/stl_algobase.h:405:25: error: use of deleted function ‘torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item& torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item::operator=(torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item&&)’
    405 |               *__result = std::move(*__first);
        |               ~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/jit/api/module.h:12,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/serialize/input-archive.h:5,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/serialize/archive.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/samplers/serialize.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/samplers.h:8,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets/chunk.h:6,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/datasets.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data.h:4,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/ordered_dict.h:194:32: note: ‘torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item& torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item::operator=(torch::OrderedDict<std::__cxx11::basic_string<char>, torch::Tensor>::Item&&)’ is implicitly deleted because the default definition would be ill-formed:
    194 | class OrderedDict<Key, Value>::Item {
        |                                ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/ordered_dict.h:194:32: error: use of deleted function ‘std::pair<std::__cxx11::basic_string<char>, torch::Tensor>& std::pair<std::__cxx11::basic_string<char>, torch::Tensor>::operator=(const std::pair<std::__cxx11::basic_string<char>, torch::Tensor>&)’
  In file included from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_pair.h:211:12: note: ‘std::pair<std::__cxx11::basic_string<char>, torch::Tensor>& std::pair<std::__cxx11::basic_string<char>, torch::Tensor>::operator=(const std::pair<std::__cxx11::basic_string<char>, torch::Tensor>&)’ is implicitly declared as deleted because ‘std::pair<std::__cxx11::basic_string<char>, torch::Tensor>’ declares a move constructor or move assignment operator
    211 |     struct pair
        |            ^~~~
  In file included from /usr/include/c++/11/deque:67,
                   from /usr/include/c++/11/stack:60,
                   from /workspace/nunchaku/src/common.h:13,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_deque.h: In instantiation of ‘static std::size_t std::_Deque_iterator<_Tp, _Ref, _Ptr>::_S_buffer_size() [with _Tp = torch::Tensor; _Ref = torch::Tensor&; _Ptr = torch::Tensor*; std::size_t = long unsigned int]’:
  /usr/include/c++/11/bits/stl_deque.h:355:39:   required from ‘std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>::difference_type std::operator-(const _Self&, const _Self&)’
  /usr/include/c++/11/bits/stl_deque.h:1234:40:   required from ‘std::deque<_Tp, _Alloc>::size_type std::deque<_Tp, _Alloc>::size() const [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::deque<_Tp, _Alloc>::size_type = long unsigned int]’
  /usr/include/c++/11/bits/deque.tcc:117:28:   required from ‘std::deque<_Tp, _Alloc>& std::deque<_Tp, _Alloc>::operator=(const std::deque<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:45:3:   required from here
  /usr/include/c++/11/bits/stl_deque.h:132:33: error: invalid application of ‘sizeof’ to incomplete type ‘torch::Tensor’
    132 |       { return __deque_buf_size(sizeof(_Tp)); }
        |                                 ^~~~~~~~~~~
  In file included from /usr/include/c++/11/memory:66,
                   from /workspace/nunchaku/src/common.h:9,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_uninitialized.h: In instantiation of ‘_ForwardIterator std::uninitialized_copy(_InputIterator, _InputIterator, _ForwardIterator) [with _InputIterator = std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>; _ForwardIterator = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>]’:
  /usr/include/c++/11/bits/stl_uninitialized.h:333:37:   required from ‘_ForwardIterator std::__uninitialized_copy_a(_InputIterator, _InputIterator, _ForwardIterator, std::allocator<_Tp>&) [with _InputIterator = std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>; _ForwardIterator = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>; _Tp = torch::Tensor]’
  /usr/include/c++/11/bits/deque.tcc:609:30:   required from ‘void std::deque<_Tp, _Alloc>::_M_range_insert_aux(std::deque<_Tp, _Alloc>::iterator, _ForwardIterator, _ForwardIterator, std::forward_iterator_tag) [with _ForwardIterator = std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>; _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::deque<_Tp, _Alloc>::iterator = std::_Deque_base<torch::Tensor, std::allocator<torch::Tensor> >::iterator]’
  /usr/include/c++/11/bits/deque.tcc:125:27:   required from ‘std::deque<_Tp, _Alloc>& std::deque<_Tp, _Alloc>::operator=(const std::deque<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:45:3:   required from here
  /usr/include/c++/11/bits/stl_uninitialized.h:138:72: error: static assertion failed: result type must be constructible from value type of input range
    138 |       static_assert(is_constructible<_ValueType2, decltype(*__first)>::value,
        |                                                                        ^~~~~
  /usr/include/c++/11/bits/stl_uninitialized.h:138:72: note: ‘std::integral_constant<bool, false>::value’ evaluates to false
  /usr/include/c++/11/bits/stl_uninitialized.h:148:40: error: invalid use of incomplete type ‘using value_type = std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>::value_type’ {aka ‘class torch::Tensor’}
    148 |       return std::__uninitialized_copy<__is_trivial(_ValueType1)
        |                                        ^~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘using value_type = std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>::value_type’ {aka ‘class torch::Tensor’}
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/memory:66,
                   from /workspace/nunchaku/src/common.h:9,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_uninitialized.h:149:43: error: invalid use of incomplete type ‘using value_type = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>::value_type’ {aka ‘class torch::Tensor’}
    149 |                                        && __is_trivial(_ValueType2)
        |                                           ^~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘using value_type = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>::value_type’ {aka ‘class torch::Tensor’}
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/vector:67,
                   from /workspace/nunchaku/src/common.h:11,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_vector.h: In instantiation of ‘void std::vector<_Tp, _Alloc>::_M_erase_at_end(std::vector<_Tp, _Alloc>::pointer) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::vector<_Tp, _Alloc>::pointer = torch::Tensor*]’:
  /usr/include/c++/11/bits/stl_vector.h:1499:9:   required from ‘void std::vector<_Tp, _Alloc>::clear() [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/bits/vector.tcc:211:11:   required from ‘std::vector<_Tp, _Alloc>& std::vector<_Tp, _Alloc>::operator=(const std::vector<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/optional:168:19:   required from ‘constexpr void std::_Optional_payload_base<_Tp>::_M_copy_assign(const std::_Optional_payload_base<_Tp>&) [with _Tp = std::vector<torch::Tensor>]’
  /usr/include/c++/11/optional:371:22:   required from ‘constexpr std::_Optional_payload<_Tp, true, false, false>& std::_Optional_payload<_Tp, true, false, false>::operator=(const std::_Optional_payload<_Tp, true, false, false>&) [with _Tp = std::vector<torch::Tensor>]’
  /usr/include/c++/11/optional:397:26:   required from here
  /usr/include/c++/11/bits/stl_vector.h:1794:53: error: invalid use of incomplete type ‘class torch::Tensor’
   1794 |         if (size_type __n = this->_M_impl._M_finish - __pos)
        |                             ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/unique_ptr.h:37,
                   from /usr/include/c++/11/memory:76,
                   from /workspace/nunchaku/src/common.h:9,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/tuple: In instantiation of ‘constexpr std::_Tuple_impl<_Idx, _Head>::_Tuple_impl(std::_Tuple_impl<_Idx, _Head>&&) [with long unsigned int _Idx = 1; _Head = torch::Tensor]’:
  /usr/include/c++/11/tuple:301:7:   required from ‘constexpr void std::_Construct(_Tp*, _Args&& ...) [with _Tp = std::tuple<torch::Tensor, torch::Tensor>; _Args = {std::tuple<torch::Tensor, torch::Tensor>}]’
  /usr/include/c++/11/optional:251:19:   required from ‘constexpr void std::_Optional_payload_base<_Tp>::_M_construct(_Args&& ...) [with _Args = {std::tuple<torch::Tensor, torch::Tensor>}; _Tp = std::tuple<torch::Tensor, torch::Tensor>]’
  /usr/include/c++/11/optional:146:22:   required from ‘constexpr std::_Optional_payload_base<_Tp>::_Optional_payload_base(bool, std::_Optional_payload_base<_Tp>&&) [with _Tp = std::tuple<torch::Tensor, torch::Tensor>]’
  /usr/include/c++/11/optional:359:42:   required from ‘constexpr std::_Optional_base<_Tp, true, false>::_Optional_base(std::_Optional_base<_Tp, true, false>&&) [with _Tp = std::tuple<torch::Tensor, torch::Tensor>]’
  /usr/include/c++/11/optional:662:11:   required from ‘torch::nn::AnyValue::Holder<T>::Holder(U&&) [with U = std::optional<std::tuple<torch::Tensor, torch::Tensor> >; <template-parameter-2-2> = void; T = std::optional<std::tuple<torch::Tensor, torch::Tensor> >]’
  /usr/include/c++/11/bits/unique_ptr.h:962:30:   required from ‘typename std::_MakeUniq<_Tp>::__single_object std::make_unique(_Args&& ...) [with _Tp = torch::nn::AnyValue::Holder<std::optional<std::tuple<torch::Tensor, torch::Tensor> > >; _Args = {std::optional<std::tuple<torch::Tensor, torch::Tensor> >}; typename std::_MakeUniq<_Tp>::__single_object = std::unique_ptr<torch::nn::AnyValue::Holder<std::optional<std::tuple<torch::Tensor, torch::Tensor> > >, std::default_delete<torch::nn::AnyValue::Holder<std::optional<std::tuple<torch::Tensor, torch::Tensor> > > > >]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_value.h:38:54:   required from ‘torch::nn::AnyValue::AnyValue(T&&) [with T = std::optional<std::tuple<torch::Tensor, torch::Tensor> >; <template-parameter-1-2> = void]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:164:3:   required from here
  /usr/include/c++/11/tuple:69:28: error: invalid use of incomplete type ‘class torch::Tensor’
     69 |     = typename conditional<__is_final(_Tp), false_type,
        |                            ^~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/deque:67,
                   from /usr/include/c++/11/stack:60,
                   from /workspace/nunchaku/src/common.h:13,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_deque.h: In instantiation of ‘void std::_Deque_base<_Tp, _Alloc>::_M_initialize_map(std::size_t) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::size_t = long unsigned int]’:
  /usr/include/c++/11/bits/stl_deque.h:447:9:   required from ‘std::_Deque_base<_Tp, _Alloc>::_Deque_base(const allocator_type&, std::size_t) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::_Deque_base<_Tp, _Alloc>::allocator_type = std::allocator<torch::Tensor>; std::size_t = long unsigned int]’
  /usr/include/c++/11/bits/stl_deque.h:916:30:   required from ‘std::deque<_Tp, _Alloc>::deque(const std::deque<_Tp, _Alloc>&, const allocator_type&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::deque<_Tp, _Alloc>::allocator_type = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/bits/stl_deque.h:2177:8:   required from ‘void std::deque<_Tp, _Alloc>::_M_replace_map(_Args&& ...) [with _Args = {const std::deque<torch::Tensor, std::allocator<torch::Tensor> >&, std::allocator<torch::Tensor>}; _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/bits/deque.tcc:108:19:   required from ‘std::deque<_Tp, _Alloc>& std::deque<_Tp, _Alloc>::operator=(const std::deque<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:45:3:   required from here
  /usr/include/c++/11/bits/stl_deque.h:620:69: error: invalid application of ‘sizeof’ to incomplete type ‘torch::Tensor’
    620 |       const size_t __num_nodes = (__num_elements / __deque_buf_size(sizeof(_Tp))
        |                                                                     ^~~~~~~~~~~
  /usr/include/c++/11/bits/stl_deque.h:651:60: error: invalid application of ‘sizeof’ to incomplete type ‘torch::Tensor’
    651 |                                         % __deque_buf_size(sizeof(_Tp)));
        |                                                            ^~~~~~~~~~~
  In file included from /usr/include/c++/11/bits/stl_iterator.h:85,
                   from /usr/include/c++/11/bits/stl_algobase.h:67,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_construct.h: In instantiation of ‘constexpr void std::destroy_at(_Tp*) [with _Tp = torch::Tensor]’:
  /usr/include/c++/11/bits/stl_construct.h:149:22:   required from ‘constexpr void std::_Destroy(_Tp*) [with _Tp = torch::Tensor]’
  /usr/include/c++/11/bits/stl_construct.h:163:19:   required from ‘static constexpr void std::_Destroy_aux<<anonymous> >::__destroy(_ForwardIterator, _ForwardIterator) [with _ForwardIterator = torch::Tensor*; bool <anonymous> = false]’
  /usr/include/c++/11/bits/stl_construct.h:193:39:   required from ‘constexpr void std::_Destroy(_ForwardIterator, _ForwardIterator) [with _ForwardIterator = torch::Tensor*]’
  /usr/include/c++/11/bits/alloc_traits.h:848:15:   required from ‘void std::_Destroy(_ForwardIterator, _ForwardIterator, std::allocator<_T2>&) [with _ForwardIterator = torch::Tensor*; _Tp = torch::Tensor]’
  /usr/include/c++/11/bits/stl_vector.h:680:15:   required from ‘std::vector<_Tp, _Alloc>::~vector() [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/data/transforms/stack.h:20:32:   required from here
  /usr/include/c++/11/bits/stl_construct.h:88:22: error: invalid use of incomplete type ‘class torch::Tensor’
     88 |         __location->~_Tp();
        |         ~~~~~~~~~~~~~^~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/move.h:57,
                   from /usr/include/c++/11/bits/stl_pair.h:59,
                   from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::is_constructible<torch::Tensor, torch::Tensor&&>’:
  /usr/include/c++/11/bits/stl_uninitialized.h:138:72:   required from ‘_ForwardIterator std::uninitialized_copy(_InputIterator, _InputIterator, _ForwardIterator) [with _InputIterator = std::move_iterator<std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*> >; _ForwardIterator = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>]’
  /usr/include/c++/11/bits/stl_uninitialized.h:333:37:   required from ‘_ForwardIterator std::__uninitialized_copy_a(_InputIterator, _InputIterator, _ForwardIterator, std::allocator<_Tp>&) [with _InputIterator = std::move_iterator<std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*> >; _ForwardIterator = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>; _Tp = torch::Tensor]’
  /usr/include/c++/11/bits/stl_uninitialized.h:341:41:   required from ‘_ForwardIterator std::__uninitialized_move_a(_InputIterator, _InputIterator, _ForwardIterator, _Allocator&) [with _InputIterator = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>; _ForwardIterator = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>; _Allocator = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/bits/deque.tcc:789:34:   required from ‘void std::deque<_Tp, _Alloc>::_M_insert_aux(std::deque<_Tp, _Alloc>::iterator, _ForwardIterator, _ForwardIterator, std::deque<_Tp, _Alloc>::size_type) [with _ForwardIterator = std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>; _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::deque<_Tp, _Alloc>::iterator = std::_Deque_base<torch::Tensor, std::allocator<torch::Tensor> >::iterator; std::deque<_Tp, _Alloc>::size_type = long unsigned int]’
  /usr/include/c++/11/bits/deque.tcc:638:17:   required from ‘void std::deque<_Tp, _Alloc>::_M_range_insert_aux(std::deque<_Tp, _Alloc>::iterator, _ForwardIterator, _ForwardIterator, std::forward_iterator_tag) [with _ForwardIterator = std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>; _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::deque<_Tp, _Alloc>::iterator = std::_Deque_base<torch::Tensor, std::allocator<torch::Tensor> >::iterator]’
  /usr/include/c++/11/bits/deque.tcc:125:27:   required from ‘std::deque<_Tp, _Alloc>& std::deque<_Tp, _Alloc>::operator=(const std::deque<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:45:3:   required from here
  /usr/include/c++/11/type_traits:955:52: error: static assertion failed: template argument must be a complete class or an unbounded array
    955 |       static_assert(std::__is_complete_or_unbounded(__type_identity<_Tp>{}),
        |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/type_traits:955:52: note: ‘std::__is_complete_or_unbounded<std::__type_identity<torch::Tensor> >((std::__type_identity<torch::Tensor>{}, std::__type_identity<torch::Tensor>()))’ evaluates to false
  In file included from /usr/include/c++/11/memory:66,
                   from /workspace/nunchaku/src/common.h:9,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_uninitialized.h: In instantiation of ‘_ForwardIterator std::uninitialized_copy(_InputIterator, _InputIterator, _ForwardIterator) [with _InputIterator = std::move_iterator<std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*> >; _ForwardIterator = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>]’:
  /usr/include/c++/11/bits/stl_uninitialized.h:333:37:   required from ‘_ForwardIterator std::__uninitialized_copy_a(_InputIterator, _InputIterator, _ForwardIterator, std::allocator<_Tp>&) [with _InputIterator = std::move_iterator<std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*> >; _ForwardIterator = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>; _Tp = torch::Tensor]’
  /usr/include/c++/11/bits/stl_uninitialized.h:341:41:   required from ‘_ForwardIterator std::__uninitialized_move_a(_InputIterator, _InputIterator, _ForwardIterator, _Allocator&) [with _InputIterator = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>; _ForwardIterator = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>; _Allocator = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/bits/deque.tcc:789:34:   required from ‘void std::deque<_Tp, _Alloc>::_M_insert_aux(std::deque<_Tp, _Alloc>::iterator, _ForwardIterator, _ForwardIterator, std::deque<_Tp, _Alloc>::size_type) [with _ForwardIterator = std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>; _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::deque<_Tp, _Alloc>::iterator = std::_Deque_base<torch::Tensor, std::allocator<torch::Tensor> >::iterator; std::deque<_Tp, _Alloc>::size_type = long unsigned int]’
  /usr/include/c++/11/bits/deque.tcc:638:17:   required from ‘void std::deque<_Tp, _Alloc>::_M_range_insert_aux(std::deque<_Tp, _Alloc>::iterator, _ForwardIterator, _ForwardIterator, std::forward_iterator_tag) [with _ForwardIterator = std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>; _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::deque<_Tp, _Alloc>::iterator = std::_Deque_base<torch::Tensor, std::allocator<torch::Tensor> >::iterator]’
  /usr/include/c++/11/bits/deque.tcc:125:27:   required from ‘std::deque<_Tp, _Alloc>& std::deque<_Tp, _Alloc>::operator=(const std::deque<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:45:3:   required from here
  /usr/include/c++/11/bits/stl_uninitialized.h:138:72: error: static assertion failed: result type must be constructible from value type of input range
    138 |       static_assert(is_constructible<_ValueType2, decltype(*__first)>::value,
        |                                                                        ^~~~~
  /usr/include/c++/11/bits/stl_uninitialized.h:138:72: note: ‘std::integral_constant<bool, false>::value’ evaluates to false
  /usr/include/c++/11/bits/stl_uninitialized.h:148:40: error: invalid use of incomplete type ‘using value_type = using value_type = std::iter_value_t<std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*> >’ {aka ‘std::iter_value_t<std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*> >’}
    148 |       return std::__uninitialized_copy<__is_trivial(_ValueType1)
        |                                        ^~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘using value_type = using value_type = std::iter_value_t<std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*> >’ {aka ‘std::iter_value_t<std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*> >’}
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/memory:66,
                   from /workspace/nunchaku/src/common.h:9,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_uninitialized.h:149:43: error: invalid use of incomplete type ‘using value_type = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>::value_type’ {aka ‘class torch::Tensor’}
    149 |                                        && __is_trivial(_ValueType2)
        |                                           ^~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘using value_type = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>::value_type’ {aka ‘class torch::Tensor’}
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/stl_iterator.h:85,
                   from /usr/include/c++/11/bits/stl_algobase.h:67,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_construct.h: In instantiation of ‘constexpr void std::_Destroy(_ForwardIterator, _ForwardIterator) [with _ForwardIterator = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>]’:
  /usr/include/c++/11/bits/alloc_traits.h:848:15:   required from ‘void std::_Destroy(_ForwardIterator, _ForwardIterator, std::allocator<_T2>&) [with _ForwardIterator = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>; _Tp = torch::Tensor]’
  /usr/include/c++/11/bits/stl_uninitialized.h:469:17:   required from ‘_ForwardIterator std::__uninitialized_move_copy(_InputIterator1, _InputIterator1, _InputIterator2, _InputIterator2, _ForwardIterator, _Allocator&) [with _InputIterator1 = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>; _InputIterator2 = std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>; _ForwardIterator = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>; _Allocator = std::allocator<torch::Tensor>]’
  /usr/include/c++/11/bits/deque.tcc:800:37:   required from ‘void std::deque<_Tp, _Alloc>::_M_insert_aux(std::deque<_Tp, _Alloc>::iterator, _ForwardIterator, _ForwardIterator, std::deque<_Tp, _Alloc>::size_type) [with _ForwardIterator = std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>; _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::deque<_Tp, _Alloc>::iterator = std::_Deque_base<torch::Tensor, std::allocator<torch::Tensor> >::iterator; std::deque<_Tp, _Alloc>::size_type = long unsigned int]’
  /usr/include/c++/11/bits/deque.tcc:638:17:   required from ‘void std::deque<_Tp, _Alloc>::_M_range_insert_aux(std::deque<_Tp, _Alloc>::iterator, _ForwardIterator, _ForwardIterator, std::forward_iterator_tag) [with _ForwardIterator = std::_Deque_iterator<torch::Tensor, const torch::Tensor&, const torch::Tensor*>; _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>; std::deque<_Tp, _Alloc>::iterator = std::_Deque_base<torch::Tensor, std::allocator<torch::Tensor> >::iterator]’
  /usr/include/c++/11/bits/deque.tcc:125:27:   required from ‘std::deque<_Tp, _Alloc>& std::deque<_Tp, _Alloc>::operator=(const std::deque<_Tp, _Alloc>&) [with _Tp = torch::Tensor; _Alloc = std::allocator<torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:45:3:   required from here
  /usr/include/c++/11/bits/stl_construct.h:188:51: error: static assertion failed: value type is destructible
    188 |       static_assert(is_destructible<_Value_type>::value,
        |                                                   ^~~~~
  /usr/include/c++/11/bits/stl_construct.h:188:51: note: ‘std::integral_constant<bool, false>::value’ evaluates to false
  /usr/include/c++/11/bits/stl_construct.h:195:25: error: invalid use of incomplete type ‘using value_type = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>::value_type’ {aka ‘class torch::Tensor’}
    195 |       std::_Destroy_aux<__has_trivial_destructor(_Value_type)>::
        |                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘using value_type = std::_Deque_iterator<torch::Tensor, torch::Tensor&, torch::Tensor*>::value_type’ {aka ‘class torch::Tensor’}
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/include/c++/11/bits/move.h:57,
                   from /usr/include/c++/11/bits/stl_pair.h:59,
                   from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::is_constructible<torch::Tensor, const torch::Tensor&&>’:
  /usr/include/c++/11/type_traits:152:12:   required from ‘struct std::__and_<std::is_constructible<torch::Tensor, const torch::Tensor&&>, std::__and_<std::is_convertible<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&&, const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::is_convertible<const torch::Tensor&, torch::Tensor> > >’
  /usr/include/c++/11/type_traits:157:12:   required from ‘struct std::__and_<std::is_constructible<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&&>, std::is_constructible<torch::Tensor, const torch::Tensor&&>, std::__and_<std::is_convertible<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&&, const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::is_convertible<const torch::Tensor&, torch::Tensor> > >’
  /usr/include/c++/11/bits/stl_pair.h:156:12:   required from ‘static constexpr bool std::_PCC<<anonymous>, _T1, _T2>::_MoveCopyPair() [with bool __implicit = true; _U1 = std::__cxx11::basic_string<char>; _U2 = torch::Tensor; bool <anonymous> = true; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
  /usr/include/c++/11/bits/stl_pair.h:320:36:   required by substitution of ‘template<class _U1, typename std::enable_if<_MoveCopyPair<true, _U1, torch::Tensor>(), bool>::type <anonymous> > constexpr std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>::pair(_U1&&, const torch::Tensor&) [with _U1 = std::__cxx11::basic_string<char>; typename std::enable_if<_MoveCopyPair<true, _U1, torch::Tensor>(), bool>::type <anonymous> = <missing>]’
  /usr/include/c++/11/type_traits:1017:25:   required by substitution of ‘template<class _Tp, class ... _Args> using __is_nothrow_constructible_impl = std::__bool_constant<__is_nothrow_constructible(_Tp)> [with _Tp = std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>; _Args = {std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor&}]’
  /usr/include/c++/11/type_traits:1022:12:   [ skipping 7 instantiation contexts, use -ftemplate-backtrace-limit=0 to disable ]
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/cast.h:1616:51:   required from ‘bool pybind11::detail::argument_loader<Args>::load_impl_sequence(pybind11::detail::function_call&, std::index_sequence<__var_indices ...>) [with long unsigned int ...Is = {0, 1, 2}; Args = {GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor> > >&, bool}; std::index_sequence<__var_indices ...> = std::integer_sequence<long unsigned int, 0, 1, 2>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/cast.h:1594:68:   required from ‘bool pybind11::detail::argument_loader<Args>::load_args(pybind11::detail::function_call&) [with Args = {GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor> > >&, bool}]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:253:42:   required from ‘void pybind11::cpp_function::initialize(Func&&, Return (*)(Args ...), const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Return = void; Args = {GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor> > >&, bool}; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg_v}]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:127:19:   required from ‘pybind11::cpp_function::cpp_function(Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg_v}; <template-parameter-1-3> = void]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:1621:22:   required from ‘pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >& pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >::def(const char*, Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Extra = {pybind11::arg, pybind11::arg_v}; type_ = GEMM_W4A4; options = {}]’
  /workspace/nunchaku/nunchaku/csrc/pybind.cpp:55:13:   required from here
  /usr/include/c++/11/type_traits:955:52: error: static assertion failed: template argument must be a complete class or an unbounded array
    955 |       static_assert(std::__is_complete_or_unbounded(__type_identity<_Tp>{}),
        |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
  /usr/include/c++/11/type_traits:955:52: note: ‘std::__is_complete_or_unbounded<std::__type_identity<torch::Tensor> >((std::__type_identity<torch::Tensor>{}, std::__type_identity<torch::Tensor>()))’ evaluates to false
  /usr/include/c++/11/type_traits: In instantiation of ‘struct std::is_constructible<torch::Tensor, torch::Tensor&>’:
  /usr/include/c++/11/type_traits:152:12:   required from ‘struct std::__and_<std::is_constructible<torch::Tensor, torch::Tensor&>, std::__and_<std::is_convertible<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::is_convertible<torch::Tensor&, torch::Tensor> > >’
  /usr/include/c++/11/type_traits:157:12:   required from ‘struct std::__and_<std::is_constructible<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&>, std::is_constructible<torch::Tensor, torch::Tensor&>, std::__and_<std::is_convertible<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::is_convertible<torch::Tensor&, torch::Tensor> > >’
  /usr/include/c++/11/bits/stl_pair.h:142:12:   required from ‘static constexpr bool std::_PCC<<anonymous>, _T1, _T2>::_CopyMovePair() [with bool __implicit = true; _U1 = const std::__cxx11::basic_string<char>; _U2 = torch::Tensor&; bool <anonymous> = true; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
  /usr/include/c++/11/bits/stl_pair.h:334:36:   required by substitution of ‘template<class _U2, typename std::enable_if<_CopyMovePair<true, const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, _U2>(), bool>::type <anonymous> > constexpr std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>::pair(const std::__cxx11::basic_string<char>&, _U2&&) [with _U2 = torch::Tensor&; typename std::enable_if<_CopyMovePair<true, const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, _U2>(), bool>::type <anonymous> = <missing>]’
  /usr/include/c++/11/type_traits:1017:25:   required by substitution of ‘template<class _Tp, class ... _Args> using __is_nothrow_constructible_impl = std::__bool_constant<__is_nothrow_constructible(_Tp)> [with _Tp = std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>; _Args = {std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor&}]’
  /usr/include/c++/11/type_traits:1022:12:   [ skipping 7 instantiation contexts, use -ftemplate-backtrace-limit=0 to disable ]
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/cast.h:1616:51:   required from ‘bool pybind11::detail::argument_loader<Args>::load_impl_sequence(pybind11::detail::function_call&, std::index_sequence<__var_indices ...>) [with long unsigned int ...Is = {0, 1, 2}; Args = {GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor> > >&, bool}; std::index_sequence<__var_indices ...> = std::integer_sequence<long unsigned int, 0, 1, 2>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/cast.h:1594:68:   required from ‘bool pybind11::detail::argument_loader<Args>::load_args(pybind11::detail::function_call&) [with Args = {GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor> > >&, bool}]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:253:42:   required from ‘void pybind11::cpp_function::initialize(Func&&, Return (*)(Args ...), const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Return = void; Args = {GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor> > >&, bool}; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg_v}]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:127:19:   required from ‘pybind11::cpp_function::cpp_function(Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg_v}; <template-parameter-1-3> = void]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:1621:22:   required from ‘pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >& pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >::def(const char*, Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Extra = {pybind11::arg, pybind11::arg_v}; type_ = GEMM_W4A4; options = {}]’
  /workspace/nunchaku/nunchaku/csrc/pybind.cpp:55:13:   required from here
  /usr/include/c++/11/type_traits:955:52: error: static assertion failed: template argument must be a complete class or an unbounded array
  /usr/include/c++/11/type_traits:955:52: note: ‘std::__is_complete_or_unbounded<std::__type_identity<torch::Tensor> >((std::__type_identity<torch::Tensor>{}, std::__type_identity<torch::Tensor>()))’ evaluates to false
  In file included from /usr/include/c++/11/ext/alloc_traits.h:34,
                   from /usr/include/c++/11/bits/basic_string.h:40,
                   from /usr/include/c++/11/string:55,
                   from /usr/include/c++/11/bits/locale_classes.h:40,
                   from /usr/include/c++/11/bits/ios_base.h:41,
                   from /usr/include/c++/11/ios:42,
                   from /usr/include/c++/11/ostream:38,
                   from /usr/include/c++/11/iostream:39,
                   from /workspace/nunchaku/src/common.h:6,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/alloc_traits.h: In instantiation of ‘static constexpr void std::allocator_traits<std::allocator<_CharT> >::construct(std::allocator_traits<std::allocator<_CharT> >::allocator_type&, _Up*, _Args&& ...) [with _Up = std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>; _Args = {std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor&}; _Tp = std::_Rb_tree_node<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >; std::allocator_traits<std::allocator<_CharT> >::allocator_type = std::allocator<std::_Rb_tree_node<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> > >]’:
  /usr/include/c++/11/bits/stl_tree.h:595:32:   required from ‘void std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::_M_construct_node(std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::_Link_type, _Args&& ...) [with _Args = {std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor&}; _Key = std::__cxx11::basic_string<char>; _Val = std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>; _KeyOfValue = std::_Select1st<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >; _Compare = std::less<std::__cxx11::basic_string<char> >; _Alloc = std::allocator<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >; std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::_Link_type = std::_Rb_tree_node<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >*]’
  /usr/include/c++/11/bits/stl_tree.h:612:21:   required from ‘std::_Rb_tree_node<_Val>* std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::_M_create_node(_Args&& ...) [with _Args = {std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor&}; _Key = std::__cxx11::basic_string<char>; _Val = std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>; _KeyOfValue = std::_Select1st<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >; _Compare = std::less<std::__cxx11::basic_string<char> >; _Alloc = std::allocator<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >; std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::_Link_type = std::_Rb_tree_node<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >*]’
  /usr/include/c++/11/bits/stl_tree.h:2384:33:   required from ‘std::pair<std::_Rb_tree_iterator<_Val>, bool> std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::_M_emplace_unique(_Args&& ...) [with _Args = {std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor&}; _Key = std::__cxx11::basic_string<char>; _Val = std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>; _KeyOfValue = std::_Select1st<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >; _Compare = std::less<std::__cxx11::basic_string<char> >; _Alloc = std::allocator<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >]’
  /usr/include/c++/11/bits/stl_map.h:577:33:   required from ‘std::pair<typename std::_Rb_tree<_Key, std::pair<const _Key, _Tp>, std::_Select1st<std::pair<const _Key, _Tp> >, _Compare, typename __gnu_cxx::__alloc_traits<_Allocator>::rebind<std::pair<const _Key, _Tp> >::other>::iterator, bool> std::map<_Key, _Tp, _Compare, _Alloc>::emplace(_Args&& ...) [with _Args = {std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor&}; _Key = std::__cxx11::basic_string<char>; _Tp = torch::Tensor; _Compare = std::less<std::__cxx11::basic_string<char> >; _Alloc = std::allocator<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >; typename std::_Rb_tree<_Key, std::pair<const _Key, _Tp>, std::_Select1st<std::pair<const _Key, _Tp> >, _Compare, typename __gnu_cxx::__alloc_traits<_Allocator>::rebind<std::pair<const _Key, _Tp> >::other>::iterator = std::_Rb_tree<std::__cxx11::basic_string<char>, std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>, std::_Select1st<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >, std::less<std::__cxx11::basic_string<char> >, std::allocator<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> > >::iterator; typename __gnu_cxx::__alloc_traits<_Allocator>::rebind<std::pair<const _Key, _Tp> >::other = std::allocator<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >; typename __gnu_cxx::__alloc_traits<_Allocator>::rebind<std::pair<const _Key, _Tp> > = __gnu_cxx::__alloc_traits<std::allocator<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >, std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >::rebind<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >; typename _Allocator::value_type = std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/stl.h:132:26:   required from ‘bool pybind11::detail::map_caster<Type, Key, Value>::load(pybind11::handle, bool) [with Type = std::map<std::__cxx11::basic_string<char>, torch::Tensor>; Key = std::__cxx11::basic_string<char>; Value = torch::Tensor]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/cast.h:1616:51:   required from ‘bool pybind11::detail::argument_loader<Args>::load_impl_sequence(pybind11::detail::function_call&, std::index_sequence<__var_indices ...>) [with long unsigned int ...Is = {0, 1, 2}; Args = {GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor> > >&, bool}; std::index_sequence<__var_indices ...> = std::integer_sequence<long unsigned int, 0, 1, 2>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/cast.h:1594:68:   required from ‘bool pybind11::detail::argument_loader<Args>::load_args(pybind11::detail::function_call&) [with Args = {GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor> > >&, bool}]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:253:42:   required from ‘void pybind11::cpp_function::initialize(Func&&, Return (*)(Args ...), const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Return = void; Args = {GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor> > >&, bool}; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg_v}]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:127:19:   required from ‘pybind11::cpp_function::cpp_function(Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg_v}; <template-parameter-1-3> = void]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:1621:22:   required from ‘pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >& pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >::def(const char*, Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Extra = {pybind11::arg, pybind11::arg_v}; type_ = GEMM_W4A4; options = {}]’
  /workspace/nunchaku/nunchaku/csrc/pybind.cpp:55:13:   required from here
  /usr/include/c++/11/bits/alloc_traits.h:518:28: error: no matching function for call to ‘construct_at(std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>*&, std::__cxx11::basic_string<char>, torch::Tensor&)’
    518 |           std::construct_at(__p, std::forward<_Args>(__args)...);
        |           ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/bits/stl_iterator.h:85,
                   from /usr/include/c++/11/bits/stl_algobase.h:67,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_construct.h:94:5: note: candidate: ‘template<class _Tp, class ... _Args> constexpr decltype (::new(void*(0)) _Tp) std::construct_at(_Tp*, _Args&& ...)’
     94 |     construct_at(_Tp* __location, _Args&&... __args)
        |     ^~~~~~~~~~~~
  /usr/include/c++/11/bits/stl_construct.h:94:5: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/bits/stl_construct.h: In substitution of ‘template<class _Tp, class ... _Args> constexpr decltype (::new(void*(0)) _Tp) std::construct_at(_Tp*, _Args&& ...) [with _Tp = std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>; _Args = {std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor&}]’:
  /usr/include/c++/11/bits/alloc_traits.h:518:21:   required from ‘static constexpr void std::allocator_traits<std::allocator<_CharT> >::construct(std::allocator_traits<std::allocator<_CharT> >::allocator_type&, _Up*, _Args&& ...) [with _Up = std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>; _Args = {std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor&}; _Tp = std::_Rb_tree_node<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >; std::allocator_traits<std::allocator<_CharT> >::allocator_type = std::allocator<std::_Rb_tree_node<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> > >]’
  /usr/include/c++/11/bits/stl_tree.h:595:32:   required from ‘void std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::_M_construct_node(std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::_Link_type, _Args&& ...) [with _Args = {std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor&}; _Key = std::__cxx11::basic_string<char>; _Val = std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>; _KeyOfValue = std::_Select1st<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >; _Compare = std::less<std::__cxx11::basic_string<char> >; _Alloc = std::allocator<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >; std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::_Link_type = std::_Rb_tree_node<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >*]’
  /usr/include/c++/11/bits/stl_tree.h:612:21:   required from ‘std::_Rb_tree_node<_Val>* std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::_M_create_node(_Args&& ...) [with _Args = {std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor&}; _Key = std::__cxx11::basic_string<char>; _Val = std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>; _KeyOfValue = std::_Select1st<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >; _Compare = std::less<std::__cxx11::basic_string<char> >; _Alloc = std::allocator<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >; std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::_Link_type = std::_Rb_tree_node<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >*]’
  /usr/include/c++/11/bits/stl_tree.h:2384:33:   required from ‘std::pair<std::_Rb_tree_iterator<_Val>, bool> std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::_M_emplace_unique(_Args&& ...) [with _Args = {std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor&}; _Key = std::__cxx11::basic_string<char>; _Val = std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>; _KeyOfValue = std::_Select1st<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >; _Compare = std::less<std::__cxx11::basic_string<char> >; _Alloc = std::allocator<std::pair<const std::__cxx11::basic_string<char>, torch::Tensor> >]’
  /usr/include/c++/11/bits/stl_map.h:577:33:   [ skipping 2 instantiation contexts, use -ftemplate-backtrace-limit=0 to disable ]
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/cast.h:1616:51:   required from ‘bool pybind11::detail::argument_loader<Args>::load_impl_sequence(pybind11::detail::function_call&, std::index_sequence<__var_indices ...>) [with long unsigned int ...Is = {0, 1, 2}; Args = {GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor> > >&, bool}; std::index_sequence<__var_indices ...> = std::integer_sequence<long unsigned int, 0, 1, 2>]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/cast.h:1594:68:   required from ‘bool pybind11::detail::argument_loader<Args>::load_args(pybind11::detail::function_call&) [with Args = {GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor> > >&, bool}]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:253:42:   required from ‘void pybind11::cpp_function::initialize(Func&&, Return (*)(Args ...), const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Return = void; Args = {GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, torch::Tensor> > >&, bool}; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg_v}]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:127:19:   required from ‘pybind11::cpp_function::cpp_function(Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Extra = {pybind11::name, pybind11::is_method, pybind11::sibling, pybind11::arg, pybind11::arg_v}; <template-parameter-1-3> = void]’
  /usr/local/lib/python3.10/dist-packages/torch/include/pybind11/pybind11.h:1621:22:   required from ‘pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >& pybind11::class_< <template-parameter-1-1>, <template-parameter-1-2> >::def(const char*, Func&&, const Extra& ...) [with Func = pybind11_init__C(pybind11::module_&)::<lambda(GEMM_W4A4&, const std::map<std::__cxx11::basic_string<char>, torch::Tensor>&, bool)>; Extra = {pybind11::arg, pybind11::arg_v}; type_ = GEMM_W4A4; options = {}]’
  /workspace/nunchaku/nunchaku/csrc/pybind.cpp:55:13:   required from here
  /usr/include/c++/11/bits/stl_construct.h:96:17: error: no matching function for call to ‘std::pair<const std::__cxx11::basic_string<char>, torch::Tensor>::pair(std::__cxx11::basic_string<char>, torch::Tensor&)’
     96 |     -> decltype(::new((void*)0) _Tp(std::declval<_Args>()...))
        |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_pair.h:452:9: note: candidate: ‘template<class ... _Args1, long unsigned int ..._Indexes1, class ... _Args2, long unsigned int ..._Indexes2> constexpr std::pair<_T1, _T2>::pair(std::tuple<_Args1 ...>&, std::tuple<_Args2 ...>&, std::_Index_tuple<_Indexes1 ...>, std::_Index_tuple<_Indexes2 ...>) [with _Args1 = {_Args1 ...}; long unsigned int ..._Indexes1 = {_Indexes1 ...}; _Args2 = {_Args2 ...}; long unsigned int ..._Indexes2 = {_Indexes2 ...}; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    452 |         pair(tuple<_Args1...>&, tuple<_Args2...>&,
        |         ^~~~
  /usr/include/c++/11/bits/stl_pair.h:452:9: note:   template argument deduction/substitution failed:
  In file included from /usr/include/c++/11/bits/stl_iterator.h:85,
                   from /usr/include/c++/11/bits/stl_algobase.h:67,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_construct.h:96:17: note:   ‘std::__cxx11::basic_string<char>’ is not derived from ‘std::tuple<_Tps ...>’
     96 |     -> decltype(::new((void*)0) _Tp(std::declval<_Args>()...))
        |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_pair.h:387:9: note: candidate: ‘template<class ... _Args1, class ... _Args2> constexpr std::pair<_T1, _T2>::pair(std::piecewise_construct_t, std::tuple<_Args1 ...>, std::tuple<_Args2 ...>) [with _Args1 = {_Args1 ...}; _Args2 = {_Args2 ...}; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    387 |         pair(piecewise_construct_t, tuple<_Args1...>, tuple<_Args2...>);
        |         ^~~~
  /usr/include/c++/11/bits/stl_pair.h:387:9: note:   template argument deduction/substitution failed:
  In file included from /usr/include/c++/11/bits/stl_iterator.h:85,
                   from /usr/include/c++/11/bits/stl_algobase.h:67,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_construct.h:96:17: note:   ‘torch::Tensor’ is not derived from ‘std::tuple<_Tps ...>’
     96 |     -> decltype(::new((void*)0) _Tp(std::declval<_Args>()...))
        |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_pair.h:381:28: note: candidate: ‘template<class _U1, class _U2, typename std::enable_if<(std::_PCC<((! std::is_same<const std::__cxx11::basic_string<char>, _U1>::value) || (! std::is_same<torch::Tensor, _U2>::value)), const std::__cxx11::basic_string<char>, torch::Tensor>::_MoveConstructiblePair<_U1, _U2>() && (! std::_PCC<((! std::is_same<const std::__cxx11::basic_string<char>, _U1>::value) || (! std::is_same<torch::Tensor, _U2>::value)), const std::__cxx11::basic_string<char>, torch::Tensor>::_ImplicitlyMoveConvertiblePair<_U1, _U2>())), bool>::type <anonymous> > constexpr std::pair<_T1, _T2>::pair(std::pair<_U1, _U2>&&) [with _U1 = _U1; _U2 = _U2; typename std::enable_if<(std::_PCC<((! std::is_same<_T1, _U1>::value) || (! std::is_same<_T2, _U2>::value)), _T1, _T2>::_MoveConstructiblePair<_U1, _U2>() && (! std::_PCC<((! std::is_same<_T1, _U1>::value) || (! std::is_same<_T2, _U2>::value)), _T1, _T2>::_ImplicitlyMoveConvertiblePair<_U1, _U2>())), bool>::type <anonymous> = <anonymous>; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    381 |         explicit constexpr pair(pair<_U1, _U2>&& __p)
        |                            ^~~~
  /usr/include/c++/11/bits/stl_pair.h:381:28: note:   template argument deduction/substitution failed:
  In file included from /usr/include/c++/11/bits/stl_iterator.h:85,
                   from /usr/include/c++/11/bits/stl_algobase.h:67,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_construct.h:96:17: note:   ‘std::__cxx11::basic_string<char>’ is not derived from ‘std::pair<_T1, _T2>’
     96 |     -> decltype(::new((void*)0) _Tp(std::declval<_Args>()...))
        |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_pair.h:371:19: note: candidate: ‘template<class _U1, class _U2, typename std::enable_if<(std::_PCC<((! std::is_same<const std::__cxx11::basic_string<char>, _U1>::value) || (! std::is_same<torch::Tensor, _U2>::value)), const std::__cxx11::basic_string<char>, torch::Tensor>::_MoveConstructiblePair<_U1, _U2>() && std::_PCC<((! std::is_same<const std::__cxx11::basic_string<char>, _U1>::value) || (! std::is_same<torch::Tensor, _U2>::value)), const std::__cxx11::basic_string<char>, torch::Tensor>::_ImplicitlyMoveConvertiblePair<_U1, _U2>()), bool>::type <anonymous> > constexpr std::pair<_T1, _T2>::pair(std::pair<_U1, _U2>&&) [with _U1 = _U1; _U2 = _U2; typename std::enable_if<(std::_PCC<((! std::is_same<_T1, _U1>::value) || (! std::is_same<_T2, _U2>::value)), _T1, _T2>::_MoveConstructiblePair<_U1, _U2>() && std::_PCC<((! std::is_same<_T1, _U1>::value) || (! std::is_same<_T2, _U2>::value)), _T1, _T2>::_ImplicitlyMoveConvertiblePair<_U1, _U2>()), bool>::type <anonymous> = <anonymous>; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    371 |         constexpr pair(pair<_U1, _U2>&& __p)
        |                   ^~~~
  /usr/include/c++/11/bits/stl_pair.h:371:19: note:   template argument deduction/substitution failed:
  In file included from /usr/include/c++/11/bits/stl_iterator.h:85,
                   from /usr/include/c++/11/bits/stl_algobase.h:67,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_construct.h:96:17: note:   ‘std::__cxx11::basic_string<char>’ is not derived from ‘std::pair<_T1, _T2>’
     96 |     -> decltype(::new((void*)0) _Tp(std::declval<_Args>()...))
        |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_pair.h:361:28: note: candidate: ‘template<class _U1, class _U2, typename std::enable_if<(_MoveConstructiblePair<_U1, _U2>() && (! _ImplicitlyMoveConvertiblePair<_U1, _U2>())), bool>::type <anonymous> > constexpr std::pair<_T1, _T2>::pair(_U1&&, _U2&&) [with _U1 = _U1; _U2 = _U2; typename std::enable_if<(std::_PCC<true, _T1, _T2>::_MoveConstructiblePair<_U1, _U2>() && (! std::_PCC<true, _T1, _T2>::_ImplicitlyMoveConvertiblePair<_U1, _U2>())), bool>::type <anonymous> = <anonymous>; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    361 |         explicit constexpr pair(_U1&& __x, _U2&& __y)
        |                            ^~~~
  /usr/include/c++/11/bits/stl_pair.h:361:28: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/bits/stl_pair.h:360:38: error: no type named ‘type’ in ‘struct std::enable_if<false, bool>’
    360 |                          bool>::type=false>
        |                                      ^~~~~
  /usr/include/c++/11/bits/stl_pair.h:352:19: note: candidate: ‘template<class _U1, class _U2, typename std::enable_if<(_MoveConstructiblePair<_U1, _U2>() && _ImplicitlyMoveConvertiblePair<_U1, _U2>()), bool>::type <anonymous> > constexpr std::pair<_T1, _T2>::pair(_U1&&, _U2&&) [with _U1 = _U1; _U2 = _U2; typename std::enable_if<(std::_PCC<true, _T1, _T2>::_MoveConstructiblePair<_U1, _U2>() && std::_PCC<true, _T1, _T2>::_ImplicitlyMoveConvertiblePair<_U1, _U2>()), bool>::type <anonymous> = <anonymous>; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    352 |         constexpr pair(_U1&& __x, _U2&& __y)
        |                   ^~~~
  /usr/include/c++/11/bits/stl_pair.h:352:19: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/bits/stl_pair.h:351:38: error: no type named ‘type’ in ‘struct std::enable_if<false, bool>’
    351 |                          bool>::type=true>
        |                                      ^~~~
  /usr/include/c++/11/bits/stl_pair.h:343:17: note: candidate: ‘template<class _U2, typename std::enable_if<_CopyMovePair<false, const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, _U2>(), bool>::type <anonymous> > std::pair<_T1, _T2>::pair(const _T1&, _U2&&) [with _U2 = _U2; typename std::enable_if<std::_PCC<true, _T1, _T2>::_CopyMovePair<false, _T1, _U2>(), bool>::type <anonymous> = <anonymous>; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    343 |        explicit pair(const _T1& __x, _U2&& __y)
        |                 ^~~~
  /usr/include/c++/11/bits/stl_pair.h:343:17: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/bits/stl_pair.h:342:38: error: no type named ‘type’ in ‘struct std::enable_if<false, bool>’
    342 |                          bool>::type=false>
        |                                      ^~~~~
  /usr/include/c++/11/bits/stl_pair.h:336:18: note: candidate: ‘template<class _U2, typename std::enable_if<_CopyMovePair<true, const std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, _U2>(), bool>::type <anonymous> > constexpr std::pair<_T1, _T2>::pair(const _T1&, _U2&&) [with _U2 = _U2; typename std::enable_if<std::_PCC<true, _T1, _T2>::_CopyMovePair<true, _T1, _U2>(), bool>::type <anonymous> = <anonymous>; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    336 |        constexpr pair(const _T1& __x, _U2&& __y)
        |                  ^~~~
  /usr/include/c++/11/bits/stl_pair.h:336:18: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/bits/stl_pair.h:335:38: error: no type named ‘type’ in ‘struct std::enable_if<false, bool>’
    335 |                          bool>::type=true>
        |                                      ^~~~
  /usr/include/c++/11/bits/stl_pair.h:329:27: note: candidate: ‘template<class _U1, typename std::enable_if<_MoveCopyPair<false, _U1, torch::Tensor>(), bool>::type <anonymous> > constexpr std::pair<_T1, _T2>::pair(_U1&&, const _T2&) [with _U1 = _U1; typename std::enable_if<std::_PCC<true, _T1, _T2>::_MoveCopyPair<false, _U1, _T2>(), bool>::type <anonymous> = <anonymous>; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    329 |        explicit constexpr pair(_U1&& __x, const _T2& __y)
        |                           ^~~~
  /usr/include/c++/11/bits/stl_pair.h:329:27: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/bits/stl_pair.h:328:38: error: no type named ‘type’ in ‘struct std::enable_if<false, bool>’
    328 |                          bool>::type=false>
        |                                      ^~~~~
  /usr/include/c++/11/bits/stl_pair.h:322:18: note: candidate: ‘template<class _U1, typename std::enable_if<_MoveCopyPair<true, _U1, torch::Tensor>(), bool>::type <anonymous> > constexpr std::pair<_T1, _T2>::pair(_U1&&, const _T2&) [with _U1 = _U1; typename std::enable_if<std::_PCC<true, _T1, _T2>::_MoveCopyPair<true, _U1, _T2>(), bool>::type <anonymous> = <anonymous>; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    322 |        constexpr pair(_U1&& __x, const _T2& __y)
        |                  ^~~~
  /usr/include/c++/11/bits/stl_pair.h:322:18: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/bits/stl_pair.h:321:38: error: no type named ‘type’ in ‘struct std::enable_if<false, bool>’
    321 |                          bool>::type=true>
        |                                      ^~~~
  /usr/include/c++/11/bits/stl_pair.h:309:28: note: candidate: ‘template<class _U1, class _U2, typename std::enable_if<(std::_PCC<((! std::is_same<const std::__cxx11::basic_string<char>, _U1>::value) || (! std::is_same<torch::Tensor, _U2>::value)), const std::__cxx11::basic_string<char>, torch::Tensor>::_ConstructiblePair<_U1, _U2>() && (! std::_PCC<((! std::is_same<const std::__cxx11::basic_string<char>, _U1>::value) || (! std::is_same<torch::Tensor, _U2>::value)), const std::__cxx11::basic_string<char>, torch::Tensor>::_ImplicitlyConvertiblePair<_U1, _U2>())), bool>::type <anonymous> > constexpr std::pair<_T1, _T2>::pair(const std::pair<_U1, _U2>&) [with _U1 = _U1; _U2 = _U2; typename std::enable_if<(std::_PCC<((! std::is_same<_T1, _U1>::value) || (! std::is_same<_T2, _U2>::value)), _T1, _T2>::_ConstructiblePair<_U1, _U2>() && (! std::_PCC<((! std::is_same<_T1, _U1>::value) || (! std::is_same<_T2, _U2>::value)), _T1, _T2>::_ImplicitlyConvertiblePair<_U1, _U2>())), bool>::type <anonymous> = <anonymous>; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    309 |         explicit constexpr pair(const pair<_U1, _U2>& __p)
        |                            ^~~~
  /usr/include/c++/11/bits/stl_pair.h:309:28: note:   template argument deduction/substitution failed:
  In file included from /usr/include/c++/11/bits/stl_iterator.h:85,
                   from /usr/include/c++/11/bits/stl_algobase.h:67,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_construct.h:96:17: note:   ‘std::__cxx11::basic_string<char>’ is not derived from ‘const std::pair<_T1, _T2>’
     96 |     -> decltype(::new((void*)0) _Tp(std::declval<_Args>()...))
        |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_pair.h:300:19: note: candidate: ‘template<class _U1, class _U2, typename std::enable_if<(std::_PCC<((! std::is_same<const std::__cxx11::basic_string<char>, _U1>::value) || (! std::is_same<torch::Tensor, _U2>::value)), const std::__cxx11::basic_string<char>, torch::Tensor>::_ConstructiblePair<_U1, _U2>() && std::_PCC<((! std::is_same<const std::__cxx11::basic_string<char>, _U1>::value) || (! std::is_same<torch::Tensor, _U2>::value)), const std::__cxx11::basic_string<char>, torch::Tensor>::_ImplicitlyConvertiblePair<_U1, _U2>()), bool>::type <anonymous> > constexpr std::pair<_T1, _T2>::pair(const std::pair<_U1, _U2>&) [with _U1 = _U1; _U2 = _U2; typename std::enable_if<(std::_PCC<((! std::is_same<_T1, _U1>::value) || (! std::is_same<_T2, _U2>::value)), _T1, _T2>::_ConstructiblePair<_U1, _U2>() && std::_PCC<((! std::is_same<_T1, _U1>::value) || (! std::is_same<_T2, _U2>::value)), _T1, _T2>::_ImplicitlyConvertiblePair<_U1, _U2>()), bool>::type <anonymous> = <anonymous>; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    300 |         constexpr pair(const pair<_U1, _U2>& __p)
        |                   ^~~~
  /usr/include/c++/11/bits/stl_pair.h:300:19: note:   template argument deduction/substitution failed:
  In file included from /usr/include/c++/11/bits/stl_iterator.h:85,
                   from /usr/include/c++/11/bits/stl_algobase.h:67,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_construct.h:96:17: note:   ‘std::__cxx11::basic_string<char>’ is not derived from ‘const std::pair<_T1, _T2>’
     96 |     -> decltype(::new((void*)0) _Tp(std::declval<_Args>()...))
        |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_pair.h:276:26: note: candidate: ‘template<class _U1, class _U2, typename std::enable_if<(_ConstructiblePair<_U1, _U2>() && (! _ImplicitlyConvertiblePair<_U1, _U2>())), bool>::type <anonymous> > constexpr std::pair<_T1, _T2>::pair(const _T1&, const _T2&) [with _U1 = _U1; _U2 = _U2; typename std::enable_if<(std::_PCC<true, _T1, _T2>::_ConstructiblePair<_U1, _U2>() && (! std::_PCC<true, _T1, _T2>::_ImplicitlyConvertiblePair<_U1, _U2>())), bool>::type <anonymous> = <anonymous>; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    276 |       explicit constexpr pair(const _T1& __a, const _T2& __b)
        |                          ^~~~
  /usr/include/c++/11/bits/stl_pair.h:276:26: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/bits/stl_pair.h:275:38: error: no type named ‘type’ in ‘struct std::enable_if<false, bool>’
    275 |                          bool>::type=false>
        |                                      ^~~~~
  /usr/include/c++/11/bits/stl_pair.h:266:17: note: candidate: ‘template<class _U1, class _U2, typename std::enable_if<(_ConstructiblePair<_U1, _U2>() && _ImplicitlyConvertiblePair<_U1, _U2>()), bool>::type <anonymous> > constexpr std::pair<_T1, _T2>::pair(const _T1&, const _T2&) [with _U1 = _U1; _U2 = _U2; typename std::enable_if<(std::_PCC<true, _T1, _T2>::_ConstructiblePair<_U1, _U2>() && std::_PCC<true, _T1, _T2>::_ImplicitlyConvertiblePair<_U1, _U2>()), bool>::type <anonymous> = <anonymous>; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    266 |       constexpr pair(const _T1& __a, const _T2& __b)
        |                 ^~~~
  /usr/include/c++/11/bits/stl_pair.h:266:17: note:   template argument deduction/substitution failed:
  /usr/include/c++/11/bits/stl_pair.h:265:38: error: no type named ‘type’ in ‘struct std::enable_if<false, bool>’
    265 |                          bool>::type=true>
        |                                      ^~~~
  /usr/include/c++/11/bits/stl_pair.h:245:26: note: candidate: ‘template<class _U1, class _U2, typename std::enable_if<std::__and_<std::is_default_constructible<_U1>, std::is_default_constructible<_Dp>, std::__not_<std::__and_<std::__is_implicitly_default_constructible<_U1>, std::__is_implicitly_default_constructible<_U2> > > >::value, bool>::type <anonymous> > constexpr std::pair<_T1, _T2>::pair() [with _U1 = _U1; _U2 = _U2; typename std::enable_if<std::__and_<std::is_default_constructible<_U1>, std::is_default_constructible<_U2>, std::__not_<std::__and_<std::__is_implicitly_default_constructible<_U1>, std::__is_implicitly_default_constructible<_U2> > > >::value, bool>::type <anonymous> = <anonymous>; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    245 |       explicit constexpr pair()
        |                          ^~~~
  /usr/include/c++/11/bits/stl_pair.h:245:26: note:   template argument deduction/substitution failed:
  In file included from /usr/include/c++/11/bits/stl_iterator.h:85,
                   from /usr/include/c++/11/bits/stl_algobase.h:67,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_construct.h:96:17: note:   candidate expects 0 arguments, 2 provided
     96 |     -> decltype(::new((void*)0) _Tp(std::declval<_Args>()...))
        |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_pair.h:232:26: note: candidate: ‘template<class _U1, class _U2, typename std::enable_if<std::__and_<std::__is_implicitly_default_constructible<_U1>, std::__is_implicitly_default_constructible<_U2> >::value, bool>::type <anonymous> > constexpr std::pair<_T1, _T2>::pair() [with _U1 = _U1; _U2 = _U2; typename std::enable_if<std::__and_<std::__is_implicitly_default_constructible<_U1>, std::__is_implicitly_default_constructible<_U2> >::value, bool>::type <anonymous> = <anonymous>; _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    232 |       _GLIBCXX_CONSTEXPR pair()
        |                          ^~~~
  /usr/include/c++/11/bits/stl_pair.h:232:26: note:   template argument deduction/substitution failed:
  In file included from /usr/include/c++/11/bits/stl_iterator.h:85,
                   from /usr/include/c++/11/bits/stl_algobase.h:67,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_construct.h:96:17: note:   candidate expects 0 arguments, 2 provided
     96 |     -> decltype(::new((void*)0) _Tp(std::declval<_Args>()...))
        |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/c++/11/bits/stl_algobase.h:64,
                   from /usr/include/c++/11/bits/specfun.h:45,
                   from /usr/include/c++/11/cmath:1935,
                   from /workspace/nunchaku/src/common.h:5,
                   from /workspace/nunchaku/src/Linear.h:3,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /usr/include/c++/11/bits/stl_pair.h:315:17: note: candidate: ‘std::pair<_T1, _T2>::pair(std::pair<_T1, _T2>&&) [with _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    315 |       constexpr pair(pair&&) = default;         ///< Move constructor
        |                 ^~~~
  /usr/include/c++/11/bits/stl_pair.h:315:17: note:   candidate expects 1 argument, 2 provided
  /usr/include/c++/11/bits/stl_pair.h:314:17: note: candidate: ‘std::pair<_T1, _T2>::pair(const std::pair<_T1, _T2>&) [with _T1 = const std::__cxx11::basic_string<char>; _T2 = torch::Tensor]’
    314 |       constexpr pair(const pair&) = default;    ///< Copy constructor
        |                 ^~~~
  /usr/include/c++/11/bits/stl_pair.h:314:17: note:   candidate expects 1 argument, 2 provided
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::CrossMapLRN2dImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::SequentialImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::ParameterDictImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::ModuleListImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::ModuleDictImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::ConvTranspose3dImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h: In instantiation of ‘void torch::nn::ConvNdImpl<D, Derived>::reset() [with long unsigned int D = 3; Derived = torch::nn::ConvTranspose3dImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:32:8:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:82:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::weight’
     82 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:82:40: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     82 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |                ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:90:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::weight’
     90 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:90:40: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     90 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |                ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:94:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::bias’
     94 |       bias = this->register_parameter(
        |       ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:94:38: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     94 |       bias = this->register_parameter(
        |              ~~~~~~~~~~~~~~~~~~~~~~~~^
     95 |           "bias", torch::empty({options.out_channels()}));
        |           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:97:40: error: invalid use of incomplete type ‘class torch::Tensor’
     97 |       this->register_parameter("bias", Tensor(), /*requires_grad=*/false);
        |                                        ^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::ConvTranspose2dImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h: In instantiation of ‘void torch::nn::ConvNdImpl<D, Derived>::reset() [with long unsigned int D = 2; Derived = torch::nn::ConvTranspose2dImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:32:8:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:82:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::weight’
     82 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:82:40: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     82 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |                ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:90:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::weight’
     90 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:90:40: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     90 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |                ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:94:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::bias’
     94 |       bias = this->register_parameter(
        |       ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:94:38: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     94 |       bias = this->register_parameter(
        |              ~~~~~~~~~~~~~~~~~~~~~~~~^
     95 |           "bias", torch::empty({options.out_channels()}));
        |           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:97:40: error: invalid use of incomplete type ‘class torch::Tensor’
     97 |       this->register_parameter("bias", Tensor(), /*requires_grad=*/false);
        |                                        ^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::ConvTranspose1dImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h: In instantiation of ‘void torch::nn::ConvNdImpl<D, Derived>::reset() [with long unsigned int D = 1; Derived = torch::nn::ConvTranspose1dImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:32:8:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:82:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::weight’
     82 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:82:40: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     82 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |                ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:90:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::weight’
     90 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:90:40: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     90 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |                ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:94:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::bias’
     94 |       bias = this->register_parameter(
        |       ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:94:38: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     94 |       bias = this->register_parameter(
        |              ~~~~~~~~~~~~~~~~~~~~~~~~^
     95 |           "bias", torch::empty({options.out_channels()}));
        |           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:97:40: error: invalid use of incomplete type ‘class torch::Tensor’
     97 |       this->register_parameter("bias", Tensor(), /*requires_grad=*/false);
        |                                        ^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::Conv3dImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h: In instantiation of ‘void torch::nn::ConvNdImpl<D, Derived>::reset() [with long unsigned int D = 3; Derived = torch::nn::Conv3dImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:32:8:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:82:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::weight’
     82 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:82:40: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     82 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |                ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:90:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::weight’
     90 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:90:40: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     90 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |                ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:94:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::bias’
     94 |       bias = this->register_parameter(
        |       ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:94:38: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     94 |       bias = this->register_parameter(
        |              ~~~~~~~~~~~~~~~~~~~~~~~~^
     95 |           "bias", torch::empty({options.out_channels()}));
        |           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:97:40: error: invalid use of incomplete type ‘class torch::Tensor’
     97 |       this->register_parameter("bias", Tensor(), /*requires_grad=*/false);
        |                                        ^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::Conv2dImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h: In instantiation of ‘void torch::nn::ConvNdImpl<D, Derived>::reset() [with long unsigned int D = 2; Derived = torch::nn::Conv2dImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:32:8:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:82:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::weight’
     82 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:82:40: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     82 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |                ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:90:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::weight’
     90 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:90:40: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     90 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |                ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:94:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::bias’
     94 |       bias = this->register_parameter(
        |       ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:94:38: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     94 |       bias = this->register_parameter(
        |              ~~~~~~~~~~~~~~~~~~~~~~~~^
     95 |           "bias", torch::empty({options.out_channels()}));
        |           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:97:40: error: invalid use of incomplete type ‘class torch::Tensor’
     97 |       this->register_parameter("bias", Tensor(), /*requires_grad=*/false);
        |                                        ^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::Conv1dImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h: In instantiation of ‘void torch::nn::ConvNdImpl<D, Derived>::reset() [with long unsigned int D = 1; Derived = torch::nn::Conv1dImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:32:8:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:82:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::weight’
     82 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:82:40: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     82 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |                ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:90:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::weight’
     90 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |       ^~~~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:90:40: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     90 |       weight = this->register_parameter("weight", torch::empty(weight_sizes));
        |                ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:94:7: error: using invalid field ‘torch::nn::ConvNdImpl<D, Derived>::bias’
     94 |       bias = this->register_parameter(
        |       ^~~~
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:94:38: error: cannot convert ‘at::Tensor’ to ‘torch::Tensor’
     94 |       bias = this->register_parameter(
        |              ~~~~~~~~~~~~~~~~~~~~~~~~^
     95 |           "bias", torch::empty({options.out_channels()}));
        |           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/module.h:433:14: note:   initializing argument 2 of ‘torch::Tensor& torch::nn::Module::register_parameter(std::string, torch::Tensor, bool)’
    433 |       Tensor tensor,
        |       ~~~~~~~^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules.h:20,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:7,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:97:40: error: invalid use of incomplete type ‘class torch::Tensor’
     97 |       this->register_parameter("bias", Tensor(), /*requires_grad=*/false);
        |                                        ^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::AdaptiveLogSoftmaxWithLossImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::MultiheadAttentionImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::ThresholdImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::LogSoftmaxImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::SoftminImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::SoftmaxImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::BilinearImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::UnflattenImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::LinearImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::TransformerDecoderImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::TransformerEncoderImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::TransformerDecoderLayerImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::TransformerEncoderLayerImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::GRUCellImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::LSTMCellImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::RNNCellImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::GRUImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::LSTMImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::RNNImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::FractionalMaxPool3dImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::FractionalMaxPool2dImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::GroupNormImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::LocalResponseNormImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::LayerNormImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::UnfoldImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::FoldImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::EmbeddingBagImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h: In instantiation of ‘std::shared_ptr<torch::nn::Module> torch::nn::Cloneable<Derived>::clone(...) const [with Derived = torch::nn::EmbeddingImpl]’:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:34:27:   required from here
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:52:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     52 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:53:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     53 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:54:42: error: invalid use of incomplete type ‘class torch::Tensor’
     54 |       copy->parameters_[parameter.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:36: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                             ~~~~~~~^~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:64:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     64 |       auto data = device && tensor.device() != *device ? tensor.to(*device)
        |                                                          ~~~~~~~^~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:65:65: error: invalid use of incomplete type ‘const class torch::Tensor’
     65 |                                                        : tensor.clone();
        |                                                          ~~~~~~~^~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  In file included from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn.h:3,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/all.h:15,
                   from /usr/local/lib/python3.10/dist-packages/torch/include/torch/extension.h:5,
                   from /workspace/nunchaku/nunchaku/csrc/ops.h:2,
                   from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:2:
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/cloneable.h:66:36: error: invalid use of incomplete type ‘class torch::Tensor’
     66 |       copy->buffers_[buffer.key()].set_data(data);
        |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~
  In file included from /workspace/nunchaku/nunchaku/csrc/pybind.cpp:1:
  /workspace/nunchaku/src/Linear.h:8:7: note: forward declaration of ‘class torch::Tensor’
      8 | class Tensor;
        |       ^~~~~~
  [13/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/src/kernels/layernorm_kernels.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/kernels/layernorm_kernels.cu -o /tmp/tmpup_b75_q.build-temp/src/kernels/layernorm_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [14/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm/gemm_w4a4.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/kernels/zgemm/gemm_w4a4.cu -o /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm/gemm_w4a4.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [15/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm/attention.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/kernels/zgemm/attention.cu -o /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm/attention.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [16/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/src/kernels/gemm_f16.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/kernels/gemm_f16.cu -o /tmp/tmpup_b75_q.build-temp/src/kernels/gemm_f16.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [17/37] c++ -MMD -MF /tmp/tmpup_b75_q.build-temp/src/interop/torch.o.d -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -fPIC -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/interop/torch.cpp -o /tmp/tmpup_b75_q.build-temp/src/interop/torch.o -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -fvisibility=hidden -g -std=c++20 -UNDEBUG -Og -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [18/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm/gemm_w4a4_test.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/kernels/zgemm/gemm_w4a4_test.cu -o /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm/gemm_w4a4_test.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [19/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm/gemm_w4a4_launch_bf16_fp4.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/kernels/zgemm/gemm_w4a4_launch_bf16_fp4.cu -o /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm/gemm_w4a4_launch_bf16_fp4.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [20/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm/gemm_w4a4_launch_fp16_fp4.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/kernels/zgemm/gemm_w4a4_launch_fp16_fp4.cu -o /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm/gemm_w4a4_launch_fp16_fp4.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [21/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm/gemm_w4a4_launch_fp16_int4_fasteri2f.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/kernels/zgemm/gemm_w4a4_launch_fp16_int4_fasteri2f.cu -o /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm/gemm_w4a4_launch_fp16_int4_fasteri2f.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [22/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/src/kernels/misc_kernels.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/kernels/misc_kernels.cu -o /tmp/tmpup_b75_q.build-temp/src/kernels/misc_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [23/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/nunchaku/csrc/ops.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/nunchaku/csrc/ops.cu -o /tmp/tmpup_b75_q.build-temp/nunchaku/csrc/ops.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h(92): warning #3189-D: "module" is parsed as an identifier rather than a keyword because the tokens that follow it do not match those of a preprocessor directive
              module->_forward_populate_default_args(std::move(arguments)));
              ^

  Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h(92): warning #3189-D: "module" is parsed as an identifier rather than a keyword because the tokens that follow it do not match those of a preprocessor directive
      module.attr(name) = wrapper_class;
      ^

  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h(154): warning #3189-D: "module" is parsed as an identifier rather than a keyword because the tokens that follow it do not match those of a preprocessor directive
                  module.to(
                  ^

  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h(158): warning #3189-D: "module" is parsed as an identifier rather than a keyword because the tokens that follow it do not match those of a preprocessor directive
                  module.to(detail::py_object_to_dtype(object), non_blocking);
                  ^

  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h(169): warning #3189-D: "module" is parsed as an identifier rather than a keyword because the tokens that follow it do not match those of a preprocessor directive
                    module.to(detail::py_object_to_dtype(dtype), non_blocking);
                    ^

  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h(171): warning #3189-D: "module" is parsed as an identifier rather than a keyword because the tokens that follow it do not match those of a preprocessor directive
                    module.to(detail::py_object_to_device(device), non_blocking);
                    ^

  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h(173): warning #3189-D: "module" is parsed as an identifier rather than a keyword because the tokens that follow it do not match those of a preprocessor directive
                    module.to(
                    ^

  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/nn/modules/container/any_module_holder.h(92): warning #3189-D: "module" is parsed as an identifier rather than a keyword because the tokens that follow it do not match those of a preprocessor directive
              module->_forward_populate_default_args(std::move(arguments)));
              ^

  Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h(92): warning #3189-D: "module" is parsed as an identifier rather than a keyword because the tokens that follow it do not match those of a preprocessor directive
      module.attr(name) = wrapper_class;
      ^

  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h(154): warning #3189-D: "module" is parsed as an identifier rather than a keyword because the tokens that follow it do not match those of a preprocessor directive
                  module.to(
                  ^

  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h(158): warning #3189-D: "module" is parsed as an identifier rather than a keyword because the tokens that follow it do not match those of a preprocessor directive
                  module.to(detail::py_object_to_dtype(object), non_blocking);
                  ^

  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h(169): warning #3189-D: "module" is parsed as an identifier rather than a keyword because the tokens that follow it do not match those of a preprocessor directive
                    module.to(detail::py_object_to_dtype(dtype), non_blocking);
                    ^

  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h(171): warning #3189-D: "module" is parsed as an identifier rather than a keyword because the tokens that follow it do not match those of a preprocessor directive
                    module.to(detail::py_object_to_device(device), non_blocking);
                    ^

  /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include/torch/python.h(173): warning #3189-D: "module" is parsed as an identifier rather than a keyword because the tokens that follow it do not match those of a preprocessor directive
                    module.to(
                    ^

  [24/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm/gemm_w4a4_launch_fp16_int4.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/kernels/zgemm/gemm_w4a4_launch_fp16_int4.cu -o /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm/gemm_w4a4_launch_fp16_int4.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  [25/37] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm/gemm_w4a4_launch_bf16_int4.o.d -I/workspace/nunchaku/src -I/workspace/nunchaku/third_party/cutlass/include -I/workspace/nunchaku/third_party/json/include -I/workspace/nunchaku/third_party/mio/include -I/workspace/nunchaku/third_party/spdlog/include -I/workspace/nunchaku/third_party/Block-Sparse-Attention/csrc/block_sparse_attn -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include -I/usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -I/usr/local/lib/python3.10/dist-packages/torch/include/TH -I/usr/local/lib/python3.10/dist-packages/torch/include/THC -I/usr/local/cuda/include -I/workspace/nunchaku/venv/include -I/usr/include/python3.10 -c -c /workspace/nunchaku/src/kernels/zgemm/gemm_w4a4_launch_bf16_int4.cu -o /tmp/tmpup_b75_q.build-temp/src/kernels/zgemm/gemm_w4a4_launch_bf16_int4.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DENABLE_BF16=1 -DBUILD_NUNCHAKU=1 -g -std=c++20 -UNDEBUG -Xcudafe --diag_suppress=20208 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_HALF2_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --threads=1 --expt-relaxed-constexpr --expt-extended-lambda --ptxas-options=--allow-expensive-optimizations=true --generate-line-info -gencode arch=compute_87,code=sm_87 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1016"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=1
  ninja: build stopped: subcommand failed.
  Traceback (most recent call last):
    File "/usr/local/lib/python3.10/dist-packages/torch/utils/cpp_extension.py", line 2209, in _run_ninja_build
      subprocess.run(
    File "/usr/lib/python3.10/subprocess.py", line 526, in run
      raise CalledProcessError(retcode, process.args,
  subprocess.CalledProcessError: Command '['ninja', '-v']' returned non-zero exit status 1.

  The above exception was the direct cause of the following exception:

  Traceback (most recent call last):
    File "/usr/local/lib/python3.10/dist-packages/setuptools/command/editable_wheel.py", line 139, in run
      self._create_wheel_file(bdist_wheel)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/command/editable_wheel.py", line 340, in _create_wheel_file
      files, mapping = self._run_build_commands(dist_name, unpacked, lib, tmp)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/command/editable_wheel.py", line 263, in _run_build_commands
      self._run_build_subcommands()
    File "/usr/local/lib/python3.10/dist-packages/setuptools/command/editable_wheel.py", line 290, in _run_build_subcommands
      self.run_command(name)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/_distutils/cmd.py", line 339, in run_command
      self.distribution.run_command(command)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/dist.py", line 999, in run_command
      super().run_command(command)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/_distutils/dist.py", line 1002, in run_command
      cmd_obj.run()
    File "/usr/local/lib/python3.10/dist-packages/setuptools/command/build_ext.py", line 99, in run
      _build_ext.run(self)
    File "/usr/local/lib/python3.10/dist-packages/Cython/Distutils/old_build_ext.py", line 186, in run
      _build_ext.build_ext.run(self)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/_distutils/command/build_ext.py", line 365, in run
      self.build_extensions()
    File "<string>", line 25, in build_extensions
    File "/usr/local/lib/python3.10/dist-packages/torch/utils/cpp_extension.py", line 900, in build_extensions
      build_ext.build_extensions(self)
    File "/usr/local/lib/python3.10/dist-packages/Cython/Distutils/old_build_ext.py", line 195, in build_extensions
      _build_ext.build_ext.build_extensions(self)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/_distutils/command/build_ext.py", line 481, in build_extensions
      self._build_extensions_serial()
    File "/usr/local/lib/python3.10/dist-packages/setuptools/_distutils/command/build_ext.py", line 507, in _build_extensions_serial
      self.build_extension(ext)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/command/build_ext.py", line 264, in build_extension
      _build_ext.build_extension(self, ext)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/_distutils/command/build_ext.py", line 562, in build_extension
      objects = self.compiler.compile(
    File "/usr/local/lib/python3.10/dist-packages/torch/utils/cpp_extension.py", line 713, in unix_wrap_ninja_compile
      _write_ninja_file_and_compile_objects(
    File "/usr/local/lib/python3.10/dist-packages/torch/utils/cpp_extension.py", line 1869, in _write_ninja_file_and_compile_objects
      _run_ninja_build(
    File "/usr/local/lib/python3.10/dist-packages/torch/utils/cpp_extension.py", line 2225, in _run_ninja_build
      raise RuntimeError(message) from e
  RuntimeError: Error compiling objects for extension
  /usr/local/lib/python3.10/dist-packages/setuptools/_distutils/dist.py:1002: _DebuggingTips: Problem in editable installation.
  !!

          ********************************************************************************
          An error happened while installing `nunchaku` in editable mode.

          The following steps are recommended to help debug this problem:

          - Try to install the project normally, without using the editable mode.
            Does the error still persist?
            (If it does, try fixing the problem before attempting the editable mode).
          - If you are using binary extensions, make sure you have all OS-level
            dependencies installed (e.g. compilers, toolchains, binary libraries, ...).
          - Try the latest version of setuptools (maybe the error was already fixed).
          - If you (or your project dependencies) are using any setuptools extension
            or customization, make sure they support the editable mode.

          After following the steps above, if the problem still persists and
          you think this is related to how setuptools handles editable installations,
          please submit a reproducible example
          (see https://stackoverflow.com/help/minimal-reproducible-example) to:

              https://github.com/pypa/setuptools/issues

          See https://setuptools.pypa.io/en/latest/userguide/development_mode.html for details.
          ********************************************************************************

  !!
    cmd_obj.run()
  Traceback (most recent call last):
    File "/usr/local/lib/python3.10/dist-packages/torch/utils/cpp_extension.py", line 2209, in _run_ninja_build
      subprocess.run(
    File "/usr/lib/python3.10/subprocess.py", line 526, in run
      raise CalledProcessError(retcode, process.args,
  subprocess.CalledProcessError: Command '['ninja', '-v']' returned non-zero exit status 1.

  The above exception was the direct cause of the following exception:

  Traceback (most recent call last):
    File "/workspace/nunchaku/venv/lib/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py", line 363, in <module>
      main()
    File "/workspace/nunchaku/venv/lib/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py", line 345, in main
      json_out['return_val'] = hook(**hook_input['kwargs'])
    File "/workspace/nunchaku/venv/lib/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py", line 283, in build_editable
      return hook(wheel_directory, config_settings, metadata_directory)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/build_meta.py", line 476, in build_editable
      return self._build_with_temp_dir(
    File "/usr/local/lib/python3.10/dist-packages/setuptools/build_meta.py", line 407, in _build_with_temp_dir
      self.run_setup()
    File "/usr/local/lib/python3.10/dist-packages/setuptools/build_meta.py", line 320, in run_setup
      exec(code, locals())
    File "<string>", line 196, in <module>
    File "/usr/local/lib/python3.10/dist-packages/setuptools/__init__.py", line 117, in setup
      return distutils.core.setup(**attrs)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/_distutils/core.py", line 186, in setup
      return run_commands(dist)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/_distutils/core.py", line 202, in run_commands
      dist.run_commands()
    File "/usr/local/lib/python3.10/dist-packages/setuptools/_distutils/dist.py", line 983, in run_commands
      self.run_command(cmd)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/dist.py", line 999, in run_command
      super().run_command(command)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/_distutils/dist.py", line 1002, in run_command
      cmd_obj.run()
    File "/usr/local/lib/python3.10/dist-packages/setuptools/command/editable_wheel.py", line 139, in run
      self._create_wheel_file(bdist_wheel)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/command/editable_wheel.py", line 340, in _create_wheel_file
      files, mapping = self._run_build_commands(dist_name, unpacked, lib, tmp)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/command/editable_wheel.py", line 263, in _run_build_commands
      self._run_build_subcommands()
    File "/usr/local/lib/python3.10/dist-packages/setuptools/command/editable_wheel.py", line 290, in _run_build_subcommands
      self.run_command(name)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/_distutils/cmd.py", line 339, in run_command
      self.distribution.run_command(command)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/dist.py", line 999, in run_command
      super().run_command(command)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/_distutils/dist.py", line 1002, in run_command
      cmd_obj.run()
    File "/usr/local/lib/python3.10/dist-packages/setuptools/command/build_ext.py", line 99, in run
      _build_ext.run(self)
    File "/usr/local/lib/python3.10/dist-packages/Cython/Distutils/old_build_ext.py", line 186, in run
      _build_ext.build_ext.run(self)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/_distutils/command/build_ext.py", line 365, in run
      self.build_extensions()
    File "<string>", line 25, in build_extensions
    File "/usr/local/lib/python3.10/dist-packages/torch/utils/cpp_extension.py", line 900, in build_extensions
      build_ext.build_extensions(self)
    File "/usr/local/lib/python3.10/dist-packages/Cython/Distutils/old_build_ext.py", line 195, in build_extensions
      _build_ext.build_ext.build_extensions(self)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/_distutils/command/build_ext.py", line 481, in build_extensions
      self._build_extensions_serial()
    File "/usr/local/lib/python3.10/dist-packages/setuptools/_distutils/command/build_ext.py", line 507, in _build_extensions_serial
      self.build_extension(ext)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/command/build_ext.py", line 264, in build_extension
      _build_ext.build_extension(self, ext)
    File "/usr/local/lib/python3.10/dist-packages/setuptools/_distutils/command/build_ext.py", line 562, in build_extension
      objects = self.compiler.compile(
    File "/usr/local/lib/python3.10/dist-packages/torch/utils/cpp_extension.py", line 713, in unix_wrap_ninja_compile
      _write_ninja_file_and_compile_objects(
    File "/usr/local/lib/python3.10/dist-packages/torch/utils/cpp_extension.py", line 1869, in _write_ninja_file_and_compile_objects
      _run_ninja_build(
    File "/usr/local/lib/python3.10/dist-packages/torch/utils/cpp_extension.py", line 2225, in _run_ninja_build
      raise RuntimeError(message) from e
  RuntimeError: Error compiling objects for extension
  error: subprocess-exited-with-error
  
  × Building editable for nunchaku (pyproject.toml) did not run successfully.
  │ exit code: 1
  ╰─> See above for output.
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  full command: /workspace/nunchaku/venv/bin/python3 /workspace/nunchaku/venv/lib/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py build_editable /tmp/tmpe8iv364c
  cwd: /workspace/nunchaku
  Building editable for nunchaku (pyproject.toml): finished with status 'error'
  ERROR: Failed building editable for nunchaku
Failed to build nunchaku
ERROR: Could not build wheels for nunchaku, which is required to install pyproject.toml-based projects
